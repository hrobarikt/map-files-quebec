{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"__TECTONIC__$servicenow_ui_renderer_snabbdom\"","webpack:///external \"__TECTONIC__sn_translate\"","webpack:///external \"__TECTONIC__$servicenow_ui_core\"","webpack:///external \"__TECTONIC__$servicenow_ui_effect_graphql\"","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///external \"__TECTONIC__$servicenow_now_button\"","webpack:///./node_modules/@babel/runtime/helpers/extends.js","webpack:///./src/now-kb-office-addin/now-kb-office-addin-footer/styles.scss?debe","webpack:///./src/now-kb-office-addin/styles.scss?af86","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///external \"__TECTONIC__$servicenow_ui_effect_amb\"","webpack:///external \"__TECTONIC__$devsnc_library_uxf_19_50_22\"","webpack:///external \"__TECTONIC__$servicenow_now_card\"","webpack:///./src/now-kb-office-addin/now-kb-office-addin-footer/styles.scss","webpack:///external \"__TECTONIC__$servicenow_now_template_card\"","webpack:///external \"__TECTONIC__$servicenow_now_heading\"","webpack:///external \"__TECTONIC__$servicenow_now_modal\"","webpack:///external \"__TECTONIC__$servicenow_now_tooltip\"","webpack:///external \"__TECTONIC__$servicenow_now_pill\"","webpack:///./src/now-kb-office-addin/styles.scss","webpack:///./src/now-kb-office-addin/Word/helpers.js","webpack:///./src/now-kb-office-addin/Word/index.js","webpack:///./src/now-kb-office-addin/updateArticleFromDocument.js","webpack:///./src/now-kb-office-addin/now-kb-office-addin-footer/action.js","webpack:///./src/now-kb-office-addin/now-kb-office-addin-footer/index.js","webpack:///./src/now-kb-office-addin/now-kb-office-addin-footer/view.js","webpack:///./src/now-kb-office-addin/svgImgs.js","webpack:///./src/now-kb-office-addin/routes/Home.js","webpack:///./src/now-kb-office-addin/routes/Loader.js","webpack:///./src/now-kb-office-addin/routes/Search.js","webpack:///./src/now-kb-office-addin/routes/Form.js","webpack:///./src/now-kb-office-addin/routes/index.js","webpack:///./src/now-kb-office-addin/view.js","webpack:///./src/now-kb-office-addin/actions/homeActions.js","webpack:///./src/now-kb-office-addin/actions/searchActions.js","webpack:///./src/now-kb-office-addin/actions/formActions.js","webpack:///./src/now-kb-office-addin/actions/index.js","webpack:///./src/now-kb-office-addin/kb-office-addin.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__TECTONIC__$servicenow_ui_renderer_snabbdom","__TECTONIC__sn_translate","__TECTONIC__$servicenow_ui_core","__TECTONIC__$servicenow_ui_effect_graphql","useSourceMap","list","toString","this","map","item","content","cssMapping","btoa","sourceMapping","sourceMap","base64","unescape","encodeURIComponent","JSON","stringify","data","concat","sourceURLs","sources","source","sourceRoot","join","cssWithMappingToString","mediaQuery","dedupe","alreadyImportedModules","length","id","_i","push","__TECTONIC__$servicenow_now_button","_extends","assign","target","arguments","apply","result","obj","configurable","writable","__TECTONIC__$servicenow_ui_effect_amb","__TECTONIC__$devsnc_library_uxf_19_50_22","__TECTONIC__$servicenow_now_card","___CSS_LOADER_API_IMPORT___","__TECTONIC__$servicenow_now_template_card","__TECTONIC__$servicenow_now_heading","__TECTONIC__$servicenow_now_modal","__TECTONIC__$servicenow_now_tooltip","__TECTONIC__$servicenow_now_pill","fetchImages","imgs","imgRequests","img","URL","src","origin","document","baseURI","e","isNowURL","fetch","then","response","Promise","async","resolve","reject","reader","FileReader","onloadend","onerror","readAsDataURL","blob","promises","allSettled","reqs","status","all","catch","preProcessHtml","doc","DOMParser","parseFromString","base","createElement","href","location","head","appendChild","images","Array","from","forEach","index","body","innerHTML","getShareableUrl","url","Office","context","getFilePropertiesAsync","path","pathname","isOneDrive","host","endsWith","pathMatcher","match","searchParams","set","decodeURIComponent","replace","setCustomProperty","prop","Word","run","properties","customProperties","add","sync","insertContentControl","title","tag","appearance","clearContent","html","clear","control","insertHtml","getSelection","select","getDocument","fileName","getFileAsync","FileType","Compressed","sliceSize","AsyncResultStatus","Succeeded","error","blobs","count","file","sliceCount","sliceIndex","getSliceAsync","Blob","Uint8Array","closeAsync","getAllBlobs","docxFile","File","type","success","sysId","method","headers","g_ck","json","COMPONENT_PROPERTY_CHANGED","actionTypes","action","payload","dispatch","fields","office_doc_url","values","filter","field","some","originalValue","readonly","displayValue","modifier","delay","stopPropagation","effect","homePage","newArticle","officeInitialized","uiAction","actionSysId","page","notificationAction","isInvalid","mandatory","number","includes","updateArticleFromDocument","createCustomElement","view","actions","label","size","variant","append-to-payload","styles","actionHandlers","default","reflect","customPropertySet","sessionExpired","dangerouslyCreateElementFromString","noResults","kbList","canContribute","className","kb","sys_id","interaction","heading","lines","caption","description","hasNoMargin","level","purpose","home-page","loading","resultList","totalPaginationCount","paginationOffset","searchQuery","Loader","short_description","kb_knowledge_base","kb_category","display_number","workflow_state","resultIndex","manage-selected","Boolean","tagline","icon","disabled","tooltipContent","bare","configAria","previousResults","nextResults","uiActions","style","display","spin","table","sys-id","workspace-config-id","slot","new-article","office-initialized","custom-property-set","state","Home","Search","Form","iconWithToolTip","toolTip","target-ref","elm","backIcon","aria-describedby","homeIcon","infoIcon","reloadIcon","Navbar","historyCount","displayNavButtons","loggedIn","on-click","open","reload","loginPage","has-no-margin","iconEnd","WarningModal","showWarning","header-label","footer-actions","clickActionType","opened","manage-opened","contentChangedWarning","cssText","DirtyFormModal","dirtyFormWarning","homeActions","createGraphQLEffect","successActionType","errorActionType","updateState","GlideRecord_Query","_results","AppKnowledge_Query","getContributableKnowledgeBases","searchActions","selectedKb","commonQuery","queryConditions","variableList","kb_knowledge","Math","ceil","_rowCount","formActions","query","loadedArticle","updateProperties","results","stateMap","reduce","article","setTimeout","resetDocument","currentArticleNumber","isEmpty","getHtml","text","textContent","trim","articleContent","undefined","GlideUIAction_Query","setAutoOpenAddin","shouldOpen","settings","saveAsync","COMPONENT_BOOTSTRAPPED","COMPONENT_DISCONNECTED","paramPropertyMap","getPath","execRouterActions","handleLogout","window","top","focus","onfocus","getComponentsByTagNames","subscribe","setupRouter","props","history","replaceState","onpopstate","params","URLSearchParams","search","newProps","addIn","initialize","kbNumber","getItemOrNullObject","load","createAmbEventEffect","selectedKbTitle","searchPill","sys_class_name","oldPage","dirtyForm","dirtyFormRedirect","nextPath","pushState","goBackOnRedirect","back","onbeforeunload","canDismiss","autoComplete","on-change","placeholder","initialState"],"mappings":"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","file":"@servicenow/now-kb-office-addin/now-kb-office-addin.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 12);\n","module.exports = __TECTONIC__$servicenow_ui_renderer_snabbdom;","module.exports = __TECTONIC__sn_translate;","module.exports = __TECTONIC__$servicenow_ui_core;","module.exports = __TECTONIC__$servicenow_ui_effect_graphql;","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","module.exports = __TECTONIC__$servicenow_now_button;","function _extends() {\n  module.exports = _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nmodule.exports = _extends;","\n        var result = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/src/index.js??ref--5-2!../../../node_modules/resolve-url-loader/index.js??ref--5-3!../../../node_modules/sass-loader/dist/cjs.js??ref--5-4!./styles.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","\n        var result = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/src/index.js??ref--5-2!../../node_modules/resolve-url-loader/index.js??ref--5-3!../../node_modules/sass-loader/dist/cjs.js??ref--5-4!./styles.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","module.exports = __TECTONIC__$servicenow_ui_effect_amb;","module.exports = __TECTONIC__$devsnc_library_uxf_19_50_22;","module.exports = __TECTONIC__$servicenow_now_card;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \":host{box-sizing:border-box;line-height:var(--now-line-height,1.25);font-family:var(--now-font-family,\\\"Source Sans Pro\\\",sans-serif)}:host([hidden]){display:none}*,:after,:before{box-sizing:border-box}:host{display:flex;min-height:3rem;align-items:center;justify-content:space-evenly;box-shadow:0 4px .5rem 0 RGBA(var(--now-color--neutral-21,0,0,0),.25)}:host now-button{width:120px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","module.exports = __TECTONIC__$servicenow_now_template_card;","module.exports = __TECTONIC__$servicenow_now_heading;","module.exports = __TECTONIC__$servicenow_now_modal;","module.exports = __TECTONIC__$servicenow_now_tooltip;","module.exports = __TECTONIC__$servicenow_now_pill;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \":host{box-sizing:border-box;line-height:var(--now-line-height,1.25);font-family:var(--now-font-family,\\\"Source Sans Pro\\\",sans-serif)}:host([hidden]){display:none}*,:after,:before{box-sizing:border-box}:host{background-color:#fff;display:flex;flex-direction:column}nav.kb-office-nav{display:grid;background-color:RGB(var(--now-color_brand--primary,var(--now-color--brand-1,41,62,64)));padding:.25rem;grid-template-columns:1.5rem auto 1.5rem;height:2rem}nav.kb-office-nav button{background-color:unset;border:unset;padding:0;cursor:pointer}nav.kb-office-nav button:active{color:RGB(var(--now-color_brand--secondary,var(--now-color--brand-2,129,181,161)))}nav.kb-office-nav button:focus{outline:1px solid RGB(var(--now-color--secondary-1,1,119,142))}nav.kb-office-nav now-icon{color:#fff}nav.kb-office-nav img{cursor:pointer;margin:auto}input{height:2rem;width:100%;border:0;padding-left:.25rem;border-bottom:1px solid rgb(var(--now-color_divider--secondary,var(--now-color--neutral-5,172,180,181)));color:RGB(var(--now-color_text--primary,var(--now-color--neutral-18,22,27,28)));font-size:1rem}input:hover{background-color:RGB(var(--now-color--neutral-2,228,230,231));border-bottom:1px solid rgb(var(--now-color_divider--secondary,var(--now-color--neutral-5,172,180,181)))}input:focus{outline:none;border-bottom:1px solid rgb(var(--now-color--primary-1,30,133,109));background-color:RGB(var(--now-color--primary-0,221,237,233))}main{height:calc(100% - 2rem);display:flex;flex-flow:column}main p.login-msg{padding:0 10%;color:RGB(var(--now-color--neutral-7,135,147,148))}main svg.login-icon{width:50%;height:40%;margin-left:auto;margin-right:auto}main svg.no-results{margin:.75rem auto;width:50%}main ul.login-actions{padding:0 10%;list-style-type:none}main ul.login-actions li{margin-top:.75rem}main ul.login-actions li now-icon{margin-bottom:2px;color:RGB(var(--now-color--secondary-2,1,89,107));transform:rotate(-90deg)}main ul.login-actions li now-button-bare{margin-left:1rem}main ul.login-actions li:last-child{margin-left:2rem;color:RGB(var(--now-color--neutral-7,135,147,148))}main now-heading.login-title{margin:0 auto}main span.page-header{margin:1rem 1rem .75rem}main div.search-pagination,main span.page-header{display:flex;justify-content:space-between;align-items:center}main div.search-pagination{margin-top:auto;min-height:2rem;box-shadow:0 4px .5rem 0 RGBA(var(--now-color--neutral-21,0,0,0),.25)}main p.pagination-warning{padding:0 1rem;color:RGB(var(--now-color--neutral-12,66,80,81))}main input{margin-block-end:0;margin:0 5%;width:90%}main div.card-list{display:flex;margin:0 5%;flex-flow:column;height:calc(100% - 25px - 3.5rem);margin-block-start:.5rem;overflow:auto}main div.card-list>now-card,main div.card-list now-template-card-assist{list-style:none;margin-block-end:.75rem}main div.card-list now-heading{margin:1rem auto}main div.card-list span.no-results-help{text-align:center;color:RGB(var(--now-color--neutral-7,135,147,148))}main now-record-form-section-connected{height:calc(100% - 3rem);padding:0 5%;display:flex;flex-direction:column;overflow-x:hidden}main now-record-form-section-connected now-kb-office-addin-footer{position:fixed;left:0;bottom:0;right:0}main now-kb-office-addin-footer{margin-top:auto}main div.form-loading-layover{position:absolute;top:0;left:0;height:100%;width:100%;z-index:10;opacity:.65;background-color:RGB(var(--now-color--neutral-2,228,230,231))}main div.form-loading-layover now-icon{color:RGB(var(--now-color--primary-3,15,67,55));top:50%;left:48%;position:absolute}.skeleton{height:90px;margin-bottom:.75rem;border:1px solid rgb(var(--now-color--neutral-3,209,214,214));background-image:linear-gradient(100deg,hsla(0,0%,100%,0),hsla(0,0%,100%,.5) 50%,hsla(0,0%,100%,0) 80%),linear-gradient(RGB(var(--now-color--neutral-3,209,214,214)) 1rem,transparent 0),linear-gradient(RGB(var(--now-color--neutral-2,228,230,231)) 1rem,transparent 0),linear-gradient(RGB(var(--now-color--neutral-2,228,230,231)) 1rem,transparent 0);background-repeat:no-repeat;background-size:80px 90px,30% 1rem,80% 1rem,80% 1rem;background-position:.75rem .75rem,.75rem .75rem,.75rem 2.25rem,.75rem 3.75rem;animation:shine .75s infinite}@keyframes shine{to{background-position:100% .75rem,.75rem .75rem,.75rem 2.25rem,.75rem 3.75rem}}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","const promiseAll = promises => {\n    if(Promise.allSettled){\n        return Promise.allSettled(promises).then(reqs => reqs.map(({status,value}) => status==='fulfilled'?value: null));\n    } else {\n        return Promise.all(promises.map(p => p.catch(() => null)));\n    }\n};\n\nconst isNowURL = img => {\n    try{\n        const url = new URL(img.src);\n        return url.origin === new URL(document.baseURI).origin;\n    }\n    catch(e){\n        return true;\n    }\n};\n\nconst fetchImages = imgs => {\n    const imgRequests = imgs.map(img => {\n        if(isNowURL(img)){\n            return fetch(img.src).then(response => \n                new Promise(async (resolve, reject) => {\n                    const reader = new FileReader()\n                    reader.onloadend = () => resolve(reader.result)\n                    reader.onerror = reject;\n                    reader.readAsDataURL(await response.blob());\n                })\n            )\n        } else {\n            return Promise.resolve(img.src);\n        }\n    });\n    return imgRequests.length > 0? promiseAll(imgRequests): Promise.resolve([]);\n};\nexport const getAllBlobs = async file => {\n    const blobs = [];\n    let count = file.sliceCount;\n    while (count --> 0) {\n        const sliceIndex = file.sliceCount - count - 1;\n        blobs.push(await new Promise((resolve, reject) => \n            file.getSliceAsync(sliceIndex, ({status, value: {data}}) => \n                status === Office.AsyncResultStatus.Succeeded? resolve(new Blob([new Uint8Array(data)])): file.closeAsync(reject)\n            )\n        ));\n    }\n    file.closeAsync();\n    return blobs;\n};\n\nexport const preProcessHtml = async content => {\n    const doc = new DOMParser().parseFromString(content, 'text/html');\n    var base = doc.createElement('base');\n    base.href = location.origin;\n    doc.head.appendChild(base);\n    const images = Array.from(doc.images);\n    const imgData = await fetchImages(images);\n    imgData.forEach((data, index) => data? images[index].src = data: null);\n\n    return doc.body.innerHTML;\n};\n","import {getAllBlobs, preProcessHtml} from './helpers';\n\nexport const initializeOffice = () => new Promise((resolve, reject) => {\n    try{\n        Office.initialize = resolve;\n    }catch(e){\n        reject();\n    }\n});\n\nexport const getDocumentUrl = () => new Promise((resolve, reject) => \n    Office.context.document.getFilePropertiesAsync(({value, status}) => \n        (status === 'succeeded')? resolve(value.url): reject())\n);\n\nexport const getShareableUrl = () => new Promise(async resolve => {\n    const urlComponent = '_layouts/WordViewer.aspx';\n    const url = new URL(await getDocumentUrl());\n    const path = url.pathname;\n    const isOneDrive = url.host.endsWith('-my.sharepoint.com');\n\n    if(isOneDrive || url.host.endsWith('.sharepoint.com')){\n        const pathMatcher = path.match(isOneDrive? '\\/personal\\/(.*?)\\/': '\\/sites\\/(.*?)\\/');\n        if(pathMatcher){\n            url.pathname = pathMatcher[0] + urlComponent;\n            url.searchParams.set('id', decodeURIComponent(path.replace(pathMatcher[0], '')));\n            resolve(url.href);\n            return;\n        }\n    }\n    resolve(null);\n});\n\nexport const getCustomProperty = prop => new Promise(resolve => {\n    Word.run(async context => {\n        const property = context.document.properties.customProperties.getItemOrNullObject(prop);\n        context.load(property);\n        await context.sync();\n        resolve(property.value);\n    });\n});\n\nexport const setCustomProperty = (prop, value) => new Promise(resolve => {\n    Word.run(async context => {\n        context.document.properties.customProperties.add(prop,value);\n        await context.sync();\n        resolve();\n    });\n});\n\nexport const insertContentControl = (title, tag, appearance = 'BoundingBox', clearContent = true, html = '', location = 'Start') => new Promise(resolve => {\n    Word.run(async context => {\n        const body = context.document.body;\n        if(clearContent) body.clear();\n\n        const control = body.insertContentControl();\n        control.tag = tag;\n        control.title = title;\n        control.appearance = appearance;\n\n        if(html) control.insertHtml(await preProcessHtml(html), location);\n        \n        const range = context.document.getSelection();\n        range.select(location);\n        await context.sync();\n        resolve();\n    });\n});\n\nexport const isContentEmpty = () => new Promise(resolve => {\n    Word.run(async context => {\n        const html = context.document.body.getHtml();\n        await context.sync();\n        const text = new DOMParser().parseFromString(html.value, 'text/html').body.textContent;\n        resolve(!text.trim());\n    });\n});\n\nexport const setAutoOpenAddin = shouldOpen => new Promise((resolve, reject) => {\n    Office.context.document.settings.set(\"Office.AutoShowTaskpaneWithDocument\", shouldOpen);\n    Office.context.document.settings.saveAsync(result => {\n        if(result.status === Office.AsyncResultStatus.Succeeded){\n            resolve();\n        } else {\n            reject(result.error);\n        }\n    });\n});\n\nexport const getDocument = fileName => new Promise((resolve, reject) => {\n    Office.context.document.getFileAsync(Office.FileType.Compressed, { sliceSize: 750*1024 }, async result => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n            const blobs = await getAllBlobs(result.value);\n            const docxFile = new File(blobs, fileName + '.docx', {\n                type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\n            });\n            resolve({\n                file: docxFile,\n                success: true\n            });\n            return;\n        }\n        reject({error: true});\n    });\n});\n","import {getDocument} from './Word';\n\nexport default async sysId => {\n    const {success, error, file} = await getDocument('kb_addin_doc');\n    if(error && !success){\n        return {error};\n    }\n\n    return await fetch(`/api/sn_km_word/knowledge_addin/kb_document_update?sys_id=${sysId}`, {\n        method: \"POST\",\n        body: file,\n        headers: {\n            'x-usertoken': g_ck\n        }\n    }).then(response => response.json());\n};\n","import updateArticleFromDocument from '../updateArticleFromDocument';\nimport {actionTypes} from '@servicenow/ui-core';\nimport {getShareableUrl} from '../Word';\n\nconst {COMPONENT_PROPERTY_CHANGED} = actionTypes\n\nexport default {\n    [COMPONENT_PROPERTY_CHANGED]: async ({action: {payload: {name}}, dispatch, properties: {sysId, fields}}) => {\n        if(name !== 'fields'){\n            return;\n        }\n        const {office_doc_url} = fields;\n        const unsavedForm = Object.values(fields).filter(field => field.name !== 'office_doc_url').some(field => field.originalValue !== field.value)\n        dispatch('DIRTY_FORM_SET',unsavedForm);\n        \n        if(!sysId || (office_doc_url && office_doc_url.value) || office_doc_url.readonly)\n            return;\n        const url = await getShareableUrl();\n        if(url){\n            dispatch('SET_FIELDS_VALUE', {\n                fields: {\n                    office_doc_url: {\n                        value: url,\n                        displayValue: url\n                    }\n                }\n            });\n        }\n    },\n    ['NOW_BUTTON#CLICKED']: {\n        modifier: {name: 'debounce', delay: 100},\n        stopPropagation: true,\n        effect: async ({properties:{fields, homePage, newArticle, sysId, officeInitialized}, action: {payload: {uiAction, actionSysId, name}, stopPropagation}, dispatch}) => {\n            if(homePage){\n                dispatch('ROUTE_CHANGED',{\n                    page: 'form',\n                    sysId: '-1'\n                });\n                return;\n            }\n\n            dispatch('CLEAR_NOTIFICATIONS', {\n                notificationAction: {\n                    type: 'clear'\n                }\n            });\n\n            const isInvalid = Object.values(fields).some(field => (field.mandatory && !field.value) || field.isInvalid);\n            if(!isInvalid)\n                dispatch('LOADING_STARTED');\n            if(newArticle){\n                dispatch('GFORM#SAVE');\n                if(!isInvalid){\n                    dispatch('DIRTY_FORM_SET',false);\n                    dispatch('CUSTOM_PROPERTY_SET', fields.number.value);\n                }\n            } else if(uiAction){\n                if(!isInvalid && officeInitialized && ['publish_knowledge','sysverb_ws_save'].includes(name)){\n                    await updateArticleFromDocument(sysId).then(() => dispatch('CUSTOM_PROPERTY_SET', fields.number.value));\n                }\n                dispatch('NOW_RECORD_UI_ACTION_BAR#CLICKED',{actionSysId});\n                dispatch('UI_ACTIONS_LOAD_INITIATED', {sysId});\n            }\n        }\n    }\n};\n","import { createCustomElement } from \"@servicenow/ui-core\";\nimport view from './view';\nimport styles from './styles.scss';\nimport actionHandlers from './action';\n\ncreateCustomElement('now-kb-office-addin-footer', {\n    view,\n    styles,\n    actionHandlers,\n    properties: {\n        newArticle: {\n            default: false\n        },\n        homePage: {\n            default: false\n        },\n        actions:{\n            default: []\n        },\n        sysId: {\n            default: ''\n        },\n        fields:{\n            default: {}\n        },\n\t\tofficeInitialized: {\n\t\t\tdefault: false,\n\t\t\treflect: true\n        },\n        customPropertySet: {\n            default: false\n        }\n    }\n});\n","import {Fragment} from '@servicenow/ui-renderer-snabbdom';\nimport {t} from 'sn-translate';\n\nexport default ({properties: {newArticle,homePage,actions}}) => {\n    if(homePage || newArticle)\n        return <now-button label={newArticle? t('Submit'): t('Create article')} size=\"md\" variant=\"secondary\" append-to-payload={{name:newArticle}}/>;\n    if(actions.length > 0){\n        return (\n            <Fragment>\n                {actions.map(({sysId, label, name}) => (\n                    <now-button label={label} size=\"md\" variant=\"secondary\" append-to-payload={{\n                        uiAction: true,\n                        actionSysId:sysId,\n                        name\n                    }}/>\n                ))}\n            </Fragment>\n        );\n    }\n};\n","import {dangerouslyCreateElementFromString} from '@servicenow/ui-renderer-snabbdom';\n\nexport const sessionExpired = dangerouslyCreateElementFromString(`<svg class=\"login-icon\" height=\"360pt\" viewBox=\"-3 0 360 360.90027\" width=\"360pt\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"m60.109375 114.644531c1.082031.628907 2.265625.929688 3.433594.929688 2.347656 0 4.632812-1.207031 5.902343-3.382813 3.691407-6.324218 8.011719-12.363281 12.824219-17.941406 2.46875-2.855469 2.148438-7.164062-.703125-9.628906-2.835937-2.457032-7.160156-2.152344-9.628906.707031-5.359375 6.207031-10.167969 12.929687-14.28125 19.976563-1.898438 3.257812-.808594 7.4375 2.453125 9.339843zm0 0\"/>\n    <path d=\"m122.515625 229.722656c1.746094 0 3.492187-.667968 4.828125-2l50.410156-50.417968c1.28125-1.277344 2.003906-3.015626 2.003906-4.824219v-72.023438c0-3.769531-3.054687-6.828125-6.828124-6.828125-3.773438 0-6.828126 3.058594-6.828126 6.828125v69.195313l-48.410156 48.417968c-2.667968 2.664063-2.667968 6.984376 0 9.652344 1.332032 1.332032 3.078125 2 4.824219 2zm0 0\"/>\n    <path d=\"m329.789062 244.164062c10.332032-22.554687 15.621094-46.644531 15.621094-71.683593 0-95.109375-77.375-172.480469-172.480468-172.480469-95.105469 0-172.480469 77.375-172.480469 172.480469s77.375 172.480469 172.480469 172.480469c21.625 0 42.671874-3.992188 62.625-11.773438 11.882812 16.738281 31.378906 27.710938 53.429687 27.710938 36.136719 0 65.539063-29.398438 65.539063-65.539063 0-20.710937-9.683594-39.179687-24.734376-51.195313zm-156.859374 87.144532c-87.578126 0-158.828126-71.25-158.828126-158.828125 0-87.574219 71.25-158.824219 158.828126-158.824219 87.578124 0 158.824218 71.25 158.824218 158.824219 0 22.425781-4.617187 44.011719-13.609375 64.273437-7.621093-3.808594-16.070312-6.15625-25.015625-6.722656 6.34375-13.234375 10.558594-27.3125 12.277344-42.042969 8.554688-73.050781-43.917969-139.4375-116.972656-147.988281-29.765625-3.476562-58.980469 2.863281-84.546875 18.34375-3.21875 1.953125-4.25 6.152344-2.300781 9.375 1.960937 3.234375 6.160156 4.257812 9.382812 2.304688 22.933594-13.890626 49.152344-19.589844 75.878906-16.460938 31.765625 3.71875 60.179688 19.582031 80.011719 44.671875 19.835937 25.09375 28.707031 56.40625 24.988281 88.167969-1.78125 15.226562-6.359375 29.730468-13.601562 43.109375-.230469.425781-.273438.886719-.40625 1.332031-25.988282 4.476562-46.75 24.261719-52.65625 49.734375-.511719.109375-1.027344.144531-1.523438.375-20.105468 9.429687-42.453125 13.054687-64.652344 10.449219-31.769531-3.722656-60.183593-19.585938-80.015624-44.675782-19.832032-25.09375-28.707032-56.402343-24.988282-88.164062.441406-3.742188-2.238281-7.136719-5.984375-7.574219-3.773437-.4375-7.136719 2.246094-7.574219 5.984375-4.140624 35.386719 5.746094 70.269532 27.839844 98.21875 22.089844 27.953125 53.746094 45.625 89.132813 49.769532 5.199219.609374 10.398437.910156 15.59375.910156 17.3125 0 34.429687-3.378906 50.453125-9.949219.074218 8.914063 1.925781 17.410156 5.238281 25.144531-17.816406 6.691406-36.519531 10.242188-55.773437 10.242188zm116.054687 15.9375c-28.617187 0-51.886719-23.277344-51.886719-51.886719s23.273438-51.886719 51.886719-51.886719c28.609375 0 51.882813 23.277344 51.882813 51.886719s-23.269532 51.886719-51.882813 51.886719zm0 0\"/>\n    <path d=\"m288.984375 254.398438c-3.773437 0-6.828125 3.058593-6.828125 6.828124v40.960938c0 3.769531 3.054688 6.824219 6.828125 6.824219s6.824219-3.054688 6.824219-6.824219v-40.960938c0-3.769531-3.050782-6.828124-6.824219-6.828124zm0 0\"/>\n    <path d=\"m295.808594 322.664062c0 3.773438-3.054688 6.828126-6.824219 6.828126-3.773437 0-6.828125-3.054688-6.828125-6.828126 0-3.769531 3.054688-6.824218 6.828125-6.824218 3.769531 0 6.824219 3.054687 6.824219 6.824218zm0 0\"/>\n</svg>`);\n\nexport const noResults = dangerouslyCreateElementFromString(`<svg class=\"no-results\" version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\" viewBox=\"0 0 141 71\">\n    <style type=\"text/css\">\n        .st0{fill:#FFFFFF;stroke:#293E40;stroke-width:3;}\n        .st1{fill:none;stroke:#293E40;stroke-width:3;stroke-linecap:round;}\n        .st2{fill:none;stroke:#FFFFFF;stroke-width:3;stroke-linecap:square;}\n        .st3{fill:#81B5A1;}\n        .st4{fill:#FFFFFF;}\n        .st5{fill:#293E40;}\n        .st6{opacity:0.3;fill:#293E40;enable-background:new    ;}\n        .st7{opacity:0.4;fill:#293E40;enable-background:new    ;}\n    </style>\n    <title>sn-es-no-match-found</title>\n    <desc>Created with Sketch.</desc>\n    <g id=\"Empty-States\">\n        <g transform=\"translate(-354.000000, -508.000000)\">\n            <g id=\"sn-es-no-match-found\" transform=\"translate(354.000000, 508.000000)\">\n                <g id=\"Group-23\" transform=\"translate(31.000000, 26.000000)\">\n                    <g id=\"Group-14\">\n                        <g id=\"Group-13\">\n                            <g id=\"Group-12\">\n                                <path id=\"Rectangle-6\" class=\"st0\" d=\"M0.5-1.5h64.3c1.1,0,2,0.9,2,2v34c0,1.1-0.9,2-2,2H0.5c-1.1,0-2-0.9-2-2v-34\n                                    C-1.5-0.6-0.6-1.5,0.5-1.5z\"/>\n                            </g>\n                            <path id=\"Line-2\" class=\"st1\" d=\"M5.3,6.3h39.8\"/>\n                            <path class=\"st1\" d=\"M5.2,13.1h48.7\"/>\n                            <path class=\"st1\" d=\"M5.2,21.1h31\"/>\n                        </g>\n                        <g id=\"Group-11\" transform=\"translate(59.000000, 28.000000)\">\n                            <path id=\"Line\" class=\"st2\" d=\"M0.2,7.8l7.7-7.7\"/>\n                            <path class=\"st2\" d=\"M7.8,7.8L0.2,0.2\"/>\n                        </g>\n                    </g>\n                    <circle id=\"Oval\" class=\"st3\" cx=\"63\" cy=\"33\" r=\"12\"/>\n                    <path class=\"st4\" d=\"M65,36.8c0,0.6-0.2,1.1-0.6,1.5C64,38.8,63.5,39,63,39s-1-0.2-1.4-0.6C61.2,38,61,37.5,61,36.9\n                        s0.2-1.1,0.6-1.5c0.4-0.4,0.9-0.6,1.4-0.6s1,0.2,1.4,0.6C64.8,35.7,65,36.2,65,36.8z M61.2,25.7c0-0.2,0.1-0.3,0.2-0.5\n                        c0.1-0.1,0.3-0.2,0.4-0.2h2.4c0.2,0,0.3,0.1,0.4,0.2s0.2,0.3,0.2,0.5l-0.3,7.4c0,0.2-0.1,0.3-0.2,0.5s-0.3,0.2-0.4,0.2h-1.7\n                        c-0.2,0-0.3-0.1-0.4-0.2s-0.2-0.3-0.2-0.5L61.2,25.7z\"/>\n                </g>\n                <g id=\"bubbles\">\n                    <circle id=\"Oval-5\" class=\"st5\" cx=\"4.5\" cy=\"26.5\" r=\"4.5\"/>\n                    <circle id=\"Oval-5-Copy\" class=\"st5\" cx=\"112.5\" cy=\"17.5\" r=\"4.5\"/>\n                    <circle id=\"Oval-5-Copy-3\" class=\"st6\" cx=\"138.5\" cy=\"44.5\" r=\"2.5\"/>\n                    <circle id=\"Oval-5-Copy-2\" class=\"st7\" cx=\"65.5\" cy=\"2.5\" r=\"2.5\"/>\n                </g>\n            </g>\n        </g>\n    </g>\n</svg>`);","import '@servicenow/now-card';\nimport { Fragment } from '@servicenow/ui-renderer-snabbdom';\nimport '../now-kb-office-addin-footer';\nimport {noResults} from '../svgImgs';\nimport { t } from 'sn-translate';\n\nexport default ({kbList, canContribute}) => (\n    <Fragment>\n        <div className=\"card-list\">\n            {kbList.length?\n                kbList.map(kb => (\n                    <now-card key={kb.sys_id.value} size=\"lg\" interaction=\"click\" append-to-payload={{id: kb.sys_id.value, title: kb.title.displayValue}}>\n                        <now-card-header heading={{label: kb.title.displayValue, lines:2}} caption={{label:kb.description.displayValue}}/>\n                    </now-card>\n                )):\n                [\n                    noResults,\n                    <now-heading hasNoMargin={true} label={t(\"No knowledge bases yet\")} level=\"4\" purpose=\"header\" variant=\"title-primary\"></now-heading>\n                ]\n            }\n        </div>\n        {canContribute?\n            <now-kb-office-addin-footer home-page={true}/>:''\n        }\n    </Fragment>\n);\n","export default () => (\n    <div className=\"card-list\">\n        <div className=\"skeleton\"></div>\n        <div className=\"skeleton\"></div>\n        <div className=\"skeleton\"></div>\n    </div>\n);\n","import {noResults} from '../svgImgs';\nimport { t } from 'sn-translate';\nimport { Fragment } from '@servicenow/ui-renderer-snabbdom';\nimport Loader from './Loader';\nimport '@servicenow/now-template-card';\nimport '@servicenow/now-button';\n\nexport default ({loading, resultList, totalPaginationCount, paginationOffset, properties: {searchQuery}}) => (\n    <Fragment>\n        {loading?<Loader/>:<div className=\"card-list\">\n            {resultList.length?\n                <Fragment>{\n                    resultList.map(({short_description, kb_knowledge_base, kb_category, display_number, number, workflow_state}, resultIndex) => (\n                    <now-template-card-assist\n                    append-to-payload={{resultIndex}}\n                    manage-selected = {false}\n                    content={[{value: {\"type\": \"string\", value: `${[kb_knowledge_base.displayValue, kb_category.displayValue].filter(Boolean).join(' | ')}`}}]}\n                    heading={{ \"label\":short_description.displayValue }} \n                    tagline={{\n                        icon: \"document-fill\",\n                        label: `${display_number? display_number.displayValue:number.displayValue}  ${workflow_state.displayValue}`\n                    }}/>\n                    ))}\n                    {(resultList.length < 20 && (totalPaginationCount - paginationOffset/20) > 1)?\n                        <p className=\"pagination-warning\">{20-resultList.length === 1?\n                            t('1 item was removed from this list because of security constraints.'):\n                            t('{0} items were removed from this list because of security constraints.', 20 - resultList.length)}\n                        </p>: ''\n                    }\n                </Fragment>\n                :\n                [\n                    noResults,\n                    searchQuery?\n                    <now-heading hasNoMargin={true} label={t(\"No results found\")} level=\"4\" purpose=\"header\" variant=\"title-primary\"/>:\n                    <now-heading hasNoMargin={true} label={t(\"No articles in the knowledge base yet\")} level=\"4\" purpose=\"header\" variant=\"title-primary\"/>,\n                    searchQuery?\n                    <span className=\"no-results-help\">{t('Try using different keywords.')}</span>:\n                    <span className=\"no-results-help\">{t('Any articles created within the knowledge base will show up here.')}</span>\n                ]\n                }\n        </div>}\n        {\n            resultList.length?\n            <div className=\"search-pagination\">\n                <now-button-iconic icon=\"arrow-left-fill\" disabled={paginationOffset === 0} tooltipContent=\"Previous page\" size=\"md\" variant=\"tertiary\" bare={true} configAria={{\"aria-label\":\"Previous Page\"}} append-to-payload={{previousResults: true}}/>\n                <now-button-iconic icon=\"arrow-right-fill\" disabled={(totalPaginationCount - paginationOffset/20) <= 1} tooltipContent=\"Next page\" size=\"md\" variant=\"tertiary\" bare={true} configAria={{\"aria-label\":\"Next Page\"}} append-to-payload={{nextResults: true}}/>\n            </div>:''\n        }\n    </Fragment>\n);\n","import {Fragment} from '@servicenow/ui-renderer-snabbdom';\nimport '../now-kb-office-addin-footer';\n\nexport default ({uiActions, properties: {sysId}, officeInitialized, customPropertySet, loading}) => sysId?(\n    <Fragment>\n        <div className=\"form-loading-layover\" style={{display: loading? 'block': 'none'}}>\n            <now-icon icon=\"loader-outline\" size=\"lg\" spin={true}/>\n        </div>\n        <now-record-form-section-connected table=\"kb_knowledge\" sys-id={sysId} view=\"word_addin\" workspace-config-id=\"7b24ceae5304130084acddeeff7b12a3\">\n            <now-kb-office-addin-footer slot=\"footer\" sys-id={sysId} new-article={sysId === '-1'} home-page={false} actions={uiActions} office-initialized={officeInitialized} custom-property-set={customPropertySet}/>\n        </now-record-form-section-connected>\n    </Fragment>\n):'';\n","import Home from './Home';\nimport Search from './Search';\nimport Form from './Form';\nimport Loader from './Loader';\n\nexport default state => {\n    const {loading, properties: {page}} = state;\n    switch(page){\n        case 'home': return loading?<Loader/>:<Home {...state}/>;\n        case 'search': return <Search {...state}/>;\n        case 'form': return <Form {...state}/>;\n    }\n}\n","import {Fragment} from '@servicenow/ui-renderer-snabbdom';\nimport {t} from 'sn-translate';\nimport Router from './routes';\nimport {sessionExpired} from './svgImgs';\nimport '@servicenow/now-button';\nimport '@servicenow/now-heading';\nimport '@servicenow/now-modal';\nimport '@servicenow/now-tooltip';\nimport '@servicenow/now-pill';\n\nconst iconWithToolTip = (icon, toolTip, id) => (\n    <Fragment>\n        {icon}\n        <now-tooltip id={id} target-ref={icon.elm} content={toolTip} delay={200}/>\n    </Fragment>\n);\n\nconst backIcon = <now-icon icon=\"chevron-left-fill\" aria-describedby=\"backToolTip\" size=\"lg\"/>;\nconst homeIcon = <now-icon icon=\"home-outline\" aria-describedby=\"homeToolTip\" size=\"lg\"/>;\nconst infoIcon = <now-icon icon=\"circle-info-outline\" aria-describedby=\"infoToolTip\" size=\"lg\"/>;\nconst reloadIcon = <now-icon icon=\"arrow-counterclockwise-outline\" aria-describedby=\"reloadToolTip\" size=\"lg\"/>;\n\nconst Navbar = ({page, dispatch, historyCount, displayNavButtons, loggedIn}) => (\n    <nav className=\"kb-office-nav\">\n        {(displayNavButtons && historyCount > 0)?\n            <button on-click={() => dispatch('BACK_PRESSED')}>{iconWithToolTip(backIcon, t('Go back to the previous view'), 'backToolTip')}</button>:<div/>\n        }\n        <img src=\"/styles/images/now-logo.svg\" on-click={() => open(location.origin)}/>\n        {(displayNavButtons && page!=='home')?\n            <button on-click={() => dispatch('ROUTE_CHANGED',{page: 'home'})}>{iconWithToolTip(homeIcon, t('Go to the landing screen'), 'homeToolTip')}</button>:\n        !loggedIn?\n            <button on-click={() => location.reload()}>{iconWithToolTip(reloadIcon, t('Reload the add-in'), 'reloadToolTip')}</button>:\n        loggedIn && !displayNavButtons?\n            <div>{iconWithToolTip(infoIcon, t('The article is linked to the current document. To create or access other articles, open another document in Word.'), 'infoToolTip')}</div>:''}\n    </nav>\n);\n\nconst loginPage = <Fragment>\n    <Navbar displayNavButtons={false} loggedIn={false}/>\n    <main>\n        {sessionExpired}\n        <now-heading className=\"login-title\" label={t(\"Session Inactive\")} has-no-margin={true} level=\"1\" variant=\"header-secondary\"/>\n        <p className=\"login-msg\">{t('Log in to your ServiceNow account.')}</p>\n        <ul className=\"login-actions\">\n            <li>\n                <now-icon icon=\"circle-arrow-down-outline\"/>\n                <now-button-bare variant=\"secondary\" label={t(\"Log in to ServiceNow\")} iconEnd=\"open-link-outline\" append-to-payload={{loginPage:true}}/>\n            </li>\n            <li>{t('Opens the ServiceNow login page in a new tab.')}</li>\n        </ul>\n    </main>\n</Fragment>;\n\nconst WarningModal = ({showWarning}) => <now-modal \n    header-label={t('What do you want to do?')}\n    footer-actions={[{\n        label:t(\"Retain\"),\n        variant: \"primary\",\n        clickActionType: 'CLOSE_CONTENT_CHANGED_WARNING'\n    },{\n        label:t(\"Replace\"),\n        variant: \"secondary\",\n        clickActionType: 'REPLACE_CONTENT'\n    }]}\n    size=\"sm\"\n    opened={showWarning}\n    manage-opened\n    append-to-payload={{contentChangedWarning: true}}>\n        <ul style={{cssText: 'padding-left:20px'}}>\n            <li>{t('Select Replace to overwrite the existing content in the Word document with content from the article you selected.')}</li>\n            <li>{t('Select Retain to keep the existing content in the Word document.')}</li>\n        </ul>\n        {t('Note: When you save the article, the Word document content will replace the article content.')}\n    </now-modal>;\n\nconst DirtyFormModal = ({showWarning}) => <now-modal \n    header-label={t('Confirm navigation')}\n    content={t('You have unsaved changes on this form. If you continue, your changes will be lost.')}\n    footer-actions={[{\n        label:t(\"Continue\"),\n        variant: \"primary\",\n        clickActionType: 'REDIRECT_CONTINUED'\n    },{\n        label:t(\"Cancel\"),\n        variant: \"secondary\",\n        clickActionType: 'REDIRECT_CANCELLED'\n    }]}\n    size=\"sm\"\n    opened={showWarning}\n    manage-opened\n    append-to-payload={{dirtyFormWarning: true}}/>;\n\nexport default (state, {dispatch, updateState}) => {\n    const {properties:{page, searchQuery, loggedIn, selectedKb}, historyCount, customPropertySet, showWarning, dirtyFormRedirect, selectedKbTitle} = state;\n    const charLimit = 3;\n    if(!loggedIn){\n        return loginPage;\n    };\n    return (\n        <Fragment>\n            <Navbar page={page} historyCount={historyCount} loggedIn={loggedIn} dispatch={dispatch} displayNavButtons={!customPropertySet}/>\n            <main>\n                <WarningModal showWarning={showWarning}/>\n                <DirtyFormModal showWarning={dirtyFormRedirect? true: false}/>\n                {(page && page !== 'form')?\n                    (<Fragment>\n                        <span className=\"page-header\">\n                            <now-heading has-no-margin label={page==='search'? t('Search'): t('Welcome to Knowledge')} level=\"2\" variant=\"header-secondary\"/>\n                            {\n                                page==='search' && selectedKb?\n                                <now-pill label={selectedKbTitle} size=\"md\" canDismiss={true} append-to-payload={{searchPill:true}}/>:''\n                            }\n                        </span>\n                        <input type=\"text\" autoComplete=\"off\" value={searchQuery} className=\"search-input\"\n                        on-change={e => charLimit && (e.target.value.length >= charLimit)? dispatch('ROUTE_CHANGED', {page:'search',searchQuery: e.target.value}): ''}\n                        placeholder={t('Search (minimum {0} characters)', charLimit)}/>\n                    </Fragment>):''\n                }\n                <Router {...state} dispatch={dispatch} updateState={updateState}/>\n            </main>\n        </Fragment>\n    )\n};\n","import {createGraphQLEffect} from '@servicenow/ui-effect-graphql';\n\nconst query = `\nquery {\n    GlideRecord_Query{\n        kb_knowledge_base(queryConditions:\"active=true\"){\n            _results{\n                description{\n                    displayValue\n                }\n                sys_id{\n                    value\n                }\n                title{\n                    displayValue\n                }\n            }\n        }\n    }\n    AppKnowledge_Query{\n        getContributableKnowledgeBases{\n            value\n            displayValue\n        }\n    }\n}\n`;\n\nexport const homeActions = {\n    ['KB_LIST_REQUESTED']: createGraphQLEffect(query, {\n        successActionType: 'KB_LIST_LOADED',\n        errorActionType: 'ADDIN#REQUEST_FAILED'\n    }),\n    ['KB_LIST_LOADED']: ({action,updateState}) => {\n        const kbList = action.payload.data.GlideRecord_Query.kb_knowledge_base._results;\n        const knowledgeBases = action.payload.data.AppKnowledge_Query.getContributableKnowledgeBases;\n        updateState({\n            kbList,\n            canContribute: knowledgeBases.length > 0,\n            loading: false\n        });\n    }\n}\n","import {createGraphQLEffect} from '@servicenow/ui-effect-graphql';\n\nconst searchGqlQuery = `\nquery($queryConditions: String!, $paginationOffset: Int) {\n\tGlideRecord_Query{\n        kb_knowledge(queryConditions: $queryConditions, pagination: {limit: 20, offset: $paginationOffset}){\n            _results{\n                sys_class_name{\n                    value\n                },\n                number{\n                    displayValue\n                },\n                display_number {\n                    displayValue\n                },\n                workflow_state{\n                    displayValue\n                },\n                short_description{\n                    displayValue\n                },\n                kb_knowledge_base{\n                    displayValue\n                },\n                sys_id{\n                    value\n                },\n                kb_category{\n                    displayValue\n                },\n                office_doc_url{\n                  value\n                }\n            }\n            _rowCount\n        }\n    }\n}\n`;\n\nexport const searchActions = {\n    ['SEARCH_PERFORMED']: ({properties, state: {paginationOffset}, dispatch}) => {\n        const {selectedKb, searchQuery} = properties;\n        const commonQuery = 'active=true^sys_class_name!=kb_knowledge_block^workflow_state=draft^ORworkflow_state=published^ORworkflow_state=review^ORworkflow_state=scheduled_publish^kb_knowledge_base.active=true';\n        let queryConditions = searchQuery?`GOTO123TEXTQUERY321=${searchQuery}^${commonQuery}`:commonQuery;\n        if(selectedKb){\n            queryConditions += `^kb_knowledge_base=${selectedKb}`;\n        }\n        dispatch('SEARCH_REQUESTED',{queryConditions, paginationOffset})\n    },\n    ['SEARCH_REQUESTED']: createGraphQLEffect(searchGqlQuery,{\n        variableList: ['queryConditions', 'paginationOffset'],\n        successActionType: 'SEARCH_RESULTS_LOADED',\n        errorActionType: 'ADDIN#REQUEST_FAILED'\n    }),\n    ['SEARCH_RESULTS_LOADED']: ({action, updateState}) => updateState({\n        resultList: action.payload.data.GlideRecord_Query.kb_knowledge._results,\n        totalPaginationCount: Math.ceil(action.payload.data.GlideRecord_Query.kb_knowledge._rowCount/20),\n        loading: false\n    })\n}\n","import {createGraphQLEffect} from '@servicenow/ui-effect-graphql';\nimport {setCustomProperty, setAutoOpenAddin, isContentEmpty, insertContentControl} from '../Word';\nimport updateArticleFromDocument from '../updateArticleFromDocument';\n\nconst articleQuery = `\nquery($query: String!) {\n    GlideRecord_Query{\n        kb_knowledge(queryConditions: $query){\n            _results{\n                workflow_state{\n                    displayValue,\n                    value\n                },\n                sys_id{\n                    value\n                },\n                number{\n                    value\n                },\n                text{\n                    displayValue\n                },\n                office_doc_url{\n                    value\n                }\n            }\n        }\n    }\n}\n`;\n\nconst uiActionQuery = `\n    query($sysId: String!) {\n        GlideUIAction_Query{\n            uiActions(table:\"kb_knowledge\", sysId:$sysId, view:\"word_addin\"){\n                formActions{\n                    label,\n                    sysId,\n                    name\n                }\n            }\n        }\n    }\n`;\n\nconst resetDocument = async (dispatch, updateState) => {\n    await setCustomProperty('sn_kb_number', '');\n    dispatch('ROUTE_CHANGED',{\n        page: 'home'\n    });\n    setTimeout(() => updateState({\n        customPropertySet: false,\n        historyCount: 0\n    }),100);\n};\n\nexport const formActions = {\n    ['ARTICLE_SELECTED']: ({properties: {sysId, number}, dispatch, updateState}) => {\n        if(sysId === '-1'){\n            updateState({loading:false});\n            return;\n        }\n        let query;\n        if(sysId){\n            query = `sys_id=${sysId}`;\n            dispatch('UI_ACTIONS_LOAD_INITIATED',{sysId});\n        }\n        else if(number)\n            query = `number=${number}^workflow_state=draft^ORworkflow_state=published^ORworkflow_state=review^ORworkflow_state=scheduled_publish`;\n        dispatch('ARTICLE_FORM_LOAD_STARTED',{query});\n    },\n    ['ARTICLE_FORM_LOAD_STARTED']: createGraphQLEffect(articleQuery,{\n        variableList: ['query'],\n        successActionType: 'ARTICLE_DATA_LOADED',\n        errorActionType: 'ADDIN#REQUEST_FAILED'\n    }),\n    ['ARTICLE_DATA_LOADED']: async ({action, properties: {sysId}, state: {customPropertySet, officeInitialized, loadedArticle}, updateState, updateProperties, dispatch}) => {\n        const results = action.payload.data.GlideRecord_Query.kb_knowledge._results;\n        \n        let result = results[0];\n        if(results.length > 1){\n            const stateMap = results.reduce((map, article, index) => (map[article.workflow_state.value] = {index}, map),{});\n            const {index} = stateMap['review'] || stateMap['scheduled_publish'] || stateMap['draft'] || stateMap['published'];\n            result = results[index];\n        }\n\n        if(customPropertySet && !result.office_doc_url.value)\n            return await resetDocument(dispatch, updateState);\n        \n        if(sysId !== result.sys_id.value)\n            dispatch('UI_ACTIONS_LOAD_INITIATED',{sysId: result.sys_id.value});\n        \n        const currentArticleNumber = result.number.value;\n\n        updateProperties({\n            number: currentArticleNumber,\n            sysId: result.sys_id.value\n        });\n        updateState({\n            loading: false\n        });\n\n        if(currentArticleNumber!==loadedArticle &&officeInitialized && !customPropertySet){\n            const isEmpty = await isContentEmpty();\n            const articleContent = result.text.displayValue;\n            if(isEmpty && articleContent){\n                await insertContentControl('Article body', 'article', 'Hidden', true, articleContent, 'Start')\n                updateState({loadedArticle: currentArticleNumber});\n            }\n            else {\n                updateState({\n                    showWarning: true,\n                    articleContent\n                });\n            }\n        }\n    },\n    ['CLOSE_CONTENT_CHANGED_WARNING']: ({updateState, properties: {number}}) => updateState({\n        showWarning: false,\n        articleContent: undefined,\n        loadedArticle: number\n    }),\n    ['REPLACE_CONTENT']: ({state: {articleContent, officeInitialized, customPropertySet}, properties:{number}, updateState}) => {\n        if(officeInitialized && !customPropertySet){\n            insertContentControl('Article body', 'article', 'Hidden', true, articleContent, 'Start')\n            updateState({\n                articleContent: undefined,\n                showWarning: false,\n                loadedArticle: number\n            });\n        }\n    },\n    ['UI_ACTIONS_LOAD_INITIATED']: createGraphQLEffect(uiActionQuery, {\n        variableList: ['sysId'],\n        successActionType: 'UI_ACTIONS_LOADED',\n        errorActionType: 'ADDIN#REQUEST_FAILED'\n    }),\n    ['UI_ACTIONS_LOADED']: ({action, updateState}) => updateState({\n        loading: false,\n        uiActions: action.payload.data.GlideUIAction_Query.uiActions.formActions.filter(action => ['publish_knowledge','checkout_knowledge','sysverb_ws_save','recall'].includes(action.name))\n    }),\n    ['PREVIEW_RECORD']: ({action: {payload: {table, sys_id: sysId}}, dispatch}) => {\n        if(table === 'kb_knowledge'){\n            dispatch('ROUTE_CHANGED',{sysId})\n        } else {\n            open(`/${table}.do?sys_id=${sysId}`);\n        }\n    },\n    ['RECORD_STATUS_CHANGED']: ({action: {payload: {sys_id, status}}, properties: {sysId}, state:{officeInitialized}, dispatch, updateState}) => {\n        if(status === 'inserted' && sysId === '-1' && sys_id !== '-1'){\n            if(officeInitialized){\n                updateState({loading: true})\n                updateArticleFromDocument(sys_id).then(() => {\n                    dispatch('ROUTE_CHANGED',{sysId: sys_id});\n                });\n            } else {\n                dispatch('ROUTE_CHANGED',{sysId: sys_id});\n            }\n        }\n    },\n    ['CUSTOM_PROPERTY_SET']: ({action, state: {officeInitialized}, updateState}) => {\n        if(officeInitialized){\n            setCustomProperty('sn_kb_number', action.payload)\n                .then(() => setAutoOpenAddin(true))\n                .then(() => updateState({customPropertySet: true}));\n        }\n    },\n    ['LOADING_STARTED']: ({updateState}) => updateState({loading: true})\n};\n","import {actionTypes} from '@servicenow/ui-core';\nimport {createAmbEventEffect} from '@servicenow/ui-effect-amb';\nimport {homeActions} from './homeActions';\nimport {searchActions} from './searchActions';\nimport {formActions} from './formActions';\nimport {getCustomProperty, initializeOffice} from '../Word';\nimport {getComponentsByTagNames} from '@devsnc/library-uxf';\nconst {COMPONENT_BOOTSTRAPPED, COMPONENT_DISCONNECTED} = actionTypes;\n\nconst paramPropertyMap = {\n    page: 'page',\n    number: 'number',\n    sysId: 'id',\n    searchQuery: 'query',\n    selectedKb: 'kb'\n};\n\nconst getPath = ({page, sysId, number, searchQuery, selectedKb}) => {\n    let path = `${location.pathname}?page=${page}`\n    switch(page){\n        case 'search': {\n            if(searchQuery)\n                path = `${path}&query=${searchQuery}`;\n            if(selectedKb)\n                path = `${path}&kb=${selectedKb}`;\n            return path;\n        };\n        case 'form': {\n            if(sysId)\n                path = `${path}&id=${sysId || '-1'}`\n            else\n                path = `${path}&number=${number}`;\n            return path;\n        };\n        default: return path;\n    }\n};\n\nconst execRouterActions = (page, dispatch, updateState) => {\n    if(page !== 'form')\n        updateState({\n            loadedArticle: '',\n            loading: true\n        });\n    else\n        updateState({loading: true});\n\n    switch(page){\n        case 'search': dispatch('SEARCH_PERFORMED'); break;\n        case 'form': dispatch('ARTICLE_SELECTED'); break;\n        default: dispatch('KB_LIST_REQUESTED'); break;\n    }\n};\n\nconst handleLogout = ({updateProperties}) => updateProperties({loggedIn: false});\n\nexport const actionHandlers = {\n    [COMPONENT_BOOTSTRAPPED]: ({properties, dispatch, updateState, updateProperties}) => {\n        if(window !== top){\n            focus();\n            onfocus = () => dispatch('ADDIN_FOCUSED');\n        }\n        getComponentsByTagNames(['sn-kb-category-picker']);\n        dispatch('AMB_EVENT_SUBSCRIPTION_CHANGED', {subscribe: true});\n\n        const setupRouter = props => {\n            updateProperties(props);\n            execRouterActions(props.page, dispatch, updateState);\n            history.replaceState(props, props.page, getPath(props));\n            onpopstate = e => dispatch('HISTORY_BACK_PRESSED', {props: e.state});\n        };\n\n        const params = new URLSearchParams(location.search);\n        const newProps = {page: 'home'};\n        ['page','sysId','number','searchQuery','selectedKb'].forEach(prop => {\n            newProps[prop] = params.get(paramPropertyMap[prop]) || properties[prop] || newProps[prop];\n        });\n        if(properties.addIn){\n            initializeOffice().then(async () => {\n                updateState({officeInitialized: true})\n                const kbNumber = await getCustomProperty('sn_kb_number');\n                if(kbNumber){\n                    updateState({customPropertySet: true});\n                    setupRouter({\n                        page: 'form',\n                        sysId: '',\n                        number: kbNumber\n                    });\n                } else {\n                    setupRouter(newProps);\n                }\n            });\n        } else {\n            setupRouter(newProps);    \n        }\n    },\n    [COMPONENT_DISCONNECTED]: () => {\n        dispatch('AMB_EVENT_SUBSCRIPTION_CHANGED', {subscribe: false});\n    },\n    ['AMB_EVENT_SUBSCRIPTION_CHANGED']: createAmbEventEffect(),\n    ['AMB_EVENT_SESSION_LOGGED_OUT']: handleLogout,\n    ['AMB_EVENT_SESSION_INVALIDATED']: handleLogout,\n    ['NOW_BUTTON_BARE#CLICKED']: ({action:{payload:{loginPage}}}) => loginPage? open(`${location.origin}/sn_km_word_kb_login_helper.do`): null,\n    ['NOW_BUTTON_ICONIC#CLICKED']: ({action: {payload: {nextResults, previousResults}}, state: {paginationOffset}, dispatch, updateState}) => {\n        if(nextResults || previousResults){\n            updateState({\n                paginationOffset: nextResults? paginationOffset + 20: paginationOffset - 20,\n                loading: true\n            });\n            dispatch('SEARCH_PERFORMED');\n        }\n    },\n    ['ADDIN_FOCUSED']: ({properties:{loggedIn}}) => !loggedIn?location.reload():null,\n    ['ADDIN#REQUEST_FAILED']: ({action, updateProperties}) => {\n        const status = action.payload.response.status;\n        if(status >= 400 && status < 500)\n            updateProperties({loggedIn: false});\n    },\n    ['NOW_CARD#CLICKED']: ({action, dispatch, updateState}) => {\n        const {id, title} = action.payload;\n        dispatch('ROUTE_CHANGED',{\n            page: 'search',\n            selectedKb: id\n        });\n        updateState({\n            selectedKbTitle: title\n        });\n    },\n    ['NOW_PILL#DISMISSED']: ({action: {payload: {searchPill}}, properties: {searchQuery}, dispatch}) => {\n        if(searchPill){\n            if(searchQuery){\n                dispatch('ROUTE_CHANGED', {\n                    page: 'search',\n                    selectedKb: null,\n                    searchQuery\n                });\n            } else {\n                dispatch('ROUTE_CHANGED', {\n                    page: 'home',\n                    selectedKb: null\n                });\n            }\n        }\n    },\n    ['NOW_TEMPLATE_CARD_ASSIST#SELECTED_SET']: ({state, action, dispatch}) => {\n        const {resultIndex} = action.payload;\n        const {resultList} = state;\n        const article = resultList[resultIndex];\n        if(article.office_doc_url && article.office_doc_url.value){\n            open(article.office_doc_url.value);\n        } else if(article.sys_class_name.value !== 'kb_knowledge'){\n            open(`/${article.sys_class_name.value}.do?sys_id=${article.sys_id.value}`)\n        } else {\n            dispatch('ROUTE_CHANGED',{\n                page: 'form',\n                sysId: article.sys_id.value\n            });\n        }\n    },\n    ['NOW_MODAL#OPENED_SET']: ({action: {payload: {contentChangedWarning, dirtyFormWarning}}, dispatch}) => { \n        if(dirtyFormWarning)\n            dispatch('REDIRECT_CANCELLED');\n        if(contentChangedWarning)\n            dispatch('CLOSE_CONTENT_CHANGED_WARNING');\n    },\n    ['ROUTE_CHANGED']: {\n        modifier: {name: 'debounce', delay: 50},\n        effect: ({properties: {page: oldPage, searchQuery: query, selectedKb: kb}, state:{historyCount, dirtyForm}, updateState, updateProperties, dispatch, action:{\n                payload: {\n                    page = oldPage,\n                    searchQuery = page==='search'? query: null,\n                    selectedKb = page==='search'? kb: null,\n                    sysId = null,\n                    number = null,\n                }\n            }}) => {\n            const props = {page, searchQuery, selectedKb, sysId, number};\n            if(dirtyForm){\n                updateState({dirtyFormRedirect: props})\n                return;\n            }\n            const nextPath = getPath(props);\n            history.pushState(props, page, nextPath);\n            updateProperties(props);\n            updateState({historyCount: historyCount + 1});\n            execRouterActions(page, dispatch, updateState);\n        }\n    },\n    ['HISTORY_BACK_PRESSED']: ({action: {payload: {props}}, state:{historyCount, customPropertySet}, updateProperties, updateState, dispatch}) => {\n        if(!customPropertySet){\n            updateProperties(props);\n            if(historyCount > 0)\n                updateState({historyCount: historyCount - 1});\n            execRouterActions(props.page, dispatch, updateState);\n        }\n    },\n    ['BACK_PRESSED']: ({state:{dirtyForm}, updateState}) => {\n        if(dirtyForm){\n            updateState({\n                dirtyFormRedirect: true,\n                goBackOnRedirect: true\n            });\n            return;\n        }\n        history.back();\n    },\n    ['DIRTY_FORM_SET']: ({action: {payload: dirtyForm}, updateState}) => {\n        updateState({dirtyForm});\n        onbeforeunload = dirtyForm? () => true: null;\n    },\n    ['REDIRECT_CONTINUED']: ({state:{dirtyFormRedirect, goBackOnRedirect}, dispatch, updateState}) => {\n        updateState({\n            dirtyFormRedirect: undefined,\n            goBackOnRedirect: undefined\n        });\n        dispatch('DIRTY_FORM_SET', false);\n        if(goBackOnRedirect)\n            history.back();\n        else\n            dispatch('ROUTE_CHANGED', dirtyFormRedirect);\n    },\n    ['REDIRECT_CANCELLED']: ({updateState}) => updateState({dirtyFormRedirect: undefined, goBackOnRedirect: undefined}),\n    ...homeActions,\n    ...searchActions,\n    ...formActions\n}\n","import {createCustomElement} from '@servicenow/ui-core';\nimport view from './view';\nimport styles from './styles.scss';\nimport {actionHandlers} from './actions';\n\ncreateCustomElement('now-kb-office-addin', {\n\tview,\n\tstyles,\n\tactionHandlers,\n\tinitialState: {\n\t\tresultList: [],\n\t\tuiActions: [],\n\t\tkbList: [],\n\t\thistoryCount: 0,\n\t\tshowWarning: false,\n\t\tpaginationOffset: 0\n\t},\n\tproperties: {\n\t\tpage: {\n\t\t\tdefault: '',\n\t\t\treflect: true\n\t\t},\n\t\tsysId: {\n\t\t\tdefault: '',\n\t\t\treflect: true\n\t\t},\n\t\tnumber: {\n\t\t\tdefault: '',\n\t\t\treflect: true\n\t\t},\n\t\tsearchQuery: {\n\t\t\tdefault: '',\n\t\t\treflect: true\n\t\t},\n\t\tselectedKb: {\n\t\t\tdefault: '',\n\t\t\treflect: true\n\t\t},\n\t\taddIn: {\n\t\t\tdefault: false,\n\t\t\treflect: true\n\t\t},\n\t\tloggedIn: {\n\t\t\tdefault: true\n\t\t}\n\t}\n});\n"],"sourceRoot":""}