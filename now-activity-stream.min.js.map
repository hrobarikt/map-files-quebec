{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"__TECTONIC__$servicenow_ui_renderer_snabbdom\"","webpack:///./node_modules/@babel/runtime/helpers/extends.js","webpack:///external \"__TECTONIC__sn_translate\"","webpack:///external \"__TECTONIC__lodash_4_17_4\"","webpack:///external \"__TECTONIC__$servicenow_ui_core\"","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///external \"__TECTONIC__sn_uxpage_presource_18_0_4\"","webpack:///external \"__TECTONIC__$servicenow_ui_effect_graphql\"","webpack:///./node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/runtime/api.js","webpack:///external \"__TECTONIC__$servicenow_now_button\"","webpack:///./src/activity/tiles/_emailTile.scss?d5f3","webpack:///external \"__TECTONIC__$servicenow_now_label_value\"","webpack:///external \"__TECTONIC__sn_component_timeago\"","webpack:///external \"__TECTONIC__$servicenow_now_dropdown\"","webpack:///external \"__TECTONIC__$servicenow_now_email_client\"","webpack:///./src/activity-compose/_tinyMCE.scss?dd5b","webpack:///external \"__TECTONIC__$servicenow_now_heading\"","webpack:///external \"__TECTONIC__$servicenow_now_popover\"","webpack:///external \"__TECTONIC__$servicenow_now_record_common\"","webpack:///./src/activity/activity.scss?c8ef","webpack:///./src/activity/emptyActivityImage.svg","webpack:///./src/activity/tiles/_activityTile.scss?236e","webpack:///./src/activity-compose/_nowActivityStreamCompose.scss?e9a0","webpack:///./src/nowActivityStreamSettings/_nowActivityStreamSettingsPopoverContent.scss?3169","webpack:///./src/activity/activity-filter/_pill-panel.scss?e3a1","webpack:///external \"__TECTONIC__$servicenow_ui_effect_amb\"","webpack:///external \"__TECTONIC__$servicenow_ui_effect_http\"","webpack:///external \"__TECTONIC__sn_user_preferences\"","webpack:///external \"__TECTONIC__resize_observer_polyfill_1_5_1\"","webpack:///./src/activity-combo/_nowActivityCombo.scss?cb2f","webpack:///./src/activity/activity.scss","webpack:///external \"__TECTONIC__$servicenow_now_avatar\"","webpack:///./src/activity/tiles/_activityTile.scss","webpack:///external \"__TECTONIC__react\"","webpack:///external \"__TECTONIC__$servicenow_now_tabs\"","webpack:///external \"__TECTONIC__$servicenow_now_toggle\"","webpack:///./src/activity-compose/_nowActivityStreamCompose.scss","webpack:///./src/nowActivityStreamSettings/_nowActivityStreamSettingsPopoverContent.scss","webpack:///external \"__TECTONIC__$servicenow_now_record_html_editor\"","webpack:///./src/activity-compose/_tinyMCE.scss","webpack:///external \"__TECTONIC__$servicenow_now_icon\"","webpack:///./src/activity/tiles/_emailTile.scss","webpack:///external \"__TECTONIC__$servicenow_now_pill\"","webpack:///external \"__TECTONIC__$servicenow_now_checkbox\"","webpack:///./src/activity/activity-filter/_pill-panel.scss","webpack:///external \"__TECTONIC__$servicenow_now_modal\"","webpack:///./src/activity-combo/_nowActivityCombo.scss","webpack:///./src/shared/SeismicComponent.js","webpack:///./src/activity/translations.js","webpack:///./src/activity/actions.js","webpack:///./src/activity/constants.js","webpack:///./src/shared/utils.js","webpack:///./src/activity/ActivityDto.js","webpack:///./src/activity/TilesRepo.js","webpack:///./src/activity/FluxCapacitor.js","webpack:///./src/activity/FluxCapacitorRepo.js","webpack:///./src/activity/activityLazyRenderBehavior.js","webpack:///./src/activity/tiles/tileFocusManagementBehavior.js","webpack:///./src/activity/tiles/actions/TileHeaderAction.js","webpack:///./src/activity-connected/supplementalDataBehavior.js","webpack:///./src/activity/tiles/actions/FavoritingHeaderAction.js","webpack:///./src/activity-connected/actions.js","webpack:///./src/activity/tiles/actions/FlaggingHeaderAction.js","webpack:///./src/activity/tiles/ActivityTile.js","webpack:///./src/activity/tiles/TestTile.js","webpack:///./src/activity/tiles/TruncatedTile.js","webpack:///./src/activity-compose/actions.js","webpack:///./src/activity-compose/nowActivityStreamComposeConnectedBehavior.js","webpack:///./src/activity-compose/inputConfig.js","webpack:///./src/activity-compose/actionHandlers.js","webpack:///./src/nowActivityStreamSettings/consts.js","webpack:///./src/nowActivityStreamSettings/nowActivityStreamSettingsPopoverContent.js","webpack:///./src/activity-compose/formSync.js","webpack:///./src/activity-compose/tinyMCESyncHeightPlugin.js","webpack:///./src/activity-compose/ComposeInput.js","webpack:///./src/activity-compose/nowActivityStreamCompose.js","webpack:///./src/nowActivityStreamSettings/nowActivityStreamSettings.js","webpack:///./src/activity/utils.js","webpack:///./src/activity/tiles/JournalTile.js","webpack:///./src/activity/tiles/AttachmentTile.js","webpack:///./src/activity/tiles/EmailLastReply.js","webpack:///./src/activity/tiles/EmailContent.js","webpack:///./src/activity/tiles/actions/EmailHeaderAction.js","webpack:///./src/activity/UserReferenceDto.js","webpack:///./src/activity/UserReferenceRepo.js","webpack:///./src/activity-connected/activityQueries.js","webpack:///./src/activity/AttachmentDto.js","webpack:///./src/activity/AttachmentRepo.js","webpack:///./src/activity/DataTransformer.js","webpack:///./src/activity/activity-filter/FilterAreaBehavior.js","webpack:///./src/shared/AccessiblePopoverPanelBehavior.js","webpack:///./src/activity/activity-filter/PillPanel.js","webpack:///./src/activity/activity-filter/filter-utils.js","webpack:///./src/activity/activity-filter/PopOverPill.js","webpack:///./src/activity/activity-filter/EventFilterTransformer.js","webpack:///./src/activity/activity-filter/FilterSets.js","webpack:///./src/activity/activity-filter/quick-filters/FlaggedQuickFilter.js","webpack:///./src/activity/activity-filter/quick-filters/QuickFilter.js","webpack:///./src/activity/activity-filter/QuickFilters.js","webpack:///./src/activity/activity-filter/ActivityFilter.js","webpack:///./src/activity-connected/activityStreamGraphQLBehavior.js","webpack:///./src/activity/tiles/EmailTile.js","webpack:///./src/activity/tiles/AuditTile.js","webpack:///./src/activity/tiles/AuditRelationTile.js","webpack:///./src/activity/NowActivityStream.js","webpack:///./src/activity-connected/emailAttachmentBehavior.js","webpack:///./src/activity-connected/activityStreamAmbBehavior.js","webpack:///./src/now-link-interceptor/nowLinkInterceptorBehavior.js","webpack:///./src/activity-connected/saveFiltersBehavior.js","webpack:///./src/activity-connected/saveSortDirectionBehavior.js","webpack:///./src/activity-connected/NowActivityStreamConnected.js","webpack:///./src/activity/resizeObserverBehavior.js","webpack:///./src/activity-combo/actionHandlers.js","webpack:///./src/activity-combo/actions.js","webpack:///./src/activity-compose/nowActivityStreamComposeConnected.js","webpack:///./src/activity-combo/nowActivityComboElement.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__TECTONIC__$servicenow_ui_renderer_snabbdom","_extends","assign","target","arguments","length","source","apply","this","__TECTONIC__sn_translate","__TECTONIC__lodash_4_17_4","__TECTONIC__$servicenow_ui_core","obj","configurable","writable","__TECTONIC__sn_uxpage_presource_18_0_4","__TECTONIC__$servicenow_ui_effect_graphql","useSourceMap","list","toString","map","item","content","cssMapping","btoa","sourceMapping","sourceMap","base64","unescape","encodeURIComponent","JSON","stringify","data","concat","sourceURLs","sources","sourceRoot","join","cssWithMappingToString","mediaQuery","dedupe","alreadyImportedModules","id","_i","push","__TECTONIC__$servicenow_now_button","result","__TECTONIC__$servicenow_now_label_value","__TECTONIC__sn_component_timeago","__TECTONIC__$servicenow_now_dropdown","__TECTONIC__$servicenow_now_email_client","__TECTONIC__$servicenow_now_heading","__TECTONIC__$servicenow_now_popover","__TECTONIC__$servicenow_now_record_common","__TECTONIC__$servicenow_ui_effect_amb","__TECTONIC__$servicenow_ui_effect_http","__TECTONIC__sn_user_preferences","__TECTONIC__resize_observer_polyfill_1_5_1","___CSS_LOADER_API_IMPORT___","__TECTONIC__$servicenow_now_avatar","__TECTONIC__react","__TECTONIC__$servicenow_now_tabs","__TECTONIC__$servicenow_now_toggle","__TECTONIC__$servicenow_now_record_html_editor","__TECTONIC__$servicenow_now_icon","__TECTONIC__$servicenow_now_pill","__TECTONIC__$servicenow_now_checkbox","__TECTONIC__$servicenow_now_modal","SeismicComponent","getCustomElementParts","styles","getStyles","behaviors","getBehaviors","properties","getPropertyDefinitions","actions","getActions","actionHandlers","getActionHandlers","initialState","getInitialState","eventHandlers","getEventHandlers","renderer","type","snabbdom","view","state","coeffects","getView","constructor","TypeError","_getAbstractMethods","forEach","method","getComponentName","_validateAbstractMethod","methodName","DEFAULT_ACTIVITY_TITLE","NO_ACTIVITY_TO_DISPLAY","SOMETHING_WENT_WRONG","NEW_RECORD_EMPTY_ACTIVITY","NO_RESULTS_FOR_FILTER","NO_ACTIVITY_WAITING","EXPAND_ALL_POST","COLLAPSE_ALL_POST","MORE_OPTIONS","AUTHOR_LABEL","author","LOADING_TEXT","ADDITIONAL_COMMENTS_TITLE","WORK_NOTES_TITLE","FIELD_CHANGES_TITLE","ATTACHMENT_TITLE","SHOW_MORE","SHOW_LESS","SHOW_FULL","HIDE_FULL","ADD_FAVORITE_TOOLTIP","REMOVE_FAVORITE_TOOLTIP","SORT_DESCENDING","SORT_ASCENDING","ADD_FLAG_TOOLTIP","REMOVE_FLAG_TOOLTIP","EMPTY","SUBJECT","FROM","TO","CC","LOADING_EMAIL_CONTENT","LOADING_EMAIL_CONTENT_FAILED","LOADING_EMAIL_LAST_REPLY","LOADING_EMAIL_LAST_REPLY_FAILED","REPLY","FORWARD","REPLY_ALL","MORE","EMAIL_PANEL_HEADERS","OPEN_FILTERS","FILTERS_APPLIED_OPEN","CLOSE_FILTERS","POST_TYPES","FIELD_CHANGES","CONVERSATION","CONVERSATION_SUBLABEL","CLEAR_ALL","SELECT_ALL","RESET_FILTER","CLEAR_FILTERS_TOOLTIP","FILTER_SETS","FLAGGED","EMAIL","EMAIL_COMPOSE_MODAL_CONTENT","NEW_EMAIL","CONTINUE","CANCEL","AS_SORT_CHANGED_ACTION","EVENT_TABLES","EVENT_SUB_TYPES","COMMENTS","WORK_NOTES","SENT","RECEIVED","apiVersion","sysPropValue","getProperty","getApiVersion","isTrue","prop","parseJson","original","defaultValue","parse","e","console","error","jsonStringToObject","jsonStringToArray","ActivityDto","defaultValues","documentTable","documentId","eventTable","eventSysId","eventCreatedOn","subtype","payload","supplemental","tile","eventTitle","eventCreatedBy","tileRefsByNowIdAndEventId","Map","TilesRepo","nowId","refMap","tileReference","has","set","clear","delete","propertyName","propertyValue","tileRef","FluxCapacitor","setBehaviors","setTimeAgoOptions","options","timeAgoOptions","addTimedTile","activityDto","getTimeAgo","setUpdateFn","tickTime","getTile","words","timeAgo","destroyTimeContinuum","timeAgoReferences","_removeFn","SnTimeAgo","timestampLong","numericValue","displayValue","fluxCapacitorInstances","FluxCapacitorRepo","instance","getInstance","getTickTime","COMPONENT_DISCONNECTED","actionTypes","observersByComponentId","tileRefsByComponentId","tileObserverCallback","events","observer","entry","isIntersecting","intersectionRatio","boundingClientRect","activated","height","width","unobserve","observe","activityLazyRenderBehavior","observeTile","default","componentId","IntersectionObserver","root","rootMargin","threshold","createTileObserver","tiles","ref","disconnect","destroyTileObserver","selectedHeaderActionIndex","currentHeaderActionElements","previousHeaderActionElement","tileFocusManagementBehavior","effect","action","event","composedPath","filter","elem","classList","contains","path","origin","originType","actionElements","querySelectorAll","setTimeout","actionElem","focus","previousKey","document","dir","nextKey","preventDefault","stopPropagation","shiftKey","tabIndex","TileHeaderAction","getJSX","supplementalBehaviors","registerSupplementalBehavior","saveAction","saveSucceededAction","saveFailedAction","saveSucceededActionHandler","noop","saveFailedActionHandler","isPrivate","succeededAction","failedAction","behavior","private","createGraphQLEffect","variableList","successActionType","errorActionType","COMPONENT_PROPERTY_CHANGED","updateFavorite","favorite","updateState","errors","message","FavoritingHeaderAction","originalFavorite","headerAction","dispatch","documentSysId","eventId","_state","_getInitialRenderState","className","toggleIcon","tooltipText","append-to-payload","icon","selected","tooltip-content","size","variant","bare","disabled","hidePadding","configAria","role","updateFlag","flag","FlaggingHeaderAction","originalFlag","isForAllUsers","COMPONENT_CONNECTED","COMPONENT_DOM_READY","ActivityTile","super","setTimeRef","activityNowId","showAvatar","showIcon","showFavorite","image","expanded","getOnConnect","getOnDisconnect","getHeaderActions","additionalDestroy","additionalOnConnect","shouldRender","timeRefs","showCardActions","relatedTarget","closest","getTileIcon","getTitleDecorator","backgroundColor","avatar","image-src","user-name","avatarPlaceholder","iconCode","tileIcon","headerActions","render","colorVariant","cardActionStyles","aria-label","renderTime","style","node","tooltip","querySelector","targetRef","time","alternate","tooltipContent","displayTime","elm","target-ref","testTile","wordBreak","createCustomElement","observers","TruncatedTile","reflect","host","items","contentHeight","contentWidth","hostEl","maxLimit","shouldHideToggle","toggle","shadowRoot","obsData","observerInfo","innerHTML","maxHeight","collapsedStyle","overflow","truncateHeightStyle","button","label","on-click","getTruncatedContent","activityMutationQuery","defaultJournalFieldSettings","comments","helpText","helpTextIcon","work_notes","nowActivityStreamComposeConnectedBehavior","table","sysId","journalFieldSettings","startActionType","field","postingCommentMap","window","localStorage","setItem","mentions","prefix","allowedPosition","HTML_EDITOR_CONFIG","toolbar","plugins","defaultNumLines","JOURNAL_FIELD_SETTINGS_FIELDS","OBJECT_TYPE_PROPERTIES","Set","isPropsChanged","previousValue","isString","isEqual","getUpdatedState","fields","updateSelectedField","propsChanged","parsed","fieldsArr","values","emailAction","allowJournalFieldSettingsOverrides","tabItems","journalFieldsMap","firstField","needUpdate","journalSettings","fieldSettings","isEmpty","sys_readonly","readonly","visible","settingsForField","override","settings","fieldName","getAppliedFieldSettings","selectedField","email","newState","syncState","futureState","handleFieldSelection","useTabs","RICH_TEXT_EDITOR_LABEL","STACKED_VIEW_LABEL","TOGGLE_SETTINGS_TITLE","SIDE_BY_SIDE_LABEL","keyHandler","currentFocus","currentTarget","nextFocus","previousElementSibling","nextElementSibling","click","createItem","enabled","settingName","toggleChecked","tabindex","on-mouseover","on-keydown","aria-live","panelRefByComponentId","isRichTextAvailable","isStackedViewAvailable","isRichTextEnabled","isStackedViewEnabled","isSideBySideViewAvailable","isSideBySideViewEnabled","setting","getSettingsPanel","data-settings","element","firstChild","syncForm","parseCssValueToInt","dom","computed","parseInt","getStyle","isNaN","isFullStretch","targetElm","getRootNode","dataset","tinymce","PluginManager","add","editor","isResized","customHeight","_syncHeight","containerEl","getContentAreaContainer","iframeEl","theme","resizeTo","offsetHeight","hostParentEl","footerEl","editorContainerEl","getContainer","editorToolbarEl","snControlEl","delta","on","sendToForm","selectedFieldName","ComposeInput","requestAnimationFrame","getComponentId","fire","styleTag","createElement","tinyMCEStyles","Document","styleSheet","CSSStyleSheet","replace","adoptedStyleSheets","appendChild","inputValue","isRichTextMentionsEnabled","handleInputChange","isSidebySideWithFullStretch","makeHTMLEditorTransparent","content-style","onStagedValueChange","onValueChange","onBlur","enableMentions","resourceTable","resourceSysId","placeholder","getPlaceholderText","useCodeBlocks","minLineCount","data-isFullStretch","initialValue","rows","referringTable","referringRecordId","maxlength","maxLength","debounce","resizable","getHtmlEditor","getTextEditor","fieldLabel","COMPONENT_BOOTSTRAPPED","COMPONENT_RENDERED","buttonInstancesByComponentId","getInputValue","journalField","getPostButton","isPostDisabled","isPostingComment","isEmptyValue","trim","setButtonRef","getToggleButton","stackedView","hide-tail","opened","interaction-type","positions","trigger","slot","nowActivityStreamSettings","getInputProperties","getFieldFooter","helpTextElement","getIsStackedViewAvailable","getIsStackedViewEnabled","getItem","getIsRichTextAvailable","getIsRichTextEnabled","showHtmlEditor","getIsRichTextMentionsEnabled","getAllowJournalFieldSettingsOverrides","getComposeShouldUseTabs","getIsSideBySideViewEnabled","sideBySideView","NowActivityStreamCompose","commonCreateComponentParts","isNewRecord","title","composeTitle","toggleButton","fieldKeys","keys","inputView","mappedField","getStackedView","inEmailTab","useTabsPropValue","RENDER_TAG","selectionProp","selectedItem","maxWidth","selectedItems","getNonStackedView","classNames","shouldExpandToFit","has-no-margin","popoverOpened","refit","operation","onPost","handlePostButton","transformState","shouldRenderCompose","shouldEnableSideBySideView","journalTile","setHTMLContent","_apiVersion","newValue","prepareContent","getAttribute","a","setAttribute","rel","attachmentTile","fileName","sizeBytes","contentType","fileState","emailLastReply","lastReply","loader","renderContent","attachShadow","renderError","emailContent","contentUrl","response","fetch","headers","ok","text","fetchContent","EMAIL_ACTION_IDS","emailActionEffect","snCustomRenderer","renderers","parentTable","parentSysId","actionId","replyOptions","headerValue","replyType","tableName","custom_renderer_tag","customTag","getRendererTable","sys_id","params","replyId","getRecordPreviewPayload","actionOrigin","EmailTile","EmailHeaderAction","createPreSourceBehavior","transform","getEmailActionOptions","to","cc","panelFitProps","position","data-testId","icon-name","hide-caret","select","UserReferenceDto","active","displayName","userName","UserReferenceMap","userReferences","UserReferenceRepo","userDto","userReferenceMap","ACTIVITY_STREAM_INNER_SCHEMA","OLD_METHOD","getQueryMethod","FULL_QUERY","QUERY_METHOD","ENTRIES_FIELD","FIELDS_FIELD","AttachmentDto","attachment","attachmentsByNowIdAndAttachmentId","AttachmentRepo","attachmentDto","attachmentId","attachmentsById","eventTypes","typeToTableMap","tileMap","DataTransformer","transformOldEvents","oldEventTransform","_getPayload","sysCreatedOnAdjusted","_getSubType","_getJournalPayload","_getEmailPayload","_getAttachmentPayload","_getAuditPayload","transformedEntry","_getCommonPayload","entryItem","isWorknote","from","recipients","split","copied","subject","previewText","auditValues","TOGGLE_FILTERS_AREA_BEHAVIOR","activityAction","filtersOpen","filtersHaveBeenFocused","pillsContainer","getElementById","container","timeout","Promise","accept","tries","maxTries","Math","ceil","handler","setInterval","firstPopover","nowPill","clearInterval","then","focusableElementsByNowId","currentFocusedIndexByNowId","handlersByNowIdAndElement","removeListeners","focusables","handlersByElement","handlers","eventType","removeEventListener","updateFocusedItem","isFocusing","currentFocusableStateKey","AccessiblePopoverPanelBehavior","elements","currentIndex","nextIndex","prevIndex","focusPrevious","focusNext","isRTL","actionsByKey","eventKey","getPanelReference","getInitialFocusElement","panel","index","elementIndex","WeakMap","addEventListener","focusable","createListeners","elementToFocus","findIndex","propertyDefs","filterOptions","panelReferences","pillPanel","focusedKey","fieldNames","itemsToRender","filterOption","data-focusable","checked","checkbox","appendToPayload","level","processFilterOptions","quickFilterSelections","predicate","isFiltering","filterCount","newOptions","hasQuickFiltersApplied","some","FILTER_PILL_BEHAVIOR","pill","openedPill","filterStatus","lastUpdateTimestamp","Date","now","newQuickFilterSelections","OOB_POST_TYPES","isPostTypeOption","journal","getFilterOptions","optionsByPill","renderPopOverPill","pillTitle","popoverClassName","countText","accessibleTitle","numberOfSelections","ACCESSIBLE_PILL_LABEL","aria-haspopup","aria-expanded","isFieldChangeEvent","transformEvent","selectedFields","availableFields","eventField","sys_journal_field","sys_audit_relation","sys_email","sys_attachment","getFilterFieldForEvent","auditValue","transformAuditEvent","getSelection","FILTER_SETS_BEHAVIOR","getQuickFilterId","getIcon","getLabel","getEventIsOfQuickFilterType","tilePayload","tileSupplemental","quickFilters","flaggedQuickFilter","shouldFilterOutEvent","quickFilter","FILTER_QUICK_FILTERS_BEHAVIOR","clearButtonRefs","ActivityFilter","option","transformAndFilterEvents","filterOptionSelections","hasFieldChanges","hasFieldChangesType","selectedOptions","filteringIcon","presence","String","toRender","mappedByPill","renderFilterOptionPills","manageSelected","renderQuickFilters","showConversationFilter","sublabel","renderFilterSets","addToSupplementalMap","supplementalMap","userSysId","payloadStr","parseSupplementalPayload","user","global","convertToSupplementalMap","displayErrorMessage","loading","getLegacyAmbChannels","updateRepos","addReference","activity","addAttachment","fetchEmailReplies","emailSysIds","emailsWithNoLastReply","emailSysId","getEventTransformer","transformEvents","getFilterOptionsForAdapter","dataFields","adaptersByPathSuffix","getStream","ambChannels","entries","getEvents","filterFields","accumulateEmailSysId","activityStreamGraphQLBehavior","reduce","shouldUpdate","suffix","find","transformGraphQLPayload","hasErrors","getInitialFilterStatus","loadingStatus","sortDirection","subscribe","reply","updateProperty","expandedEmailTiles","expandedFullEmailTiles","emailTile","emailActions","attachments","expandedFull","getHeader","searchable","emailList","userRef","getFromReferences","labelValueComp","getAttachmentList","getPreview","getTopToggle","getBottomToggle","fullConversation","auditTile","getLabelValues","previous","buttonLabel","displayItems","slice","tileAction","oldValue","htmlNewValue","htmlOldValue","getLabelValue","getDisplayValue","auditRelationTile","targetTable","targetName","targetLabel","_getValue","DEFINED_TILES","TestTile","JournalTile","AttachmentTile","AuditTile","AuditRelationTile","timestamp","showTileAvatars","showTileIcons","showFavoriting","memoizedTilesByNowId","NowActivityStream","_addTileRef","_renderActivities","timeAgoBehaviors","b","getFilterBehaviors","getRecordPreviewPrefix","createComponentPropertyChangedEffect","updateLastUpdateTimestamp","getEmailIds","destroyTiles","destroyInstance","destroy","deleteReferences","removeAttachments","getInitialRenderState","renderClearAll","renderFilterToggle","_renderSort","_renderExpandCollapseAll","renderFilters","_renderActivityContent","sortDisplay","panel-fit-props","_renderEmptyActivities","memoData","_createTile","TILE","setRefCallback","_loadExternalTile","_getTileBackgroundColor","_getHydratedTilePayload","tileIndex","dto","getAttachment","addTileRef","createInstance","transformedEvents","maxBoundIndex","max","bounds","supplementalPayload","body","alt","src","emptySvg","setTile","AS","NowActivityStreamElement","EMAIL_ATTACHMENTS_DATA_PATH","emailAttachmentBehavior","attachmentsByEmailId","groupBy","defaultEvents","lookupAndAddAttachments","cloneDeep","addAttachments","AS_AMB_ACTIONS","deletedMap","messageBuffer","messageProcessors","effectsByNowIdAndChannel","createMessageProcessor","messages","processedEvents","processedUsers","messagePayload","newEvents","newEventCreatedTime","newEventSysId","deletedEvents","len","splice","_processMessage","activityStreamAmbBehavior","channel","effectsByChannel","channelEffect","createAmbSubscriptionEffect","messageReceivedActionType","subscribeFailedActionType","args","effects","ambEffect","dataStr","userStr","handleSuplementalUpdates","addMessage","inTransitMessage","cancel","TABLES_OPEN_OUTSIDE_WORKSPACE","nowLinkInterceptorState","retryHandler","retryCount","capturedUrls","propsToHtmlArrayByComponentId","coeffectsToHtmlArrayByComponentId","processProps","fromCoeffectsFnc","fromPropsFnc","toHtmlArray","newUrls","html","foundUrls","matchAll","match","href","extractAnchorUrls","toCapture","substring","sysparm_link","Array","nowLinkInterceptorBehavior","propsToHtmlArray","nowLinkInterceptor","createHttpEffect","batch","queryParams","urlEntry","url","k","clearTimeout","coeffectsToHtmlArray","anchor","tagName","cleanedUrl","captured","ctrlKey","metaKey","openInWorkspace","sysKBId","indexOf","saveFiltersBehavior","selections","saveSortDirectionBehavior","ASConnected","getHtmlArrayFromCoeffects","userPreferencesBehavior","dataTransformer","eventsFromProps","eventsFromState","textArray","rawPayload","NowActivityStreamConnectedElement","observedMap","resize","ResizeObserver","contentRect","mountResizeObserver","wait","fn","disconnectedHandler","resizeObserverBehavior","offsetWidth","handlerFn","isFunction","EMAIL_DRAFT_SEND_SUCCESS","EMAIL_DRAFT_SAVE_SUCCESS","emailComposerActionTypes","comboActionHandlers","toggleModal","showEmailComposeConfirmation","emailActionHandler","meta","isEmailComposeDirty","ensuedEmailAction","targetRecord","getEmailActionFromPayload","composeEmailHandler","resetEmailCompose","emailActivityActionHandlers","suppressPreviewRecord","footerAction","emailActionState","NowActivityStreamComposeConnected","FOOTER_ACTIONS_CONFIG","resizeBehavior","exec","navigator","userAgent","parseFloat","disableSibeBySide","prevWidth","clientWidth","activityStreamTitle","showSideBySideOption","renderCompose","hasMinWidth","headerLabel","footerActions","schema","getQueryFragments"],"mappings":"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","file":"@servicenow/now-activity-stream/now-activity-stream.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 30);\n","module.exports = __TECTONIC__$servicenow_ui_renderer_snabbdom;","function _extends() {\n  module.exports = _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nmodule.exports = _extends;","module.exports = __TECTONIC__sn_translate;","module.exports = __TECTONIC__lodash_4_17_4;","module.exports = __TECTONIC__$servicenow_ui_core;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","module.exports = __TECTONIC__sn_uxpage_presource_18_0_4;","module.exports = __TECTONIC__$servicenow_ui_effect_graphql;","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","module.exports = __TECTONIC__$servicenow_now_button;","\n        var result = require(\"!!../../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/src/index.js??ref--6-2!../../../node_modules/resolve-url-loader/index.js??ref--6-3!../../../node_modules/sass-loader/dist/cjs.js??ref--6-4!./_emailTile.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","module.exports = __TECTONIC__$servicenow_now_label_value;","module.exports = __TECTONIC__sn_component_timeago;","module.exports = __TECTONIC__$servicenow_now_dropdown;","module.exports = __TECTONIC__$servicenow_now_email_client;","\n        var result = require(\"!!../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/src/index.js??ref--6-2!../../node_modules/resolve-url-loader/index.js??ref--6-3!../../node_modules/sass-loader/dist/cjs.js??ref--6-4!./_tinyMCE.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","module.exports = __TECTONIC__$servicenow_now_heading;","module.exports = __TECTONIC__$servicenow_now_popover;","module.exports = __TECTONIC__$servicenow_now_record_common;","\n        var result = require(\"!!../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/src/index.js??ref--6-2!../../node_modules/resolve-url-loader/index.js??ref--6-3!../../node_modules/sass-loader/dist/cjs.js??ref--6-4!./activity.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","module.exports = \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNDEgMTAzIj4KICAgIDxnIGlkPSJFbXB0eS1TdGF0ZXMiPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNDQyLjAwMDAwMCwgLTE1NDguMDAwMDAwKSI+CiAgICAgICAgPGcgaWQ9InNuLWVzLW5vLXBvc3RzLXRvLWRpc3BsYXkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ0Mi4wMDAwMDAsIDE1NDguMDAwMDAwKSI+CiAgICAgICAgICA8ZyBpZD0iR3JvdXAtMiI+CiAgICAgICAgICAgIDxwYXRoIHN0eWxlPSJvcGFjaXR5OiAwLjg7IGZpbGwtcnVsZTogZXZlbm9kZDsgY2xpcC1ydWxlOiBldmVub2RkOyBmaWxsOiAjYzJjZWQwOyBlbmFibGUtYmFja2dyb3VuZDogbmV3OyIgZD0iTTY3LDMwLjZsLTcuNSwyLjZsLTIuMy02LjZsMC40LTAuMWMwLjQtMC4xLDAuOC0wLjEsMS4xLDBsNy41LDNjMC40LDAuMSwwLjYsMC40LDAuNywwLjdMNjcsMzAuNnoKCQkJTTU5LjcsMzQuNmw3LjYtMi43bDUuOCwxNi4zYzAuMSwwLjMsMC4xLDAuNy0wLjEsMWMtMC4yLDAuMy0wLjUsMC42LTAuOCwwLjdsLTE4LjgsNi42Yy0wLjQsMC4xLTAuNywwLjEtMS4xLDAKCQkJYy0wLjMtMC4xLTAuNi0wLjQtMC43LTAuN2wtOC4yLTIzYy0wLjEtMC4zLTAuMS0wLjcsMC4xLTFzMC41LTAuNiwwLjgtMC43bDExLjItMy45bDIuNCw2LjdjMC4xLDAuMywwLjMsMC42LDAuNywwLjcKCQkJQzU5LDM0LjcsNTkuMywzNC44LDU5LjcsMzQuNnogTTUyLjQsMzguOGMwLjYtMC4yLDEuMy0wLjIsMS45LDAuMWMwLjYsMC4zLDEuMSwwLjgsMS4zLDEuNGMwLjIsMC43LDAuMiwxLjMtMC4xLDEuOQoJCQljLTAuMywwLjYtMC44LDEuMS0xLjQsMS4zYy0wLjYsMC4yLTEuMywwLjItMS45LTAuMWMtMC42LTAuMy0xLTAuOC0xLjMtMS40Yy0wLjItMC43LTAuMi0xLjMsMC4xLTEuOVM1MS43LDM5LjEsNTIuNCwzOC44egoJCQlNNjguMSw0Nkw1NCw1MWwtMC44LTIuM2wxLjUtMi43YzAuMS0wLjEsMC4yLTAuMiwwLjQtMC4zYzAuMi0wLjEsMC4zLTAuMSwwLjUsMGwyLjksMS4xbDMuOS03YzAuMS0wLjEsMC4zLTAuMywwLjQtMC4zCgkJCWMwLjItMC4xLDAuMy0wLjEsMC41LDBsMi45LDEuMUw2OC4xLDQ2eiI+PC9wYXRoPgogICAgICAgICAgICA8ZyBpZD0iUGFwZXItSWNvbiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjAuMDAwMDAwLCAxNC4wMDAwMDApIj4KICAgICAgICAgICAgICA8cGF0aCBzdHlsZT0iZmlsbC1ydWxlOiBldmVub2RkOyBjbGlwLXJ1bGU6IGV2ZW5vZGQ7IGZpbGw6ICM4MWI1YTE7IiBkPSJNMjUuMiwxNC45Yy0wLjIsMC40LTAuMSwwLjksMC4xLDEuM3MwLjYsMC43LDEsMC45bDkuNiwzLjdsLTguMiwyMS4zYy0wLjIsMC40LTAuNSwwLjctMC45LDAuOQoJCQkJYy0wLjQsMC4yLTAuOSwwLjItMS40LDBMMS43LDMzLjljLTAuNS0wLjItMC44LTAuNS0xLTAuOWMtMC4yLTAuNC0wLjItMC45LTAuMS0xLjNMMTIuMiwxLjZjMC4yLTAuNCwwLjUtMC43LDAuOS0wLjkKCQkJCWMwLjQtMC4yLDAuOS0wLjIsMS40LDBsMTQuMSw1LjRMMjUuMiwxNC45eiBNMjMuOCwzMmwwLjItMC41YzAuMS0wLjIsMC4xLTAuNCwwLTAuNmMtMC4xLTAuMi0wLjMtMC40LTAuNS0wLjVsLTExLjktNC41CgkJCQljLTAuMi0wLjEtMC41LTAuMS0wLjcsMGMtMC4yLDAuMS0wLjQsMC4yLTAuNSwwLjVsLTAuMiwwLjVjLTAuMSwwLjItMC4xLDAuNCwwLDAuNmMwLjEsMC4yLDAuMywwLjQsMC41LDAuNWwxMS45LDQuNQoJCQkJYzAuMiwwLjEsMC41LDAuMSwwLjcsMEMyMy42LDMyLjMsMjMuNywzMi4yLDIzLjgsMzJ6IE0yNS40LDI3LjhsMC4yLTAuNWMwLjEtMC4yLDAuMS0wLjQsMC0wLjZjLTAuMS0wLjItMC4zLTAuNC0wLjUtMC41CgkJCQlsLTExLjktNC41Yy0wLjItMC4xLTAuNS0wLjEtMC43LDBjLTAuMiwwLjEtMC40LDAuMi0wLjUsMC41bC0wLjIsMC41Yy0wLjEsMC4yLTAuMSwwLjQsMCwwLjZjMC4xLDAuMiwwLjMsMC40LDAuNSwwLjUKCQkJCWwxMS45LDQuNWMwLjIsMC4xLDAuNSwwLjEsMC43LDBDMjUuMiwyOC4yLDI1LjMsMjgsMjUuNCwyNy44eiBNMjcuMiwyMy4xYzAuMS0wLjIsMC4xLTAuNCwwLTAuNmMtMC4xLTAuMi0wLjMtMC40LTAuNS0wLjUKCQkJCWwtMTEuOS00LjVjLTAuMi0wLjEtMC41LTAuMS0wLjcsMGMtMC4yLDAuMS0wLjQsMC4yLTAuNSwwLjVsLTAuMiwwLjVjLTAuMSwwLjItMC4xLDAuNCwwLDAuNmMwLjEsMC4yLDAuMywwLjQsMC41LDAuNQoJCQkJbDExLjksNC41YzAuMiwwLjEsMC41LDAuMSwwLjcsMGMwLjItMC4xLDAuNC0wLjIsMC41LTAuNUwyNy4yLDIzLjF6IE0zNi43LDE4LjdsLTktMy41bDMuMi04LjNsMC40LDAuMmMwLjUsMC4yLDAuOCwwLjUsMSwwLjkKCQkJCWw0LjUsOWMwLjIsMC40LDAuMiwwLjksMC4xLDEuM0wzNi43LDE4Ljd6Ij48L3BhdGg+CiAgICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTEuMDAwMDAwLCA0LjAwMDAwMCkiPjwvZz4KICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8ZyBpZD0iZmlsdGVyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MC4wMDAwMDAsIDYwLjAwMDAwMCkiPgogICAgICAgICAgICAgIDxwYXRoIGlkPSJTaGFwZSIgc3R5bGU9ImZpbGw6ICMyOTNlNDA7IHN0cm9rZTogIzI5M2U0MDsiIGQ9Ik0zOS40LDBIMi42QzAuMywwLTAuOSwyLjgsMC44LDQuNWwxNSwxNXYxNS4zYzAsMC44LDAuMywxLjUsMC45LDJsNS4yLDQuNgoJCQkJYzEuNywxLjUsNC40LDAuMyw0LjQtMlYxOS41bDE1LTE1QzQyLjksMi44LDQxLjcsMCwzOS40LDB6IE0yMy42LDE4LjR2MjAuOWwtNS4yLTQuNlYxOC40TDIuNywyLjdoMzYuNkwyMy42LDE4LjR6Ij48L3BhdGg+CiAgICAgICAgICAgICAgPHBvbHlnb24gaWQ9IlBhdGgtMiIgc3R5bGU9ImZpbGwtcnVsZTogZXZlbm9kZDsgY2xpcC1ydWxlOiBldmVub2RkOyBmaWxsOiAjZjRmNGY0OyIgcG9pbnRzPSIyLjcsMi44IDE4LjQsMTguNCAxOC40LDM0LjcgMjMuNywzOS41IDIzLjcsMTguNCAzOS4zLDIuOCAJCQkJCSI+PC9wb2x5Z29uPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0yLUNvcHkiPgogICAgICAgICAgICAgIDxjaXJjbGUgaWQ9Ik92YWwtNSIgc3R5bGU9ImZpbGw6ICMyOTNlNDA7IiBjeD0iNC41IiBjeT0iMjYuNSIgcj0iNC41Ij48L2NpcmNsZT4KICAgICAgICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsLTUtQ29weSIgc3R5bGU9ImZpbGw6ICMyOTNlNDA7IiBjeD0iMTEyLjUiIGN5PSIxNy41IiByPSI0LjUiPjwvY2lyY2xlPgogICAgICAgICAgICAgIDxjaXJjbGUgaWQ9Ik92YWwtNS1Db3B5LTMiIHN0eWxlPSJvcGFjaXR5OiAwLjM7IGZpbGw6ICMyOTNlNDA7IiBjeD0iMTM4LjUiIGN5PSI0NC41IiByPSIyLjUiPjwvY2lyY2xlPgogICAgICAgICAgICAgIDxjaXJjbGUgaWQ9Ik92YWwtNS1Db3B5LTIiIHN0eWxlPSJvcGFjaXR5OiAwLjQ7IGZpbGw6ICMyOTNlNDA7IiBjeD0iNjUuNSIgY3k9IjIuNSIgcj0iMi41Ij48L2NpcmNsZT4KICAgICAgICAgICAgPC9nPgogICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=\"","\n        var result = require(\"!!../../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/src/index.js??ref--6-2!../../../node_modules/resolve-url-loader/index.js??ref--6-3!../../../node_modules/sass-loader/dist/cjs.js??ref--6-4!./_activityTile.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","\n        var result = require(\"!!../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/src/index.js??ref--6-2!../../node_modules/resolve-url-loader/index.js??ref--6-3!../../node_modules/sass-loader/dist/cjs.js??ref--6-4!./_nowActivityStreamCompose.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","\n        var result = require(\"!!../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/src/index.js??ref--6-2!../../node_modules/resolve-url-loader/index.js??ref--6-3!../../node_modules/sass-loader/dist/cjs.js??ref--6-4!./_nowActivityStreamSettingsPopoverContent.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","\n        var result = require(\"!!../../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/src/index.js??ref--6-2!../../../node_modules/resolve-url-loader/index.js??ref--6-3!../../../node_modules/sass-loader/dist/cjs.js??ref--6-4!./_pill-panel.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","module.exports = __TECTONIC__$servicenow_ui_effect_amb;","module.exports = __TECTONIC__$servicenow_ui_effect_http;","module.exports = __TECTONIC__sn_user_preferences;","module.exports = __TECTONIC__resize_observer_polyfill_1_5_1;","\n        var result = require(\"!!../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/src/index.js??ref--6-2!../../node_modules/resolve-url-loader/index.js??ref--6-3!../../node_modules/sass-loader/dist/cjs.js??ref--6-4!./_nowActivityCombo.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \":host{box-sizing:border-box;line-height:var(--now-line-height,1.25);font-family:var(--now-font-family,\\\"Source Sans Pro\\\",sans-serif)}:host([hidden]){display:none}*,:after,:before{box-sizing:border-box}.now-a11y-label{position:absolute;overflow:hidden;width:1px;height:auto;margin:0;border:none;padding:0;white-space:nowrap;clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%)}.now-pill{position:relative;--now-line-height:0;display:inline-block;vertical-align:middle;min-width:4.75rem;font-variant:normal;letter-spacing:normal;word-spacing:normal;text-indent:0;text-shadow:none;white-space:normal}.now-pill .now-line-height-crop{width:100%;min-width:0}.now-pill-button{display:flex;justify-content:center;align-items:center;width:inherit;cursor:pointer;width:100%;margin:0;border:var(--mv9-XAjj--kvZptZ-9Apz8,var(--mv9-PvZT-JvmzZvj--kvZptZ-9Apz8,1px)) solid rgb(var(--mv9-xajj--kvzptz-jvjvz,var(--now-color_border--secondary,var(--now-color--neutral-5,172,180,181))));padding-block-start:0;padding-block-end:0;font-style:var(--mv9-XAjj--Pvmz-1zOjt,var(--mv9-PvZT-JvmzZvj--Pvmz-1zOjt,normal));font-weight:var(--mv9-XAjj--Pvmz-9tAf8z,var(--mv9-PvZT-JvmzZvj--Pvmz-9tAf8z,normal));font-family:var(--mv9-XAjj--Pvmz-PrTAjO,var(--mv9-PvZT-JvmzZvj--Pvmz-PrTAjO,var(--now-font-family,\\\"Source Sans Pro\\\",sans-serif)));text-transform:var(--mv9-XAjj--ztuz-zZrm1PvZT,var(--mv9-PvZT-JvmzZvj--ztuz-zZrm1PvZT,none));color:RGB(var(--mv9-XAjj--JvjvZ,var(--now-color_text--primary,var(--now-color--neutral-18,22,27,28))));background-color:RGB(var(--mv9-XAjj--krJUfZvWmp-JvjvZ,var(--now-color_background--primary,var(--now-color--neutral-0,255,255,255))))}.now-pill-button:active{color:currentColor}.now-pill-button:hover{border-color:RGB(var(--mv9-XAjj--kvZptZ-JvjvZ--8vstZ,var(--mv9-XAjj--kvZptZ-JvjvZ,var(--now-color_border--secondary,var(--now-color--neutral-5,172,180,181)))));color:RGB(var(--mv9-XAjj--JvjvZ--8vstZ,var(--now-color--primary-1,30,133,109)));background-color:RGB(var(--mv9-XAjj--krJUfZvWmp-JvjvZ--8vstZ,var(--mv9-XAjj--krJUfZvWmp-JvjvZ,var(--now-color_background--primary,var(--now-color--neutral-0,255,255,255)))))}.now-pill-button:active{border-color:RGB(var(--mv9-XAjj--kvZptZ-JvjvZ--rJzAst,var(--mv9-XAjj--kvZptZ-JvjvZ,var(--now-color_border--secondary,var(--now-color--neutral-5,172,180,181)))));color:RGB(var(--mv9-XAjj--JvjvZ--rJzAst,var(--now-color--primary-2,23,100,82)));background-color:RGB(var(--mv9-XAjj--krJUfZvWmp-JvjvZ--rJzAst,var(--mv9-XAjj--krJUfZvWmp-JvjvZ,var(--now-color_background--primary,var(--now-color--neutral-0,255,255,255)))))}.now-pill-button:focus{border-color:RGB(var(--mv9-XAjj--kvZptZ-JvjvZ--PvJW1,var(--now-color--primary-1,30,133,109)));color:RGB(var(--mv9-XAjj--JvjvZ--PvJW1,var(--now-color--primary-3,15,67,55)));background-color:RGB(var(--mv9-XAjj--krJUfZvWmp-JvjvZ--PvJW1,var(--now-color--primary-0,221,237,233)));outline:none}.now-pill-button:focus:after{content:\\\"\\\";position:absolute;top:0;left:0;width:100%;height:100%;border-radius:inherit;box-shadow:inset 0 0 0 2px RGB(var(--now-color_focus-ring,var(--now-color--secondary-1,1,119,142))),inset 0 0 0 3px RGB(var(--now-color_focus-ring_shadow,var(--now-color--neutral-0,255,255,255))),0 1px .125rem 0 RGBA(var(--now-color--neutral-21,0,0,0),.25)}.now-pill-button:focus::-moz-focus-inner{border-style:none}.-sm .now-pill-button{height:1.5rem;border-radius:.75rem;padding-inline-start:.5rem;padding-inline-end:.5rem;font-size:.75rem;line-height:1.33333}.-sm .now-pill-button.show-dismiss{padding-inline-end:1.5rem}.-sm .now-pill-button .now-line-height-crop:after,.-sm .now-pill-button .now-line-height-crop:before{content:\\\"\\\";display:block;height:0}.-sm .now-pill-button .now-line-height-crop:before{margin-block-start:calc(var(--now-line-height-crop--before, -.25em)*1.06667)}.-sm .now-pill-button .now-line-height-crop:after{margin-block-end:calc(var(--now-line-height-crop--after, -.125em)*1.06667)}.-sm .now-pill-button .now-line-height-crop+.-sm .now-pill-button .now-line-height-crop{margin-block-start:calc(var(--now-line-height-crop--after, -.125em)*1.06667*-1)}.-md .now-pill-button{height:2rem;border-radius:1rem;padding-inline-start:1rem;padding-inline-end:1rem;font-size:1rem;line-height:1.25}.-md .now-pill-button.show-dismiss{padding-inline-end:2.25rem}.-md .now-pill-button .now-line-height-crop:after,.-md .now-pill-button .now-line-height-crop:before{content:\\\"\\\";display:block;height:0}.-md .now-pill-button .now-line-height-crop:before{margin-block-start:calc(var(--now-line-height-crop--before, -.25em)*1)}.-md .now-pill-button .now-line-height-crop:after{margin-block-end:calc(var(--now-line-height-crop--after, -.125em)*1)}.-md .now-pill-button .now-line-height-crop+.-md .now-pill-button .now-line-height-crop{margin-block-start:calc(var(--now-line-height-crop--after, -.125em)*1*-1)}.is-selected .now-pill-button{border-color:RGB(var(--mv9-XAjj--1tjtJztp--kvZptZ-JvjvZ,var(--now-color--primary-1,30,133,109)));color:RGB(var(--mv9-XAjj--1tjtJztp--JvjvZ,var(--now-color--neutral-0,255,255,255)));background-color:RGB(var(--mv9-XAjj--1tjtJztp--krJUfZvWmp-JvjvZ,var(--now-color--primary-1,30,133,109)))}.is-selected .now-pill-button:hover{border-color:RGB(var(--mv9-XAjj--1tjtJztp--kvZptZ-JvjvZ--8vstZ,var(--mv9-XAjj--1tjtJztp--kvZptZ-JvjvZ,var(--now-color--primary-1,30,133,109))));color:RGB(var(--mv9-XAjj--1tjtJztp--JvjvZ--8vstZ,var(--mv9-XAjj--1tjtJztp--JvjvZ,var(--now-color--neutral-0,255,255,255))));background-color:RGB(var(--mv9-XAjj--1tjtJztp--krJUfZvWmp-JvjvZ--8vstZ,var(--mv9-XAjj--1tjtJztp--krJUfZvWmp-JvjvZ,var(--now-color--primary-1,30,133,109))))}.is-selected .now-pill-button:active{border-color:RGB(var(--mv9-XAjj--1tjtJztp--kvZptZ-JvjvZ--rJzAst,var(--mv9-XAjj--1tjtJztp--kvZptZ-JvjvZ,var(--now-color--primary-1,30,133,109))));color:RGB(var(--mv9-XAjj--1tjtJztp--JvjvZ--rJzAst,var(--mv9-XAjj--1tjtJztp--JvjvZ,var(--now-color--neutral-0,255,255,255))));background-color:RGB(var(--mv9-XAjj--1tjtJztp--krJUfZvWmp-JvjvZ--rJzAst,var(--mv9-XAjj--1tjtJztp--krJUfZvWmp-JvjvZ,var(--now-color--primary-1,30,133,109))))}.is-selected .now-pill-button:focus{border-color:RGB(var(--mv9-XAjj--1tjtJztp--kvZptZ-JvjvZ--PvJW1,var(--now-color--primary-1,30,133,109)));color:RGB(var(--mv9-XAjj--1tjtJztp--JvjvZ--PvJW1,var(--mv9-XAjj--1tjtJztp--JvjvZ,var(--now-color--neutral-0,255,255,255))));background-color:RGB(var(--mv9-XAjj--1tjtJztp--krJUfZvWmp-JvjvZ--PvJW1,var(--mv9-XAjj--1tjtJztp--krJUfZvWmp-JvjvZ,var(--now-color--primary-1,30,133,109))))}.now-pill-button.show-identifier{padding-inline-start:0}.filter-pills{display:flex;margin-top:.5rem;border-top:.125rem solid rgb(var(--now-color_border--secondary,var(--now-color--neutral-5,172,180,181)));border-bottom:.125rem solid rgb(var(--now-color_border--secondary,var(--now-color--neutral-5,172,180,181)));padding-top:.75rem;padding-bottom:.25rem}.filter-pills .now-pill,.filter-pills now-pill{margin-right:.5rem;margin-bottom:.5rem;margin-inline-start:.5rem}.filter-pills .option-pills{flex:auto}.as-header,.clear-all-wrap{display:flex;align-items:center}.as-header{margin-bottom:1rem}.as-header now-heading{flex:auto}.as-header .actions{display:flex}.as-header .actions>*{margin-left:.5rem}.as-header .filter-toggle-wrap{position:relative}.as-header .filter-toggle-wrap now-icon-presence{position:absolute;right:0}.sn-as now-activity-stream-input{margin-bottom:1rem}.sn-as activity-stream-header{margin-top:1.5rem}.sn-as-toolbar{display:flex;align-content:center;justify-content:flex-end;border-bottom:1px solid rgb(var(--now-color_border--secondary,var(--now-color--neutral-5,172,180,181)));padding-bottom:.5rem}.sn-as-toolbar now-activity-stream-filter{width:100%;padding-right:.5rem}.sn-as .activities>.tile{display:block;min-height:42px}.sn-as-empty-state{position:static;top:auto;bottom:auto;display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%;margin-top:1.5rem}.sn-as-empty-state-row{margin-top:.5rem}.sn-as-empty-state-row:first-of-type{margin-top:0}.sn-as-empty-state-header{max-width:600px;margin:0;padding:0;font-size:1rem;text-align:center;color:RGB(var(--now-color_text--primary,var(--now-color--neutral-18,22,27,28)))}.sn-as-empty-state-body{display:block;max-width:480px;font-size:.75rem;text-align:center;color:RGB(var(--now-color_text--tertiary,var(--now-color--neutral-9,99,114,116)))}.sn-as-empty-state-image img{width:100%}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","module.exports = __TECTONIC__$servicenow_now_avatar;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \":host{box-sizing:border-box;line-height:var(--now-line-height,1.25);font-family:var(--now-font-family,\\\"Source Sans Pro\\\",sans-serif)}:host([hidden]){display:none}*,:after,:before{box-sizing:border-box}.color-variant-neutral{background:RGB(var(--now-color_background--primary,var(--now-color--neutral-0,255,255,255)))}.color-variant-yellow{background:RGB(var(--now-color_grouped--yellow-0,251,241,209))}.color-variant-magenta{background:RGB(var(--now-color_grouped--magenta-0,239,215,236))}.color-variant-pink{background:RGB(var(--now-color_grouped--pink-0,239,215,221))}.color-variant-orange{background:RGB(var(--now-color_grouped--orange-0,243,217,210))}.color-variant-brown{background:RGB(var(--now-color_grouped--brown-0,225,220,214))}.color-variant-green{background:RGB(var(--now-color_grouped--green-0,223,230,216))}.color-variant-green-yellow{background:RGB(var(--now-color_grouped--green-yellow-0,225,230,207))}.color-variant-blue{background:RGB(var(--now-color_grouped--blue-0,215,231,240))}.card-actions{display:flex;margin:0}.card-actions>li{display:inline;flex:auto}.card-actions>li .force-show{display:inline-block}.card-actions.hidden>li>*{display:none}.card-actions.hidden .force-show{display:inline-block}.card-actions:focus-within>li>*,.card-actions:focus>li>*{display:inline-block}.sn-as-card{position:relative;margin-bottom:.125rem;padding:.75rem}.sn-as-card-header{position:sticky;top:0;z-index:11;display:flex;flex-wrap:wrap;align-items:center;padding:0}.sn-as-card-header-top{display:flex;width:100%}.sn-as-card-header-top>.card-info{overflow:hidden;flex:1 1 auto;text-overflow:ellipsis;white-space:nowrap}.sn-as-card-header-top>.card-actions{flex:0 0 auto;min-height:25px;border-color:inherit;padding:0;box-shadow:none;outline:none}.sn-as-card-header-top .user{margin:0 0 .125rem;font-weight:600;font-size:1rem;color:RGB(var(--now-color_text--primary,var(--now-color--neutral-18,22,27,28)));overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.sn-as-card-header-bottom{display:flex;width:100%;margin-bottom:.75rem}.sn-as-card-header-bottom .meta{display:inline-flex;align-items:center;font-size:.75rem;line-height:1}.sn-as-card-header-bottom .meta,.sn-as-card-header-bottom .meta:after{color:RGB(var(--now-color_text--tertiary,var(--now-color--neutral-9,99,114,116)))}.sn-as-card-header-bottom .meta:after{content:\\\"|\\\";display:inline-block;margin:0 .25rem}.sn-as-card-header-bottom .meta:last-of-type:after{display:none}.sn-as-card-body{overflow-x:hidden;overflow-y:hidden;font-size:1rem;color:RGB(var(--now-color_text--primary,var(--now-color--neutral-18,22,27,28)))}.sn-as-card-body-content{margin-top:-.75rem;margin-bottom:-.5rem}.sn-as-card-body img{overflow:hidden;max-width:100%;height:auto}.sn-as-card-body-journal{margin:0;overflow-wrap:break-word}.sn-as-card-body-journal :first-child{margin-top:0}.sn-as-card-body-journal :last-child{margin-bottom:0}.sn-as-card-body-email{min-height:400px;padding:0}.sn-as-card-body-email now-label-value-tabbed{margin-bottom:.75rem}.sn-as-card-body-email iframe{width:100%;height:400px;border:none;background-color:RGB(var(--now-color_background--primary,var(--now-color--neutral-0,255,255,255)))}.sn-as-card-body pre{overflow-x:auto;margin:0}.sn-as-card-body-toggler{padding-top:.5rem}.sn-as-card-body-toggler.hidden{display:none}.sn-as-toggler{display:inline-flex;vertical-align:middle;justify-content:center;align-items:center;width:auto;margin:.75rem 0 0;border:none;padding:0;font-size:1rem;font-family:inherit;white-space:nowrap;cursor:pointer;color:RGB(var(--now-color--secondary-1,1,119,142));background:transparent}.sn-as-toggler:hover{color:RGB(var(--now-color--secondary-2,1,89,107))}.sn-as-toggler:active{color:RGB(var(--now-color--secondary-3,1,60,71))}.icon{display:inline-block;width:25px;height:25px}.icon+.user{padding-right:.75rem;padding-left:.75rem}.fake-avatar{border:1px solid rgb(var(--now-color_border--tertiary,var(--now-color--neutral-3,209,214,214)));border-radius:50%;background-color:RBG(var(--now-color_background--secondary,var(--now-color--neutral-1,246,247,247)))}.icon-wrap{display:inline-block;width:25px;height:25px}.hidden-searchable{position:absolute;overflow:hidden;clip:rect(0 0 0 0);width:1px;height:1px;margin:-1px;border:0;padding:0}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","module.exports = __TECTONIC__react;","module.exports = __TECTONIC__$servicenow_now_tabs;","module.exports = __TECTONIC__$servicenow_now_toggle;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \":host{box-sizing:border-box;line-height:var(--now-line-height,1.25);font-family:var(--now-font-family,\\\"Source Sans Pro\\\",sans-serif)}:host([hidden]){display:none}*,:after,:before{box-sizing:border-box}.color-variant-neutral{background:RGB(var(--now-color_background--primary,var(--now-color--neutral-0,255,255,255)))}.color-variant-yellow{background:RGB(var(--now-color_grouped--yellow-0,251,241,209))}.color-variant-magenta{background:RGB(var(--now-color_grouped--magenta-0,239,215,236))}.color-variant-pink{background:RGB(var(--now-color_grouped--pink-0,239,215,221))}.color-variant-orange{background:RGB(var(--now-color_grouped--orange-0,243,217,210))}.color-variant-brown{background:RGB(var(--now-color_grouped--brown-0,225,220,214))}.color-variant-green{background:RGB(var(--now-color_grouped--green-0,223,230,216))}.color-variant-green-yellow{background:RGB(var(--now-color_grouped--green-yellow-0,225,230,207))}.color-variant-blue{background:RGB(var(--now-color_grouped--blue-0,215,231,240))}.as-header{display:flex;align-items:center;margin-bottom:1rem}.as-header now-heading{flex:auto}.as-header .actions{display:flex}.as-header .actions>*{margin-left:.5rem}.compose-response{position:relative;margin-bottom:1rem;font-size:1rem;color:RGB(var(--now-color_text--secondary,var(--now-color--neutral-12,66,80,81)))}.compose-form now-button{float:right;margin-top:.5rem}.compose-form.footer-bar{display:flex}.compose-form .help-text{display:flex;width:100%;margin-top:.5rem;font-size:.75rem;color:RGB(var(--now-color_text--tertiary,var(--now-color--neutral-9,99,114,116)))}.compose-form .help-text>*{margin-right:.25rem}.compose-container .input .input-control.--hidden{display:none}.compose-container .input now-dropdown{margin-bottom:.125rem}.compose-container.--full-stretch,.compose-container.--full-stretch .input{display:flex;flex-direction:column;flex-grow:1}.compose-container.--full-stretch .input now-dropdown{display:flex}.compose-container.--full-stretch .input-control{display:flex;flex-direction:column;flex-grow:1}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \":host{box-sizing:border-box;line-height:var(--now-line-height,1.25);font-family:var(--now-font-family,\\\"Source Sans Pro\\\",sans-serif)}:host([hidden]){display:none}*,:after,:before{box-sizing:border-box}.now-a11y-label{position:absolute;overflow:hidden;width:1px;height:auto;margin:0;border:none;padding:0;white-space:nowrap;clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%)}.now-popover-list{margin:0;border:1px solid rgb(var(--now-color_border--primary,var(--now-color--neutral-7,135,147,148)));padding:0;box-shadow:0 2px .25rem 0 RGBA(var(--now-color--neutral-21,0,0,0),.25);list-style:none}.now-popover-list .now-popover--item{position:relative;display:flex;overflow:hidden;align-items:center;height:2rem;cursor:pointer;color:RGB(var(--now-color_text--primary,var(--now-color--neutral-18,22,27,28)))}.now-popover-list .now-popover--item:active,.now-popover-list .now-popover--item:focus,.now-popover-list .now-popover--item:hover{background-color:RGB(var(--now-color--primary-0,221,237,233))}.now-popover-list .now-popover--item:focus{outline:none}.now-popover-list .now-popover--item--content{display:flex;overflow:hidden;flex-direction:row;align-items:center;width:100%;height:100%;padding:1rem}.now-popover-list .now-popover--item--title{display:inline;overflow-x:hidden;flex:1 1 auto!important;align-items:center;white-space:nowrap;text-overflow:ellipsis}.now-popover-list .now-popover--item--title .toggle-container{width:100%;margin-left:.75rem}.now-popover-list .now-popover--item--title .toggle-container now-toggle{float:right;line-height:0}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","module.exports = __TECTONIC__$servicenow_now_record_html_editor;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".mce-container-body.mce-stack-layout,.mce-panel.mce-panel.mce-panel.mce-panel{background:transparent}.mce-top-part.mce-container.mce-stack-layout-item.mce-first{background:RGB(var(--now-color_background--primary,var(--now-color--neutral-0,255,255,255)))}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","module.exports = __TECTONIC__$servicenow_now_icon;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \":host{box-sizing:border-box;line-height:var(--now-line-height,1.25);font-family:var(--now-font-family,\\\"Source Sans Pro\\\",sans-serif)}:host([hidden]){display:none}*,:after,:before{box-sizing:border-box}.color-variant-neutral{background:RGB(var(--now-color_background--primary,var(--now-color--neutral-0,255,255,255)))}.color-variant-yellow{background:RGB(var(--now-color_grouped--yellow-0,251,241,209))}.color-variant-magenta{background:RGB(var(--now-color_grouped--magenta-0,239,215,236))}.color-variant-pink{background:RGB(var(--now-color_grouped--pink-0,239,215,221))}.color-variant-orange{background:RGB(var(--now-color_grouped--orange-0,243,217,210))}.color-variant-brown{background:RGB(var(--now-color_grouped--brown-0,225,220,214))}.color-variant-green{background:RGB(var(--now-color_grouped--green-0,223,230,216))}.color-variant-green-yellow{background:RGB(var(--now-color_grouped--green-yellow-0,225,230,207))}.color-variant-blue{background:RGB(var(--now-color_grouped--blue-0,215,231,240))}.card-actions{display:flex;margin:0}.card-actions>li{display:inline;flex:auto}.card-actions>li .force-show{display:inline-block}.card-actions.hidden>li>*{display:none}.card-actions.hidden .force-show{display:inline-block}.card-actions:focus-within>li>*,.card-actions:focus>li>*{display:inline-block}.sn-as-card{position:relative;margin-bottom:.125rem;padding:.75rem}.sn-as-card-header{position:sticky;top:0;z-index:11;display:flex;flex-wrap:wrap;align-items:center;padding:0}.sn-as-card-header-top{display:flex;width:100%}.sn-as-card-header-top>.card-info{overflow:hidden;flex:1 1 auto;text-overflow:ellipsis;white-space:nowrap}.sn-as-card-header-top>.card-actions{flex:0 0 auto;min-height:25px;border-color:inherit;padding:0;box-shadow:none;outline:none}.sn-as-card-header-top .user{margin:0 0 .125rem;font-weight:600;font-size:1rem;color:RGB(var(--now-color_text--primary,var(--now-color--neutral-18,22,27,28)));overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.sn-as-card-header-bottom{display:flex;width:100%;margin-bottom:.75rem}.sn-as-card-header-bottom .meta{display:inline-flex;align-items:center;font-size:.75rem;line-height:1}.sn-as-card-header-bottom .meta,.sn-as-card-header-bottom .meta:after{color:RGB(var(--now-color_text--tertiary,var(--now-color--neutral-9,99,114,116)))}.sn-as-card-header-bottom .meta:after{content:\\\"|\\\";display:inline-block;margin:0 .25rem}.sn-as-card-header-bottom .meta:last-of-type:after{display:none}.sn-as-card-body{overflow-x:hidden;overflow-y:hidden;font-size:1rem;color:RGB(var(--now-color_text--primary,var(--now-color--neutral-18,22,27,28)))}.sn-as-card-body-content{margin-top:-.75rem;margin-bottom:-.5rem}.sn-as-card-body img{overflow:hidden;max-width:100%;height:auto}.sn-as-card-body-journal{margin:0;overflow-wrap:break-word}.sn-as-card-body-journal :first-child{margin-top:0}.sn-as-card-body-journal :last-child{margin-bottom:0}.sn-as-card-body-email{min-height:400px;padding:0}.sn-as-card-body-email now-label-value-tabbed{margin-bottom:.75rem}.sn-as-card-body-email iframe{width:100%;height:400px;border:none;background-color:RGB(var(--now-color_background--primary,var(--now-color--neutral-0,255,255,255)))}.sn-as-card-body pre{overflow-x:auto;margin:0}.sn-as-card-body-toggler{padding-top:.5rem}.sn-as-card-body-toggler.hidden{display:none}.sn-as-toggler{display:inline-flex;vertical-align:middle;justify-content:center;align-items:center;width:auto;margin:.75rem 0 0;border:none;padding:0;font-size:1rem;font-family:inherit;white-space:nowrap;cursor:pointer;color:RGB(var(--now-color--secondary-1,1,119,142));background:transparent}.sn-as-toggler:hover{color:RGB(var(--now-color--secondary-2,1,89,107))}.sn-as-toggler:active{color:RGB(var(--now-color--secondary-3,1,60,71))}.icon{display:inline-block;width:25px;height:25px}.icon+.user{padding-right:.75rem;padding-left:.75rem}.fake-avatar{border:1px solid rgb(var(--now-color_border--tertiary,var(--now-color--neutral-3,209,214,214)));border-radius:50%;background-color:RBG(var(--now-color_background--secondary,var(--now-color--neutral-1,246,247,247)))}.icon-wrap{display:inline-block;width:25px;height:25px}.hidden-searchable{position:absolute;overflow:hidden;clip:rect(0 0 0 0);width:1px;height:1px;margin:-1px;border:0;padding:0}.email-content,.last-reply{display:block;overflow-x:auto;max-width:100%;margin-block-start:.75rem}.sn-as-email-inline-attachments{display:flex;flex-flow:row wrap;margin:0;padding:0}.sn-as-email-inline-attachments .item{flex-grow:1;margin-block-start:.75rem;margin-inline-end:.5rem;max-width:100%;list-style-type:none}.email-preview{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.email-preview>span{font-weight:700}@supports (display:-webkit-box){.email-preview{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;white-space:normal}}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","module.exports = __TECTONIC__$servicenow_now_pill;","module.exports = __TECTONIC__$servicenow_now_checkbox;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \":host{box-sizing:border-box;line-height:var(--now-line-height,1.25);font-family:var(--now-font-family,\\\"Source Sans Pro\\\",sans-serif)}:host([hidden]){display:none}*,:after,:before{box-sizing:border-box}.now-a11y-label{position:absolute;overflow:hidden;width:1px;height:auto;margin:0;border:none;padding:0;white-space:nowrap;clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%)}.as-filter-options-panel{padding:0}.as-filter-options-panel .multi-selectors{padding:0 1rem}.as-filter-options-panel .as-filter-options{margin:.75rem 0;padding:0;list-style:none}.as-filter-options-panel .as-filter-options .sub-header-option{display:inline-block;margin-bottom:.5rem}.as-filter-options-panel .as-filter-options .sub-header-option:first-of-type{margin-inline-start:1rem}.as-filter-options-panel .as-filter-options .sub-header-option:last-of-type{margin-inline-end:1rem}.as-filter-options-panel .as-filter-options .separator{margin-right:.5rem;margin-left:.5rem;color:RGB(var(--now-color_divider--tertiary,var(--now-color--neutral-3,209,214,214)))}.as-filter-options-panel .as-filter-options .filter-option{display:block;margin:0;padding:0}.as-filter-options-panel .as-filter-options .filter-option:last-of-type{margin-bottom:0}.as-filter-options-panel .as-filter-options .filter-option .check-box{display:block;padding:.25rem 1rem}.as-filter-options-panel .as-filter-options .filter-option .check-box:hover{background-color:RGB(var(--now-color--primary-0,221,237,233))}.as-filter-options-panel .as-filter-options .filter-option .check-box.focused,.as-filter-options-panel .as-filter-options .filter-option .check-box:active,.as-filter-options-panel .as-filter-options .filter-option .check-box:focus{box-shadow:inset 0 0 0 2px RGB(var(--now-color_focus-ring,var(--now-color--secondary-1,1,119,142))),inset 0 0 0 3px RGB(var(--now-color_focus-ring_shadow,var(--now-color--neutral-0,255,255,255))),0 1px .125rem 0 RGBA(var(--now-color--neutral-21,0,0,0),.25);background-color:RGB(var(--now-color--primary-0,221,237,233))}.as-filter-options-header{display:flex;align-items:center;padding:1rem 1rem 0}.as-filter-options-header .title{flex:auto}.as-filter-options-header .title now-heading{display:inline-block;font-size:1.25rem;color:RGB(var(--now-color_text--primary,var(--now-color--neutral-18,22,27,28)))}.as-filter-options-header .title now-button-bare{margin-right:.5rem;margin-left:.5rem}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","module.exports = __TECTONIC__$servicenow_now_modal;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/@tectonic/webpack-block/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \":host{line-height:var(--now-line-height,1.25);font-family:var(--now-font-family,\\\"Source Sans Pro\\\",sans-serif)}:host([hidden]){display:none}*,:after,:before{box-sizing:border-box}:host{display:flex;flex-direction:column;flex:0 0 100%;box-sizing:border-box;height:100%}.combo{display:flex;flex-direction:column}.combo now-activity-stream-compose-connected{display:block;margin-bottom:1rem;background:RGB(var(--now-color_background--secondary,var(--now-color--neutral-1,246,247,247)))}.combo now-activity-stream-compose-connected,.combo now-activity-stream-connected{flex:1 1 auto;box-sizing:border-box;padding:1.5rem}.combo.combo--column-mode{overflow-y:auto;flex-direction:row;align-items:stretch;height:inherit;margin:0;padding:0}.combo.combo--column-mode now-activity-stream-compose-connected,.combo.combo--column-mode now-activity-stream-connected{display:flex;overflow-y:auto;flex-direction:column;flex:1 0 22.1875rem;margin-bottom:0}.combo.combo--column-mode now-activity-stream-connected{margin-top:1.5rem;padding-top:0}.combo.combo--column-mode .gutter{flex:0 0 auto;border-left:1px solid rgb(var(--now-color_divider--tertiary,var(--now-color--neutral-3,209,214,214)))}.combo now-activity-stream-input{margin-bottom:1rem}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import snabbdom from '@servicenow/ui-renderer-snabbdom';\n\nexport default class SeismicComponent {\n\tdispatch = null;\n\n\t// Public Methods\n\tgetCustomElementParts() {\n\t\tconst view = (state, coeffects) => {\n\t\t\treturn this.getView(state, coeffects);\n\t\t};\n\t\tconst styles = this.getStyles();\n\t\tconst behaviors = this.getBehaviors();\n\t\tconst properties = this.getPropertyDefinitions();\n\t\tconst actions = this.getActions();\n\t\tconst actionHandlers = this.getActionHandlers();\n\t\tconst initialState = this.getInitialState();\n\t\tconst eventHandlers = this.getEventHandlers();\n\n\t\treturn {\n\t\t\tstyles,\n\t\t\trenderer: { type: snabbdom, view },\n\t\t\tproperties,\n\t\t\tactions,\n\t\t\tactionHandlers,\n\t\t\tinitialState,\n\t\t\tbehaviors,\n\t\t\teventHandlers\n\t\t};\n\t}\n\n\tconstructor() {\n\t\tif (this.constructor === SeismicComponent)\n\t\t\tthrow new TypeError('Can not construct abstract class SeismicComponent.');\n\n\t\t// Check if all instance methods are implemented.\n\t\tlet abstractMethods = this._getAbstractMethods();\n\t\tabstractMethods.forEach((method) => {\n\t\t\tif (this[method] === SeismicComponent.prototype[method])\n\t\t\t\tthrow new TypeError(`Please implement abstract method ${method}.`);\n\t\t});\n\n\t\tthis.styles = '';\n\t}\n\n\tgetInitialState() {\n\t\treturn {};\n\t}\n\n\tgetPropertyDefinitions() {\n\t\treturn {};\n\t}\n\n\tgetActions() {\n\t\treturn {};\n\t}\n\n\tgetActionHandlers() {\n\t\treturn {};\n\t}\n\n\tgetEventHandlers() {\n\t\treturn [];\n\t}\n\n\tgetBehaviors() {\n\t\treturn [];\n\t}\n\n\tgetStyles() {\n\t\treturn '';\n\t}\n\n\t// abstract methods\n\t/**\n\t * @abstract\n\t * @return String Tag name to use must follow web component standard (lower case and dashes)\n\t */\n\tgetComponentName() {\n\t\tthis._validateAbstractMethod('getComponentName');\n\t}\n\n\t/* eslint-disable no-unused-vars */\n\t/**\n\t * @abstract\n\t * @return {HTMLElement | HTMLElement[] | string}\n\t */\n\tgetView(state, coeffects) {\n\t\tthis._validateAbstractMethod('getView');\n\t}\n\t/* eslint-enable no-unused-vars */\n\n\t// friend Methods\n\t/**\n\t * Can be overwritten to create other abstract seismic component sub classes\n\t * @return {string[]}\n\t * @friend\n\t */\n\t_getAbstractMethods() {\n\t\treturn ['getView', 'getComponentName'];\n\t}\n\n\t/**\n\t * Helps validate implementation when defining abstract methods\n\t * @param methodName\n\t * @friend\n\t */\n\t_validateAbstractMethod(methodName) {\n\t\tif (this === SeismicComponent)\n\t\t\tthrow new TypeError(`Can not call static abstract method ${methodName}.`);\n\t\telse if (this[methodName] === SeismicComponent[methodName])\n\t\t\tthrow new TypeError(`Please implement static abstract method ${methodName}.`);\n\t\telse\n\t\t\tthrow new TypeError(`Do not call static abstract method ${methodName} from child.`);\n\t}\n}\n","import { t } from 'sn-translate';\n\nexport const DEFAULT_ACTIVITY_TITLE = t('Activity');\nexport const NO_ACTIVITY_TO_DISPLAY = t('No activity to display');\nexport const SOMETHING_WENT_WRONG = t('Something went wrong');\nexport const NEW_RECORD_EMPTY_ACTIVITY = t('Activity will be displayed after the record is created.');\nexport const NO_RESULTS_FOR_FILTER = t('Try adding more categories or selecting \"All\" in the filter.');\nexport const NO_ACTIVITY_WAITING = t('Just waiting for something to happen.');\n\nexport const EXPAND_ALL_POST = t('Expand all posts');\nexport const COLLAPSE_ALL_POST = t('Collapse all posts');\nexport const MORE_OPTIONS = t('More Options');\n\nexport const AUTHOR_LABEL = (author) => t('Author: {0}.', author);\nexport const LOADING_TEXT = t('Loading Activity History...');\n\nexport const ADDITIONAL_COMMENTS_TITLE = t('Additional comments');\nexport const WORK_NOTES_TITLE = t('Work notes');\nexport const FIELD_CHANGES_TITLE = t('Field changes');\nexport const ATTACHMENT_TITLE = t('Attachment');\nexport const EMAIL_TITLE = (type) => t('Email {0}', type);\n\nexport const SHOW_MORE = t('Show more');\nexport const SHOW_LESS = t('Show less');\nexport const SHOW_FULL = t('Show full conversation');\nexport const HIDE_FULL = t('Hide full conversation');\n\nexport const ADD_FAVORITE_TOOLTIP = t('Add to favorites');\nexport const REMOVE_FAVORITE_TOOLTIP = t('Remove from favorites');\n\nexport const SORT_DESCENDING = t('Sort by oldest to newest');\nexport const SORT_ASCENDING = t('Sort by newest to oldest');\n\nexport const ADD_FLAG_TOOLTIP = t('Flag as important');\nexport const REMOVE_FLAG_TOOLTIP = t('Clear flag');\n\n//AUDIT TILE\nexport const EMPTY = t('Empty');\n\n//EMAIL TILE\nexport const SUBJECT = t('Subject');\nexport const FROM = t('From');\nexport const TO = t('To');\nexport const CC = t('CC');\nexport const LOADING_EMAIL_CONTENT = t('Loading Email Content');\nexport const LOADING_EMAIL_CONTENT_FAILED = t('Loading email content failed');\nexport const LOADING_EMAIL_LAST_REPLY = t('Loading last reply');\nexport const LOADING_EMAIL_LAST_REPLY_FAILED = t('Loading last reply failed');\nexport const REPLY = t('Reply');\nexport const FORWARD = t('Forward');\nexport const REPLY_ALL = t('Reply All');\nexport const MORE = t('More');\nexport const EMAIL_PANEL_HEADERS = {\n\tREPLY: t('Reply Email'),\n\tREPLY_ALL: t('Reply All Email'),\n\tFORWARD: t('Forward Email')\n};\n\n//Filters\nexport const OPEN_FILTERS = t('Open filters');\nexport const FILTERS_APPLIED_OPEN = t('Filters applied, click to open filters');\nexport const CLOSE_FILTERS = t('Close filters');\nexport const POST_TYPES = t('Post types');\nexport const FIELD_CHANGES = t('Field changes');\nexport const CONVERSATION = t('Conversation');\nexport const CONVERSATION_SUBLABEL = t('Comments, work notes, email');\n\nexport const CLEAR_ALL = t('Clear all');\nexport const SELECT_ALL = t('Select all');\nexport const CLOSE_FILTER_PILL = t('Close filter pill');\nexport const RESET_FILTER = t('Reset filter');\nexport const CLEAR_FILTERS_TOOLTIP = t('Clear all activity stream filters');\nexport const FILTER_SETS = t('Filter sets');\nexport const FLAGGED = t('Flagged');\nexport const ACCESSIBLE_PILL_LABEL = (pillTitle, numberOfSelections) =>\n\tt('{0} {1} options selected', pillTitle, numberOfSelections);\nexport const N_OPTIONS_AVAILABLE = (n) => t('{0} options available', n);\n\n//Email Action\nexport const EMAIL = t('Email');\nexport const EMAIL_COMPOSE_MODAL_CONTENT = t('Opening a new email will cause your current changes to be lost. Do you want to continue closing the existing email without saving?');\nexport const NEW_EMAIL = t('New email');\nexport const CONTINUE = t('Continue');\nexport const CANCEL = t('Cancel');\n","//PUBLIC ACTIONS\nexport const WS_PREVIEW_RECORD_ACTION = 'PREVIEW_RECORD'; //Open new workspace record tab\nexport const AS_PREVIEW_RECORD_REQUESTED = 'PREVIEW_RECORD_REQUESTED'; //will be prefixed with component name\n\n//PRIVATE ACTIONS\nexport const AS_SET_FLAG_ACTION = 'NOW_ACTIVITY_STREAM#SET_FLAG';\nexport const AS_SET_FLAG_ACTION_IS_PRIVATE = true;\n\nexport const AS_SET_FAVORITE_ACTION = 'NOW_ACTIVITY_STREAM#SET_FAVORITE';\nexport const AS_SET_FAVORITE_ACTION_IS_PRIVATE = true;\n\nexport const AS_QUICK_FILTER_CHANGED_ACTION = 'NOW_ACTIVITY_STREAM#QUICK_FILTER_CHANGED';\nexport const AS_QUICK_FILTER_CHANGED_ACTION_IS_PRIVATE = true;\n\nexport const AS_FILTER_CHANGED_ACTION = 'NOW_ACTIVITY_STREAM#FILTER_CHANGED';\nexport const AS_FILTER_CHANGED_ACTION_IS_PRIVATE = true;\n\nexport const AS_SORT_CHANGED_ACTION = 'NOW_ACTIVITY_STREAM#SORT_CHANGED';\nexport const AS_SORT_CHANGED_ACTION_IS_PRIVATE = true;\n\nexport const AS_EXPAND_ALL_EVENTS_ACTION = 'NOW_ACTIVITY_STREAM#EXPAND_ALL_EVENTS';\nexport const AS_COLLAPSE_ALL_EVENTS_ACTION = 'NOW_ACTIVITY_STREAM#COLLAPSE_ALL_EVENTS';\nexport const AS_EXPAND_COLLAPSE_ALL_ACTIONS_ARE_PRIVATE = true;\n\nexport const AS_REQUEST_AMB_CONNECTIONS_ACTION = 'NOW_ACTIVITY_STREAM#REQUEST_AMB_CONNECTIONS';\nexport const AS_REQUEST_AMB_DISCONNECTIONS_ACTION = 'NOW_ACTIVITY_STREAM#REQUEST_AMB_DISCONNECTIONS';\nexport const AS_REQUEST_AMB_ACTIONS_ARE_PRIVATE = true;\n\n//INTERNAL PRIVATE\nexport const AS_UPDATE_EVENT_SUPPLEMENTAL_STATE_ACTION = 'NOW_ACTIVITY_STREAM#UPDATE_EVENT_SUPPLEMENTAL_STATE';\nexport const AS_POPOVER_PANEL_OPENED_ACTION = 'NOW_ACTIVITY_STREAM#POPOVER_PANEL_OPENED';\nexport const AS_POPOVER_PANEL_CLOSED_ACTION = 'NOW_ACTIVITY_STREAM#POPOVER_PANEL_CLOSED';\n\n//ACTION IDS (Identify intention in the payload of a shared action)\nexport const EXPAND_ALL_POST_ACTION_ID = 'ACTIVITY_EXPAND_ALL_POST';\nexport const COLLAPSE_ALL_POST_ACTION_ID = 'ACTIVITY_COLLAPSE_ALL_POST';\nexport const TOGGLE_FILTERS_AREA_ACTION_ID = 'ACTIVITY_TOGGLE_FILTERS_AREA';\n","import { getProperty } from 'sn-uxpage-presource';\n\nexport const EVENT_TABLES = {\n\tJOURNAL: 'sys_journal_field',\n\tEMAIL: 'sys_email',\n\tAUDIT: 'sys_audit',\n\tATTACHMENT: 'sys_attachment'\n};\n\nexport const EVENT_SUB_TYPES = {\n\tJOURNAL: {\n\t\tCOMMENTS: 'comments',\n\t\tWORK_NOTES: 'work_notes'\n\t},\n\tEMAIL: {\n\t\tSENT: 'sent',\n\t\tRECEIVED: 'received'\n\t}\n};\n\nexport const FIELD_CHANGES_FILTER_FIELD = '*field-changes*';\n\nconst getApiVersion = () => {\n\tconst sysPropValue = getProperty('glide.activity.api_version', 0);\n\treturn sysPropValue === 0 || sysPropValue === '0' ? 0 : 1;\n};\nexport const apiVersion = getApiVersion();\n","export const isTrue = (prop) => prop === true || prop === 'true';\n\nexport const parseJson = (original, defaultValue) => {\n\tif (!original)\n\t\treturn defaultValue;\n\n\tif (typeof original !== 'string')\n\t\treturn original;\n\n\ttry {\n\t\treturn JSON.parse(original);\n\t} catch (e) {\n\t\tconsole.error(`Failed to parse: ${original}, returned: ${defaultValue}`, e);\n\t\treturn defaultValue;\n\t}\n};\n\nexport const jsonStringToObject = (original) => {\n\treturn parseJson(original, {});\n};\n\nexport const jsonStringToArray = (original) => {\n\treturn parseJson(original, []);\n};\n","import { jsonStringToObject } from '../shared/utils';\n\nexport default class ActivityDto {\n\tdocumentTable: string = '';\n\tdocumentId: string = '';\n\teventTable: string = '';\n\teventSysId: string = '';\n\teventCreatedOn: {\n\t\tdisplayValue: string,\n\t\tnumericValue: number,\n\t\tvalue: string\n\t} = null;\n\teventTitle: string = '';\n\tsubtype: string = '';\n\tpayload: Object = null;\n\tsupplemental: Object = null;\n\ttile: String = '';\n\teventCreatedBy: string = '';\n\n\tconstructor(defaultValues = {}) {\n\t\tthis.documentTable = defaultValues['documentTable'] || '';\n\t\tthis.documentId = defaultValues['documentId'] || '';\n\t\tthis.eventTable = defaultValues['eventTable'] || '';\n\t\tthis.eventSysId = defaultValues['eventSysId'] || '';\n\t\tthis.eventCreatedOn = defaultValues['eventCreatedOn'] || null;\n\t\tthis.subtype = defaultValues['subtype'] || '';\n\t\tthis.payload = jsonStringToObject(defaultValues['payload']);\n\t\tthis.supplemental = defaultValues['supplemental'] || {};\n\t\tthis.tile = defaultValues['tile'] || '';\n\t\tthis.eventTitle = defaultValues['eventTitle'] || '';\n\t\tthis.eventCreatedBy = defaultValues['eventCreatedBy'] || '';\n\t}\n}\n","const tileRefsByNowIdAndEventId: Map<String, Map<String, *>> = new Map();\n\nexport default class TilesRepo {\n\tstatic getTile(nowId, eventSysId) {\n\t\tconst refMap = tileRefsByNowIdAndEventId.get(nowId);\n\t\tif (!refMap)\n\t\t\treturn null;\n\n\t\treturn refMap.get(eventSysId);\n\t}\n\n\tstatic setTile(nowId, eventSysId, tileReference) {\n\t\tif (!tileRefsByNowIdAndEventId.has(nowId))\n\t\t\ttileRefsByNowIdAndEventId.set(nowId, new Map());\n\n\t\ttileRefsByNowIdAndEventId.get(nowId).set(eventSysId, tileReference);\n\t}\n\n\tstatic destroyTiles(nowId) {\n\t\tconst refMap = tileRefsByNowIdAndEventId.get(nowId);\n\t\tif (!refMap)\n\t\t\treturn;\n\n\t\trefMap.clear();\n\t\ttileRefsByNowIdAndEventId.delete(nowId);\n\t}\n\n\t/**\n\t * Update the tile property <<propertyName>> with the value <<propertyValue>>, for all tiles,\n\t * if eventSysId is provided only the tile with such evenSysId will be updated.\n\t *\n\t * @param nowId\n\t * @param propertyName\n\t * @param propertyValue\n\t * @param eventSysId Optional Only updates the tile with the provided eventSysId\n\t */\n\tstatic updateProperty(nowId, propertyName, propertyValue, eventSysId = '') {\n\t\tconst refMap = tileRefsByNowIdAndEventId.get(nowId);\n\t\tif (!refMap)\n\t\t\treturn;\n\n\t\tif (eventSysId) {\n\t\t\tconst tileRef = refMap.get(eventSysId);\n\t\t\tif (!tileRef)\n\t\t\t\treturn;\n\n\t\t\ttileRef[propertyName] = propertyValue;\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const [key] of refMap)\n\t\t\trefMap.get(key)[propertyName] = propertyValue;\n\t}\n}\n","import ActivityDto from './ActivityDto';\nimport { SnTimeAgo } from 'sn-component-timeago';\nimport TilesRepo from './TilesRepo';\n/**\n * Controls the time and timeAgo references per event\n */\nexport default class FluxCapacitor {\n\tbehaviors = {};\n\ttimeAgoOptions = {};\n\ttimeAgoReferences: Map = new Map([]);\n\n\tsetBehaviors(behaviors) {\n\t\tthis.behaviors = behaviors;\n\t}\n\n\tsetTimeAgoOptions(options) {\n\t\tthis.timeAgoOptions = options;\n\t}\n\n\taddTimedTile(nowId, activityDto: ActivityDto) {\n\t\tconst timeAgo = this.getTimeAgo(activityDto);\n\t\ttimeAgo.setUpdateFn((tickTime) => {\n\t\t\tconst tile = TilesRepo.getTile(nowId, activityDto.eventSysId);\n\t\t\tif (!tile)\n\t\t\t\treturn;\n\t\t\tif (tile.getProperty('timeAgo').words !== tickTime.words)\n\t\t\t\ttile.timeAgo = tickTime;\n\t\t});\n\t}\n\n\t/**\n\t * Removes functions that continuously update time elements\n\t */\n\tdestroyTimeContinuum() {\n\t\tthis.timeAgoReferences.forEach((timeAgo) => {\n\t\t\ttimeAgo._removeFn();\n\t\t});\n\t\tthis.timeAgoReferences.clear();\n\t}\n\n\tgetTimeAgo(activityDto: ActivityDto) {\n\t\tif (!this.timeAgoReferences.has(activityDto.eventSysId)) {\n\t\t\tconst behaviors = this.behaviors;\n\t\t\tthis.timeAgoReferences.set(\n\t\t\t\tactivityDto.eventSysId,\n\t\t\t\tnew SnTimeAgo(\n\t\t\t\t\t{\n\t\t\t\t\t\tbehaviors,\n\t\t\t\t\t\ttimestampLong: activityDto.eventCreatedOn.numericValue\n\t\t\t\t\t},\n\t\t\t\t\tactivityDto.eventCreatedOn.displayValue,\n\t\t\t\t\tthis.timeAgoOptions\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\treturn this.timeAgoReferences.get(activityDto.eventSysId);\n\t}\n}\n","import FluxCapacitor from './FluxCapacitor';\n\nconst fluxCapacitorInstances: Map<String, FluxCapacitor> = new Map();\n\nexport default class FluxCapacitorRepo {\n\tstatic getInstance(nowId: String) {\n\t\treturn fluxCapacitorInstances.get(nowId) || null;\n\t}\n\n\tstatic createInstance(nowId: String, behaviors, timeAgoOptions) {\n\t\tconst instance = new FluxCapacitor();\n\t\tinstance.setBehaviors(behaviors);\n\t\tinstance.setTimeAgoOptions(timeAgoOptions);\n\t\tfluxCapacitorInstances.set(nowId, instance);\n\t}\n\n\tstatic destroyInstance(nowId: String) {\n\t\tconst instance = FluxCapacitorRepo.getInstance(nowId);\n\t\tif (!instance)\n\t\t\treturn;\n\n\t\tinstance.destroyTimeContinuum();\n\t\tinstance.setBehaviors(null);\n\t\tinstance.setTimeAgoOptions(null);\n\t\tfluxCapacitorInstances.delete(nowId);\n\t}\n\n\tstatic addTimedTile(nowId, activityDto) {\n\t\tconst instance = FluxCapacitorRepo.getInstance(nowId);\n\t\tif (!instance)\n\t\t\treturn;\n\t\tinstance.addTimedTile(nowId, activityDto);\n\t}\n\n\t/**\n\t *\n\t * @param nowId\n\t * @param activityDto\n\t * @returns {null|{words: string, alternate: string, time: string, timestamp: string}}\n\t */\n\tstatic getTickTime(nowId, activityDto) {\n\t\tconst instance = FluxCapacitorRepo.getInstance(nowId);\n\t\tif (!instance)\n\t\t\treturn null;\n\n\t\tconst timeAgo = instance.getTimeAgo(activityDto);\n\t\tif (!timeAgo)\n\t\t\treturn null;\n\n\t\treturn timeAgo.getTickTime();\n\t}\n}\n","// noinspection ES6CheckImport\nimport { actionTypes } from '@servicenow/ui-core';\nconst { COMPONENT_DISCONNECTED } = actionTypes;\n\nconst observersByComponentId = new Map();\nconst tileRefsByComponentId = new Map();\n\nconst tileObserverCallback = (events, observer) => {\n\tevents.forEach((entry) => {\n\t\tconst { target, isIntersecting, intersectionRatio, boundingClientRect } = entry;\n\t\tconst activated = intersectionRatio > 0 && isIntersecting;\n\n\t\t// On first load tiles might render with width < 2 and height < 2, making them all fit in view, re-observing\n\t\t// makes sure we get the callback called when they fully render.\n\t\tif (boundingClientRect.height < 2 || boundingClientRect.width < 2) {\n\t\t\tobserver.unobserve(target);\n\t\t\tobserver.observe(target);\n\t\t} else if (activated) {\n\t\t\ttarget.activated = true;\n\t\t\tobserver.unobserve(target);\n\t\t}\n\t});\n};\n\nconst createTileObserver = (componentId) => {\n\tconst options = {\n\t\troot: null, // null = viewport is the browser window\n\t\trootMargin: '50px', // viewport extended by 50px to load some elements of screen\n\t\tthreshold: [0, 1] // Triggered when: Top of element (0), or Bottom of element (1), gets into the viewport\n\t};\n\tobserversByComponentId.set(componentId, new IntersectionObserver(tileObserverCallback, options));\n};\n\nconst destroyTileObserver = (componentId) => {\n\tconst observer = observersByComponentId.get(componentId);\n\tconst tiles = tileRefsByComponentId.get(componentId);\n\n\tif (!observer || !tiles)\n\t\treturn;\n\n\ttiles.forEach((ref) => {\n\t\tobserver.unobserve(ref);\n\t});\n\tobserver.disconnect();\n\tobserversByComponentId.set(componentId, null);\n\tobserversByComponentId.delete(componentId);\n\ttileRefsByComponentId.set(componentId, null);\n\ttileRefsByComponentId.delete(componentId);\n};\n\nexport const activityLazyRenderBehavior = {\n\tname: 'activityLazyRenderBehavior',\n\tproperties: {\n\t\tobserveTile: {\n\t\t\tdefault: (componentId, tileRef) => {\n\t\t\t\tif (!observersByComponentId.get(componentId))\n\t\t\t\t\tcreateTileObserver(componentId);\n\n\t\t\t\tif (!tileRefsByComponentId.get(componentId))\n\t\t\t\t\ttileRefsByComponentId.set(componentId, []);\n\n\t\t\t\tconst tiles = tileRefsByComponentId.get(componentId);\n\t\t\t\tobserversByComponentId.get(componentId).observe(tileRef);\n\t\t\t\ttiles.push(tileRef);\n\t\t\t}\n\t\t}\n\t},\n\tactionHandlers: {\n\t\t[COMPONENT_DISCONNECTED]: (coeffects) => {\n\t\t\tconst {\n\t\t\t\tproperties: { nowId }\n\t\t\t} = coeffects;\n\t\t\tdestroyTileObserver(nowId);\n\t\t}\n\t}\n};\n","let selectedHeaderActionIndex = 0;\nlet currentHeaderActionElements = [];\nlet previousHeaderActionElement = null;\n\nconst SENSIBILITY = 0; //make bigger in case of tabbing issues.\n\nexport const tileFocusManagementBehavior = {\n\tname: 'tileFocusManagementBehavior',\n\teventHandlers: [\n\t\t{\n\t\t\tevents: ['mouseout', 'blur'],\n\t\t\teffect({\n\t\t\t\taction: {\n\t\t\t\t\tpayload: { event }\n\t\t\t\t}\n\t\t\t}) {\n\t\t\t\tconst path = event.composedPath();\n\t\t\t\tconst target = path.filter((elem) => elem.classList && elem.classList.contains('tile'));\n\t\t\t\tif (target.length === 0)\n\t\t\t\t\treturn;\n\n\t\t\t\tpreviousHeaderActionElement = null;\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tevents: ['keyup', 'keydown'],\n\t\t\teffect({\n\t\t\t\taction: {\n\t\t\t\t\tpayload: { event }\n\t\t\t\t}\n\t\t\t}) {\n\t\t\t\tconst path = event.composedPath();\n\t\t\t\tlet origin = null;\n\t\t\t\tlet originType = '';\n\t\t\t\tfor (let i = 0; i < path.length && origin === null; i++) {\n\t\t\t\t\tconst classList = path[i].classList;\n\t\t\t\t\tif (classList && classList.contains('card-actions')) {\n\t\t\t\t\t\toriginType = 'card-actions';\n\t\t\t\t\t\torigin = path[i];\n\t\t\t\t\t}\n\t\t\t\t\tif (classList && classList.contains('button-group-item')) {\n\t\t\t\t\t\toriginType = 'button-group-item';\n\t\t\t\t\t\torigin = path[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (origin !== null) {\n\t\t\t\t\tif (event.type === 'keyup') {\n\t\t\t\t\t\tif (event.key === 'Tab' && originType === 'card-actions') {\n\t\t\t\t\t\t\tselectedHeaderActionIndex = 0;\n\t\t\t\t\t\t\tconst actionElements = origin.querySelectorAll('.button-group-item');\n\t\t\t\t\t\t\tcurrentHeaderActionElements = actionElements;\n\t\t\t\t\t\t\tif (previousHeaderActionElement !== origin) {\n\t\t\t\t\t\t\t\tpreviousHeaderActionElement = origin;\n\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\tconst actionElem = actionElements[selectedHeaderActionIndex];\n\t\t\t\t\t\t\t\t\tif (actionElem)\n\t\t\t\t\t\t\t\t\t\tactionElem.focus();\n\t\t\t\t\t\t\t\t}, SENSIBILITY);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst previousKey = document.dir === 'rtl' ? 'ArrowRight' : 'ArrowLeft';\n\t\t\t\t\t\tconst nextKey = document.dir === 'rtl' ? 'ArrowLeft' : 'ArrowRight';\n\n\t\t\t\t\t\tif (event.key === previousKey) {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\tselectedHeaderActionIndex--;\n\t\t\t\t\t\t\tif (selectedHeaderActionIndex < 0)\n\t\t\t\t\t\t\t\tselectedHeaderActionIndex = currentHeaderActionElements.length - 1;\n\t\t\t\t\t\t\tcurrentHeaderActionElements[selectedHeaderActionIndex].focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (event.key === nextKey) {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\tselectedHeaderActionIndex++;\n\t\t\t\t\t\t\tif (selectedHeaderActionIndex > currentHeaderActionElements.length - 1)\n\t\t\t\t\t\t\t\tselectedHeaderActionIndex = 0;\n\t\t\t\t\t\t\tcurrentHeaderActionElements[selectedHeaderActionIndex].focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (event.key === 'Tab' && event.shiftKey) {\n\t\t\t\t\t\tpreviousHeaderActionElement.tabIndex = -1;\n\t\t\t\t\t\tlet ref = previousHeaderActionElement;\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tref.tabIndex = 0;\n\t\t\t\t\t\t}, SENSIBILITY);\n\t\t\t\t\t}\n\t\t\t\t} else\n\t\t\t\t\tpreviousHeaderActionElement = null;\n\t\t\t}\n\t\t}\n\t]\n};\n","/**\n * @abstract\n */\nexport default class TileHeaderAction {\n\t/* eslint-disable no-unused-vars */\n\n\t/**\n\t * @abstract\n\t */\n\tgetBehaviors() {}\n\n\t/**\n\t * @abstract\n\t * @return {HTMLElement | HTMLElement[] | string}\n\t */\n\tgetJSX(state) {\n\t\treturn '';\n\t}\n\n\t/* eslint-enable no-unused-vars */\n}\n","import { createGraphQLEffect } from '@servicenow/ui-effect-graphql';\nimport { noop } from 'lodash';\n\nconst supplementalQuery = `\n    mutation ($documentSysId: String, $eventId: String, $payload: String!, $isForAllUsers: Boolean) {\n        GlideActivity_Mutation {\n            putSupplemental(documentSysId: $documentSysId, eventId: $eventId, payload: $payload, isForAllUsers: $isForAllUsers){\n                documentId\n                eventId\n                payload\n                userSysId\n            }\n        }\n    }\n`;\n\nexport const supplementalBehaviors = [];\nexport const registerSupplementalBehavior = ({\n\tsaveAction,\n\tsaveSucceededAction = null,\n\tsaveFailedAction = null,\n\tsaveSucceededActionHandler = noop,\n\tsaveFailedActionHandler = noop,\n\tisPrivate = true\n}) => {\n\tconst succeededAction = saveSucceededAction || `${saveAction}_SUCCEEDED`;\n\tconst failedAction = saveFailedAction || `${saveAction}_FAILED`;\n\tsupplementalBehaviors.push({\n\t\tbehavior: {\n\t\t\tname: `supplementalDataBehavior_${saveAction}`,\n\t\t\tactions: {\n\t\t\t\t[saveAction]: { private: isPrivate }\n\t\t\t},\n\t\t\tactionHandlers: {\n\t\t\t\t[saveAction]: createGraphQLEffect(supplementalQuery, {\n\t\t\t\t\tvariableList: ['documentSysId', 'eventId', 'payload', 'isForAllUsers'],\n\t\t\t\t\tsuccessActionType: succeededAction,\n\t\t\t\t\terrorActionType: failedAction\n\t\t\t\t}),\n\t\t\t\t[succeededAction]: { effect: saveSucceededActionHandler, stopPropagation: true },\n\t\t\t\t[failedAction]: { effect: saveFailedActionHandler, stopPropagation: true }\n\t\t\t}\n\t\t}\n\t});\n};\n","import TileHeaderAction from './TileHeaderAction';\nimport { _getInitialRenderState } from '../ActivityTile';\nimport { ADD_FAVORITE_TOOLTIP, REMOVE_FAVORITE_TOOLTIP } from '../../translations';\nimport { actionTypes } from '@servicenow/ui-core';\nimport { registerSupplementalBehavior } from '../../../activity-connected/supplementalDataBehavior';\nimport {\n\tAS_SET_FAVORITE_ACTION,\n\tAS_SET_FAVORITE_ACTION_IS_PRIVATE,\n\tAS_UPDATE_EVENT_SUPPLEMENTAL_STATE_ACTION\n} from '../../actions';\nimport {\n\tAS_SAVE_FAVORITE_SUCCEEDED_ACTION,\n\tAS_SAVE_FAVORITE_FAILED_ACTION,\n\tAS_SAVE_FAVORITE_ACTION_IS_PRIVATE\n} from '../../../activity-connected/actions';\nconst { COMPONENT_PROPERTY_CHANGED } = actionTypes;\n\nconst updateFavorite = (favorite, updateState, supplemental) => {\n\tupdateState({\n\t\tsupplemental: {\n\t\t\t...supplemental,\n\t\t\tfavorite\n\t\t}\n\t});\n};\n\nregisterSupplementalBehavior({\n\tsaveAction: AS_SET_FAVORITE_ACTION,\n\tisPrivate: AS_SAVE_FAVORITE_ACTION_IS_PRIVATE,\n\tsaveSucceededAction: AS_SAVE_FAVORITE_SUCCEEDED_ACTION,\n\tsaveFailedAction: AS_SAVE_FAVORITE_FAILED_ACTION,\n\tsaveSucceededActionHandler: (coeffects) => {\n\t\tconst {\n\t\t\tupdateState,\n\t\t\tstate,\n\t\t\taction: {\n\t\t\t\tpayload: { errors }\n\t\t\t}\n\t\t} = coeffects;\n\t\tif (errors && errors.length > 0) {\n\t\t\tconsole.error(errors[0].message || 'Something went wrong when favoriting a tile');\n\t\t\tconst { supplemental } = state;\n\t\t\tconst { favorite = false } = supplemental;\n\t\t\tupdateFavorite(!favorite, updateState, supplemental);\n\t\t}\n\t},\n\tsaveFailedActionHandler: (coeffects) => {\n\t\tconst {\n\t\t\tupdateState,\n\t\t\tstate: { supplemental }\n\t\t} = coeffects;\n\n\t\tconst { favorite = false } = supplemental;\n\t\tconsole.error('Something went wrong when favoriting a tile, check network call');\n\t\tupdateFavorite(!favorite, updateState, supplemental);\n\t}\n});\n\nexport default class FavoritingHeaderAction extends TileHeaderAction {\n\tgetBehaviors() {\n\t\treturn [\n\t\t\t{\n\t\t\t\tname: 'tileFavoritingBehavior',\n\n\t\t\t\tactions: {\n\t\t\t\t\t['NOW_BUTTON_ICONIC#CLICKED']: { private: true },\n\t\t\t\t\t[AS_SET_FAVORITE_ACTION]: { private: AS_SET_FAVORITE_ACTION_IS_PRIVATE },\n\t\t\t\t\t[AS_SAVE_FAVORITE_SUCCEEDED_ACTION]: { private: AS_SAVE_FAVORITE_ACTION_IS_PRIVATE },\n\t\t\t\t\t[AS_SAVE_FAVORITE_FAILED_ACTION]: { private: AS_SAVE_FAVORITE_ACTION_IS_PRIVATE }\n\t\t\t\t},\n\n\t\t\t\tactionHandlers: {\n\t\t\t\t\t[COMPONENT_PROPERTY_CHANGED]: (coeffects) => {\n\t\t\t\t\t\tconst { properties = {}, updateState, state } = coeffects;\n\t\t\t\t\t\tconst { favorite = false } = properties.supplemental;\n\n\t\t\t\t\t\tconst { supplemental } = state;\n\t\t\t\t\t\tconst { favorite: originalFavorite = false } = supplemental || {};\n\n\t\t\t\t\t\tif (supplemental && favorite !== originalFavorite)\n\t\t\t\t\t\t\tupdateFavorite(favorite, updateState, supplemental);\n\t\t\t\t\t},\n\n\t\t\t\t\t['NOW_BUTTON_ICONIC#CLICKED']: (coeffects) => {\n\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\taction: {\n\t\t\t\t\t\t\t\tpayload: { headerAction = '' }\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tstate,\n\t\t\t\t\t\t\tdispatch,\n\t\t\t\t\t\t\tupdateState\n\t\t\t\t\t\t} = coeffects;\n\n\t\t\t\t\t\tif (headerAction !== 'favorite')\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\tconst { supplemental = {} } = state;\n\t\t\t\t\t\tconst { documentId = '', eventSysId = '' } = state.properties;\n\t\t\t\t\t\tconst { favorite = false } = supplemental;\n\t\t\t\t\t\tconst payload = `{\"favorite\": ${!favorite}}`;\n\n\t\t\t\t\t\tupdateFavorite(!favorite, updateState, supplemental);\n\n\t\t\t\t\t\tdispatch(AS_UPDATE_EVENT_SUPPLEMENTAL_STATE_ACTION, {\n\t\t\t\t\t\t\teventSysId,\n\t\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\t\tfavorite: !favorite\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tdispatch(AS_SET_FAVORITE_ACTION, {\n\t\t\t\t\t\t\tdocumentSysId: documentId,\n\t\t\t\t\t\t\teventId: eventSysId,\n\t\t\t\t\t\t\tpayload: payload\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\tgetJSX(_state) {\n\t\tconst state = typeof _state.supplemental === 'undefined' ? _getInitialRenderState(_state) : _state;\n\t\tconst { favorite = false } = state.supplemental;\n\t\tconst className = favorite ? 'sn-as-card-favorite force-show' : 'sn-as-card-favorite';\n\t\tconst toggleIcon = favorite ? 'star-fill' : 'star-outline';\n\t\tconst tooltipText = !favorite ? ADD_FAVORITE_TOOLTIP : REMOVE_FAVORITE_TOOLTIP;\n\t\treturn (\n\t\t\t<div className={className}>\n\t\t\t\t<now-button-iconic\n\t\t\t\t\tclassName=\"button-group-item\"\n\t\t\t\t\ttabIndex={-1}\n\t\t\t\t\tappend-to-payload={{ headerAction: 'favorite' }}\n\t\t\t\t\ticon={toggleIcon}\n\t\t\t\t\tselected={favorite}\n\t\t\t\t\ttooltip-content={tooltipText}\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\tbare={true}\n\t\t\t\t\tdisabled={false}\n\t\t\t\t\thidePadding={false}\n\t\t\t\t\tconfigAria={{\n\t\t\t\t\t\trole: 'button',\n\t\t\t\t\t\t'aria-label': tooltipText\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","//PUBLIC ACTIONS\n// -none-\n\n//PRIVATE ACTIONS\nexport const AS_SAVE_FLAG_SUCCEEDED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#SAVE_FLAG_SUCCEEDED';\nexport const AS_SAVE_FLAG_FAILED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#SAVE_FLAG_FAILED';\nexport const AS_SAVE_FLAG_ACTION_IS_PRIVATE = true;\n\nexport const AS_SAVE_FAVORITE_SUCCEEDED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#SAVE_FAVORITE_SUCCEEDED';\nexport const AS_SAVE_FAVORITE_FAILED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#SAVE_FAVORITE_FAILED';\nexport const AS_SAVE_FAVORITE_ACTION_IS_PRIVATE = true;\n\nexport const AS_SAVE_QUICK_FILTER_SUCCEEDED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#SAVE_QUICK_FILTER_SUCCEEDED';\nexport const AS_SAVE_QUICK_FILTER_FAILED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#SAVE_QUICK_FILTER_FAILED';\nexport const AS_SAVE_QUICK_FILTER_ACTION_IS_PRIVATE = true;\n\nexport const AS_SAVE_SORT_DIRECTION_REQUESTED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#SAVE_SORT_DIRECTION_REQUESTED';\nexport const AS_SAVE_SORT_DIRECTION_SUCCEEDED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#SAVE_SORT_DIRECTION_SUCCEEDED';\nexport const AS_SAVE_SORT_DIRECTION_FAILED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#SAVE_SORT_DIRECTION_FAILED';\nexport const AS_SAVE_SORT_DIRECTION_REQUESTED_ACTION_IS_PRIVATE = true;\n\nexport const AS_SAVE_FILTER_REQUESTED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#SAVE_FILTER_REQUESTED';\nexport const AS_SAVE_FILTER_SUCCEEDED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#SAVE_FILTER_SUCCEEDED';\nexport const AS_SAVE_FILTER_FAILED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#SAVE_FILTER_FAILED';\nexport const AS_SAVE_FILTER_REQUESTED_ACTION_IS_PRIVATE = true;\n\nexport const AS_FETCH_ACTIVITY_REQUESTED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#ACTIVITY_REQUESTED';\nexport const AS_FETCH_ACTIVITY_SUCCEEDED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#FETCH_ACTIVITY_SUCCEEDED';\nexport const AS_FETCH_ACTIVITY_FAILED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#FETCH_ACTIVITY_FAILED';\n\nexport const AS_FETCH_EMAIL_REPLIES_REQUESTED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#EMAIL_REPLIES_REQUESTED';\nexport const AS_FETCH_EMAIL_REPLIES_SUCCEEDED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#FETCH_EMAIL_REPLIES_SUCCEEDED';\nexport const AS_FETCH_EMAIL_REPLIES_FAILED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#FETCH_EMAIL_REPLIES_FAILED';\n\nexport const AS_FETCH_EMAIL_ATTACHMENTS_REQUESTED_ACTION =\n\t'NOW_ACTIVITY_STREAM_CONNECTED#FETCH_EMAIL_ATTACHMENTS_REQUESTED';\nexport const AS_FETCH_EMAIL_ATTACHMENTS_SUCCEEDED_ACTION =\n\t'NOW_ACTIVITY_STREAM_CONNECTED#FETCH_EMAIL_ATTACHMENTS_SUCCEEDED';\nexport const AS_FETCH_EMAIL_ATTACHMENTS_FAILED_ACTION = 'NOW_ACTIVITY_STREAM_CONNECTED#FETCH_EMAIL_ATTACHMENTS_FAILED';\n","import TileHeaderAction from './TileHeaderAction';\nimport { _getInitialRenderState } from '../ActivityTile';\nimport { ADD_FLAG_TOOLTIP, REMOVE_FLAG_TOOLTIP } from '../../translations';\nimport { actionTypes } from '@servicenow/ui-core';\nimport { registerSupplementalBehavior } from '../../../activity-connected/supplementalDataBehavior';\nimport {\n\tAS_SET_FLAG_ACTION,\n\tAS_SET_FLAG_ACTION_IS_PRIVATE,\n\tAS_UPDATE_EVENT_SUPPLEMENTAL_STATE_ACTION\n} from '../../actions';\nimport {\n\tAS_SAVE_FLAG_SUCCEEDED_ACTION,\n\tAS_SAVE_FLAG_FAILED_ACTION,\n\tAS_SAVE_FLAG_ACTION_IS_PRIVATE\n} from '../../../activity-connected/actions';\nconst { COMPONENT_PROPERTY_CHANGED } = actionTypes;\n\nconst updateFlag = (flag, updateState, supplemental) => {\n\tupdateState({\n\t\tsupplemental: {\n\t\t\t...supplemental,\n\t\t\tflag\n\t\t}\n\t});\n};\n\nregisterSupplementalBehavior({\n\tsaveAction: AS_SET_FLAG_ACTION,\n\tsaveSucceededAction: AS_SAVE_FLAG_SUCCEEDED_ACTION,\n\tisPrivate: AS_SAVE_FLAG_ACTION_IS_PRIVATE,\n\tsaveFailedAction: AS_SAVE_FLAG_FAILED_ACTION,\n\tsaveSucceededActionHandler: (coeffects) => {\n\t\tconst {\n\t\t\tupdateState,\n\t\t\tstate,\n\t\t\taction: {\n\t\t\t\tpayload: { errors }\n\t\t\t}\n\t\t} = coeffects;\n\n\t\tif (errors && errors.length > 0) {\n\t\t\tconsole.error(errors[0].message || 'Something went wrong when flagging a tile');\n\t\t\tconst { supplemental } = state;\n\t\t\tconst { flag = false } = supplemental;\n\t\t\tupdateFlag(!flag, updateState, supplemental);\n\t\t}\n\t},\n\tsaveFailedActionHandler: (coeffects) => {\n\t\tconst {\n\t\t\tupdateState,\n\t\t\tstate: { supplemental }\n\t\t} = coeffects;\n\t\tconst { flag = false } = supplemental;\n\t\tconsole.error('Something went wrong when flagging a tile, check network call');\n\t\tupdateFlag(!flag, updateState, supplemental);\n\t}\n});\n\nexport default class FlaggingHeaderAction extends TileHeaderAction {\n\tgetBehaviors() {\n\t\treturn [\n\t\t\t{\n\t\t\t\tname: 'tileFlaggingBehavior',\n\n\t\t\t\tactions: {\n\t\t\t\t\t['NOW_BUTTON_ICONIC#CLICKED']: { private: true },\n\t\t\t\t\t[AS_SET_FLAG_ACTION]: { private: AS_SET_FLAG_ACTION_IS_PRIVATE },\n\t\t\t\t\t[AS_SAVE_FLAG_SUCCEEDED_ACTION]: { private: AS_SAVE_FLAG_ACTION_IS_PRIVATE },\n\t\t\t\t\t[AS_SAVE_FLAG_FAILED_ACTION]: { private: AS_SAVE_FLAG_ACTION_IS_PRIVATE }\n\t\t\t\t},\n\n\t\t\t\tactionHandlers: {\n\t\t\t\t\t[COMPONENT_PROPERTY_CHANGED]: (coeffects) => {\n\t\t\t\t\t\tconst { properties, updateState, state } = coeffects;\n\t\t\t\t\t\tconst { flag = false } = properties.supplemental;\n\n\t\t\t\t\t\tconst { supplemental } = state;\n\t\t\t\t\t\tconst { flag: originalFlag = false } = supplemental || {};\n\n\t\t\t\t\t\tif (supplemental && flag !== originalFlag)\n\t\t\t\t\t\t\tupdateFlag(flag, updateState, supplemental);\n\t\t\t\t\t},\n\n\t\t\t\t\t['NOW_BUTTON_ICONIC#CLICKED']: (coeffects) => {\n\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\taction: {\n\t\t\t\t\t\t\t\tpayload: { headerAction = '' }\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tstate,\n\t\t\t\t\t\t\tdispatch,\n\t\t\t\t\t\t\tupdateState\n\t\t\t\t\t\t} = coeffects;\n\n\t\t\t\t\t\tif (headerAction !== 'flag')\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\tconst { documentId = '', eventSysId } = state.properties;\n\n\t\t\t\t\t\tconst { supplemental } = state;\n\t\t\t\t\t\tconst { flag = false } = supplemental;\n\t\t\t\t\t\tconst payload = `{\"flag\": ${!flag}}`;\n\n\t\t\t\t\t\tupdateFlag(!flag, updateState, supplemental);\n\n\t\t\t\t\t\tdispatch(AS_UPDATE_EVENT_SUPPLEMENTAL_STATE_ACTION, {\n\t\t\t\t\t\t\teventSysId,\n\t\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\t\tflag: !flag\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tdispatch(AS_SET_FLAG_ACTION, {\n\t\t\t\t\t\t\tdocumentSysId: documentId,\n\t\t\t\t\t\t\teventId: eventSysId,\n\t\t\t\t\t\t\tpayload: payload,\n\t\t\t\t\t\t\tisForAllUsers: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\tgetJSX(_state) {\n\t\tconst state = typeof _state.supplemental === 'undefined' ? _getInitialRenderState(_state) : _state;\n\t\tconst { flag = false } = state.supplemental;\n\t\tconst className = flag ? 'sn-as-card-flag force-show' : 'sn-as-card-flag';\n\t\tconst toggleIcon = flag ? 'flag-fill' : 'flag-outline';\n\t\tconst tooltipText = !flag ? ADD_FLAG_TOOLTIP : REMOVE_FLAG_TOOLTIP;\n\t\treturn (\n\t\t\t<div className={className}>\n\t\t\t\t<now-button-iconic\n\t\t\t\t\tclassName=\"button-group-item\"\n\t\t\t\t\ttabIndex={-1}\n\t\t\t\t\tappend-to-payload={{ headerAction: 'flag' }}\n\t\t\t\t\ticon={toggleIcon}\n\t\t\t\t\tselected={flag}\n\t\t\t\t\ttooltip-content={tooltipText}\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\tbare={true}\n\t\t\t\t\tdisabled={false}\n\t\t\t\t\thidePadding={false}\n\t\t\t\t\tconfigAria={{\n\t\t\t\t\t\trole: 'button',\n\t\t\t\t\t\t'aria-label': tooltipText\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import SeismicComponent from '../../shared/SeismicComponent';\nimport '@servicenow/now-avatar';\nimport { AUTHOR_LABEL } from '../translations';\nimport style from './_activityTile.scss';\nimport { actionTypes } from '@servicenow/ui-core';\nimport FavoritingHeaderAction from './actions/FavoritingHeaderAction';\nimport FlaggingHeaderAction from './actions/FlaggingHeaderAction';\nconst { COMPONENT_CONNECTED, COMPONENT_DISCONNECTED, COMPONENT_DOM_READY } = actionTypes;\n\nexport const _getInitialRenderState = (state) => {\n\tconst {\n\t\tproperties: { supplemental = {} }\n\t} = state;\n\treturn { ...state, supplemental };\n};\n\n/**\n * @abstract\n */\nexport default class ActivityTile extends SeismicComponent {\n\ttimeRefs: Map = new Map([]);\n\n\theaderActions: Array = [new FavoritingHeaderAction(), new FlaggingHeaderAction()];\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.setTimeRef = this.setTimeRef.bind(this);\n\t}\n\n\tgetPropertyDefinitions(): {} {\n\t\treturn {\n\t\t\tactivityNowId: { default: '' },\n\t\t\tshowAvatar: { default: false },\n\t\t\tshowIcon: { default: true },\n\t\t\tshowFavorite: { default: false },\n\t\t\timage: { default: '' },\n\t\t\tauthor: { default: '' },\n\t\t\teventCreatedOn: { default: null },\n\t\t\teventTitle: { default: '' },\n\t\t\texpanded: { default: false },\n\t\t\ttimeAgo: { default: {} },\n\t\t\tactivated: { default: false },\n\t\t\tsupplemental: { default: {} },\n\t\t\tdocumentId: { default: '' },\n\t\t\teventSysId: { default: '' },\n\t\t\teventTable: { default: '' },\n\t\t\tsubtype: { default: '' },\n\t\t\tdocumentTable: { default: '' }\n\t\t};\n\t}\n\n\tgetOnConnect(coeffects) {} // eslint-disable-line no-unused-vars\n\n\tgetOnDisconnect(coeffects) {} // eslint-disable-line no-unused-vars\n\n\tgetBehaviors() {\n\t\tconst behaviors = [];\n\t\tthis.getHeaderActions().forEach((action) => {\n\t\t\tbehaviors.push(...action.getBehaviors());\n\t\t});\n\t\treturn behaviors;\n\t}\n\n\tgetActionHandlers() {\n\t\tconst additionalDestroy = this.getOnDisconnect;\n\t\tconst additionalOnConnect = this.getOnConnect;\n\t\treturn {\n\t\t\t[COMPONENT_CONNECTED]: ({ updateState, state }) => {\n\t\t\t\tupdateState({\n\t\t\t\t\t..._getInitialRenderState(state),\n\t\t\t\t\tshouldRender: false\n\t\t\t\t});\n\t\t\t},\n\t\t\t[COMPONENT_DISCONNECTED]: (coeffects) => {\n\t\t\t\tconst timeRefs = this.timeRefs;\n\t\t\t\ttimeRefs.forEach((ref, key) => {\n\t\t\t\t\ttimeRefs.set(key, null);\n\t\t\t\t});\n\t\t\t\ttimeRefs.clear();\n\t\t\t\tif (additionalDestroy)\n\t\t\t\t\tadditionalDestroy(coeffects);\n\t\t\t},\n\t\t\t[COMPONENT_DOM_READY]: (coeffects) => {\n\t\t\t\tif (additionalOnConnect)\n\t\t\t\t\tadditionalOnConnect(coeffects);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetInitialState() {\n\t\treturn {\n\t\t\tshowCardActions: false\n\t\t};\n\t}\n\n\tgetEventHandlers() {\n\t\tconst handlers = [\n\t\t\t{\n\t\t\t\tevents: ['mouseenter', 'mouseout', 'blur'],\n\t\t\t\teffect({\n\t\t\t\t\taction: {\n\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\tevent: { type, relatedTarget }\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tupdateState\n\t\t\t\t}) {\n\t\t\t\t\tconst showCardActions =\n\t\t\t\t\t\t(type !== 'mouseout' && type !== 'blur') ||\n\t\t\t\t\t\t(relatedTarget && relatedTarget.closest('now-popover-panel'));\n\n\t\t\t\t\tupdateState({\n\t\t\t\t\t\tshowCardActions\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\treturn handlers;\n\t}\n\n\t/* eslint-disable no-unused-vars */\n\tgetTileIcon(state) {\n\t\treturn '';\n\t}\n\t/* eslint-enable no-unused-vars */\n\n\t/* eslint-disable no-unused-vars */\n\tgetTitleDecorator(state) {\n\t\treturn '';\n\t}\n\t/* eslint-disable no-unused-vars */\n\n\t// noinspection JSCheckFunctionSignatures\n\tgetView(state, coeffects) {\n\t\tconst {\n\t\t\tactivated,\n\t\t\tauthor,\n\t\t\timage = '',\n\t\t\tbackgroundColor = '',\n\t\t\tshowAvatar,\n\t\t\tshowIcon,\n\t\t\tshowFavorite,\n\t\t\teventTitle\n\t\t} = state.properties;\n\t\tconst avatar = showAvatar ? (\n\t\t\tactivated ? (\n\t\t\t\t<now-avatar size=\"sm\" image-src={image} user-name={author} />\n\t\t\t) : (\n\t\t\t\t<div className=\"fake-avatar\" />\n\t\t\t)\n\t\t) : (\n\t\t\t''\n\t\t);\n\t\tconst avatarPlaceholder = avatar !== '' ? <div className=\"icon\">{avatar}</div> : '';\n\n\t\tconst iconCode = this.getTileIcon(state);\n\t\tconst tileIcon =\n\t\t\tactivated && showIcon && iconCode ? (\n\t\t\t\t<div className=\"icon\">\n\t\t\t\t\t<now-icon size=\"lg\" icon={iconCode} />\n\t\t\t\t</div>\n\t\t\t) : (\n\t\t\t\t''\n\t\t\t);\n\n\t\tconst headerActions = !activated\n\t\t\t? ''\n\t\t\t: this.getHeaderActions().map((action) => {\n\t\t\t\tif (!showFavorite && action instanceof FavoritingHeaderAction)\n\t\t\t\t\treturn;\n\n\t\t\t\tconst render = action.getJSX(state);\n\t\t\t\treturn render === '' ? '' : <li role=\"menuitem\">{render}</li>;\n\t\t\t  });\n\n\t\tconst colorVariant = backgroundColor === '' ? 'color-variant-neutral' : `color-variant-${backgroundColor}`;\n\t\tconst cardActionStyles = `card-actions${state.showCardActions ? '' : ' hidden'}`;\n\t\treturn (\n\t\t\t<article className={`sn-as-card ${colorVariant}`}>\n\t\t\t\t<header className={`sn-as-card-header ${colorVariant}`}>\n\t\t\t\t\t<div className=\"sn-as-card-header-top\">\n\t\t\t\t\t\t<div className=\"card-info\" id=\"createdBy\" aria-label={AUTHOR_LABEL(author)}>\n\t\t\t\t\t\t\t{tileIcon}\n\t\t\t\t\t\t\t{avatarPlaceholder}\n\t\t\t\t\t\t\t<span className=\"user\">{author}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<ul className={cardActionStyles} tabIndex=\"0\" role=\"group\">\n\t\t\t\t\t\t\t{headerActions}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"sn-as-card-header-bottom\">\n\t\t\t\t\t\t{eventTitle && <span className=\"meta\">{eventTitle}</span>}\n\t\t\t\t\t\t<span className=\"meta\">{this.renderTime(state)}</span>\n\t\t\t\t\t\t{this.getTitleDecorator(state)}\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\t\t\t\t{this.getJSX(state, coeffects)}\n\t\t\t</article>\n\t\t);\n\t}\n\n\tgetStyles(): string {\n\t\treturn style;\n\t}\n\n\t_getAbstractMethods(): [string] {\n\t\treturn [...super._getAbstractMethods(), 'getJSX'];\n\t}\n\n\t/* eslint-disable no-unused-vars */\n\t/**\n\t * @abstract\n\t * @return {HTMLElement | HTMLElement[] | string}\n\t */\n\tgetJSX(state, coeffects) {\n\t\tthis._validateAbstractMethod('getJSX');\n\t}\n\t/* eslint-enable no-unused-vars */\n\n\tsetTimeRef(node, componentId) {\n\t\tif (this.timeRefs.has(componentId))\n\t\t\treturn;\n\t\tthis.timeRefs.set(componentId, node);\n\t\t//do not block render for update\n\t\tsetTimeout(() => {\n\t\t\tconst tooltip = node.querySelector('now-tooltip');\n\t\t\tif (tooltip)\n\t\t\t\ttooltip.targetRef = node;\n\t\t}, 0);\n\t}\n\n\trenderTime(state) {\n\t\tconst {\n\t\t\ttimeAgo: { time = '', alternate = '' },\n\t\t\tactivated\n\t\t} = state.properties;\n\t\tconst { componentId } = state;\n\t\tif (!time)\n\t\t\treturn <time />;\n\n\t\tconst tooltipContent = alternate.toString();\n\t\tconst displayTime = time.toString();\n\t\treturn (\n\t\t\t<time ref={(elm) => this.setTimeRef(elm, componentId)}>\n\t\t\t\t{displayTime}\n\t\t\t\t{tooltipContent && activated ? (\n\t\t\t\t\t<now-tooltip target-ref={this.timeRefs.get(componentId)} content={tooltipContent} />\n\t\t\t\t) : (\n\t\t\t\t\t''\n\t\t\t\t)}\n\t\t\t</time>\n\t\t);\n\t}\n\n\t/* eslint-disable no-unused-vars */\n\t/**\n\t * Allows to add options to the header actions\n\t * @friend\n\t * @param state\n\t * @return TileHeaderAction[]\n\t */\n\tgetHeaderActions() {\n\t\treturn this.headerActions;\n\t}\n\t/* eslint-enable no-unused-vars */\n}\n","import ActivityTile from './ActivityTile';\nimport { createCustomElement } from '@servicenow/ui-core';\n\nconst TEST_TILE = 'test-tile';\n\nclass TestTile extends ActivityTile {\n\tgetComponentName() {\n\t\treturn TEST_TILE;\n\t}\n\n\tgetPropertyDefinitions() {\n\t\treturn super.getPropertyDefinitions();\n\t}\n\n\t// noinspection JSUnresolvedVariable\n\tgetJSX(state) {\n\t\t// noinspection JSXNamespaceValidation\n\t\treturn <div style={{ wordBreak: 'break-all' }}>{JSON.stringify(state.properties)}</div>;\n\t}\n}\n\nconst testTile = new TestTile();\ncreateCustomElement(TEST_TILE, testTile.getCustomElementParts());\nexport default testTile.getComponentName();\n","// noinspection ES6CheckImport\nimport '@servicenow/now-button';\nimport { SHOW_MORE, SHOW_LESS } from '../translations';\nimport ActivityTile from './ActivityTile';\nimport { AS_EXPAND_ALL_EVENTS_ACTION, AS_COLLAPSE_ALL_EVENTS_ACTION } from '../actions';\n\nconst observers: Map = new Map([]);\n/**\n * @abstract\n */\nexport default class TruncatedTile extends ActivityTile {\n\t_getAbstractMethods() {\n\t\treturn [...super._getAbstractMethods(), 'getTruncatedContent'];\n\t}\n\n\tgetPropertyDefinitions(): {} {\n\t\treturn {\n\t\t\t...super.getPropertyDefinitions(),\n\t\t\theight: { default: 100 },\n\t\t\texpanded: { default: false, reflect: true }\n\t\t};\n\t}\n\n\tgetOnConnect(coeffects) {\n\t\tconst {\n\t\t\taction: {\n\t\t\t\tpayload: { host }\n\t\t\t},\n\t\t\tproperties: { height }\n\t\t} = coeffects;\n\n\t\tif (observers.has(host))\n\t\t\treturn;\n\n\t\tobservers.set(host, {\n\t\t\tobserver: new IntersectionObserver(\n\t\t\t\t(items) => {\n\t\t\t\t\tif (items.length === 0)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tconst {\n\t\t\t\t\t\tisIntersecting,\n\t\t\t\t\t\tintersectionRatio,\n\t\t\t\t\t\tboundingClientRect: { height: contentHeight, width: contentWidth }\n\t\t\t\t\t} = items[0];\n\t\t\t\t\tconst hostEl = observers.get(host);\n\t\t\t\t\tconst maxLimit = hostEl.height;\n\t\t\t\t\tconst isFullyVisible = isIntersecting && intersectionRatio === 1;\n\t\t\t\t\tconst hasDisplayed = contentWidth > 0 && contentHeight > 0;\n\t\t\t\t\tconst shouldHideToggle = !hasDisplayed || (isFullyVisible && contentHeight <= maxLimit);\n\t\t\t\t\thostEl.toggle.classList.toggle('hidden', shouldHideToggle);\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\troot: host.shadowRoot.querySelector('.truncate-height'),\n\t\t\t\t\trootMargin: '0px',\n\t\t\t\t\tthreshold: 1.0\n\t\t\t\t}\n\t\t\t),\n\t\t\ttarget: host.shadowRoot.querySelector('.truncate-inner'),\n\t\t\ttoggle: host.shadowRoot.querySelector('.sn-as-card-body-toggler'),\n\t\t\theight\n\t\t});\n\n\t\tconst obsData = observers.get(host);\n\t\tobsData.observer.observe(obsData.target);\n\t}\n\n\tgetOnDisconnect(coeffects) {\n\t\tconst {\n\t\t\taction: {\n\t\t\t\tpayload: { host }\n\t\t\t}\n\t\t} = coeffects;\n\n\t\tif (!observers.has(host))\n\t\t\treturn;\n\n\t\tconst observerInfo = observers.get(host);\n\t\tobserverInfo.observer.disconnect();\n\t\tobserverInfo.target = null;\n\t\tobserverInfo.toggle = null;\n\t\tobserverInfo.observer = null;\n\t\thost.shadowRoot.innerHTML = '';\n\t\tobservers.delete(host);\n\t}\n\n\tgetJSX(state, coeffects): HTMLElement | HTMLElement[] | string {\n\t\tconst { dispatch } = coeffects;\n\t\tconst {\n\t\t\tproperties: { expanded, height, activated, eventSysId }\n\t\t} = state;\n\n\t\tconst maxHeight = `${height}px`;\n\t\tconst collapsedStyle = expanded ? {} : { maxHeight, overflow: 'hidden' };\n\t\tconst truncateHeightStyle = expanded ? {} : { maxHeight };\n\n\t\tconst button = activated ? (\n\t\t\t<now-button-bare\n\t\t\t\tlabel={expanded ? SHOW_LESS : SHOW_MORE}\n\t\t\t\tsize=\"md\"\n\t\t\t\tvariant=\"primary\"\n\t\t\t\ton-click={() => {\n\t\t\t\t\tdispatch(expanded ? AS_COLLAPSE_ALL_EVENTS_ACTION : AS_EXPAND_ALL_EVENTS_ACTION, { eventSysId });\n\t\t\t\t}}\n\t\t\t/>\n\t\t) : (\n\t\t\t''\n\t\t);\n\n\t\t// noinspection JSXNamespaceValidation\n\t\treturn (\n\t\t\t<div className=\"sn-as-card-body\">\n\t\t\t\t<div className=\"truncate-toggle-area\" style={collapsedStyle}>\n\t\t\t\t\t<div className=\"truncate-height\" style={truncateHeightStyle}>\n\t\t\t\t\t\t<div className={'truncate-inner'}>{this.getTruncatedContent(state, coeffects)}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className={'sn-as-card-body-toggler hidden'}>{button}</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/* eslint-disable no-unused-vars */\n\t/**\n\t * @abstract\n\t * @param {Object} state\n\t * @param {Object} [coeffects]\n\t * @return {HTMLElement | HTMLElement[] | string}\n\t */\n\tgetTruncatedContent(state, coeffects) {\n\t\tthis._validateAbstractMethod('getTruncatedContent');\n\t}\n\t/* eslint-enable no-unused-vars */\n}\n","//PUBLIC ACTIONS\nexport const AC_FORM_SYNC_REQUESTED_ACTION = 'GFORM#SET_VALUE'; //Tells gForm to update a form field value\n\n//PRIVATE ACTIONS\nexport const AC_POST_COMMENT_REQUESTED_ACTION = 'ACTIVITY_COMPOSE#POST_COMMENT_REQUESTED';\nexport const AC_SET_SETTING_REQUESTED_ACTION = 'ACTIVITY_COMPOSE#SET_SETTING_REQUESTED';\nexport const AC_SYNC_EDITOR_HEIGHT = 'ACTIVITY_COMPOSE#SYNC_EDITOR_HEIGHT';\n\n//PRIVATE FOR NOW-ACTIVITY-STREAM-COMPOSE-CONNECTED\nexport const AC_POST_STARTED_ACTION = 'ACTIVITY_COMPOSE#POST_STARTED';\nexport const AC_POST_FINISHED_ACTION = 'ACTIVITY_COMPOSE#POST_FINISHED';\n","import { createGraphQLEffect } from '@servicenow/ui-effect-graphql';\nimport {\n\tAC_POST_COMMENT_REQUESTED_ACTION,\n\tAC_POST_FINISHED_ACTION,\n\tAC_POST_STARTED_ACTION,\n\tAC_SET_SETTING_REQUESTED_ACTION\n} from './actions';\nimport { t } from 'sn-translate';\nimport { apiVersion } from '../activity/constants';\n\nconst oldMutation = `\n\tmutation ($table: String!, $sysId: String!, $field: String!, $value: String!, $timestamp: Long) {\n\t\tGlideActivity_Mutation {\n\t\t\tpostJournal(table: $table, sysId: $sysId, field: $field, value: $value, timestamp: $timestamp) {\n\t\t\t\tentries {\n\t\t\t\t\tsysId: uid\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n`;\n\nconst newMutation = `\n\tmutation ($table: String!, $sysId: String!, $field: String!, $value: String!) {\n\t\tGlideActivity_Mutation {\n\t\t\tputJournal(documentTable: $table, documentSysId: $sysId, field: $field, value: $value)\n\t\t}\n\t}\n`;\n\nconst activityMutationQuery = apiVersion === 0 ? oldMutation : newMutation;\n\nconst saveSetting = (coeffects) => {\n\tconst {\n\t\tupdateState,\n\t\taction: { payload = {} }\n\t} = coeffects;\n\n\tconst { name, value = false } = payload;\n\n\tif (name)\n\t\twindow.localStorage.setItem(name, value);\n\n\tupdateState({\n\t\t[name]: value\n\t});\n};\n\nconst handleStartPost = (coeffects) => {\n\tconst {\n\t\tstate,\n\t\tupdateState,\n\t\taction: {\n\t\t\tpayload: { field }\n\t\t}\n\t} = coeffects;\n\tupdateState({\n\t\t...state,\n\t\tpostingCommentMap: {\n\t\t\t...state.postingCommentMap,\n\t\t\t[field]: true\n\t\t}\n\t});\n};\n\nconst handleFinishedPost = (coeffects) => {\n\tconst {\n\t\tstate,\n\t\tupdateState,\n\t\taction: { payload }\n\t} = coeffects;\n\tconst { field } = payload;\n\tupdateState({\n\t\t...state,\n\t\tpostingCommentMap: {\n\t\t\t...state.postingCommentMap,\n\t\t\t[field]: false\n\t\t}\n\t});\n};\n\nexport const defaultJournalFieldSettings = {\n\tcomments: {\n\t\tlabel: t('Comments'),\n\t\ticon: 'user-group-fill',\n\t\tcolorVariant: '',\n\t\thelpText: t('Everyone can see this comment'),\n\t\thelpTextIcon: 'eye-outline'\n\t},\n\twork_notes: {\n\t\tlabel: t('Work notes (Private)'),\n\t\ticon: 'lock-fill',\n\t\tcolorVariant: 'yellow',\n\t\thelpText: '',\n\t\thelpTextIcon: ''\n\t}\n};\n\nexport const nowActivityStreamComposeConnectedBehavior = {\n\tname: 'nowComposeConnectedBehavior',\n\n\tproperties: {\n\t\ttable: {},\n\t\tsysId: {},\n\t\tjournalFieldSettings: {\n\t\t\tdefault: defaultJournalFieldSettings\n\t\t}\n\t},\n\n\tactions: {\n\t\t[AC_POST_COMMENT_REQUESTED_ACTION]: { private: true },\n\t\t[AC_SET_SETTING_REQUESTED_ACTION]: { private: true },\n\t\t['NOW_TABS#SELECTED_ITEM_SET']: { private: true },\n\t\t[AC_POST_STARTED_ACTION]: { private: true },\n\t\t[AC_POST_FINISHED_ACTION]: { private: true },\n\t\t['UPDATE_STATE']: { private: true }\n\t},\n\n\tactionHandlers: {\n\t\t[AC_POST_COMMENT_REQUESTED_ACTION]: createGraphQLEffect(activityMutationQuery, {\n\t\t\tvariableList: ['table', 'sysId', 'field', 'value', 'timestamp'],\n\t\t\tstartActionType: AC_POST_STARTED_ACTION,\n\t\t\tsuccessActionType: AC_POST_FINISHED_ACTION,\n\t\t\terrorActionType: AC_POST_FINISHED_ACTION\n\t\t}),\n\t\t[AC_POST_STARTED_ACTION]: handleStartPost,\n\t\t[AC_POST_FINISHED_ACTION]: handleFinishedPost,\n\t\t[AC_SET_SETTING_REQUESTED_ACTION]: saveSetting\n\t}\n};\n","import { t } from 'sn-translate';\n\nexport const PLACEHOLDER_TEXT = (fieldLabel) => t('Type your {fieldLabel} here', { fieldLabel });\nexport const RICH_TEXT_SETTING_NAME = 'isRichTextEnabled';\nexport const STACKED_VIEW_SETTING_NAME = 'stackedView';\nexport const SIDE_BY_SIDE_VIEW_SETTING_NAME = 'isSideBySideViewEnabled';\nexport const USE_HTML_FIELD = 'glide.ui.journal.use_html';\nexport const ALLOW_STACKED_VIEW_FIELD = 'glide.ui.activity.journal.stacked';\nexport const ENABLE_MENTIONS_FIELD = 'glide.ui.journal.enable_mentions';\n\nexport const mentions = [\n\t{\n\t\tprefix: '@',\n\t\ttype: 'users',\n\t\tallowedPosition: 'anywhere'\n\t}\n];\n\nexport const HTML_EDITOR_CONFIG = {\n\ttoolbar: ['bold,italic,underline,|,fontselect,|,alignleft,aligncenter,alignright,|,bullist,numlist,|,link,unlink'],\n\tplugins:\n\t\t'link,lists,advlist,table,powerpaste,searchreplace,preview,fullscreen,a11y_fixes,placeholder,sn_resizer,as_synceditorheight',\n\tdefaultNumLines: 3\n};\n\nexport const COMPOSE_USE_TABS_SYS_PROP = 'glide.activity.compose.use_tabs';\nexport const COMPOSE_ALLOW_JOURNAL_SETTINGS_OVERRIDES_SYS_PROP =\n\t'glide.activity.compose.allow_journal_settings_overrides';\n\nexport const JOURNAL_FIELD_SETTINGS_FIELDS = ['label', 'icon', 'colorVariant', 'helpText', 'helpTextIcon'];\n","import { AC_POST_COMMENT_REQUESTED_ACTION } from './actions';\nimport { isString, isEqual, isEmpty } from 'lodash';\nimport { EMAIL } from '../activity/translations';\nimport { isTrue, jsonStringToObject } from '../shared/utils';\nimport { defaultJournalFieldSettings } from './nowActivityStreamComposeConnectedBehavior';\nimport { JOURNAL_FIELD_SETTINGS_FIELDS } from './inputConfig';\n\nconst DEFAULT_TAB_ICON = 'document-fill';\nconst OBJECT_TYPE_PROPERTIES = new Set(['fields', 'emailAction']);\n\nconst isPropsChanged = (name, previousValue, value) => {\n\tif (!OBJECT_TYPE_PROPERTIES.has(name))\n\t\treturn !isEqual(previousValue, value);\n\n\tif (isString(previousValue))\n\t\tpreviousValue = jsonStringToObject(previousValue);\n\n\tif (isString(value))\n\t\tvalue = jsonStringToObject(value);\n\n\treturn !isEqual(previousValue, value);\n};\n\nexport const getAppliedFieldSettings = (field, settingsForField, allowJournalFieldSettingsOverrides = true) => {\n\tconst override = isTrue(allowJournalFieldSettingsOverrides);\n\tlet settings = {};\n\tJOURNAL_FIELD_SETTINGS_FIELDS.forEach((fieldName) => {\n\t\tsettings[fieldName] =\n\t\t\ttypeof settingsForField[fieldName] !== 'undefined' ? settingsForField[fieldName] : field[fieldName] || '';\n\t});\n\treturn override ? { ...field, ...settings } : { ...settings, ...field };\n};\n\nexport const getUpdatedState = (state, fields, journalFieldSettings, updateSelectedField, propsChanged = false) => {\n\tconst parsed = jsonStringToObject(fields);\n\tconst fieldsArr = Object.values(parsed || {});\n\tconst { properties: { emailAction, allowJournalFieldSettingsOverrides = true } = {} } = state;\n\tconst tabItems = [];\n\tconst journalFieldsMap = state.journalFieldsMap || {};\n\tlet firstField = null;\n\tlet needUpdate = false;\n\tconst journalSettings = jsonStringToObject(journalFieldSettings);\n\tconst fieldSettings = isEmpty(journalSettings) ? defaultJournalFieldSettings : journalSettings;\n\tfieldsArr.forEach((field) => {\n\t\tconst { sys_readonly, readonly, visible, type } = field;\n\t\tif (!(!sys_readonly && !readonly && visible && type === 'journal_input'))\n\t\t\treturn;\n\n\t\t//override journal settings or enrich with defaults\n\t\tconst settingsForField = fieldSettings[field.name] || {};\n\t\tconst item = getAppliedFieldSettings(field, settingsForField, allowJournalFieldSettingsOverrides);\n\t\ttabItems.push({\n\t\t\tid: item.name,\n\t\t\tlabel: item.label,\n\t\t\ticon: item.icon || DEFAULT_TAB_ICON\n\t\t});\n\n\t\tconst value = field.value || ''; //This allows form -> compose sync to happen, form passes in value in fields\n\t\tif (!journalFieldsMap[item.name] || journalFieldsMap[item.name].value !== value || propsChanged)\n\t\t\tneedUpdate = true;\n\n\t\tjournalFieldsMap[item.name] = {\n\t\t\t...item,\n\t\t\tvalue,\n\t\t\tdisplayValue: value\n\t\t};\n\n\t\tif (updateSelectedField && !firstField)\n\t\t\tfirstField = journalFieldsMap[item.name];\n\t});\n\n\tlet selectedField = firstField || {};\n\n\tif (emailAction && propsChanged) {\n\t\ttabItems.push({\n\t\t\tid: 'email',\n\t\t\ticon: 'envelope-outline',\n\t\t\tlabel: EMAIL\n\t\t});\n\n\t\tjournalFieldsMap.email = {\n\t\t\tname: 'email',\n\t\t\tvalue: '',\n\t\t\tlabel: EMAIL\n\t\t};\n\n\t\tselectedField = journalFieldsMap.email;\n\t\tneedUpdate = true;\n\t}\n\n\treturn {\n\t\tneedUpdate,\n\t\tnewState: updateSelectedField ? { tabItems, selectedField, journalFieldsMap } : { tabItems, journalFieldsMap }\n\t};\n};\n\nconst syncState = (coeffects, updateSelectedField, shouldRender) => {\n\tconst {\n\t\tproperties: { fields, journalFieldSettings },\n\t\tupdateState,\n\t\tstate,\n\t\taction = { payload: { previousValue: {}, value: {} } }\n\t} = coeffects;\n\n\tconst {\n\t\tpayload: { previousValue, value, name }\n\t} = action;\n\n\tconst propsChanged = isPropsChanged(name, previousValue, value);\n\tconst futureState = getUpdatedState(state, fields, journalFieldSettings, updateSelectedField, propsChanged);\n\tif (futureState.needUpdate)\n\t\tupdateState({\n\t\t\t...futureState.newState,\n\t\t\tshouldRender\n\t\t});\n};\n\n/**\n * Setting state when the component loads for the first time.\n *\n */\nexport const initState = (coeffects) => {\n\tsyncState(coeffects, true, false);\n};\n\n/**\n * Resetting state when the properties change.\n * Letting <now-tabs> handle the state of current tab.\n */\nexport const resetState = (coeffects) => {\n\tconst {\n\t\taction: {\n\t\t\tpayload: { name, previousValue, value }\n\t\t}\n\t} = coeffects;\n\n\tconst updateSelectedField =\n\t\t(name === 'emailAction' || name === 'journalFieldSettings') && isPropsChanged(name, previousValue, value);\n\tsyncState(coeffects, updateSelectedField, true);\n};\n\nexport const handleFieldSelection = (coeffects) => {\n\tconst {\n\t\tupdateState,\n\t\tstate,\n\t\taction: {\n\t\t\tpayload: { value: fieldName }\n\t\t}\n\t} = coeffects;\n\tconst {\n\t\tproperties: { useTabs = false }\n\t} = state;\n\tconst { journalFieldsMap } = state;\n\tconst selectedField = isTrue(useTabs) ? journalFieldsMap[fieldName] : journalFieldsMap[fieldName[0]];\n\tupdateState({\n\t\t...state,\n\t\tselectedField,\n\t\tshouldRender: true\n\t});\n};\n\nconst updateSelectedField = (value, displayValue, name, state, { updateState }) => {\n\tupdateState({\n\t\tselectedField: {\n\t\t\t...state.selectedField,\n\t\t\tvalue,\n\t\t\tdisplayValue\n\t\t},\n\t\tjournalFieldsMap: {\n\t\t\t...state.journalFieldsMap,\n\t\t\t[name]: {\n\t\t\t\t...state.journalFieldsMap[name],\n\t\t\t\tvalue,\n\t\t\t\tdisplayValue\n\t\t\t}\n\t\t}\n\t});\n};\n\nexport const handlePostButton = (coeffects) => {\n\tconst {\n\t\tstate,\n\t\tdispatch,\n\t\taction: {\n\t\t\tpayload: { selectedField, focus }\n\t\t},\n\t\tproperties: { table, sysId, onPost }\n\t} = coeffects;\n\n\tfocus();\n\tif (typeof onPost === 'function') {\n\t\tonPost(selectedField);\n\t\treturn;\n\t}\n\tdispatch(AC_POST_COMMENT_REQUESTED_ACTION, {\n\t\ttable,\n\t\tsysId,\n\t\tfield: selectedField.name,\n\t\tvalue: selectedField.value\n\t});\n\tupdateSelectedField('', '', selectedField.name, state, coeffects);\n\treturn { private: true };\n};\n\nexport const handleInputChange = ({ value, displayValue, name }, state, coeffects) => {\n\tupdateSelectedField(value, displayValue, name, state, coeffects);\n};\n","import { t } from 'sn-translate';\n\nexport const RICH_TEXT_EDITOR_LABEL = t('Rich text editor');\nexport const STACKED_VIEW_LABEL = t('Stacked view');\nexport const TOGGLE_SETTINGS_TITLE = t('Toggle compose settings');\nexport const SIDE_BY_SIDE_LABEL = t('Side by side');\n","import { createCustomElement, actionTypes } from '@servicenow/ui-core';\nimport snabbdom from '@servicenow/ui-renderer-snabbdom';\nimport styles from './_nowActivityStreamSettingsPopoverContent.scss';\nimport { RICH_TEXT_EDITOR_LABEL, STACKED_VIEW_LABEL, SIDE_BY_SIDE_LABEL } from './consts';\nimport {\n\tRICH_TEXT_SETTING_NAME,\n\tSTACKED_VIEW_SETTING_NAME,\n\tSIDE_BY_SIDE_VIEW_SETTING_NAME\n} from '../activity-compose/inputConfig';\nimport { t } from 'sn-translate';\nimport { AC_SET_SETTING_REQUESTED_ACTION } from '../activity-compose/actions';\nconst { COMPONENT_DISCONNECTED, COMPONENT_PROPERTY_CHANGED } = actionTypes;\n\nexport const NowActivityStreamSettingsPopoverContent = 'now-activity-stream-settings-popover-content';\n\n// This is a workaround for the issue with now-popover where the event handlers bound to host\n// of component slotted in the content of now-popover, are not honored when the component's view is hoisted.\n// Link to issue raised in design-system repo : https://code.devsnc.com/dev/design-system/issues/2040\nconst keyHandler = (event) => {\n\tconst currentFocus = event.currentTarget;\n\tlet nextFocus;\n\tswitch (event.key) {\n\tcase 'ArrowUp': {\n\t\tnextFocus = currentFocus.previousElementSibling;\n\t\tif (nextFocus)\n\t\t\tnextFocus.focus();\n\t\tbreak;\n\t}\n\tcase 'ArrowDown': {\n\t\tnextFocus = currentFocus.nextElementSibling;\n\t\tif (nextFocus)\n\t\t\tnextFocus.focus();\n\t\tbreak;\n\t}\n\tcase 'Enter': {\n\t\tcurrentFocus.click();\n\t\tbreak;\n\t}\n\t}\n\tevent.preventDefault();\n};\n\nconst createItem = (label, enabled, settingName, dispatch) => {\n\tconst toggleChecked = {};\n\tif (enabled)\n\t\ttoggleChecked['checked'] = true;\n\n\treturn (\n\t\t<li\n\t\t\tclassName=\"now-popover--item\"\n\t\t\trole=\"option\"\n\t\t\ttabindex=\"0\"\n\t\t\ton-mouseover={(e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.currentTarget.focus();\n\t\t\t}}\n\t\t\ton-keydown={keyHandler}\n\t\t\ton-click={() => {\n\t\t\t\tdispatch(AC_SET_SETTING_REQUESTED_ACTION, { name: settingName, value: !enabled });\n\t\t\t}}\n\t\t\taria-label={t('{0}, {1}, Highlighted, Clickable', enabled ? t('enabled') : t('disabled'), label)}\n\t\t\taria-live=\"assertive\"\n\t\t>\n\t\t\t<div className=\"now-popover--item--content\">\n\t\t\t\t<span className=\"now-popover--item--title\">\n\t\t\t\t\t<div className=\"now-popover--item\" key={label}>\n\t\t\t\t\t\t{label}\n\t\t\t\t\t\t<div className=\"toggle-container\">\n\t\t\t\t\t\t\t<now-toggle\n\t\t\t\t\t\t\t\t{...toggleChecked}\n\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\tappend-to-payload={{\n\t\t\t\t\t\t\t\t\tname: settingName\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</li>\n\t);\n};\n\nlet settings = [];\n\nconst getSettingsPanel = (state, dispatch) => {\n\tconst {\n\t\tisRichTextAvailable,\n\t\tisStackedViewAvailable,\n\t\tisRichTextEnabled,\n\t\tisStackedViewEnabled,\n\t\tisSideBySideViewAvailable,\n\t\tisSideBySideViewEnabled\n\t} = state.properties;\n\n\tlet items = [];\n\tsettings = [];\n\n\tif (isRichTextAvailable) {\n\t\tsettings.push({ setting: RICH_TEXT_SETTING_NAME, value: isRichTextEnabled });\n\t\titems.push(createItem(RICH_TEXT_EDITOR_LABEL, isRichTextEnabled, RICH_TEXT_SETTING_NAME, dispatch));\n\t}\n\tif (isStackedViewAvailable) {\n\t\tsettings.push({ setting: STACKED_VIEW_SETTING_NAME, value: isStackedViewEnabled });\n\t\titems.push(createItem(STACKED_VIEW_LABEL, isStackedViewEnabled, STACKED_VIEW_SETTING_NAME, dispatch));\n\t}\n\tif (isSideBySideViewAvailable) {\n\t\tsettings.push({ setting: SIDE_BY_SIDE_VIEW_SETTING_NAME, value: isSideBySideViewEnabled });\n\t\titems.push(createItem(SIDE_BY_SIDE_LABEL, isSideBySideViewEnabled, SIDE_BY_SIDE_VIEW_SETTING_NAME, dispatch));\n\t}\n\n\treturn items;\n};\n\nconst panelRefByComponentId = new Map();\n\nconst view = (state, dispatch) => {\n\tconst items = getSettingsPanel(state, dispatch);\n\tconst {\n\t\tproperties: { nowId }\n\t} = state;\n\treturn (\n\t\t<ul\n\t\t\tclassName=\"now-popover-list\"\n\t\t\trole=\"listbox\"\n\t\t\tdata-settings={JSON.stringify(settings)}\n\t\t\tref={(element) => panelRefByComponentId.set(nowId, element)}\n\t\t>\n\t\t\t{items}\n\t\t</ul>\n\t);\n};\n\nexport default createCustomElement(NowActivityStreamSettingsPopoverContent, {\n\tstyles: styles,\n\tview,\n\trenderer: {\n\t\ttype: snabbdom\n\t},\n\tproperties: {\n\t\tisRichTextAvailable: { default: false },\n\t\tisStackedViewAvailable: { default: false },\n\t\tisRichTextEnabled: { default: false },\n\t\tisStackedViewEnabled: { default: false },\n\t\tisSideBySideViewAvailable: { default: false },\n\t\tisSideBySideViewEnabled: { default: false }\n\t},\n\tactionHandlers: {\n\t\t'NOW_TOGGLE#CHECKED_SET': ({ action: { payload }, dispatch }) => {\n\t\t\tdispatch(AC_SET_SETTING_REQUESTED_ACTION, payload);\n\t\t},\n\t\t[COMPONENT_PROPERTY_CHANGED]: (coeffects) => {\n\t\t\tconst {\n\t\t\t\tproperties: { nowId },\n\t\t\t\taction: {\n\t\t\t\t\tpayload: { name, value, previousValue }\n\t\t\t\t}\n\t\t\t} = coeffects;\n\n\t\t\tif (name !== 'nowHoist')\n\t\t\t\treturn;\n\n\t\t\tif (value && !previousValue) {\n\t\t\t\tconst firstChild = panelRefByComponentId.get(nowId).firstChild;\n\t\t\t\tif (!firstChild)\n\t\t\t\t\treturn;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tfirstChild.focus();\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t},\n\t\t[COMPONENT_DISCONNECTED]: ({ properties: { nowId } }) => {\n\t\t\tpanelRefByComponentId.delete(nowId);\n\t\t}\n\t}\n});\n","import { AC_FORM_SYNC_REQUESTED_ACTION } from './actions';\n\nexport const syncForm = (field, value, displayValue, dispatch) => {\n\tdispatch(AC_FORM_SYNC_REQUESTED_ACTION, {\n\t\tfieldName: field,\n\t\tvalue,\n\t\tdisplayValue\n\t});\n};\n","import { isTrue } from '../shared/utils';\nimport { AC_SYNC_EDITOR_HEIGHT } from './actions';\n\nconst parseCssValueToInt = (dom, elm, name, computed) => {\n\tconst value = parseInt(dom.getStyle(elm, name, computed), 10);\n\t// The value maybe be an empty string, so in that case treat it as being 0\n\treturn isNaN(value) ? 0 : value;\n};\n\nconst isFullStretch = (e) => {\n\tconst host = e.target.targetElm.getRootNode().host;\n\treturn isTrue(host.dataset.isFullStretch);\n};\n\n/* eslint-disable no-undef */\ntinymce.PluginManager.add('as_synceditorheight', function (editor) {\n\tlet isResized = false;\n\tlet customHeight = null;\n\n\tconst _syncHeight = (e) => {\n\t\tconst containerEl = editor.getContentAreaContainer();\n\t\tconst iframeEl = containerEl.querySelector('iframe');\n\n\t\tif (!isFullStretch(e)) {\n\t\t\teditor.theme.resizeTo(null, customHeight || editor.settings.height);\n\t\t\tisResized = false;\n\t\t\treturn;\n\t\t}\n\n\t\tif (iframeEl.offsetHeight <= containerEl.offsetHeight && !isResized) {\n\t\t\tconst dom = editor.dom;\n\t\t\tconst host = e.target.targetElm.getRootNode().host;\n\t\t\tconst hostParentEl = host.closest('.input-control');\n\t\t\tconst footerEl = hostParentEl.querySelector('.footer-bar');\n\t\t\tconst editorContainerEl = editor.getContainer();\n\t\t\tconst editorToolbarEl = editorContainerEl.querySelector('.mce-top-part');\n\t\t\tconst snControlEl = editorContainerEl.closest('.sn-control');\n\n\t\t\tconst marginTop = parseCssValueToInt(dom, snControlEl, 'margin-top', true);\n\t\t\tconst marginBottom = parseCssValueToInt(dom, snControlEl, 'margin-bottom', true);\n\n\t\t\tconst delta = 3 + marginTop + marginBottom; //padding and border width and double as margin\n\t\t\tconst height = hostParentEl.offsetHeight - footerEl.offsetHeight - editorToolbarEl.offsetHeight - delta;\n\n\t\t\teditor.theme.resizeTo(null, height);\n\t\t}\n\t};\n\n\teditor.on(AC_SYNC_EDITOR_HEIGHT, _syncHeight);\n\teditor.on('ResizeEditor', (e) => {\n\t\tisResized = true;\n\t\tcustomHeight = isFullStretch(e)\n\t\t\t? null\n\t\t\t: parseCssValueToInt(editor.dom, editor.getContentAreaContainer().querySelector('iframe'), 'height', true);\n\t});\n\teditor.on('init', (e) => {\n\t\tisResized = false;\n\t\t_syncHeight(e);\n\t});\n});\n/* eslint-enable no-undef */\n","import { HTML_EDITOR_CONFIG, mentions, PLACEHOLDER_TEXT } from './inputConfig';\n/* eslint-disable no-unused-vars */\n// noinspection ES6UnusedImports,SpellCheckingInspection\nimport snabbdom from '@servicenow/ui-renderer-snabbdom';\nimport '@servicenow/now-record-html-editor';\n/* eslint-enable no-unused-vars */\nimport { syncForm } from './formSync';\nimport tinyMCEStyles from './_tinyMCE.scss';\nimport './tinyMCESyncHeightPlugin';\nimport { AC_SYNC_EDITOR_HEIGHT } from './actions';\n\nconst sendToForm = (properties, dispatch) => {\n\tconst {\n\t\tjournalFieldsMap,\n\t\tselectedField: { name: selectedFieldName }\n\t} = properties;\n\n\tconst { name: field, value, displayValue } = journalFieldsMap[selectedFieldName];\n\tsyncForm(field, value, displayValue, dispatch);\n};\n\nexport class ComposeInput {\n\t//Must remove once DEF0159058 is resolved by controls\n\tstatic makeHTMLEditorTransparent(node) {\n\t\trequestAnimationFrame(() => {\n\t\t\tconst editorRoot = node.shadowRoot.querySelector('.sn-editor');\n\n\t\t\t//dispatching custom event to sync tinymce editor height in case of SBS toggle\n\t\t\t/* eslint-disable no-undef */\n\t\t\tif (editorRoot && tinymce)\n\t\t\t\ttinymce.get(`html-${node.getComponentId()}`).fire(AC_SYNC_EDITOR_HEIGHT);\n\t\t\t/* eslint-disable no-undef */\n\n\t\t\tconst existingStyle = node.shadowRoot.querySelector('style#transparent-style');\n\t\t\tif (existingStyle)\n\t\t\t\treturn;\n\n\t\t\tconst styleTag = document.createElement('style');\n\t\t\tstyleTag.id = 'transparent-style';\n\t\t\tstyleTag.innerHTML = tinyMCEStyles;\n\n\t\t\tif (Document && 'adoptedStyleSheets' in Document.prototype) {\n\t\t\t\tconst styleSheet = new CSSStyleSheet();\n\t\t\t\tstyleSheet.replace(tinyMCEStyles);\n\t\t\t\tnode.shadowRoot.adoptedStyleSheets = [...node.shadowRoot.adoptedStyleSheets, styleSheet];\n\t\t\t}\n\n\t\t\tnode.shadowRoot.appendChild(styleTag);\n\t\t});\n\t}\n\n\tstatic getHtmlEditor(properties, dispatch) {\n\t\tconst {\n\t\t\tinputValue,\n\t\t\tselectedField,\n\t\t\tisRichTextMentionsEnabled,\n\t\t\ttable,\n\t\t\tsysId,\n\t\t\thandleInputChange,\n\t\t\tisSidebySideWithFullStretch\n\t\t} = properties;\n\n\t\treturn (\n\t\t\t<now-record-html-editor\n\t\t\t\tref={(node) => ComposeInput.makeHTMLEditorTransparent(node)}\n\t\t\t\tcontent-style={`body { background: transparent }`}\n\t\t\t\ttinymce={window.tinymce}\n\t\t\t\tvalue={inputValue}\n\t\t\t\tplugins={HTML_EDITOR_CONFIG.plugins}\n\t\t\t\ttoolbar={HTML_EDITOR_CONFIG.toolbar}\n\t\t\t\tname={selectedField.name}\n\t\t\t\tonStagedValueChange={handleInputChange}\n\t\t\t\tonValueChange={handleInputChange}\n\t\t\t\tonBlur={() => {\n\t\t\t\t\tsendToForm(properties, dispatch);\n\t\t\t\t}}\n\t\t\t\tenableMentions={isRichTextMentionsEnabled}\n\t\t\t\tmentions={{\n\t\t\t\t\tresourceTable: table,\n\t\t\t\t\tresourceSysId: sysId\n\t\t\t\t}}\n\t\t\t\tplaceholder={ComposeInput.getPlaceholderText(properties)}\n\t\t\t\tuseCodeBlocks\n\t\t\t\tminLineCount={HTML_EDITOR_CONFIG.defaultNumLines}\n\t\t\t\tdata-isFullStretch={isSidebySideWithFullStretch}\n\t\t\t/>\n\t\t);\n\t}\n\n\tstatic getPlaceholderText = (properties) => {\n\t\tconst { journalFieldsMap, selectedField } = properties;\n\t\tconst field = journalFieldsMap[selectedField.name];\n\t\treturn PLACEHOLDER_TEXT(field.label);\n\t};\n\n\tstatic getTextEditor(properties, dispatch) {\n\t\tconst { inputValue, selectedField, handleInputChange, table, sysId } = properties;\n\n\t\tconst colorVariant = selectedField.colorVariant || '';\n\n\t\tif (!selectedField)\n\t\t\treturn null;\n\n\t\treturn (\n\t\t\t<sn-record-input-connected\n\t\t\t\ttype=\"textarea\"\n\t\t\t\tinitialValue={inputValue}\n\t\t\t\trows={2}\n\t\t\t\tmentions={mentions}\n\t\t\t\treferringTable={table}\n\t\t\t\treferringRecordId={sysId}\n\t\t\t\tvariant={`standalone${colorVariant ? ' no-background' : ''}`}\n\t\t\t\tplaceholder={ComposeInput.getPlaceholderText(properties)}\n\t\t\t\tmaxlength={selectedField.maxLength}\n\t\t\t\tdebounce={250}\n\t\t\t\tname={selectedField.name}\n\t\t\t\tonStagedValueChange={handleInputChange}\n\t\t\t\tonValueChange={() => {\n\t\t\t\t\tsendToForm(properties, dispatch);\n\t\t\t\t}}\n\t\t\t\tresizable={true}\n\t\t\t/>\n\t\t);\n\t}\n\n\tstatic render(properties, dispatch) {\n\t\tconst {\n\t\t\tselectedField: { colorVariant = '' },\n\t\t\tisRichTextEnabled\n\t\t} = properties;\n\t\treturn (\n\t\t\t<div className={`input-form color-variant-${colorVariant || 'neutral'}`}>\n\t\t\t\t{isRichTextEnabled\n\t\t\t\t\t? ComposeInput.getHtmlEditor(properties, dispatch)\n\t\t\t\t\t: ComposeInput.getTextEditor(properties, dispatch)}\n\t\t\t</div>\n\t\t);\n\t}\n}\n","// noinspection ES6CheckImport\nimport { actionTypes, createCustomElement } from '@servicenow/ui-core';\nimport snabbdom, { Fragment } from '@servicenow/ui-renderer-snabbdom';\nimport React from 'react';\nimport '@servicenow/now-tabs';\nimport '@servicenow/now-dropdown';\nimport '@servicenow/now-button';\nimport '@servicenow/now-label-value';\nimport '@servicenow/now-heading';\nimport '@servicenow/now-toggle';\nimport '@servicenow/now-email-client';\nimport { getProperty } from 'sn-uxpage-presource';\nimport { t } from 'sn-translate';\nimport {\n\tinitState,\n\tresetState,\n\thandleFieldSelection,\n\thandlePostButton,\n\thandleInputChange,\n\tgetUpdatedState\n} from './actionHandlers';\nimport styles from './_nowActivityStreamCompose.scss';\nimport {\n\tnowActivityStreamSettings,\n\tsettingsActionHandlers\n} from '../nowActivityStreamSettings/nowActivityStreamSettings';\nimport { isTrue } from '../shared/utils';\nimport {\n\tRICH_TEXT_SETTING_NAME,\n\tSTACKED_VIEW_SETTING_NAME,\n\tSIDE_BY_SIDE_VIEW_SETTING_NAME,\n\tUSE_HTML_FIELD,\n\tALLOW_STACKED_VIEW_FIELD,\n\tENABLE_MENTIONS_FIELD,\n\tCOMPOSE_USE_TABS_SYS_PROP,\n\tCOMPOSE_ALLOW_JOURNAL_SETTINGS_OVERRIDES_SYS_PROP\n} from './inputConfig';\nimport { AC_POST_COMMENT_REQUESTED_ACTION } from './actions';\nimport { ComposeInput } from './ComposeInput';\nimport { syncForm } from './formSync';\n\nconst POST_BUTTON_LABEL = (fieldLabel) => t('Post {fieldLabel}', { fieldLabel });\n\nexport const POST_BUTTON_ORIGIN = 'post-button';\nconst { COMPONENT_BOOTSTRAPPED, COMPONENT_PROPERTY_CHANGED, COMPONENT_RENDERED, COMPONENT_DISCONNECTED } = actionTypes;\n\nconst buttonInstancesByComponentId = new Map();\n\nconst setButtonRef = (node, componentId) => {\n\tbuttonInstancesByComponentId.set(componentId, node);\n};\n\nconst getInputValue = (journalField, journalFieldsMap) =>\n\tjournalField.name ? journalFieldsMap[journalField.name].value : '';\n\nexport const getPostButton = (journalField, state) => {\n\tconst {\n\t\tproperties: { isPostDisabled, componentId },\n\t\tjournalFieldsMap,\n\t\tisPostingComment = false\n\t} = state;\n\n\tconst value = getInputValue(journalField, journalFieldsMap);\n\tconst isEmptyValue = value.trim().length === 0;\n\n\treturn (\n\t\t<now-button\n\t\t\tname={journalField.name}\n\t\t\tlabel={POST_BUTTON_LABEL(journalField.label)}\n\t\t\tid={`postButton-${journalField.name}`}\n\t\t\tdisabled={isPostingComment || isPostDisabled || isEmptyValue ? 'true' : null}\n\t\t\tref={(node) => {\n\t\t\t\tsetButtonRef(node, componentId);\n\t\t\t}}\n\t\t\ttooltip-content={isPostDisabled ? null : t('Post an Activity Stream message')}\n\t\t\tappend-to-payload={{\n\t\t\t\torigin: POST_BUTTON_ORIGIN,\n\t\t\t\tfocus: () => {\n\t\t\t\t\tbuttonInstancesByComponentId.get(componentId).focus();\n\t\t\t\t},\n\t\t\t\tselectedField: journalFieldsMap[journalField.name]\n\t\t\t}}\n\t\t/>\n\t);\n};\n\nexport const getToggleButton = (state) => {\n\tconst {\n\t\ttabItems = [],\n\t\tisRichTextEnabled,\n\t\tstackedView,\n\t\tisSideBySideViewEnabled,\n\t\tproperties: { isRichTextAvailable = false, isStackedViewAvailable = false, isSideBySideViewAvailable }\n\t} = state;\n\n\tconst enableStacked = isStackedViewAvailable && tabItems.length > 1;\n\n\treturn nowActivityStreamSettings(\n\t\tisRichTextAvailable,\n\t\tisRichTextEnabled,\n\t\tenableStacked,\n\t\tstackedView,\n\t\tisSideBySideViewAvailable,\n\t\tisSideBySideViewEnabled\n\t);\n};\n\nconst getInputProperties = (state, dispatch, journalField) => {\n\tconst {\n\t\tproperties: { table, sysId, isRichTextMentionsEnabled, mentions, isSideBySideViewAvailable },\n\t\tjournalFieldsMap,\n\t\tisRichTextEnabled,\n\t\tstackedView,\n\t\tisSideBySideViewEnabled\n\t} = state;\n\n\tconst inputValue = getInputValue(journalField, journalFieldsMap);\n\tconst colorVariant = !journalField.name ? '' : journalFieldsMap[journalField.name].colorVariant;\n\tconst isSidebySideWithFullStretch = isSideBySideViewAvailable && isSideBySideViewEnabled && !stackedView;\n\n\t// noinspection JSUnusedGlobalSymbols\n\treturn {\n\t\tinputValue,\n\t\tisRichTextEnabled,\n\t\tselectedField: journalField,\n\t\tcolorVariant,\n\t\ttable,\n\t\tsysId,\n\t\tisRichTextMentionsEnabled,\n\t\tmentions,\n\t\tjournalFieldsMap,\n\t\tisSidebySideWithFullStretch,\n\t\thandleInputChange: (journalField) => {\n\t\t\thandleInputChange(journalField, state, dispatch);\n\t\t}\n\t};\n};\n\nconst getFieldFooter = (state, journalField) => {\n\tconst { helpText, helpTextIcon } = journalField;\n\tconst icon = helpTextIcon ? <now-icon icon={helpTextIcon} size=\"md\" /> : '';\n\n\tconst helpTextElement = helpText ? (\n\t\t<div className=\"help-text\">\n\t\t\t{icon}\n\t\t\t<span className=\"text\">{helpText}</span>\n\t\t</div>\n\t) : (\n\t\t<div className=\"help-text\" />\n\t);\n\n\treturn (\n\t\t<div className=\"compose-form footer-bar\">\n\t\t\t{helpTextElement}\n\t\t\t{getPostButton(journalField, state)}\n\t\t</div>\n\t);\n};\n\nconst getNonStackedView = (state, dispatch) => {\n\tconst {\n\t\tselectedField = {},\n\t\ttabItems,\n\t\tproperties: { useTabs = false }\n\t} = state;\n\tconst inEmailTab = selectedField.name === 'email';\n\tconst useTabsPropValue = isTrue(useTabs);\n\tconst RENDER_TAG = useTabsPropValue ? 'now-tabs' : 'now-dropdown';\n\tconst selectionProp = useTabsPropValue\n\t\t? { selectedItem: selectedField.name, maxWidth: 320 }\n\t\t: { selectedItems: [selectedField.name], bare: true };\n\treturn (\n\t\t<section className=\"input\">\n\t\t\t<RENDER_TAG {...selectionProp} items={tabItems} />\n\t\t\t{inEmailTab ? <slot name=\"email-compose\" /> : ''}\n\t\t\t<div className={`input-control${inEmailTab ? ' --hidden' : ''}`}>\n\t\t\t\t{ComposeInput.render(getInputProperties(state, dispatch, selectedField), dispatch)}\n\t\t\t\t{getFieldFooter(state, selectedField)}\n\t\t\t</div>\n\t\t</section>\n\t);\n};\n\nconst getStackedView = (state, dispatch) => {\n\tconst { tabItems, journalFieldsMap } = state;\n\n\treturn tabItems.map((field) => {\n\t\tconst mappedField = journalFieldsMap[field.id];\n\t\treturn (\n\t\t\t<section className=\"input\">\n\t\t\t\t<now-label-value-inline label={field.label} className=\"text--quaternary\" />\n\t\t\t\t{field.id === 'email' ? (\n\t\t\t\t\t<slot name=\"email-compose\" />\n\t\t\t\t) : (\n\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t{ComposeInput.render(getInputProperties(state, dispatch, mappedField), dispatch)}\n\t\t\t\t\t\t{getFieldFooter(state, mappedField)}\n\t\t\t\t\t</Fragment>\n\t\t\t\t)}\n\t\t\t</section>\n\t\t);\n\t});\n};\n\nconst shouldExpandToFit = (state) => {\n\tconst {\n\t\tproperties: { isSideBySideViewAvailable },\n\t\tstackedView,\n\t\tisSideBySideViewEnabled,\n\t\tisRichTextEnabled,\n\t\tselectedField = {}\n\t} = state;\n\n\tconst inEmailTab = selectedField.name === 'email';\n\n\treturn (\n\t\tisSideBySideViewAvailable &&\n\t\t((isSideBySideViewEnabled && !stackedView && isRichTextEnabled) || (inEmailTab && !stackedView))\n\t);\n};\n\nexport const view = (_state, dispatch) => {\n\tconst {\n\t\tproperties: { fields, journalFieldSettings, isNewRecord, title },\n\t\tstackedView\n\t} = _state;\n\n\tif (!fields)\n\t\treturn null;\n\n\tconst state = _state.selectedField\n\t\t? _state\n\t\t: {\n\t\t\t..._state,\n\t\t\t...getUpdatedState({ properties: _state.properties }, fields, journalFieldSettings, true).newState\n\t\t  };\n\n\tconst { selectedField = {}, journalFieldsMap = {} } = state;\n\n\tconst composeTitle = title || t('Compose');\n\tconst toggleButton = getToggleButton(state);\n\n\tconst fieldKeys = Object.keys(journalFieldsMap);\n\tif (fieldKeys.length === 0 || isTrue(isNewRecord) || !selectedField.name)\n\t\treturn null;\n\n\tconst inputView =\n\t\tstackedView || fieldKeys.length === 1 ? getStackedView(state, dispatch) : getNonStackedView(state, dispatch);\n\n\tlet classNames = `compose-container`;\n\n\tif (shouldExpandToFit(state))\n\t\tclassNames += ' --full-stretch';\n\n\treturn (\n\t\t<div className={classNames}>\n\t\t\t<section className=\"as-header\">\n\t\t\t\t<now-heading label={composeTitle} variant=\"header-secondary\" has-no-margin />\n\t\t\t\t<section className=\"actions\">{toggleButton}</section>\n\t\t\t</section>\n\t\t\t{inputView}\n\t\t</div>\n\t);\n};\n\nconst handleButtonClick = (coeffects) => {\n\tconst {\n\t\taction: {\n\t\t\tpayload: { origin }\n\t\t}\n\t} = coeffects;\n\n\tif (origin === POST_BUTTON_ORIGIN)\n\t\thandlePostButton(coeffects);\n};\n\nexport const getIsStackedViewAvailable = () => {\n\treturn isTrue(getProperty(ALLOW_STACKED_VIEW_FIELD, true));\n};\n\nconst getIsStackedViewEnabled = () => {\n\tconst stackedView = window.localStorage.getItem(STACKED_VIEW_SETTING_NAME) || false;\n\treturn getIsStackedViewAvailable() && isTrue(stackedView);\n};\n\nexport const getIsRichTextAvailable = () => {\n\treturn isTrue(getProperty(USE_HTML_FIELD, false));\n};\n\nconst getIsRichTextEnabled = () => {\n\tconst showHtmlEditor = window.localStorage.getItem(RICH_TEXT_SETTING_NAME) || false;\n\tconst globallyEnabled = getIsRichTextAvailable();\n\treturn globallyEnabled && isTrue(showHtmlEditor);\n};\n\nexport const getIsRichTextMentionsEnabled = () => {\n\treturn isTrue(getProperty(ENABLE_MENTIONS_FIELD, true));\n};\n\nexport const getAllowJournalFieldSettingsOverrides = () => {\n\treturn isTrue(getProperty(COMPOSE_ALLOW_JOURNAL_SETTINGS_OVERRIDES_SYS_PROP, true));\n};\n\nexport const getComposeShouldUseTabs = () => {\n\treturn isTrue(getProperty(COMPOSE_USE_TABS_SYS_PROP, true));\n};\n\nexport const getIsSideBySideViewEnabled = () => {\n\tconst sideBySideView = window.localStorage.getItem(SIDE_BY_SIDE_VIEW_SETTING_NAME) || true;\n\treturn isTrue(sideBySideView);\n};\n\nexport const NowActivityStreamCompose = 'now-activity-stream-compose';\n\nexport const commonCreateComponentParts = {\n\tstyles,\n\trenderer: {\n\t\ttype: snabbdom,\n\t\tview\n\t},\n\tinitialState: {\n\t\tpopoverOpened: false\n\t},\n\tactions: {\n\t\t...settingsActionHandlers.actions,\n\t\t'NOW_TABS#SELECTED_ITEM_SET': { private: true },\n\t\t'NOW_DROPDOWN#SELECTED_ITEMS_SET': { private: true },\n\t\t'NOW_BUTTON#CLICKED': { private: true },\n\t\t'NOW_POPOVER#OPENED_SET': { private: true }\n\t},\n\n\tactionHandlers: {\n\t\t[COMPONENT_RENDERED]: ({ host, state: { popoverOpened } }) => {\n\t\t\tif (popoverOpened)\n\t\t\t\thost.shadowRoot.querySelector('now-popover').refit();\n\t\t},\n\t\t'NOW_POPOVER#OPENED_SET': ({\n\t\t\taction: {\n\t\t\t\tpayload: { value }\n\t\t\t},\n\t\t\tupdateState\n\t\t}) => {\n\t\t\tupdateState({\n\t\t\t\toperation: 'assign',\n\t\t\t\tpath: 'popoverOpened',\n\t\t\t\tvalue,\n\t\t\t\tshouldRender: false\n\t\t\t});\n\t\t},\n\t\t[COMPONENT_DISCONNECTED]: {\n\t\t\teffect: (coeffects) => {\n\t\t\t\tconst {\n\t\t\t\t\tproperties: { nowId }\n\t\t\t\t} = coeffects;\n\t\t\t\tbuttonInstancesByComponentId.delete(nowId);\n\t\t\t}\n\t\t},\n\t\t[COMPONENT_BOOTSTRAPPED]: initState,\n\t\t[COMPONENT_PROPERTY_CHANGED]: resetState,\n\t\t'NOW_TABS#SELECTED_ITEM_SET': handleFieldSelection,\n\t\t'NOW_DROPDOWN#SELECTED_ITEMS_SET': handleFieldSelection,\n\t\t['NOW_BUTTON#CLICKED']: handleButtonClick,\n\t\t[AC_POST_COMMENT_REQUESTED_ACTION]: {\n\t\t\teffect: ({\n\t\t\t\taction: {\n\t\t\t\t\tpayload: { field }\n\t\t\t\t},\n\t\t\t\tdispatch\n\t\t\t}) => {\n\t\t\t\tsyncForm(field, '', '', dispatch);\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t * isRichTextEnabled: Shows the rich text editor instead of the standard text area field.\n\t * The property `isRichTextAvailable` must be set in order for this property\n\t * to be used.\n\t * @type {boolean}\n\t *\n\t * stackedView: View journal fields in stacked mode.\n\t * The property `isStackedViewAvailable` must be set in order for this property\n\t * to be used.\n\t * @type {boolean}\n\t *\n\t * isSideBySideViewEnabled: Adds the ability to align Compose and Stream side by side.\n\t * The property `isSideBySideViewAvailable` must be set in order for this property\n\t * to be used.\n\t * @type {boolean}\n\t */\n\ttransformState(state) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tisRichTextEnabled: getIsRichTextEnabled(),\n\t\t\tstackedView: getIsStackedViewEnabled(),\n\t\t\tisSideBySideViewEnabled: getIsSideBySideViewEnabled()\n\t\t};\n\t}\n};\n\n/**\n * Component for creating activity stream entries (Presentational)\n *\n * Basic usage:\n *\n * ```js\n *\n * const fields = {\n *\t\t\"comments\": {\n *\t\t\tname : \"comments\",\n *\t\t\tlabel : \"Additional comments (Customer Visible)\",\n *\t\t\tsys_readonly: false,\n *\t\t\treadonly : false,\n *\t\t\tvisible: true,\n *\t\t\ttype: 'journal_input',\n *\t\t\tmaxLength: 4000\n *\t\t},\n *\t\t\"work_notes\": {\n *\t\t\tname : \"work_notes\",\n *\t\t\tlabel : \"Work Notes\",\n *\t\t\tsys_readonly: false,\n *\t\t\treadonly : false,\n *\t\t\tvisible: true,\n *\t\t\ttype: 'journal_input',\n *\t\t\tmaxLength: 4000\n *\t\t}\n *\t};\n *\n * \tconst journalFieldSettings = {\n *\t\twork_notes: {\n *\t\t\tname: 'work_notes',\n *\t\t\tlabel: 'Internal Note',\n *\t\t\tmaxLength: 2000,\n *\t\t\ticon: 'document-fill',\n *\t\t\tcolorVariant: 'yellow',\n *\t\t\thelpText: 'John Doe will see this comment',\n *\t\t\thelpTextIcon: 'eye-outline'\n *\t\t},\n *\t\tcomments: {\n *\t\t\tname: 'comments',\n *\t\t\tlabel: 'External Comment',\n *\t\t\tmaxLength: 1000,\n *\t\t\ticon: 'user-group-fill',\n *\t\t\tcolorVariant: '',\n *\t\t\thelpText: '',\n *\t\t\thelpTextIcon: ''\n *\t\t}\n *\t};\n *\n *\t<now-activity-compose\n *\t\ttable=\"incident\"\n *\t\tsysId=\"85071a1347c12200e0ef563dbb9a71c1\"\n *\t\tfields={fields}\n *\t\tjournalFieldSettings={journalFieldSettings}\n *\t/>\n * ```\n *\n * @seismicElement now-activity-stream-compose\n * @summary Component for posting entries into the activity stream (Presentational)\n **/\ncreateCustomElement(NowActivityStreamCompose, {\n\t...commonCreateComponentParts,\n\tproperties: {\n\t\t/**\n\t\t * Component Id.\n\t\t *\n\t\t * @type {string}\n\t\t */\n\t\tcomponentId: {},\n\t\t/**\n\t\t * Object containing journal fields available. For example:\n\t\t *\n\t\t * ```\n\t\t * {\n\t\t *\t \"comments\": {\n\t\t *\t\t  name : \"comments\",\n\t\t *\t\t  label : \"Additional comments (Customer Visible)\",\n\t\t *\t\t  sys_readonly: false,\n\t\t *\t\t  readonly : false,\n\t\t *\t \t  visible: true,\n\t\t *\t\t  type: 'journal_input',\n\t\t *\t  \tmaxLength: 1000\n\t\t *\t },\n\t\t *\t \"work_notes\": {\n\t\t *\t\t  name : \"work_notes\",\n\t\t *\t\t  label : \"Work Notes\",\n\t\t *\t\t  sys_readonly: false,\n\t\t *\t\t  readonly : false,\n\t\t *\t\t  visible: true,\n\t\t *\t\t  type: 'journal_input',\n\t\t *\t\t  maxLength: 2000\n\t\t *\t }\n\t\t * }\n\t\t *```\n\t\t *\n\t\t * @type {object}\n\t\t */\n\t\tfields: { default: {} },\n\t\t/**\n\t\t * Disables the Post button(s) when true\n\t\t * @type {boolean}\n\t\t */\n\t\tisPostDisabled: { default: false },\n\t\t/**\n\t\t * Adds the ability to toggle the rich text editor off and on.\n\t\t * @type {boolean}\n\t\t */\n\t\tisRichTextAvailable: { default: getIsRichTextAvailable() },\n\t\t/**\n\t\t * Allows the stack view to be available.\n\t\t * @type {boolean}\n\t\t */\n\t\tisStackedViewAvailable: { default: getIsStackedViewAvailable() },\n\t\t/**\n\t\t * Enables adding user mentions in the text field like `@user`.\n\t\t *\n\t\t * @type {boolean}\n\t\t */\n\t\tisRichTextMentionsEnabled: { default: getIsRichTextMentionsEnabled() },\n\t\t/**\n\t\t * When true, displays fields in tabs instead of a dropdown if space allows. Does not apply when using stacked mode.\n\t\t *\n\t\t * @type {boolean}\n\t\t */\n\t\tuseTabs: { default: getComposeShouldUseTabs() },\n\t\t/**\n\t\t * When true, `journalFieldSettings` properties will override journal field data, when false `journalFieldSettings` is used as defaults only.\n\t\t *\n\t\t * @type {boolean}\n\t\t */\n\t\tallowJournalFieldSettingsOverrides: { default: getAllowJournalFieldSettingsOverrides() },\n\t\t/**\n\t\t * Allows the side by side view to be available.\n\t\t *\n\t\t * @type {boolean}\n\t\t */\n\t\tisSideBySideViewAvailable: { default: false },\n\t\t/**\n\t\t * Name of the table to post the new journal entry to.\n\t\t *\n\t\t * @type {string}\n\t\t */\n\t\ttable: { default: '' },\n\t\t/**\n\t\t * The unique identifier for the record.\n\t\t *\n\t\t * @type {string}\n\t\t */\n\t\tsysId: { default: '' },\n\n\t\t/**\n\t\t * Tells whether or not the current record is newly created or not.\n\t\t *\n\t\t * @type {boolean}\n\t\t */\n\t\tisNewRecord: { default: false },\n\t\t/**\n\t\t * Defines extra display settings per journal field. Depending on the value of `allowJournalFieldSettingsOverrides` will provide overrides (`true`)\n\t\t * or default values (`false`) for the fields received in the `fields` property.\n\t\t *\n\t\t * This should be an object with the field names as properties and JournalFieldSettings as values, field names should match the ones passed in the `fields` property.\n\t\t *\n\t\t * See the example in basic usage.\n\t\t * @type {{field_name: JournalFieldSettings}}\n\t\t */\n\t\tjournalFieldSettings: { default: {} },\n\t\t/**\n\t\t * Mentions config\n\t\t *\n\t\t * @type {object}\n\t\t */\n\t\tmentions: {},\n\t\t/**\n\t\t * Title for the compose component. Defaults to \"Compose\" translated.\n\t\t *\n\t\t * @type {string}\n\t\t */\n\t\ttitle: { default: '' },\n\t\t/**\n\t\t * Enables new Email tab alongside Worknotes and Additional comments, and defines the properties to compose an email.\n\t\t * @type {EmailClientComposerAction}\n\t\t */\n\t\temailAction: {\n\t\t\tdefault: null\n\t\t}\n\t}\n});\n","import '@servicenow/now-button';\nimport '@servicenow/now-popover';\nimport { NowActivityStreamSettingsPopoverContent } from './nowActivityStreamSettingsPopoverContent';\nimport { TOGGLE_SETTINGS_TITLE } from './consts';\nimport {\n\tRICH_TEXT_SETTING_NAME,\n\tSTACKED_VIEW_SETTING_NAME,\n\tSIDE_BY_SIDE_VIEW_SETTING_NAME\n} from '../activity-compose/inputConfig';\n\nexport const nowActivityStreamSettings = (\n\tisRichTextAvailable,\n\tisRichTextEnabled,\n\tisStackedViewAvailable,\n\tisStackedViewEnabled,\n\tisSideBySideViewAvailable,\n\tisSideBySideViewEnabled\n) => {\n\tif (!isStackedViewAvailable && !isRichTextAvailable && !isSideBySideViewAvailable)\n\t\treturn null;\n\n\t// For testing\n\tconst settings = [\n\t\t{ setting: RICH_TEXT_SETTING_NAME, value: isRichTextAvailable && isRichTextEnabled },\n\t\t{ setting: STACKED_VIEW_SETTING_NAME, value: isStackedViewAvailable && isStackedViewEnabled },\n\t\t{ setting: SIDE_BY_SIDE_VIEW_SETTING_NAME, value: isSideBySideViewAvailable && isSideBySideViewEnabled }\n\t];\n\n\treturn (\n\t\t<div className=\"compose-settings\" data-settings={JSON.stringify(settings)}>\n\t\t\t<now-popover\n\t\t\t\thide-tail={true}\n\t\t\t\topened={false}\n\t\t\t\tinteraction-type={'listbox'}\n\t\t\t\taria-label={TOGGLE_SETTINGS_TITLE}\n\t\t\t\tpositions={[{ trigger: 'bottom-end', content: 'top-end' }]}\n\t\t\t>\n\t\t\t\t<now-button\n\t\t\t\t\ticon=\"sliders-outline\"\n\t\t\t\t\tsize=\"md\"\n\t\t\t\t\tbare\n\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\ttooltip-content={TOGGLE_SETTINGS_TITLE}\n\t\t\t\t\tslot=\"trigger\"\n\t\t\t\t/>\n\t\t\t\t<NowActivityStreamSettingsPopoverContent\n\t\t\t\t\tclassName=\"now-activity-stream-settings-popover-content-container\"\n\t\t\t\t\tslot=\"content\"\n\t\t\t\t\tisRichTextAvailable={isRichTextAvailable}\n\t\t\t\t\tisStackedViewAvailable={isStackedViewAvailable}\n\t\t\t\t\tisRichTextEnabled={isRichTextEnabled}\n\t\t\t\t\tisStackedViewEnabled={isStackedViewEnabled}\n\t\t\t\t\tisSideBySideViewAvailable={isSideBySideViewAvailable}\n\t\t\t\t\tisSideBySideViewEnabled={isSideBySideViewEnabled}\n\t\t\t\t/>\n\t\t\t</now-popover>\n\t\t</div>\n\t);\n};\n\nexport const settingsActionHandlers = {\n\tactions: {\n\t\t'NOW_BUTTON#CLICKED': { private: true },\n\t\t'NOW_TOGGLE#CHECKED_SET': { private: true },\n\t\t'NOW_POPOVER#OPENED_SET': { private: true }\n\t}\n};\n","import { getIsSideBySideViewEnabled } from '../activity-compose/nowActivityStreamCompose';\n\nexport const disableSibeBySide = () => {\n\tconst match = /Version\\/([0-9._]+).*Safari/.exec(navigator.userAgent);\n\n\treturn match ? parseFloat(match[1]) < parseFloat('13.1') : false;\n};\n\nexport const shouldRenderCompose = ({ properties }) => {\n\tconst fields = properties.fields || {};\n\tconst isNewRecord = properties.isNewRecord || false;\n\tif (isNewRecord)\n\t\treturn !isNewRecord;\n\n\tconst filteredFields = Object.values(fields).filter(({ sys_readonly, readonly, visible, type }) => {\n\t\treturn !sys_readonly && !readonly && visible && type === 'journal_input';\n\t});\n\n\treturn filteredFields.length > 0;\n};\n\nexport const shouldEnableSideBySideView = (isSideBySideViewAvailable) =>\n\tisSideBySideViewAvailable && getIsSideBySideViewEnabled();\n\nexport const newLinesToBreaks = (str) => str.replace(/(?:\\r\\n|\\r|\\n)/g, '<br>');\n","import TruncatedTile from './TruncatedTile';\nimport { EVENT_SUB_TYPES } from '../constants';\nimport { createCustomElement } from '@servicenow/ui-core';\nimport { newLinesToBreaks } from '../utils';\nimport { apiVersion } from '../constants';\n\nconst JOURNAL_TILE = 'journal-tile';\n\nexport class JournalTile extends TruncatedTile {\n\tgetComponentName() {\n\t\treturn JOURNAL_TILE;\n\t}\n\n\tgetTileIcon(state): string {\n\t\tconst {\n\t\t\tproperties: { activated, subtype }\n\t\t} = state;\n\t\tif (!activated)\n\t\t\treturn '';\n\n\t\tif (subtype === EVENT_SUB_TYPES.JOURNAL.WORK_NOTES)\n\t\t\treturn 'lock-outline';\n\t\tif (subtype === EVENT_SUB_TYPES.JOURNAL.COMMENTS)\n\t\t\treturn 'user-group-outline';\n\n\t\treturn 'document-outline';\n\t}\n\n\tgetPropertyDefinitions() {\n\t\treturn {\n\t\t\t...super.getPropertyDefinitions(),\n\t\t\tvalue: { default: '' },\n\t\t\tbackgroundColor: { default: '' },\n\t\t\tsubtype: { default: '' },\n\t\t\tactivated: { default: false }\n\t\t};\n\t}\n\n\t// noinspection JSCheckFunctionSignatures\n\tgetTruncatedContent(state) {\n\t\tconst {\n\t\t\tproperties: { value, activated }\n\t\t} = state;\n\t\treturn this.setHTMLContent(value, activated, apiVersion);\n\t}\n\n\tsetHTMLContent(value, activated, _apiVersion) {\n\t\t// The old api already does the conversion on the backend, but only handles '/n', but\n\t\t// newLinesToBreaks will handle all cases. So, I don't want to call newLinesToBreaks\n\t\t// when using the old api because it will cause double <br> tags.\n\t\tconst newValue = _apiVersion === 1 ? newLinesToBreaks(value) : value;\n\n\t\t// noinspection HtmlUnknownAttribute\n\t\treturn (\n\t\t\t<p\n\t\t\t\tclassName=\"sn-as-card-body-journal\"\n\t\t\t\tinnerHTML={newValue}\n\t\t\t\tref={(e) => this.prepareContent(e, activated)}\n\t\t\t/>\n\t\t);\n\t}\n\n\tprepareContent(node, activated) {\n\t\tif (!activated || node.getAttribute('data-anchors-processed'))\n\t\t\treturn;\n\t\tnode.querySelectorAll('a').forEach((a) => {\n\t\t\ta.setAttribute('target', '_blank');\n\t\t\tconst rel = a.getAttribute('rel') || '';\n\t\t\ta.setAttribute('rel', `${rel !== '' ? rel + ' ' : ''}noopener noreferrer`);\n\t\t});\n\t\tnode.setAttribute('data-anchors-processed', true);\n\t}\n}\n\nconst journalTile = new JournalTile();\ncreateCustomElement(JOURNAL_TILE, journalTile.getCustomElementParts());\nexport default journalTile.getComponentName();\n","import ActivityTile from './ActivityTile';\nimport '@servicenow/now-record-common';\nimport { createCustomElement } from '@servicenow/ui-core';\n\nconst ATTACHMENT_TILE = 'attachment-tile';\n\nclass AttachmentTile extends ActivityTile {\n\tgetTileIcon() {\n\t\treturn 'paperclip-outline';\n\t}\n\n\tgetComponentName() {\n\t\treturn ATTACHMENT_TILE;\n\t}\n\n\tgetPropertyDefinitions() {\n\t\treturn {\n\t\t\t...super.getPropertyDefinitions(),\n\t\t\tfileName: { default: '' },\n\t\t\tsizeBytes: { default: 0 },\n\t\t\tstate: { default: '' },\n\t\t\tcontentType: { default: '' }\n\t\t};\n\t}\n\n\tgetJSX(state) {\n\t\tconst {\n\t\t\tproperties: {\n\t\t\t\tfileName: name,\n\t\t\t\tsizeBytes: size,\n\t\t\t\tstate: fileState,\n\t\t\t\teventSysId: sysId,\n\t\t\t\tcontentType: type,\n\t\t\t\tactivated\n\t\t\t}\n\t\t} = state;\n\n\t\treturn !activated ? (\n\t\t\t''\n\t\t) : (\n\t\t\t<now-record-common-attachment-card item={{ name, size, state: fileState, sysId, type }} />\n\t\t);\n\t}\n}\n\nconst attachmentTile = new AttachmentTile();\ncreateCustomElement(ATTACHMENT_TILE, attachmentTile.getCustomElementParts());\nexport default attachmentTile.getComponentName();\n","// noinspection ES6CheckImport\nimport { actionTypes, createCustomElement } from '@servicenow/ui-core';\nimport SeismicComponent from '../../shared/SeismicComponent';\nimport { LOADING_EMAIL_LAST_REPLY, LOADING_EMAIL_LAST_REPLY_FAILED } from '../translations';\nconst { COMPONENT_RENDERED } = actionTypes;\nimport styles from './_emailTile.scss';\nconst EMAIL_LAST_REPLY = 'email-last-reply';\n\nclass EmailLastReply extends SeismicComponent {\n\tgetComponentName() {\n\t\treturn EMAIL_LAST_REPLY;\n\t}\n\n\tgetStyles() {\n\t\treturn styles;\n\t}\n\n\t// noinspection JSCheckFunctionSignatures\n\tgetView(state) {\n\t\tconst {\n\t\t\tproperties: { expanded, lastReply }\n\t\t} = state;\n\t\tconst loader = !lastReply ? <now-loader size=\"md\" label={LOADING_EMAIL_LAST_REPLY} /> : '';\n\n\t\t// noinspection JSXNamespaceValidation\n\t\treturn (\n\t\t\t<div id=\"email-last-reply\" className={'last-reply' + (!expanded && lastReply ? ' hidden-searchable' : '')}>\n\t\t\t\t{loader}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderContent(host, content) {\n\t\tconst elem = host.shadowRoot.querySelector('#email-last-reply');\n\t\tconst shadowRoot = elem.shadowRoot || elem.attachShadow({ mode: 'open' });\n\t\tconst imageStyles = `\n\t\t\t<style>\n\t\t\t\timg {\n\t\t\t\t\tmax-width: 100%;\n\t\t\t\t\theight: auto;\n\t\t\t\t}\n\t\t\t</style>\n\t\t`;\n\t\tshadowRoot.innerHTML = imageStyles + content;\n\t}\n\n\trenderError(host) {\n\t\tthis.renderContent(host, `${LOADING_EMAIL_LAST_REPLY_FAILED}`);\n\t}\n\n\tgetActionHandlers() {\n\t\treturn {\n\t\t\t[COMPONENT_RENDERED]: ({ host, properties }) => {\n\t\t\t\tconst { lastReply, error } = properties;\n\t\t\t\tif (error)\n\t\t\t\t\tthis.renderError(host);\n\t\t\t\telse if (lastReply)\n\t\t\t\t\tthis.renderContent(host, lastReply);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetPropertyDefinitions() {\n\t\treturn {\n\t\t\texpanded: { default: false },\n\t\t\terror: { default: false },\n\t\t\tsysId: { default: '' },\n\t\t\tlastReply: { default: '' }\n\t\t};\n\t}\n}\n\nconst emailLastReply = new EmailLastReply();\ncreateCustomElement(EMAIL_LAST_REPLY, emailLastReply.getCustomElementParts());\nexport default emailLastReply.getComponentName();\n","// noinspection ES6CheckImport\nimport { actionTypes, createCustomElement } from '@servicenow/ui-core';\nimport SeismicComponent from '../../shared/SeismicComponent';\nimport { LOADING_EMAIL_CONTENT, LOADING_EMAIL_CONTENT_FAILED } from '../translations';\nconst { COMPONENT_DOM_READY } = actionTypes;\nimport styles from './_emailTile.scss';\nconst EMAIL_CONTENT = 'email-content';\n\nclass EmailContent extends SeismicComponent {\n\tgetComponentName() {\n\t\treturn EMAIL_CONTENT;\n\t}\n\n\tgetStyles() {\n\t\treturn styles;\n\t}\n\n\t// noinspection JSCheckFunctionSignatures\n\tgetView(state) {\n\t\tconst {\n\t\t\tproperties: { expanded }\n\t\t} = state;\n\t\t// noinspection JSXNamespaceValidation\n\t\treturn (\n\t\t\t<div id=\"email-content\" className={'email-content' + (!expanded ? ' hidden-searchable' : '')}>\n\t\t\t\t<now-loader size=\"md\" label={LOADING_EMAIL_CONTENT} />\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderContent(host, content) {\n\t\tconst elem = host.shadowRoot.querySelector('#email-content');\n\t\tconst shadowRoot = elem.attachShadow({ mode: 'open' });\n\t\tconst imageStyles = `\n\t\t\t<style>\n\t\t\t\timg {\n\t\t\t\t\tmax-width: 100%;\n\t\t\t\t\theight: auto;\n\t\t\t\t}\n\t\t\t</style>\n\t\t`;\n\t\tshadowRoot.innerHTML = imageStyles + content;\n\t}\n\n\trenderError(host) {\n\t\tthis.renderContent(\n\t\t\thost,\n\t\t\t`\n\t\t\t<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n\t\t\t<html>\n\t\t\t\t<head>\n\t\t\t\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n\t\t\t\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"/>\n\t\t\t\t\t<style>p {color: red}></style>\n\t\t\t\t</head>\n\t\t\t\t<body>\n\t\t\t\t\t<p>${LOADING_EMAIL_CONTENT_FAILED}</p>\n\t\t\t\t</body>\n\t\t\t</html>\n\t\t`\n\t\t);\n\t}\n\n\tasync fetchContent(coeffects) {\n\t\tconst {\n\t\t\tproperties: { contentUrl },\n\t\t\thost\n\t\t} = coeffects;\n\t\ttry {\n\t\t\tconst response = await fetch(contentUrl, {\n\t\t\t\tmethod: 'GET',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'text/html'\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!response.ok) {\n\t\t\t\tthis.renderError(host);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.renderContent(host, await response.text());\n\t\t} catch (e) {\n\t\t\tthis.renderError(host);\n\t\t}\n\t}\n\n\tgetActionHandlers() {\n\t\treturn {\n\t\t\t[COMPONENT_DOM_READY]: (coeffects) => {\n\t\t\t\tthis.fetchContent(coeffects);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetPropertyDefinitions() {\n\t\treturn {\n\t\t\tcontentUrl: { default: '' },\n\t\t\texpanded: { default: false }\n\t\t};\n\t}\n}\n\nconst emailContent = new EmailContent();\ncreateCustomElement(EMAIL_CONTENT, emailContent.getCustomElementParts());\nexport default emailContent.getComponentName();\n","import '@servicenow/now-button';\nimport '@servicenow/now-dropdown';\nimport TileHeaderAction from './TileHeaderAction';\nimport { FORWARD, MORE, REPLY, REPLY_ALL, EMAIL_PANEL_HEADERS } from '../../translations';\nimport { Fragment } from '@servicenow/ui-renderer-snabbdom';\nimport { createPreSourceBehavior } from 'sn-uxpage-presource';\nimport { get } from 'lodash';\nimport { WS_PREVIEW_RECORD_ACTION } from '../../actions';\nimport EmailTile from '../EmailTile';\n\nconst ACTION_ID_REPLY = 'EMAIL_REPLY';\nconst ACTION_ID_REPLY_ALL = 'EMAIL_REPLY_ALL';\nconst ACTION_ID_FORWARD = 'EMAIL_FORWARD';\nconst EMAIL_ACTION_IDS = new Set([ACTION_ID_REPLY, ACTION_ID_REPLY_ALL, ACTION_ID_FORWARD]);\n\nconst getRecordPreviewPayload = (parentTable, parentSysId, eventId, actionId, renderers) => {\n\tconst replyOptions = {\n\t\t[ACTION_ID_REPLY]: {\n\t\t\theaderValue: EMAIL_PANEL_HEADERS.REPLY,\n\t\t\treplyType: 'reply'\n\t\t},\n\t\t[ACTION_ID_REPLY_ALL]: {\n\t\t\theaderValue: EMAIL_PANEL_HEADERS.REPLY_ALL,\n\t\t\treplyType: 'replyAll'\n\t\t},\n\t\t[ACTION_ID_FORWARD]: {\n\t\t\theaderValue: EMAIL_PANEL_HEADERS.FORWARD,\n\t\t\treplyType: 'forward'\n\t\t}\n\t};\n\n\tconst EMAIL_RENDERER_DRAFT = `sys_email_draft`;\n\tconst EMAIL_RENDERER_LEGACY = `sys_email`;\n\tconst COMPONENT_DRAFT = `sn-email-client-wrapper`;\n\tconst getRendererTable = (renderers) => {\n\t\tfor (let renderer of renderers) {\n\t\t\tconst {\n\t\t\t\ttable: { value: tableName },\n\t\t\t\tcustom_renderer_tag: { value: customTag }\n\t\t\t} = renderer;\n\t\t\tif (tableName === EMAIL_RENDERER_LEGACY && customTag !== COMPONENT_DRAFT)\n\t\t\t\treturn EMAIL_RENDERER_LEGACY;\n\t\t}\n\t\treturn EMAIL_RENDERER_DRAFT;\n\t};\n\n\treturn {\n\t\ttable: getRendererTable(renderers),\n\t\tsys_id: '-1',\n\t\tparams: {\n\t\t\tparentTable,\n\t\t\tparentSysId,\n\t\t\treplyId: eventId,\n\t\t\t...replyOptions[actionId]\n\t\t}\n\t};\n};\n\nconst emailActionEffect = (coeffects) => {\n\tconst {\n\t\tstate: {\n\t\t\tbehaviors: { snCustomRenderer: renderers }\n\t\t},\n\t\tproperties: { documentTable, documentId, eventSysId },\n\t\taction: {\n\t\t\tpayload: { item }\n\t\t},\n\t\tdispatch\n\t} = coeffects;\n\n\tif (!item || !EMAIL_ACTION_IDS.has(item.id))\n\t\treturn;\n\n\tdispatch(\n\t\tWS_PREVIEW_RECORD_ACTION,\n\t\tgetRecordPreviewPayload(documentTable, documentId, eventSysId, item.id, renderers),\n\t\t{\n\t\t\tactionOrigin: EmailTile\n\t\t}\n\t);\n};\n\nexport default class EmailHeaderAction extends TileHeaderAction {\n\tgetBehaviors() {\n\t\treturn [\n\t\t\tcreatePreSourceBehavior('sn-workspace-content', {\n\t\t\t\tname: 'snCustomRenderer',\n\t\t\t\ttransform: (data) => get(data, 'data.GlideRecord_Query.sys_aw_renderer._results', [])\n\t\t\t}),\n\t\t\t{\n\t\t\t\tname: 'emailHeaderActionsBehavior',\n\t\t\t\tactionHandlers: {\n\t\t\t\t\t['NOW_DROPDOWN#ITEM_CLICKED']: {\n\t\t\t\t\t\teffect: emailActionEffect,\n\t\t\t\t\t\tprivate: true\n\t\t\t\t\t},\n\t\t\t\t\t['NOW_BUTTON#CLICKED']: {\n\t\t\t\t\t\teffect: emailActionEffect,\n\t\t\t\t\t\tprivate: true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\tgetEmailActionOptions(state) {\n\t\tconst {\n\t\t\tproperties: { to = [], cc = [] }\n\t\t} = state;\n\n\t\tconst options = [{ label: REPLY, id: ACTION_ID_REPLY }];\n\n\t\tif (to.length + cc.length > 1)\n\t\t\toptions.push({ label: REPLY_ALL, id: ACTION_ID_REPLY_ALL });\n\n\t\toptions.push({ label: FORWARD, id: ACTION_ID_FORWARD });\n\n\t\treturn options;\n\t}\n\n\tgetJSX(state) {\n\t\tconst panelFitProps = {\n\t\t\tposition: ['bottom-end top-end']\n\t\t};\n\n\t\tif (document.dir === 'rtl')\n\t\t\tpanelFitProps.position = ['bottom-start top-start'];\n\n\t\t// noinspection JSXNamespaceValidation\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<now-button\n\t\t\t\t\tclassName=\"button-group-item\"\n\t\t\t\t\tdata-testId=\"email-reply-button\"\n\t\t\t\t\ttabIndex={-1}\n\t\t\t\t\tbare\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\ticon-name=\"reply-outline\"\n\t\t\t\t\ttooltip-content={REPLY}\n\t\t\t\t\tappend-to-payload={{ item: { id: ACTION_ID_REPLY } }}\n\t\t\t\t/>\n\t\t\t\t<now-dropdown\n\t\t\t\t\tclassName=\"button-group-item\"\n\t\t\t\t\tdata-testId=\"email-actions-dropdown\"\n\t\t\t\t\ttabIndex={-1}\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\titems={this.getEmailActionOptions(state)}\n\t\t\t\t\tbare\n\t\t\t\t\thide-caret\n\t\t\t\t\tselect=\"none\"\n\t\t\t\t\ticon=\"ellipsis-v-outline\"\n\t\t\t\t\ttooltip-content={MORE}\n\t\t\t\t\tpanelFitProps={panelFitProps}\n\t\t\t\t/>\n\t\t\t</Fragment>\n\t\t);\n\t}\n}\n","export default class UserReferenceDto {\n\tactive: boolean = false;\n\tavatar: string = '';\n\temail: string = '';\n\tdisplayName: string = '';\n\tsysId: string = '';\n\tuserName: string = '';\n\n\tconstructor(defaultValues = {}) {\n\t\tthis.active = defaultValues['active'] || '';\n\t\tthis.avatar = defaultValues['avatar'] || '';\n\t\tthis.email = defaultValues['email'] || '';\n\t\tthis.displayName = defaultValues['displayName'] || '';\n\t\tthis.sysId = defaultValues['sysId'] || '';\n\t\tthis.userName = defaultValues['userName'] || '';\n\t}\n}\n","import UserReferenceDto from './UserReferenceDto';\n\nclass UserReferenceMap {\n\temail: Map<string, UserReferenceDto> = null;\n\tsysId: Map<string, UserReferenceDto> = null;\n\tuserName: Map<string, UserReferenceDto> = null;\n\n\tconstructor() {\n\t\tthis.email = new Map();\n\t\tthis.sysId = new Map();\n\t\tthis.userName = new Map();\n\t}\n}\n\nconst userReferences: Map<string, UserReferenceMap> = new Map();\n\nexport default class UserReferenceRepo {\n\tstatic addReference(nowId, userDto: UserReferenceDto) {\n\t\tif (!userReferences.has(nowId))\n\t\t\tuserReferences.set(nowId, new UserReferenceMap());\n\n\t\tconst userReferenceMap: UserReferenceMap = userReferences.get(nowId);\n\t\tuserReferenceMap.sysId.set(userDto.sysId, userDto);\n\t\tuserReferenceMap.email.set(userDto.email, userDto);\n\t\tuserReferenceMap.userName.set(userDto.userName, userDto);\n\t}\n\n\t/**\n\t * @param nowId to prevent infinite accumulation this is used as a key to destroy references\n\t * @param key either a sysId, email or userName\n\t * @returns {UserReferenceDto}\n\t */\n\tstatic getFromReferences(nowId, key) {\n\t\tconst userReferenceMap: UserReferenceMap = userReferences.get(nowId);\n\t\tif (!userReferenceMap)\n\t\t\treturn null;\n\n\t\treturn (\n\t\t\tuserReferenceMap.sysId.get(key) ||\n\t\t\tuserReferenceMap.userName.get(key) ||\n\t\t\tuserReferenceMap.email.get(key) ||\n\t\t\tnull\n\t\t);\n\t}\n\n\tstatic deleteReferences(nowId) {\n\t\tconst userReferenceMap: UserReferenceMap = userReferences.get(nowId);\n\t\tif (!userReferenceMap)\n\t\t\treturn;\n\t\tuserReferenceMap.email.clear();\n\t\tuserReferenceMap.sysId.clear();\n\t\tuserReferenceMap.userName.clear();\n\t\tuserReferences.delete(nowId);\n\t}\n}\n","import { apiVersion } from '../activity/constants';\nimport { getProperty } from 'sn-uxpage-presource';\n\nexport const ACTIVITY_STREAM_FILTER_INNER_SCHEMA = `\nfields {\n\tselected:active\n\tlabel\n\tname\n\tjournal\n}\n`;\n\nconst apiVersionOriginalValue = getProperty('glide.activity.api_version', -1);\n\nconst supplementalPart =\n\tapiVersionOriginalValue === -1\n\t\t? ''\n\t\t: `supplemental {\n\tdocumentId\n\teventId\n\tuserSysId\n\tpayload\n}`;\n\nexport const ACTIVITY_STREAM_INNER_SCHEMA = `\nsysTimestamp\nisDelta\n${supplementalPart}\nentries {\n\ttype\n\tsysCreatedOnAdjusted\n\tsysCreatedBy\n\tuserImage\n\tinitials\n\tfieldColor\n\tsysId: uid\n\tentryItem {\n\t\t... on GlideActivity_AuditType {\n\t\t\tauditValues {\n\t\t\t\tfieldName\n\t\t\t\tfieldLabel\n\t\t\t\tnewValue\n\t\t\t\toldValue\n\t\t\t\thtmlNewValue\n\t\t\t\thtmlOldValue\n\t\t\t\ttype\n\t\t\t}\n\t\t\t__typename\n\t\t}\n\t\t... on GlideActivity_JournalType {\n\t\t\tfieldLabel\n\t\t\tfieldName\n\t\t\tsanitizeHtmlValue\n\t\t\t__typename\n\t\t}\n\t\t... on GlideActivity_AttachmentType {\n\t\t\tsysId\n\t\t\tfileName\n\t\t\tstate\n\t\t\tdownloadPath\n\t\t\timagePath\n\t\t\tsizeBytes\n\t\t\tcontentType\n\t\t\textension\n\t\t\t__typename\n\t\t}\n\t\t... on GlideActivity_EmailType {\n\t\t\tfields {\n\t\t\t\tsubject\n\t\t\t\tuser\n\t\t\t\trecipients\n\t\t\t\tcopied\n\t\t\t\ttype\n\t\t\t}\n\t\t\tdisplayPath\n\t\t\t__typename\n\t\t}\n\t}\n}\n`;\n\nconst OLD_METHOD = `\ngetStream(table: $table, sysId: $sysId, view: $view, timestamp: 0, omitFilters: true) {\n\t${ACTIVITY_STREAM_FILTER_INNER_SCHEMA}\n\t${ACTIVITY_STREAM_INNER_SCHEMA}\n}\n`;\n\nconst NEW_METHOD = `\ngetEvents(documents: [{table:$table, sysId:$sysId}], view: {table:$table, sysId:$sysId, name:$view}) {\n\tfilterFields {\n\t\tname\n\t\tlabel\n\t\tjournal\n\t\tselected\n\t}\n\tsupplemental {\n\t\tdocumentId\n\t\teventId\n\t\tuserSysId\n\t\tpayload\n\t}\n\tevents {\n\t\tdocumentTable\n\t\tdocumentId\n\t\teventTable\n\t\teventSysId\n\t\teventCreatedOn {\n  \t\t\tdisplayValue\n  \t\t\tnumericValue\n  \t\t\tvalue\n\t\t}\n\t\teventCreatedBy\n\t\tsubtype\n\t\ttile\n\t\tpayload\n\t\teventTitle\n\t}\n\tuserReferences {\n\t\tsysId\n\t\tdisplayName\n\t\temail\n\t\tavatar\n\t\tuserName\n\t\tactive\n\t}\n\tambChannels\n}\n`;\n\nexport const getQueryMethod = () => {\n\treturn apiVersion === 0 ? OLD_METHOD : NEW_METHOD;\n};\n\nexport const FULL_QUERY = `\nquery ($table: String!, $sysId: String!, $view: String) {\n\tGlideActivity_Query {\n\t\t${getQueryMethod()}\n\t}\n}\n`;\n\nexport const EMAIL_REPLY_QUERY = `\nquery ($emailSysIds: [String!]!) {\n\tGlideActivity_Query {\n\t\tgetEmailBodies(emailSysIds: $emailSysIds) {\n\t\t\tsysId\n\t\t\tlastReply\n\t\t\tbody\n\t\t\tbodyText\n\t\t}\n\t}\n}`;\n\nexport const QUERY_METHOD = apiVersion === 0 ? 'getStream' : 'getEvents';\nexport const ENTRIES_FIELD = apiVersion === 0 ? 'entries' : 'events';\nexport const FIELDS_FIELD = apiVersion === 0 ? 'fields' : 'filterFields';\n","export default class AttachmentDto {\n\tfileName: string = '';\n\tsizeBytes: number = 0;\n\tstate: string = '';\n\tcontentType: string = '';\n\tattachment: string = '';\n\n\tconstructor(defaultValues = {}) {\n\t\tthis.fileName = defaultValues['fileName'] || '';\n\t\tthis.sizeBytes = defaultValues['sizeBytes'] || 0;\n\t\tthis.state = defaultValues['state'] || '';\n\t\tthis.contentType = defaultValues['contentType'] || '';\n\t\tthis.attachment = defaultValues['attachment'] || '';\n\t}\n}\n","import AttachmentDto from './AttachmentDto';\n\nconst attachmentsByNowIdAndAttachmentId: Map<String, Map<String, AttachmentDto>> = new Map();\n\nexport default class AttachmentRepo {\n\tstatic addAttachment(nowId, attachmentDto: AttachmentDto) {\n\t\tif (!attachmentsByNowIdAndAttachmentId.has(nowId))\n\t\t\tattachmentsByNowIdAndAttachmentId.set(nowId, new Map());\n\n\t\tattachmentsByNowIdAndAttachmentId.get(nowId).set(attachmentDto.attachment, attachmentDto);\n\t}\n\n\tstatic getAttachment(nowId, attachmentId) {\n\t\tconst attachmentsById = attachmentsByNowIdAndAttachmentId.get(nowId);\n\n\t\treturn attachmentsById ? attachmentsById.get(attachmentId) : null;\n\t}\n\n\tstatic removeAttachments(nowId) {\n\t\tconst attachmentsById = attachmentsByNowIdAndAttachmentId.get(nowId);\n\n\t\tif (!attachmentsById)\n\t\t\treturn;\n\n\t\tattachmentsById.clear();\n\t\tattachmentsByNowIdAndAttachmentId.delete(nowId);\n\t}\n}\n","import ActivityDto from './ActivityDto';\nimport { EVENT_SUB_TYPES } from './constants';\nimport { get } from 'lodash';\nimport {\n\tWORK_NOTES_TITLE,\n\tADDITIONAL_COMMENTS_TITLE,\n\tEMAIL_TITLE,\n\tFIELD_CHANGES_TITLE,\n\tATTACHMENT_TITLE\n} from './translations';\n\nconst eventTypes = {\n\tJOURNAL: 'JOURNAL',\n\tEMAIL: 'EMAIL',\n\tATTACHMENT: 'ATTACHMENT',\n\tIMAGE: 'IMAGE',\n\tAUDIT: 'AUDIT'\n};\n\nconst typeToTableMap = {\n\t[eventTypes.JOURNAL]: 'sys_journal_field',\n\t[eventTypes.EMAIL]: 'sys_email',\n\t[eventTypes.ATTACHMENT]: 'sys_attachment',\n\t[eventTypes.IMAGE]: 'sys_attachment',\n\t[eventTypes.AUDIT]: 'sys_audit'\n};\n\nconst tileMap = {\n\t[eventTypes.JOURNAL]: 'journal-tile',\n\t[eventTypes.EMAIL]: 'email-tile',\n\t[eventTypes.ATTACHMENT]: 'attachment-tile',\n\t[eventTypes.IMAGE]: 'attachment-tile',\n\t[eventTypes.AUDIT]: 'audit-tile'\n};\n\n/**\n * Transforms events recieved from the GraphQL call\n */\nexport default class DataTransformer {\n\ttransformOldEvents(events, table, sysId) {\n\t\treturn events.map(this.oldEventTransform(table, sysId));\n\t}\n\n\toldEventTransform(table, sysId) {\n\t\treturn (item) => {\n\t\t\tconst type = item.type;\n\t\t\tconst eventTable = type === eventTypes.AUDIT ? table : typeToTableMap[item.type] || '';\n\t\t\tconst payload = this._getPayload(type, item);\n\t\t\treturn new ActivityDto({\n\t\t\t\tdocumentTable: table,\n\t\t\t\tdocumentId: sysId,\n\t\t\t\teventTable: eventTable,\n\t\t\t\teventSysId: item.sysId || '',\n\t\t\t\teventCreatedOn: {\n\t\t\t\t\tdisplayValue: item.sysCreatedOnAdjusted || ''\n\t\t\t\t},\n\t\t\t\tsubtype: this._getSubType(item),\n\t\t\t\tpayload: payload,\n\t\t\t\ttile: tileMap[type] || '',\n\t\t\t\teventTitle: payload.eventTitle\n\t\t\t});\n\t\t};\n\t}\n\n\t/**\n\t * Subtype can be 'sent' or 'recieved' for email\n\t * Subtype can be 'comment' or 'work_note' for journal\n\t * @param type\n\t * @param item\n\t */\n\t_getSubType(item) {\n\t\tswitch (item.type) {\n\t\tcase eventTypes.JOURNAL:\n\t\t\treturn get(item, 'entryItem.fieldName', '');\n\t\tcase eventTypes.EMAIL:\n\t\t\treturn get(item, 'entryItem.fields.type', '');\n\t\tdefault:\n\t\t\treturn '';\n\t\t}\n\t}\n\n\t_getPayload(type, item) {\n\t\tswitch (type) {\n\t\tcase eventTypes.JOURNAL:\n\t\t\treturn this._getJournalPayload(item);\n\t\tcase eventTypes.EMAIL:\n\t\t\treturn this._getEmailPayload(item);\n\t\tcase eventTypes.ATTACHMENT:\n\t\tcase eventTypes.IMAGE:\n\t\t\treturn this._getAttachmentPayload(item);\n\t\tcase eventTypes.AUDIT:\n\t\t\treturn this._getAuditPayload(item);\n\t\tdefault:\n\t\t\treturn {};\n\t\t}\n\t}\n\n\t_getJournalPayload(item) {\n\t\tconst transformedEntry = this._getCommonPayload(item);\n\t\tconst entryItem = get(item, 'entryItem', {});\n\t\tconst isWorknote = get(entryItem, 'fieldName', '') === EVENT_SUB_TYPES.JOURNAL.WORK_NOTES;\n\t\ttransformedEntry.eventTitle = isWorknote ? WORK_NOTES_TITLE : ADDITIONAL_COMMENTS_TITLE;\n\t\ttransformedEntry.value = get(entryItem, 'sanitizeHtmlValue', '');\n\t\treturn transformedEntry;\n\t}\n\n\t_getEmailPayload(item) {\n\t\tconst transformedEntry = this._getCommonPayload(item);\n\t\tconst entryItem = get(item, 'entryItem', {});\n\t\tconst fields = get(entryItem, 'fields', {});\n\n\t\ttransformedEntry.from = get(fields, 'user') || transformedEntry.author;\n\t\ttransformedEntry.to = (fields.recipients || '') !== '' ? fields.recipients.split(',') : [];\n\t\ttransformedEntry.cc = (fields.copied || '') !== '' ? fields.copied.split(',') : [];\n\t\ttransformedEntry.subject = get(fields, 'subject', '');\n\t\ttransformedEntry.contentUrl = get(entryItem, 'displayPath', '');\n\t\ttransformedEntry.previewText = get(fields, 'preview', '');\n\t\ttransformedEntry.subtype = this._getSubType(item);\n\t\ttransformedEntry.eventTitle = EMAIL_TITLE(transformedEntry.subtype);\n\t\treturn transformedEntry;\n\t}\n\n\t_getAttachmentPayload(item) {\n\t\tconst transformedEntry = this._getCommonPayload(item);\n\t\tconst entryItem = get(item, 'entryItem', {});\n\n\t\ttransformedEntry.fileName = get(entryItem, 'fileName', '');\n\t\ttransformedEntry.sizeBytes = get(entryItem, 'sizeBytes', '');\n\t\ttransformedEntry.state = get(entryItem, 'state', '');\n\t\ttransformedEntry.contentType = get(entryItem, 'contentType', '');\n\t\ttransformedEntry.eventTitle = ATTACHMENT_TITLE;\n\t\treturn transformedEntry;\n\t}\n\n\t_getAuditPayload(item) {\n\t\tconst transformedEntry = this._getCommonPayload(item);\n\t\tconst entryItem = get(item, 'entryItem', {});\n\n\t\ttransformedEntry.auditValues = get(entryItem, 'auditValues', {});\n\t\ttransformedEntry.eventTitle = FIELD_CHANGES_TITLE;\n\t\treturn transformedEntry;\n\t}\n\n\t_getCommonPayload(item) {\n\t\tconst transformedEntry = {};\n\t\ttransformedEntry.image = get(item, 'userImage', '');\n\t\ttransformedEntry.author = get(item, 'sysCreatedBy', '');\n\t\ttransformedEntry.eventSysId = get(item, 'sysId', '');\n\t\treturn transformedEntry;\n\t}\n}\n","import { TOGGLE_FILTERS_AREA_ACTION_ID } from '../actions';\n\n/**\n * Pills get a focus handler defined by behavior-focus, this method waits for that to happen for the first pill\n * @param container\n * @return {Promise<unknown>}\n */\nconst getFirstFocusablePill = (container, timeout) =>\n\tnew Promise((accept) => {\n\t\tlet tries = 0;\n\t\tconst interval = 10;\n\t\tconst maxTries = Math.ceil(timeout / interval);\n\t\tconst handler = setInterval(() => {\n\t\t\ttries++;\n\t\t\tconst firstPopover = container.querySelector('now-popover');\n\t\t\tif (firstPopover) {\n\t\t\t\tconst nowPill = firstPopover.querySelector('button');\n\t\t\t\tif (nowPill) {\n\t\t\t\t\tclearInterval(handler);\n\t\t\t\t\taccept(nowPill);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (tries === maxTries) {\n\t\t\t\tclearInterval(handler);\n\t\t\t\taccept(null);\n\t\t\t}\n\t\t}, interval);\n\t});\n\nexport const TOGGLE_FILTERS_AREA_BEHAVIOR = {\n\tname: 'activity_toggle_filters',\n\tactionHandlers: {\n\t\t['NOW_BUTTON_ICONIC#CLICKED']: {\n\t\t\teffect: (coeffects) => {\n\t\t\t\tconst {\n\t\t\t\t\taction: {\n\t\t\t\t\t\tpayload: { activityAction = '' }\n\t\t\t\t\t},\n\t\t\t\t\tstate: { filtersOpen = false },\n\t\t\t\t\tproperties: { nowId },\n\t\t\t\t\tupdateState,\n\t\t\t\t\thost\n\t\t\t\t} = coeffects;\n\n\t\t\t\tif (!activityAction || activityAction !== TOGGLE_FILTERS_AREA_ACTION_ID)\n\t\t\t\t\treturn;\n\n\t\t\t\tupdateState({ filtersOpen: !filtersOpen, filtersHaveBeenFocused: false });\n\n\t\t\t\tif (filtersOpen)\n\t\t\t\t\treturn;\n\n\t\t\t\tconst pillsContainer = host.shadowRoot.getElementById(`${nowId}_pills_section`);\n\t\t\t\tgetFirstFocusablePill(pillsContainer, 100).then((nowPill) => {\n\t\t\t\t\tif (!nowPill)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t//needed for safari\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tnowPill.focus();\n\t\t\t\t\t\tupdateState({ filtersHaveBeenFocused: true });\n\t\t\t\t\t}, 0);\n\t\t\t\t});\n\t\t\t},\n\t\t\tstopPropagation: true\n\t\t}\n\t}\n};\n","// noinspection ES6CheckImport\nimport { actionTypes } from '@servicenow/ui-core';\nimport { findIndex } from 'lodash';\nimport { AS_POPOVER_PANEL_OPENED_ACTION, AS_POPOVER_PANEL_CLOSED_ACTION } from '../activity/actions';\nconst { COMPONENT_PROPERTY_CHANGED, COMPONENT_DISCONNECTED } = actionTypes;\n\nconst COMPONENT_HOIST_PROP = 'nowHoist';\nconst ACCESSIBLE_POPOVER_UPDATE_FOCUSED_ITEM = 'ACCESSIBLE_POPOVER_UPDATE_FOCUSED_ITEM';\nconst ACCESSIBLE_POPOVER_BLUR_FOCUSED_ITEM = 'ACCESSIBLE_POPOVER_BLUR_FOCUSED_ITEM';\nconst focusableElementsByNowId = new Map();\nconst currentFocusedIndexByNowId = new Map();\nconst handlersByNowIdAndElement: Map<string, WeakMap<Object, Object>> = new Map();\n\nconst createListeners = (coeffects, elem, elementIndex) => {\n\tconst {\n\t\taction: {\n\t\t\tpayload: {\n\t\t\t\toptions: { currentFocusableStateKey = null }\n\t\t\t}\n\t\t},\n\t\tproperties: { nowId },\n\t\tdispatch\n\t} = coeffects;\n\n\tconst handlers = new Map();\n\tif (!handlersByNowIdAndElement.has(nowId))\n\t\thandlersByNowIdAndElement.set(nowId, new WeakMap());\n\tconst handlerMap = handlersByNowIdAndElement.get(nowId);\n\thandlerMap.set(elem, handlers);\n\n\thandlers.set('click', () => {\n\t\tcurrentFocusedIndexByNowId.set(nowId, elementIndex);\n\t});\n\telem.addEventListener('click', handlers.get('click'));\n\n\tif (!currentFocusableStateKey)\n\t\treturn;\n\n\thandlers.set('focus', () => {\n\t\tconst key = elem.dataset.focusable;\n\t\tdispatch(ACCESSIBLE_POPOVER_UPDATE_FOCUSED_ITEM, { key });\n\t});\n\telem.addEventListener('focus', handlers.get('focus'));\n\n\thandlers.set('blur', () => {\n\t\tconst key = elem.dataset.focusable;\n\t\tdispatch(ACCESSIBLE_POPOVER_BLUR_FOCUSED_ITEM, { key });\n\t});\n\telem.addEventListener('blur', handlers.get('blur'));\n};\n\nconst removeListeners = (coeffects) => {\n\tconst {\n\t\tproperties: { nowId }\n\t} = coeffects;\n\tconst focusables = focusableElementsByNowId.get(nowId);\n\n\tif (!focusables)\n\t\treturn;\n\n\tfocusables.forEach((element) => {\n\t\tconst handlersByElement = handlersByNowIdAndElement.get(nowId);\n\t\tconst handlers = handlersByElement.get(element);\n\t\tif (handlers) {\n\t\t\t['click', 'focus', 'blur'].forEach((eventType) => {\n\t\t\t\tif (handlers.has(eventType))\n\t\t\t\t\telement.removeEventListener(eventType, handlers.get(eventType));\n\t\t\t});\n\t\t\thandlersByElement.delete(element);\n\t\t}\n\t});\n};\n\nconst updateFocusedItem = (coeffects, isFocusing) => {\n\tconst {\n\t\tupdateState,\n\t\taction: {\n\t\t\tpayload: {\n\t\t\t\tkey,\n\t\t\t\toptions: { currentFocusableStateKey = null }\n\t\t\t}\n\t\t}\n\t} = coeffects;\n\n\tif (!currentFocusableStateKey)\n\t\treturn;\n\n\tif (!isFocusing && key !== coeffects.state[currentFocusableStateKey])\n\t\treturn;\n\n\tupdateState({ [currentFocusableStateKey]: isFocusing ? key : null });\n};\n\n/**\n * Creates focus trap and key handles for focus management on a pop-over panel\n *\n * Usage:\n * Add the attribute data-focusable to each element in the panel that can receive focus, optionally assign a value to it,\n * the value will come back in the state in the prop defined by the currentFocusableStateKey option,\n * indicating the current focused value.\n *\n * ```\n * {\n * \t\tbehavior: AccessiblePopoverPanelBehavior,\n * \t\toptions: {\n * \t\t\t   getPanelReference: (nowId) => {},\n * \t\t \t   getInitialFocusElement: (documentRoot) => {},\n * \t\t \t   currentFocusableStateKey: \"current_focused_key\"\n * \t\t}\n * }\n * ```\n *\n * Options:\n * getPanelReference:  Function of type (nowId) => {}. Should return the popover panel reference\n * getInitialFocusElement: Function of type (documentRoot) => {}. Should return the first element to focus when the panel is opened\n * currentFocusableStateKey: Optional String, will be used as a key to store the current data-focusable value of the focused item\n *\n */\nexport const AccessiblePopoverPanelBehavior = {\n\tname: 'accessiblePopoverPanelBehavior',\n\teventHandlers: [\n\t\t{\n\t\t\tevents: ['keydown'],\n\t\t\teffect: (coeffects) => {\n\t\t\t\tconst {\n\t\t\t\t\taction: {\n\t\t\t\t\t\tpayload: { event }\n\t\t\t\t\t},\n\t\t\t\t\tproperties: { nowId }\n\t\t\t\t} = coeffects;\n\n\t\t\t\tconst elements = focusableElementsByNowId.get(nowId);\n\t\t\t\tif (elements.length === 0)\n\t\t\t\t\treturn;\n\t\t\t\tconst currentIndex = currentFocusedIndexByNowId.get(nowId) || 0;\n\t\t\t\tconst nextIndex = currentIndex === elements.length - 1 ? 0 : currentIndex + 1;\n\t\t\t\tconst prevIndex = currentIndex === 0 ? elements.length - 1 : currentIndex - 1;\n\n\t\t\t\tconst focusPrevious = () => {\n\t\t\t\t\telements[prevIndex].focus();\n\t\t\t\t\tcurrentFocusedIndexByNowId.set(nowId, prevIndex);\n\t\t\t\t};\n\n\t\t\t\tconst focusNext = () => {\n\t\t\t\t\telements[nextIndex].focus();\n\t\t\t\t\tcurrentFocusedIndexByNowId.set(nowId, nextIndex);\n\t\t\t\t};\n\n\t\t\t\tconst isRTL = document.dir === 'rtl';\n\t\t\t\tconst actionsByKey = {\n\t\t\t\t\t['ArrowUp']: focusPrevious,\n\t\t\t\t\t['ArrowLeft']: isRTL ? focusNext : focusPrevious,\n\t\t\t\t\t['ArrowDown']: focusNext,\n\t\t\t\t\t['ArrowRight']: isRTL ? focusPrevious : focusNext,\n\t\t\t\t\t['Enter']: () => {\n\t\t\t\t\t\tconst path = event.composedPath();\n\t\t\t\t\t\tif (!path || path.length === 0)\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\tpath[0].click();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tconst eventKey = event.key;\n\t\t\t\tif (actionsByKey[eventKey]) {\n\t\t\t\t\tactionsByKey[eventKey]();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t],\n\tactionHandlers: {\n\t\t[ACCESSIBLE_POPOVER_BLUR_FOCUSED_ITEM]: {\n\t\t\teffect: (coeffects) => updateFocusedItem(coeffects, false),\n\t\t\tstopPropagation: true\n\t\t},\n\t\t[ACCESSIBLE_POPOVER_UPDATE_FOCUSED_ITEM]: {\n\t\t\teffect: (coeffects) => updateFocusedItem(coeffects, true),\n\t\t\tstopPropagation: true\n\t\t},\n\t\t[COMPONENT_PROPERTY_CHANGED]: {\n\t\t\teffect: (coeffects) => {\n\t\t\t\tconst {\n\t\t\t\t\taction: {\n\t\t\t\t\t\tpayload: { name, value, previousValue }\n\t\t\t\t\t},\n\t\t\t\t\tdispatch\n\t\t\t\t} = coeffects;\n\n\t\t\t\tif (name !== COMPONENT_HOIST_PROP)\n\t\t\t\t\treturn;\n\t\t\t\tconst opening = !previousValue && value;\n\t\t\t\tdispatch(opening ? AS_POPOVER_PANEL_OPENED_ACTION : AS_POPOVER_PANEL_CLOSED_ACTION);\n\t\t\t}\n\t\t},\n\t\t[AS_POPOVER_PANEL_CLOSED_ACTION]: {\n\t\t\teffect: (coeffects) => {\n\t\t\t\tremoveListeners(coeffects);\n\t\t\t},\n\t\t\tstopPropagation: true\n\t\t},\n\t\t[AS_POPOVER_PANEL_OPENED_ACTION]: {\n\t\t\teffect: (coeffects) => {\n\t\t\t\tconst {\n\t\t\t\t\taction: {\n\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\toptions: { getPanelReference = null, getInitialFocusElement = null }\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tproperties: { nowId }\n\t\t\t\t} = coeffects;\n\n\t\t\t\tif (!getPanelReference)\n\t\t\t\t\treturn;\n\n\t\t\t\tconst panel = getPanelReference(nowId);\n\t\t\t\tconst focusables = panel.querySelectorAll('[data-focusable]');\n\t\t\t\tif (focusables.length === 0)\n\t\t\t\t\treturn;\n\t\t\t\tfocusableElementsByNowId.set(nowId, focusables);\n\n\t\t\t\tfocusables.forEach((elem, index) => createListeners(coeffects, elem, index));\n\n\t\t\t\tconst elementToFocus = !getInitialFocusElement\n\t\t\t\t\t? focusables[0]\n\t\t\t\t\t: getInitialFocusElement(panel) || focusables[0];\n\t\t\t\tcurrentFocusedIndexByNowId.set(\n\t\t\t\t\tnowId,\n\t\t\t\t\tfindIndex(focusables, (elem) => elem === elementToFocus)\n\t\t\t\t);\n\n\t\t\t\t//When opening with keyboard using \"Enter\" can also trigger the option change if focus happens first,\n\t\t\t\t//timeout prevents that and also corrects problems due to the hoisting of the element.\n\t\t\t\tsetTimeout(() => elementToFocus.focus(), 100);\n\t\t\t},\n\t\t\tstopPropagation: true\n\t\t},\n\t\t[COMPONENT_DISCONNECTED]: {\n\t\t\teffect: (coeffects) => {\n\t\t\t\tconst {\n\t\t\t\t\tproperties: { nowId }\n\t\t\t\t} = coeffects;\n\n\t\t\t\tremoveListeners(coeffects);\n\t\t\t\thandlersByNowIdAndElement.delete(nowId);\n\t\t\t\tfocusableElementsByNowId.delete(nowId);\n\t\t\t\tcurrentFocusedIndexByNowId.delete(nowId);\n\t\t\t}\n\t\t}\n\t}\n};\n","import SeismicComponent from '../../shared/SeismicComponent';\nimport { createCustomElement } from '@servicenow/ui-core';\nimport '@servicenow/now-button';\nimport '@servicenow/now-checkbox';\nimport { CLEAR_ALL, SELECT_ALL, N_OPTIONS_AVAILABLE } from '../translations';\nimport styles from './_pill-panel.scss';\nimport { AccessiblePopoverPanelBehavior } from '../../shared/AccessiblePopoverPanelBehavior';\n\nexport const AS_ACTION_MULTI_SELECT_PILL_FILTERS = 'AS_ACTION_MULTI_SELECT_PILL_FILTERS';\nexport const AS_ACTION_CLOSE_PILL = 'AS_ACTION_CLOSE_PILL';\nexport const AS_ACTION_CHANGE_FILTER_OPTION = 'AS_ACTION_CHANGE_FILTER_OPTION';\n\nconst PILL_PANEL_TAG = 'sn-pill-panel';\n\nconst propertyDefs = {\n\ttitle: { default: '' },\n\tfilterOptions: { default: [] }\n};\nconst panelReferences = new Map();\nconst CURRENT_FOCUSED_KEY = 'popoverCurrentFocusedKey';\n\nexport class PillPanel extends SeismicComponent {\n\tgetComponentName() {\n\t\treturn PILL_PANEL_TAG;\n\t}\n\n\tgetPropertyDefinitions(): {} {\n\t\treturn propertyDefs;\n\t}\n\n\tgetStyles(): string {\n\t\treturn styles;\n\t}\n\n\tgetBehaviors() {\n\t\t// noinspection JSUnusedGlobalSymbols\n\t\treturn [\n\t\t\t{\n\t\t\t\tbehavior: AccessiblePopoverPanelBehavior,\n\t\t\t\toptions: {\n\t\t\t\t\tgetPanelReference: (nowId) => panelReferences.get(nowId),\n\t\t\t\t\tcurrentFocusableStateKey: CURRENT_FOCUSED_KEY\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\t// noinspection JSCheckFunctionSignatures\n\tgetView(state) {\n\t\tconst {\n\t\t\tproperties: { title, filterOptions, nowId }\n\t\t} = state;\n\n\t\tconst focusedKey = state[CURRENT_FOCUSED_KEY];\n\n\t\tconst fieldNames = new Set();\n\t\tconst itemsToRender = filterOptions.map((filterOption, index) => {\n\t\t\tconst { label, selected, name } = filterOption;\n\t\t\tfieldNames.add(name);\n\t\t\tconst key = `${nowId}_option_${index}`;\n\t\t\tconst className = focusedKey === key ? 'check-box focused' : 'check-box';\n\t\t\treturn (\n\t\t\t\t<li role=\"menuitem\" className=\"filter-option\" key={key}>\n\t\t\t\t\t<now-checkbox\n\t\t\t\t\t\tdata-focusable={key}\n\t\t\t\t\t\tclassName={className}\n\t\t\t\t\t\tchecked={selected}\n\t\t\t\t\t\tlabel={label}\n\t\t\t\t\t\tconfigAria={{ checkbox: { 'aria-label': label } }}\n\t\t\t\t\t\tappendToPayload={{\n\t\t\t\t\t\t\tactivityAction: AS_ACTION_CHANGE_FILTER_OPTION,\n\t\t\t\t\t\t\tfieldName: name\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</li>\n\t\t\t);\n\t\t});\n\n\t\treturn (\n\t\t\t<div className=\"as-filter-options-panel\" ref={(node) => panelReferences.set(nowId, node)}>\n\t\t\t\t<section className=\"as-filter-options-header\">\n\t\t\t\t\t<section className=\"title\">\n\t\t\t\t\t\t<now-heading label={title} level=\"3\" variant=\"header-tertiary\" has-no-margin />\n\t\t\t\t\t</section>\n\t\t\t\t</section>\n\t\t\t\t<ul className=\"as-filter-options\" aria-label={N_OPTIONS_AVAILABLE(itemsToRender.length + 2)}>\n\t\t\t\t\t<li role=\"menuitem\" className=\"sub-header-option\">\n\t\t\t\t\t\t<now-button-bare\n\t\t\t\t\t\t\tdata-focusable\n\t\t\t\t\t\t\tappendToPayload={{\n\t\t\t\t\t\t\t\tactivityAction: AS_ACTION_MULTI_SELECT_PILL_FILTERS,\n\t\t\t\t\t\t\t\tfieldNames,\n\t\t\t\t\t\t\t\tselect: 'all'\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tlabel={SELECT_ALL}\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\thidePadding\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tconfigAria={{ button: { 'aria-label': SELECT_ALL } }}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li className=\"sub-header-option separator\">|</li>\n\t\t\t\t\t<li role=\"menuitem\" className=\"sub-header-option\">\n\t\t\t\t\t\t<now-button-bare\n\t\t\t\t\t\t\tdata-focusable\n\t\t\t\t\t\t\tappendToPayload={{\n\t\t\t\t\t\t\t\tactivityAction: AS_ACTION_MULTI_SELECT_PILL_FILTERS,\n\t\t\t\t\t\t\t\tfieldNames,\n\t\t\t\t\t\t\t\tselect: 'none'\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tlabel={CLEAR_ALL}\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\thidePadding\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tconfigAria={{ button: { 'aria-label': CLEAR_ALL } }}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</li>\n\t\t\t\t\t{itemsToRender}\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nconst pillPanel = new PillPanel();\ncreateCustomElement(PILL_PANEL_TAG, {\n\t...pillPanel.getCustomElementParts(),\n\tproperties: propertyDefs\n});\nexport default pillPanel.getComponentName();\n","import { some } from 'lodash';\n\nexport const processFilterOptions = (filterOptions, quickFilterSelections, predicate) => {\n\tlet isFiltering = false;\n\tlet filterCount = 0;\n\tconst newOptions = filterOptions.map((filterOption) => {\n\t\tconst selected = predicate ? predicate(filterOption) : filterOption.selected;\n\t\tif (!selected) {\n\t\t\tisFiltering = true;\n\t\t\tfilterCount++;\n\t\t}\n\t\treturn {\n\t\t\t...filterOption,\n\t\t\tselected\n\t\t};\n\t});\n\tconst hasQuickFiltersApplied = some(Object.keys(quickFilterSelections || {}), (key) => quickFilterSelections[key]);\n\treturn {\n\t\tfilterOptions: newOptions,\n\t\tquickFilterSelections,\n\t\tisFiltering: isFiltering || hasQuickFiltersApplied,\n\t\thasQuickFiltersApplied,\n\t\tfilterCount\n\t};\n};\n","import { ACCESSIBLE_PILL_LABEL, FIELD_CHANGES, POST_TYPES } from '../translations';\nimport PillPanel from './PillPanel';\nimport { AS_ACTION_CHANGE_FILTER_OPTION, AS_ACTION_CLOSE_PILL, AS_ACTION_MULTI_SELECT_PILL_FILTERS } from './PillPanel';\nimport { AS_FILTER_CHANGED_ACTION } from '../actions';\nimport { processFilterOptions } from './filter-utils';\nimport { FIELD_CHANGES_FILTER_FIELD } from '../constants';\n\nconst AS_ACTION_TOGGLE_PILL = 'AS_ACTION_TOGGLE_PILL';\nconst togglePillActionHandler = (coeffects) => {\n\tconst {\n\t\taction: {\n\t\t\tpayload: { activityAction = '', pill }\n\t\t},\n\t\tstate: { openedPill = '' },\n\t\tupdateState\n\t} = coeffects;\n\n\tif (!activityAction || activityAction !== AS_ACTION_TOGGLE_PILL)\n\t\treturn;\n\n\tupdateState({ openedPill: openedPill === pill ? '' : pill });\n};\n\nconst changeFilterOptionHandler = (coeffects) => {\n\tconst {\n\t\tstate: { filterOptions, quickFilterSelections },\n\t\taction: {\n\t\t\tpayload: { value, fieldName, activityAction = '' }\n\t\t},\n\t\tupdateState,\n\t\tdispatch\n\t} = coeffects;\n\n\tif (activityAction !== AS_ACTION_CHANGE_FILTER_OPTION)\n\t\treturn;\n\n\tconst filterStatus = processFilterOptions(filterOptions, quickFilterSelections, (filterOption) =>\n\t\tfilterOption.name === fieldName ? value : filterOption.selected\n\t);\n\n\tdispatch(AS_FILTER_CHANGED_ACTION, { filterOptions: filterStatus.filterOptions });\n\tupdateState({ ...filterStatus, lastUpdateTimestamp: Date.now() });\n};\n\nconst multiSelectPillFiltersActionHandler = (coeffects) => {\n\tconst {\n\t\tstate: { filterOptions, quickFilterSelections },\n\t\tupdateState,\n\t\tdispatch,\n\t\taction: {\n\t\t\tpayload: { activityAction = '', fieldNames, select }\n\t\t}\n\t} = coeffects;\n\n\tif (!activityAction || activityAction !== AS_ACTION_MULTI_SELECT_PILL_FILTERS)\n\t\treturn null;\n\n\tconst newQuickFilterSelections = select === 'reset' ? {} : quickFilterSelections;\n\tconst filterStatus = processFilterOptions(filterOptions, newQuickFilterSelections, (filterOption) =>\n\t\tfieldNames.has(filterOption.name) ? select === 'all' || select === 'reset' : filterOption.selected\n\t);\n\n\tdispatch(AS_FILTER_CHANGED_ACTION, {\n\t\tfilterOptions: filterStatus.filterOptions,\n\t\tquickFilterSelections: newQuickFilterSelections\n\t});\n\tupdateState({\n\t\t...filterStatus,\n\t\tlastUpdateTimestamp: Date.now()\n\t});\n};\n\nconst closePillActionHandler = (coeffects) => {\n\tconst {\n\t\taction: {\n\t\t\tpayload: { activityAction }\n\t\t},\n\t\tupdateState\n\t} = coeffects;\n\n\tif (activityAction !== AS_ACTION_CLOSE_PILL)\n\t\treturn;\n\n\tupdateState({\n\t\topenedPill: ''\n\t});\n};\n\nconst clickOutsideCloseHandler = (coeffects) => {\n\tconst {\n\t\taction: {\n\t\t\tpayload: { value }\n\t\t},\n\t\tupdateState\n\t} = coeffects;\n\n\tif (!value)\n\t\tupdateState({\n\t\t\topenedPill: ''\n\t\t});\n};\n\nexport const FILTER_PILL_BEHAVIOR = {\n\tname: 'activity_filter_pill_behavior',\n\tactionHandlers: {\n\t\t['NOW_BUTTON#CLICKED']: { effect: togglePillActionHandler, stopPropagation: true },\n\t\t['NOW_CHECKBOX#CHECKED_SET']: { effect: changeFilterOptionHandler, stopPropagation: true },\n\t\t['NOW_BUTTON_ICONIC#CLICKED']: { effect: closePillActionHandler, stopPropagation: true },\n\t\t['NOW_BUTTON_BARE#CLICKED']: { effect: multiSelectPillFiltersActionHandler, stopPropagation: true },\n\t\t['NOW_POPOVER#OPENED_SET']: { effect: clickOutsideCloseHandler, stopPropagation: true }\n\t}\n};\n\nconst OOB_POST_TYPES = new Set([\n\t'comments',\n\t'work_notes',\n\t'*Attachments*',\n\t'*Email*',\n\t'*Relations*',\n\tFIELD_CHANGES_FILTER_FIELD\n]);\nexport const isPostTypeOption = (filterOption) => OOB_POST_TYPES.has(filterOption.name) || filterOption.journal;\n\nconst getFilterOptions = (state) => {\n\tconst { filterOptions } = state;\n\tconst optionsByPill = new Map();\n\tfilterOptions.forEach((filterOption) => {\n\t\tconst pill = isPostTypeOption(filterOption) ? POST_TYPES : FIELD_CHANGES;\n\t\tif (!optionsByPill.has(pill))\n\t\t\toptionsByPill.set(pill, []);\n\t\toptionsByPill.get(pill).push({ ...filterOption });\n\t});\n\treturn optionsByPill;\n};\n\nconst renderPopOverPill = (state, pillTitle, dispatch, popoverClassName) => {\n\tconst { openedPill = '' } = state;\n\tconst mappedByPill = getFilterOptions(state);\n\tconst options = mappedByPill.get(pillTitle) || [];\n\n\tlet filterCount = options.length;\n\toptions.forEach((filterOption) => {\n\t\tif (!filterOption.selected)\n\t\t\tfilterCount--;\n\t});\n\n\tconst downArrow = '\\u{25BE}';\n\tconst countText = filterCount < options.length ? ` (${filterCount})` : '';\n\tconst title = `${pillTitle}${countText} ${downArrow}`;\n\tconst opened = openedPill === pillTitle;\n\tconst selected = opened || filterCount < options.length;\n\tconst accessibleTitle = countText !== '' ? ACCESSIBLE_PILL_LABEL(pillTitle, countText) : pillTitle;\n\n\t// noinspection JSXNamespaceValidation\n\treturn (\n\t\t<now-popover\n\t\t\thide-tail\n\t\t\tinteraction-type={'listbox'}\n\t\t\taria-label={accessibleTitle}\n\t\t\tappendToPayload={{ activityAction: AS_ACTION_TOGGLE_PILL, pill: pillTitle }}\n\t\t\tclassName={`now-pill -md ${selected ? 'is-selected' : ''} ${popoverClassName}`}\n\t\t>\n\t\t\t<button\n\t\t\t\trole=\"menu\"\n\t\t\t\taria-label={pillTitle}\n\t\t\t\taria-haspopup=\"true\"\n\t\t\t\taria-expanded={opened ? 'true' : 'false'}\n\t\t\t\tslot=\"trigger\"\n\t\t\t\tclassName=\"now-pill-button\"\n\t\t\t\ton-click={() =>\n\t\t\t\t\tdispatch('NOW_BUTTON#CLICKED', { activityAction: AS_ACTION_TOGGLE_PILL, pill: pillTitle })\n\t\t\t\t}\n\t\t\t>\n\t\t\t\t{title}\n\t\t\t</button>\n\t\t\t<PillPanel slot=\"content\" title={pillTitle} filterOptions={options} />\n\t\t</now-popover>\n\t);\n};\n\nexport const renderFilterOptionPills = (state, dispatch) => {\n\tlet toRender = [];\n\tconst mappedByPill = getFilterOptions(state);\n\tif (mappedByPill.has(POST_TYPES))\n\t\ttoRender.push(renderPopOverPill(state, POST_TYPES, dispatch, 'post-types'));\n\tif (mappedByPill.has(FIELD_CHANGES))\n\t\ttoRender.push(renderPopOverPill(state, FIELD_CHANGES, dispatch, 'field-changes'));\n\treturn toRender;\n};\n","import ActivityDto from '../ActivityDto';\nimport { FIELD_CHANGES_FILTER_FIELD } from '../constants';\nimport { jsonStringToObject } from '../../shared/utils';\n\nconst transformAuditEvent = (event: ActivityDto, selectedFields) => {\n\tconst payload = jsonStringToObject(event.payload);\n\tconst auditValues = [];\n\tconst originalAuditValue = payload['auditValues'] || [];\n\toriginalAuditValue.forEach((auditValue) => {\n\t\tconst field = auditValue.fieldName;\n\t\tif (selectedFields.has(field))\n\t\t\tauditValues.push(auditValue);\n\t});\n\n\tif (auditValues.length === 0)\n\t\treturn null;\n\n\treturn {\n\t\t...event,\n\t\tpayload: {\n\t\t\t...payload,\n\t\t\tauditValues\n\t\t}\n\t};\n};\n\nconst isFieldChangeEvent = (event) => event.documentTable === event.eventTable;\nconst getFilterFieldForEvent = (event) => {\n\tconst map = {\n\t\tsys_journal_field: event.subtype,\n\t\tsys_audit_relation: '*Relations*',\n\t\tsys_email: '*Email*',\n\t\tsys_attachment: '*Attachments*'\n\t};\n\n\tif (isFieldChangeEvent(event))\n\t\treturn FIELD_CHANGES_FILTER_FIELD;\n\n\treturn map[event.eventTable] || ''; //default to be discussed will serve to filter dynamic tiles\n};\n\nconst transformEvent = (event: ActivityDto, isFiltering, selectedFields, availableFields) => {\n\tconst eventField = getFilterFieldForEvent(event);\n\tif (!isFieldChangeEvent(event))\n\t\treturn selectedFields.has(eventField) ? event : null;\n\tif (\n\t\tisFiltering &&\n\t\tavailableFields.has(FIELD_CHANGES_FILTER_FIELD) &&\n\t\t!selectedFields.has(FIELD_CHANGES_FILTER_FIELD)\n\t)\n\t\treturn null;\n\treturn transformAuditEvent(event, selectedFields);\n};\n\nexport const transformAndFilterEvents = (events: ActivityDto[], filterOptions, isFiltering) => {\n\tif (!filterOptions || filterOptions.length === 0)\n\t\treturn events;\n\n\tconst selectedFields = new Set();\n\tconst availableFields = new Set();\n\tfilterOptions.forEach((option) => {\n\t\tif (option.selected)\n\t\t\tselectedFields.add(option.name);\n\t\tavailableFields.add(option.name);\n\t});\n\n\treturn events\n\t\t.map((event) => transformEvent(event, isFiltering, selectedFields, availableFields))\n\t\t.filter((event) => event !== null);\n};\n","import { CONVERSATION, CONVERSATION_SUBLABEL, FILTER_SETS } from '../translations';\nimport { AS_FILTER_CHANGED_ACTION } from '../actions';\nimport { processFilterOptions } from './filter-utils';\nimport { isPostTypeOption } from './PopOverPill';\n\nconst AS_ACTION_APPLY_FILTER_SET = 'AS_ACTION_APPLY_FILTER_SET';\n\nconst getPresetOptions = () => {\n\t// eslint-disable-next-line no-unused-vars\n\treturn [{ id: CONVERSATION, label: CONVERSATION, sublabel: CONVERSATION_SUBLABEL }];\n};\n\nconst getSelection = (field) => {\n\tif (!isPostTypeOption(field))\n\t\treturn field.selected;\n\treturn field.journal || field.name === '*Email*';\n};\n\nconst handlers = {\n\t[CONVERSATION]: (coeffects) => {\n\t\tconst {\n\t\t\tstate: { filterOptions, quickFilterSelections },\n\t\t\tupdateState,\n\t\t\tdispatch\n\t\t} = coeffects;\n\t\tconst filterStatus = processFilterOptions(filterOptions, quickFilterSelections, getSelection);\n\t\tdispatch(AS_FILTER_CHANGED_ACTION, { filterOptions: filterStatus.filterOptions, quickFilterSelections });\n\t\tupdateState({ ...filterStatus, lastUpdateTimestamp: Date.now() });\n\t}\n};\n\nexport const renderFilterSets = (state) => {\n\tconst {\n\t\tproperties: { showConversationFilter }\n\t} = state;\n\n\tif (!showConversationFilter)\n\t\treturn '';\n\n\treturn (\n\t\t<now-dropdown\n\t\t\titems={getPresetOptions()}\n\t\t\tselectedItems={[]}\n\t\t\ticon=\"\"\n\t\t\tplaceholder={FILTER_SETS}\n\t\t\ttooltipContent={FILTER_SETS}\n\t\t\tsize=\"md\"\n\t\t\tvariant=\"tertiary\"\n\t\t\tselect=\"none\"\n\t\t\tbare\n\t\t\tpanelFitProps={{}}\n\t\t\tconfigAria={{}}\n\t\t\tappendToPayload={{ activityAction: AS_ACTION_APPLY_FILTER_SET }}\n\t\t/>\n\t);\n};\n\nexport const FILTER_SETS_BEHAVIOR = {\n\tname: 'activity_filter_sets_behavior',\n\tactionHandlers: {\n\t\t['NOW_DROPDOWN#ITEM_CLICKED']: {\n\t\t\teffect: (coeffects) => {\n\t\t\t\tconst {\n\t\t\t\t\taction: {\n\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\tactivityAction,\n\t\t\t\t\t\t\titem: { id }\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} = coeffects;\n\n\t\t\t\tif (activityAction !== AS_ACTION_APPLY_FILTER_SET)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (handlers[id])\n\t\t\t\t\thandlers[id](coeffects);\n\t\t\t},\n\t\t\tstopPropagation: true\n\t\t}\n\t}\n};\n","import { QuickFilter } from './QuickFilter';\nimport ActivityDto from '../../ActivityDto';\nimport { isTrue } from '../../../shared/utils';\nimport { FLAGGED } from '../../translations';\n\nclass FlaggedQuickFilter extends QuickFilter {\n\tgetIcon() {\n\t\treturn 'flag-outline';\n\t}\n\n\tgetLabel() {\n\t\treturn FLAGGED;\n\t}\n\n\tgetQuickFilterId() {\n\t\treturn 'flagged-quick-filter';\n\t}\n\n\tgetEventIsOfQuickFilterType(event: ActivityDto, tilePayload, tileSupplemental) {\n\t\treturn isTrue(tileSupplemental.flag);\n\t}\n}\n\nexport default new FlaggedQuickFilter();\n","export class QuickFilter {\n\t/**\n\t * Returns unique name for filter (defines key for quick-filter in supplemental table)\n\t * @abstract\n\t * @return string\n\t */\n\tgetQuickFilterId() {\n\t\tconsole.error('getQuickFilterId on quick filter not implemented');\n\t}\n\n\t/**\n\t * Icon to use for the pill\n\t * @abstract\n\t * @return string\n\t */\n\tgetIcon() {\n\t\tconsole.error('getIcon on quick filter not implemented');\n\t}\n\n\t/**\n\t * Text to use for the pill\n\t * @abstract\n\t * @return string\n\t */\n\tgetLabel() {\n\t\tconsole.error('getLabel on quick filter not implemented');\n\t}\n\n\t/* eslint-disable no-unused-vars */\n\t/**\n\t * Decides if an event is affected by the quick filter\n\t * @abstract\n\t * @return boolean\n\t */\n\tgetEventIsOfQuickFilterType(event, tilePayload, tileSupplemental) {\n\t\tconsole.error('getEventIsOfQuickFilterType on quick filter not implemented');\n\t}\n\t/* eslint-enable no-unused-vars */\n}\n","import flaggedQuickFilter from './quick-filters/FlaggedQuickFilter';\nimport { registerSupplementalBehavior } from '../../activity-connected/supplementalDataBehavior';\nimport { processFilterOptions } from './filter-utils';\nimport { some } from 'lodash';\nimport ActivityDto from '../ActivityDto';\nimport { AS_QUICK_FILTER_CHANGED_ACTION, AS_QUICK_FILTER_CHANGED_ACTION_IS_PRIVATE } from '../actions';\nimport {\n\tAS_SAVE_QUICK_FILTER_SUCCEEDED_ACTION,\n\tAS_SAVE_QUICK_FILTER_FAILED_ACTION,\n\tAS_SAVE_QUICK_FILTER_ACTION_IS_PRIVATE\n} from '../../activity-connected/actions';\n\nconst AS_ACTION_EXEC_QUICK_FILTER = 'AS_ACTION_EXEC_QUICK_FILTER';\nconst quickFilters = [flaggedQuickFilter];\n\nregisterSupplementalBehavior({\n\tsaveAction: AS_QUICK_FILTER_CHANGED_ACTION,\n\tsaveSucceededAction: AS_SAVE_QUICK_FILTER_SUCCEEDED_ACTION,\n\tsaveFailedAction: AS_SAVE_QUICK_FILTER_FAILED_ACTION,\n\tisPrivate: AS_SAVE_QUICK_FILTER_ACTION_IS_PRIVATE\n});\n\nexport const shouldFilterOutEvent = (event: ActivityDto, quickFilterSelections, tilePayload, tileSupplemental) => {\n\tconst inQuickFilters = some(quickFilters, (quickFilter) => {\n\t\treturn (\n\t\t\tquickFilter.getEventIsOfQuickFilterType(event, tilePayload, tileSupplemental) &&\n\t\t\tquickFilterSelections[quickFilter.getQuickFilterId()]\n\t\t);\n\t});\n\treturn !inQuickFilters;\n};\n\nexport const renderQuickFilters = (state) => {\n\tconst { quickFilterSelections = {} } = state;\n\treturn quickFilters.map((quickFilter) => {\n\t\tconst id = quickFilter.getQuickFilterId();\n\t\treturn (\n\t\t\t<now-pill\n\t\t\t\tmanageSelected={true}\n\t\t\t\tselected={quickFilterSelections[id] || false}\n\t\t\t\tkey={id}\n\t\t\t\tlabel={quickFilter.getLabel()}\n\t\t\t\ticon={quickFilter.getIcon()}\n\t\t\t\tsize=\"md\"\n\t\t\t\tappendToPayload={{\n\t\t\t\t\tactivityAction: AS_ACTION_EXEC_QUICK_FILTER,\n\t\t\t\t\tid\n\t\t\t\t}}\n\t\t\t/>\n\t\t);\n\t});\n};\n\nexport const FILTER_QUICK_FILTERS_BEHAVIOR = {\n\tname: 'activity_quick_filters_behavior',\n\tactions: {\n\t\t[AS_QUICK_FILTER_CHANGED_ACTION]: { private: AS_QUICK_FILTER_CHANGED_ACTION_IS_PRIVATE }\n\t},\n\tactionHandlers: {\n\t\t['NOW_PILL#SELECTED_SET']: {\n\t\t\teffect: (coeffects) => {\n\t\t\t\tconst {\n\t\t\t\t\tproperties: { sysId },\n\t\t\t\t\taction: {\n\t\t\t\t\t\tpayload: { activityAction, id, value }\n\t\t\t\t\t},\n\t\t\t\t\tstate: { filterOptions, quickFilterSelections },\n\t\t\t\t\tdispatch,\n\t\t\t\t\tupdateState\n\t\t\t\t} = coeffects;\n\n\t\t\t\tif (activityAction !== AS_ACTION_EXEC_QUICK_FILTER)\n\t\t\t\t\treturn;\n\n\t\t\t\tconst newQuickFilterSelections = {\n\t\t\t\t\t...quickFilterSelections,\n\t\t\t\t\t[id]: value\n\t\t\t\t};\n\n\t\t\t\tupdateState({\n\t\t\t\t\t...processFilterOptions(filterOptions, newQuickFilterSelections),\n\t\t\t\t\tlastUpdateTimestamp: Date.now()\n\t\t\t\t});\n\n\t\t\t\tdispatch(AS_QUICK_FILTER_CHANGED_ACTION, {\n\t\t\t\t\tdocumentSysId: sysId,\n\t\t\t\t\teventId: '',\n\t\t\t\t\tpayload: JSON.stringify({ quickFilterSelections: newQuickFilterSelections })\n\t\t\t\t});\n\t\t\t},\n\t\t\tstopPropagation: true\n\t\t}\n\t}\n};\n","import {\n\tCLEAR_FILTERS_TOOLTIP,\n\tCLOSE_FILTERS,\n\tFIELD_CHANGES,\n\tFILTERS_APPLIED_OPEN,\n\tOPEN_FILTERS,\n\tRESET_FILTER\n} from '../translations';\nimport '@servicenow/now-pill';\nimport '@servicenow/now-popover';\nimport { TOGGLE_FILTERS_AREA_ACTION_ID } from '../actions';\nimport { TOGGLE_FILTERS_AREA_BEHAVIOR } from './FilterAreaBehavior';\nimport { FILTER_PILL_BEHAVIOR, renderFilterOptionPills, isPostTypeOption } from './PopOverPill';\nimport { transformAndFilterEvents } from './EventFilterTransformer';\nimport { AS_ACTION_MULTI_SELECT_PILL_FILTERS } from './PillPanel';\nimport { renderFilterSets, FILTER_SETS_BEHAVIOR } from './FilterSets';\nimport { FILTER_QUICK_FILTERS_BEHAVIOR, renderQuickFilters } from './QuickFilters';\nimport { processFilterOptions } from './filter-utils';\nimport { get } from 'lodash';\nimport { FIELD_CHANGES_FILTER_FIELD } from '../constants';\n\nconst clearButtonRefs = new Map();\n\nexport class ActivityFilter {\n\tstatic transformAndFilterEvents(events, filterOptions, isFiltering) {\n\t\treturn transformAndFilterEvents(events, filterOptions, isFiltering);\n\t}\n\n\tstatic getInitialFilterStatus(filterOptions, supplemental = {}) {\n\t\tconst filterOptionSelections = get(supplemental, 'document.filterOptions', {});\n\t\tlet hasFieldChanges = false;\n\t\tlet hasFieldChangesType = false;\n\t\tconst selectedOptions = filterOptions.map((option) => {\n\t\t\thasFieldChanges = hasFieldChanges || !isPostTypeOption(option);\n\t\t\thasFieldChangesType = hasFieldChangesType || option.name === FIELD_CHANGES_FILTER_FIELD;\n\t\t\treturn {\n\t\t\t\t...option,\n\t\t\t\tselected: get(filterOptionSelections, option.name, !!option.selected)\n\t\t\t};\n\t\t});\n\t\tif (hasFieldChanges && !hasFieldChangesType)\n\t\t\tselectedOptions.push({\n\t\t\t\tselected: get(filterOptionSelections, FIELD_CHANGES_FILTER_FIELD, true),\n\t\t\t\tname: FIELD_CHANGES_FILTER_FIELD,\n\t\t\t\tlabel: FIELD_CHANGES,\n\t\t\t\tjournal: false\n\t\t\t});\n\n\t\tconst quickFilterSelections = get(supplemental, 'document.quickFilterSelections', {});\n\t\treturn processFilterOptions(selectedOptions, quickFilterSelections);\n\t}\n\n\tstatic destroy(nowId) {\n\t\tclearButtonRefs.delete(nowId);\n\t}\n\n\tstatic renderClearAll(state) {\n\t\tconst {\n\t\t\tproperties: { nowId },\n\t\t\tisFiltering,\n\t\t\tfilterOptions = []\n\t\t} = state;\n\t\tif (!isFiltering)\n\t\t\treturn '';\n\n\t\tconst fieldNames = filterOptions.map((filterOption) => filterOption.name);\n\n\t\treturn (\n\t\t\t<section className=\"clear-all-wrap\">\n\t\t\t\t<now-button-bare\n\t\t\t\t\tappendToPayload={{\n\t\t\t\t\t\tactivityAction: AS_ACTION_MULTI_SELECT_PILL_FILTERS,\n\t\t\t\t\t\tfieldNames: new Set(fieldNames),\n\t\t\t\t\t\tselect: 'reset'\n\t\t\t\t\t}}\n\t\t\t\t\tlabel={RESET_FILTER}\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\tref={(elm) => clearButtonRefs.set(nowId, elm)}\n\t\t\t\t/>\n\t\t\t\t<now-tooltip target-ref={clearButtonRefs.get(nowId)} content={CLEAR_FILTERS_TOOLTIP} />\n\t\t\t</section>\n\t\t);\n\t}\n\n\tstatic renderFilterToggle(state) {\n\t\tconst {\n\t\t\tfiltersOpen,\n\t\t\tfiltersHaveBeenFocused = false,\n\t\t\tisFiltering,\n\t\t\tproperties: { nowId }\n\t\t} = state;\n\t\tconst tooltip =\n\t\t\tfiltersOpen && filtersHaveBeenFocused ? CLOSE_FILTERS : isFiltering ? FILTERS_APPLIED_OPEN : OPEN_FILTERS;\n\n\t\t// eslint-disable-next-line multiline-ternary\n\t\tconst filteringIcon = !isFiltering || filtersOpen ? '' : <now-icon-presence size=\"md\" presence=\"busy\" />;\n\t\tconst toggleIcon = filtersOpen ? 'filter-fill' : 'filter-outline';\n\t\t// noinspection JSXNamespaceValidation\n\t\treturn (\n\t\t\t<div className=\"filter-toggle-wrap\">\n\t\t\t\t<now-button-iconic\n\t\t\t\t\tbare={true}\n\t\t\t\t\ticon={toggleIcon}\n\t\t\t\t\ttooltipContent={tooltip}\n\t\t\t\t\tsize=\"md\"\n\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\tselected={filtersOpen}\n\t\t\t\t\tconfigAria={{\n\t\t\t\t\t\trole: 'button',\n\t\t\t\t\t\t'aria-label': tooltip,\n\t\t\t\t\t\t'aria-expanded': String(!!filtersOpen),\n\t\t\t\t\t\t'aria-controls': `${nowId}_pills_section`\n\t\t\t\t\t}}\n\t\t\t\t\tappendToPayload={{ activityAction: TOGGLE_FILTERS_AREA_ACTION_ID }}\n\t\t\t\t/>\n\t\t\t\t{filteringIcon}\n\t\t\t</div>\n\t\t);\n\t}\n\n\tstatic renderFilters(state, dispatch) {\n\t\tconst {\n\t\t\tfiltersOpen,\n\t\t\tproperties: { nowId }\n\t\t} = state;\n\t\tif (!filtersOpen)\n\t\t\treturn <section id={`${nowId}_pills_section`} />;\n\n\t\treturn (\n\t\t\t<section id={`${nowId}_pills_section`} className=\"filter-pills\">\n\t\t\t\t<section className=\"option-pills\">\n\t\t\t\t\t{renderFilterOptionPills(state, dispatch)}\n\t\t\t\t\t{renderQuickFilters(state)}\n\t\t\t\t</section>\n\t\t\t\t<section className=\"filter-sets\">{renderFilterSets(state)}</section>\n\t\t\t</section>\n\t\t);\n\t}\n\n\tstatic getFilterBehaviors() {\n\t\treturn [\n\t\t\tTOGGLE_FILTERS_AREA_BEHAVIOR,\n\t\t\tFILTER_PILL_BEHAVIOR,\n\t\t\tFILTER_SETS_BEHAVIOR,\n\t\t\tFILTER_QUICK_FILTERS_BEHAVIOR\n\t\t];\n\t}\n}\n","import { createGraphQLEffect } from '@servicenow/ui-effect-graphql';\nimport { actionTypes } from '@servicenow/ui-core';\nimport { get } from 'lodash';\nimport { AS_REQUEST_AMB_CONNECTIONS_ACTION } from '../activity/actions';\nimport {\n\tAS_FETCH_EMAIL_REPLIES_REQUESTED_ACTION,\n\tAS_FETCH_EMAIL_REPLIES_SUCCEEDED_ACTION,\n\tAS_FETCH_EMAIL_REPLIES_FAILED_ACTION,\n\tAS_FETCH_ACTIVITY_REQUESTED_ACTION,\n\tAS_FETCH_ACTIVITY_SUCCEEDED_ACTION,\n\tAS_FETCH_ACTIVITY_FAILED_ACTION,\n\tAS_FETCH_EMAIL_ATTACHMENTS_REQUESTED_ACTION\n} from './actions';\nimport { FULL_QUERY, EMAIL_REPLY_QUERY } from './activityQueries';\nimport UserReferenceDto from '../activity/UserReferenceDto';\nimport UserReferenceRepo from '../activity/UserReferenceRepo';\nimport AttachmentRepo from '../activity/AttachmentRepo';\nimport AttachmentDto from '../activity/AttachmentDto';\nimport DataTransformer from '../activity/DataTransformer';\nimport { ActivityFilter } from '../activity/activity-filter/ActivityFilter';\nimport ActivityDto from '../activity/ActivityDto';\nimport TilesRepo from '../activity/TilesRepo';\nimport { jsonStringToArray } from '../shared/utils';\n\nconst { COMPONENT_CONNECTED, COMPONENT_PROPERTY_CHANGED } = actionTypes;\nconst EMAIL_BODIES_PATH = 'data.GlideActivity_Query.getEmailBodies';\n\nconst parseSupplementalPayload = (payloadStr) => {\n\tif (!payloadStr)\n\t\treturn {};\n\n\ttry {\n\t\treturn JSON.parse(payloadStr);\n\t} catch (e) {\n\t\tconsole.error(`Failed to parse supplemental payload string: ${payloadStr}`, e);\n\t\treturn {};\n\t}\n};\n\nexport const addToSupplementalMap = (supplementalMap, data) => {\n\tif (!data)\n\t\treturn supplementalMap;\n\n\tconst { eventId, documentId, userSysId, payload } = data;\n\n\tconst parsed = parseSupplementalPayload(payload);\n\n\tif (eventId) {\n\t\tsupplementalMap.event[eventId] = {\n\t\t\t...supplementalMap.event[eventId],\n\t\t\t...parsed\n\t\t};\n\t\treturn supplementalMap;\n\t}\n\tif (documentId) {\n\t\tsupplementalMap.document = {\n\t\t\t...supplementalMap.document,\n\t\t\t...parsed\n\t\t};\n\t\treturn supplementalMap;\n\t}\n\tif (userSysId) {\n\t\tsupplementalMap.user = parsed;\n\t\treturn supplementalMap;\n\t}\n\n\tsupplementalMap.global = parsed;\n\n\treturn supplementalMap;\n};\n\nexport const convertToSupplementalMap = (supplemental) => {\n\tlet supplementalMap = {\n\t\tdocument: {},\n\t\tevent: {},\n\t\tuser: {},\n\t\tglobal: {}\n\t};\n\n\tif (!supplemental)\n\t\treturn supplementalMap;\n\n\tsupplemental.forEach((data) => {\n\t\tsupplementalMap = addToSupplementalMap(supplementalMap, data);\n\t});\n\n\treturn supplementalMap;\n};\n\nconst displayErrorMessage = (updateState) => {\n\tupdateState({\n\t\tloading: false,\n\t\terror: true,\n\t\tevents: []\n\t});\n};\n\nexport const getLegacyAmbChannels = ({ properties: { table, sysId } }) => {\n\tconst filter = btoa(`sys_id=${sysId}`).replace(/=/g, '-');\n\n\treturn [\n\t\t`/activity/supplemental/global`,\n\t\t`/activity/supplemental/${sysId}`,\n\t\t`/rw/default/${table}/${filter}`,\n\t\t`/rw/default/sys_attachment/${filter}`,\n\t\t`/history/update/${table}/${sysId}`\n\t];\n};\n\nexport const updateRepos = ({ nowId, events = [], userReferences = [] }) => {\n\tif (userReferences)\n\t\tuserReferences.forEach((user) => {\n\t\t\tUserReferenceRepo.addReference(nowId, new UserReferenceDto(user));\n\t\t});\n\n\tif (events)\n\t\tevents.forEach((activity: ActivityDto) => {\n\t\t\tif (activity.eventTable === 'sys_attachment')\n\t\t\t\tAttachmentRepo.addAttachment(\n\t\t\t\t\tnowId,\n\t\t\t\t\tnew AttachmentDto({ ...activity.payload, attachment: activity.eventSysId })\n\t\t\t\t);\n\t\t});\n};\n\nexport const fetchEmailReplies = (nowId, emailSysIds, dispatch) => {\n\tconst emailsWithNoLastReply = emailSysIds.filter((emailSysId) => {\n\t\tconst emailTile = TilesRepo.getTile(nowId, emailSysId) || {};\n\t\tconst emailLastReply = emailTile['emailLastReply'];\n\t\treturn !emailLastReply;\n\t});\n\n\tif (emailsWithNoLastReply.length > 0)\n\t\tdispatch(AS_FETCH_EMAIL_REPLIES_REQUESTED_ACTION, { emailSysIds: emailsWithNoLastReply });\n};\n\nexport const getEventTransformer = ({ properties: { table, sysId } }) => (event) =>\n\tevent && event.entryItem ? new DataTransformer().oldEventTransform(table, sysId)(event) : new ActivityDto(event);\n\nexport const transformEvents = (state) => (events) => events.map(getEventTransformer(state));\n\nconst getFilterOptionsForAdapter = (state, dataFields) =>\n\tstate.properties.filterOptions ? jsonStringToArray(state.properties.filterOptions) : dataFields || [];\n\nconst adaptersByPathSuffix = {\n\tgetStream: (state, data) =>\n\t\tdata\n\t\t\t? {\n\t\t\t\tambChannels: getLegacyAmbChannels(state),\n\t\t\t\tevents: transformEvents(state)(data.entries || []),\n\t\t\t\tfilterOptions: getFilterOptionsForAdapter(state, data.fields),\n\t\t\t\tsupplemental: convertToSupplementalMap(data.supplemental || []),\n\t\t\t\tuserReferences: data.userReferences || []\n\t\t\t  }\n\t\t\t: data,\n\tgetEvents: (state, data) =>\n\t\tdata\n\t\t\t? {\n\t\t\t\tambChannels: data.ambChannels || [],\n\t\t\t\tevents: transformEvents(state)(data.events || []),\n\t\t\t\tfilterOptions: getFilterOptionsForAdapter(state, data.filterFields),\n\t\t\t\tsupplemental: convertToSupplementalMap(data.supplemental || []),\n\t\t\t\tuserReferences: data.userReferences || []\n\t\t\t  }\n\t\t\t: data\n};\n\nexport const transformGraphQLPayload = (state) => (payload) =>\n\tObject.keys(adaptersByPathSuffix)\n\t\t.map((suffix) => adaptersByPathSuffix[suffix](state, get(payload, `data.GlideActivity_Query.${suffix}`)))\n\t\t.find((data) => !!data) || {};\n\nexport const accumulateEmailSysId = (emailSysIds, event) =>\n\tevent.type === 'EMAIL' || event.eventTable === 'sys_email'\n\t\t? emailSysIds.push(event.sysId || event.eventSysId) && emailSysIds\n\t\t: emailSysIds;\n\nexport const activityStreamGraphQLBehavior = {\n\tname: 'activityStreamGraphQLBehavior',\n\n\tactions: {\n\t\t[AS_FETCH_ACTIVITY_REQUESTED_ACTION]: { private: true },\n\t\t[AS_FETCH_ACTIVITY_SUCCEEDED_ACTION]: { private: true },\n\t\t[AS_FETCH_ACTIVITY_FAILED_ACTION]: { private: true },\n\t\t[AS_FETCH_EMAIL_REPLIES_REQUESTED_ACTION]: { private: true },\n\t\t[AS_FETCH_EMAIL_REPLIES_SUCCEEDED_ACTION]: { private: true },\n\t\t[AS_FETCH_EMAIL_REPLIES_FAILED_ACTION]: { private: true }\n\t},\n\n\tactionHandlers: {\n\t\t[COMPONENT_CONNECTED]: ({ updateState, dispatch, properties, state }) => {\n\t\t\tconst events = properties.events || [];\n\n\t\t\tif (events.length === 0)\n\t\t\t\tdispatch(AS_FETCH_ACTIVITY_REQUESTED_ACTION, {\n\t\t\t\t\ttable: properties.table,\n\t\t\t\t\tsysId: properties.sysId,\n\t\t\t\t\tview: properties.view\n\t\t\t\t});\n\t\t\telse if (state.apiVersion === 0) {\n\t\t\t\tconst emailSysIds = events.reduce(accumulateEmailSysId, []);\n\t\t\t\tif (emailSysIds.length > 0)\n\t\t\t\t\tdispatch(AS_FETCH_EMAIL_ATTACHMENTS_REQUESTED_ACTION, { emailSysIds });\n\t\t\t\telse\n\t\t\t\t\tupdateState(({ state }) => ({ loading: false, shouldUpdate: state.loading }));\n\t\t\t} else\n\t\t\t\tupdateState(({ state }) => ({ loading: false, shouldUpdate: state.loading }));\n\t\t},\n\n\t\t[COMPONENT_PROPERTY_CHANGED]: ({\n\t\t\tdispatch,\n\t\t\tproperties: { table, sysId, view },\n\t\t\taction: {\n\t\t\t\tpayload: { name }\n\t\t\t}\n\t\t}) => {\n\t\t\tif (name === 'table' || name === 'sysId')\n\t\t\t\tdispatch(AS_FETCH_ACTIVITY_REQUESTED_ACTION, { table, sysId, view });\n\t\t},\n\n\t\t[AS_FETCH_ACTIVITY_REQUESTED_ACTION]: createGraphQLEffect(FULL_QUERY, {\n\t\t\tvariableList: ['table', 'sysId', 'view'],\n\t\t\tsuccessActionType: AS_FETCH_ACTIVITY_SUCCEEDED_ACTION,\n\t\t\terrorActionType: AS_FETCH_ACTIVITY_FAILED_ACTION\n\t\t}),\n\n\t\t[AS_FETCH_ACTIVITY_SUCCEEDED_ACTION]: ({ updateState, action, properties, state, dispatch }) => {\n\t\t\tconst { ambChannels, events, filterOptions, supplemental, userReferences } = transformGraphQLPayload(state)(\n\t\t\t\taction.payload\n\t\t\t);\n\n\t\t\tupdateRepos({\n\t\t\t\tnowId: properties.nowId,\n\t\t\t\tevents,\n\t\t\t\tuserReferences\n\t\t\t});\n\n\t\t\tconst hasErrors = action.payload.errors && action.payload.errors.length > 0;\n\n\t\t\tif (events.length === 0 && hasErrors) {\n\t\t\t\tdisplayErrorMessage(updateState);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst filterStatus = ActivityFilter.getInitialFilterStatus(filterOptions || [], supplemental);\n\n\t\t\tconst emailSysIds = state.apiVersion === 0 ? events.reduce(accumulateEmailSysId, []) : [];\n\t\t\tconst loadingStatus = emailSysIds.length === 0 ? { loading: false } : {};\n\n\t\t\tupdateState({\n\t\t\t\tsupplemental: supplemental,\n\t\t\t\t...loadingStatus,\n\t\t\t\terror: hasErrors,\n\t\t\t\tevents,\n\t\t\t\t...filterStatus,\n\t\t\t\tsortDirection: get(supplemental, ['document', 'sortDirection'], state.sortDirection),\n\t\t\t\tlastUpdateTimestamp: Date.now()\n\t\t\t});\n\n\t\t\tif (ambChannels.length > 0)\n\t\t\t\tdispatch(AS_REQUEST_AMB_CONNECTIONS_ACTION, { ambChannels: ambChannels, subscribe: true });\n\n\t\t\tif (emailSysIds.length > 0)\n\t\t\t\tdispatch(AS_FETCH_EMAIL_ATTACHMENTS_REQUESTED_ACTION, { emailSysIds });\n\t\t},\n\n\t\t[AS_FETCH_ACTIVITY_FAILED_ACTION]: ({ updateState }) => {\n\t\t\tdisplayErrorMessage(updateState);\n\t\t},\n\n\t\t[AS_FETCH_EMAIL_REPLIES_REQUESTED_ACTION]: createGraphQLEffect(EMAIL_REPLY_QUERY, {\n\t\t\tvariableList: ['emailSysIds'],\n\t\t\tsuccessActionType: AS_FETCH_EMAIL_REPLIES_SUCCEEDED_ACTION,\n\t\t\terrorActionType: AS_FETCH_EMAIL_REPLIES_FAILED_ACTION\n\t\t}),\n\n\t\t[AS_FETCH_EMAIL_REPLIES_SUCCEEDED_ACTION]: ({ action, properties }) => {\n\t\t\tconst { payload } = action;\n\t\t\tconst { nowId } = properties;\n\t\t\tconst replies = get(payload, EMAIL_BODIES_PATH, []);\n\n\t\t\treplies.forEach((reply) => {\n\t\t\t\tconst { lastReply, sysId } = reply;\n\t\t\t\tTilesRepo.updateProperty(nowId, 'emailLastReply', lastReply, sysId);\n\t\t\t});\n\t\t},\n\n\t\t[AS_FETCH_EMAIL_REPLIES_FAILED_ACTION]: ({ action, properties }) => {\n\t\t\tconst { payload } = action;\n\t\t\tconst { nowId } = properties;\n\t\t\tconst replies = get(payload, EMAIL_BODIES_PATH, []);\n\n\t\t\treplies.forEach((reply) => {\n\t\t\t\tconst { sysId } = reply;\n\t\t\t\tTilesRepo.updateProperty(nowId, 'error', false, sysId);\n\t\t\t});\n\n\t\t\tconsole.error('Error fetching email replies: ', payload.message);\n\t\t}\n\t}\n};\n","import '@servicenow/now-button';\nimport '@servicenow/now-icon';\nimport '@servicenow/now-label-value';\nimport '@servicenow/now-record-common';\n\nimport ActivityTile from './ActivityTile';\nimport { SHOW_LESS, SHOW_MORE, SHOW_FULL, HIDE_FULL, SUBJECT, FROM, TO, CC } from '../translations';\nimport { Fragment } from '@servicenow/ui-renderer-snabbdom';\nimport { get, isEmpty } from 'lodash';\nimport { EVENT_SUB_TYPES } from '../constants';\nimport styles from './_emailTile.scss';\nimport EmailLastReply from './EmailLastReply';\nimport EmailContent from './EmailContent';\nimport EmailHeaderAction from './actions/EmailHeaderAction';\nimport { createCustomElement } from '@servicenow/ui-core';\nimport UserReferenceDto from '../UserReferenceDto';\nimport UserReferenceRepo from '../UserReferenceRepo';\nimport { fetchEmailReplies } from '../../activity-connected/activityStreamGraphQLBehavior';\nimport { AS_EXPAND_ALL_EVENTS_ACTION, AS_COLLAPSE_ALL_EVENTS_ACTION } from '../actions';\n\nconst expandedEmailTiles = new Set();\nconst expandedFullEmailTiles = new Set();\nconst EMAIL_TILE = 'email-tile';\n\nexport class EmailTile extends ActivityTile {\n\temailActions: Array = [new EmailHeaderAction()];\n\n\tgetComponentName() {\n\t\treturn EMAIL_TILE;\n\t}\n\n\tgetHeaderActions() {\n\t\treturn [...super.getHeaderActions(), ...this.emailActions];\n\t}\n\n\tgetTileIcon(state) {\n\t\tconst {\n\t\t\tproperties: { activated, subtype }\n\t\t} = state;\n\t\tif (!activated)\n\t\t\treturn '';\n\t\treturn subtype === EVENT_SUB_TYPES.EMAIL.SENT ? 'envelope-arrow-outline' : 'envelope-outline';\n\t}\n\n\tgetTitleDecorator(state) {\n\t\tconst {\n\t\t\tproperties: { activated, attachments }\n\t\t} = state;\n\t\tif (!activated || !attachments.length)\n\t\t\treturn '';\n\t\treturn (\n\t\t\t<span className=\"meta\">\n\t\t\t\t<now-icon icon=\"paperclip-outline\" size=\"md\" className=\"count-icon\" />\n\t\t\t\t{attachments.length}\n\t\t\t</span>\n\t\t);\n\t}\n\n\tgetStyles() {\n\t\treturn super.getStyles() + ' ' + styles;\n\t}\n\n\tgetPropertyDefinitions() {\n\t\treturn {\n\t\t\t...super.getPropertyDefinitions(),\n\t\t\tsubject: { default: '' },\n\t\t\tto: { default: [] },\n\t\t\tfrom: { default: [] },\n\t\t\tcc: { default: [] },\n\t\t\tcontentUrl: { default: '' },\n\t\t\tpreviewText: { default: '' },\n\t\t\tattachments: { default: [] },\n\t\t\temailLastReply: { default: '' }\n\t\t};\n\t}\n\n\tgetInitialState() {\n\t\treturn {\n\t\t\t...super.getInitialState(),\n\t\t\texpandedFull: false\n\t\t};\n\t}\n\n\tgetHeader(state) {\n\t\tconst {\n\t\t\tproperties,\n\t\t\tproperties: { activated, activityNowId, expanded }\n\t\t} = state;\n\t\tconst data = [\n\t\t\t{ label: SUBJECT, field: 'subject' },\n\t\t\t{ label: FROM, field: 'from' },\n\t\t\t{ label: TO, field: 'to', emailList: true },\n\t\t\t{ label: CC, field: 'cc', emailList: true }\n\t\t];\n\n\t\tconst formatEmailList = (arr) => {\n\t\t\treturn arr.join('; ');\n\t\t};\n\n\t\tlet items = [];\n\t\tlet searchable = [];\n\t\tdata.filter((item) => !isEmpty(get(properties, item.field))).forEach((item) => {\n\t\t\tconst data = get(properties, item.field);\n\t\t\tconst entry = {\n\t\t\t\tlabel: item.label,\n\t\t\t\tvalue: data\n\t\t\t};\n\n\t\t\tif (item.emailList)\n\t\t\t\tentry.value = formatEmailList(data);\n\t\t\telse {\n\t\t\t\tconst userRef: UserReferenceDto = UserReferenceRepo.getFromReferences(activityNowId, data);\n\t\t\t\tif (userRef)\n\t\t\t\t\tentry.value = userRef.email;\n\t\t\t}\n\n\t\t\tif (expanded)\n\t\t\t\titems.push(entry);\n\n\t\t\tif (!expanded)\n\t\t\t\tsearchable.push(\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{entry.label}</td>\n\t\t\t\t\t\t<td>{entry.value}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t);\n\t\t});\n\n\t\tconst labelValueComp = activated ? <now-label-value-tabbed size=\"md\" items={items} /> : '';\n\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t{labelValueComp}\n\t\t\t\t<table className={'hidden-searchable'}>{searchable}</table>\n\t\t\t</Fragment>\n\t\t);\n\t}\n\n\tgetAttachmentList(state) {\n\t\tconst {\n\t\t\tproperties: { activated, attachments, expanded }\n\t\t} = state;\n\n\t\treturn activated && expanded ? (\n\t\t\t<ul className=\"sn-as-email-inline-attachments\">\n\t\t\t\t{attachments.map(\n\t\t\t\t\t({\n\t\t\t\t\t\tfileName: name,\n\t\t\t\t\t\tsizeBytes: size,\n\t\t\t\t\t\tstate: fileState,\n\t\t\t\t\t\tattachment: sysId,\n\t\t\t\t\t\tcontentType: type = ''\n\t\t\t\t\t}) => (\n\t\t\t\t\t\t<li className=\"item\" key={`attachment-${sysId}`}>\n\t\t\t\t\t\t\t<now-record-common-attachment-card item={{ name, size, state: fileState, sysId, type }} />\n\t\t\t\t\t\t</li>\n\t\t\t\t\t)\n\t\t\t\t)}\n\t\t\t</ul>\n\t\t) : (\n\t\t\t''\n\t\t);\n\t}\n\n\tgetPreview(state) {\n\t\tconst {\n\t\t\tproperties: { expanded, subject, previewText }\n\t\t} = state;\n\n\t\tif (expanded)\n\t\t\treturn;\n\n\t\treturn (\n\t\t\t<div className=\"email-preview\">\n\t\t\t\t<span>{subject} &bull;</span> {previewText}\n\t\t\t</div>\n\t\t);\n\t}\n\n\tgetTopToggle(state, coeffects) {\n\t\tconst {\n\t\t\tproperties: { activityNowId, expanded, eventSysId },\n\t\t\texpandedFull\n\t\t} = state;\n\t\tconst { dispatch } = coeffects;\n\n\t\treturn expanded && expandedFull ? (\n\t\t\t''\n\t\t) : (\n\t\t\t<now-button-bare\n\t\t\t\tkey=\"expanded-toggle\"\n\t\t\t\tclassName=\"sn-as-card-body-toggler\"\n\t\t\t\tlabel={expanded ? SHOW_LESS : SHOW_MORE}\n\t\t\t\tsize=\"md\"\n\t\t\t\tvariant=\"primary\"\n\t\t\t\ton-click={() => {\n\t\t\t\t\tdispatch(expanded ? AS_COLLAPSE_ALL_EVENTS_ACTION : AS_EXPAND_ALL_EVENTS_ACTION, { eventSysId });\n\t\t\t\t\tif (!expanded)\n\t\t\t\t\t\tfetchEmailReplies(activityNowId, [eventSysId], dispatch);\n\t\t\t\t}}\n\t\t\t/>\n\t\t);\n\t}\n\n\tgetBottomToggle(state, coeffects) {\n\t\tconst {\n\t\t\texpandedFull,\n\t\t\tproperties: { expanded }\n\t\t} = state;\n\t\tconst { updateState } = coeffects;\n\n\t\treturn expanded ? (\n\t\t\t<now-button-bare\n\t\t\t\tkey=\"expanded-full-toggle\"\n\t\t\t\tclassName=\"sn-as-card-body-toggler\"\n\t\t\t\tlabel={expandedFull ? HIDE_FULL : SHOW_FULL}\n\t\t\t\tsize=\"md\"\n\t\t\t\tvariant=\"primary\"\n\t\t\t\ton-click={() => {\n\t\t\t\t\tupdateState({\n\t\t\t\t\t\texpandedFull: !expandedFull\n\t\t\t\t\t});\n\t\t\t\t}}\n\t\t\t/>\n\t\t) : (\n\t\t\t''\n\t\t);\n\t}\n\n\tgetJSX(state, coeffects) {\n\t\tconst {\n\t\t\tproperties: { activated, expanded, nowId, contentUrl, eventSysId, emailLastReply },\n\t\t\texpandedFull\n\t\t} = state;\n\n\t\tif (expanded)\n\t\t\texpandedEmailTiles.add(nowId);\n\n\t\tif (expandedFull)\n\t\t\texpandedFullEmailTiles.add(nowId);\n\n\t\tconst everExpanded = expandedEmailTiles.has(nowId);\n\n\t\t// noinspection JSXNamespaceValidation\n\t\tconst lastReply = !everExpanded ? (\n\t\t\t''\n\t\t) : (\n\t\t\t<EmailLastReply expanded={expanded && !expandedFull} sysId={eventSysId} lastReply={emailLastReply} />\n\t\t);\n\n\t\tconst everExpandedFull = expandedFullEmailTiles.has(nowId);\n\n\t\t// noinspection JSXNamespaceValidation\n\t\tconst fullConversation = !everExpandedFull ? (\n\t\t\t''\n\t\t) : (\n\t\t\t<EmailContent expanded={expanded && expandedFull} contentUrl={contentUrl} />\n\t\t);\n\n\t\t// noinspection JSXNamespaceValidation\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t{this.getHeader(state)}\n\t\t\t\t{this.getPreview(state)}\n\t\t\t\t{this.getAttachmentList(state)}\n\t\t\t\t{activated ? this.getTopToggle(state, coeffects) : ''}\n\t\t\t\t{lastReply}\n\t\t\t\t{fullConversation}\n\t\t\t\t{activated ? this.getBottomToggle(state, coeffects) : ''}\n\t\t\t</Fragment>\n\t\t);\n\t}\n\n\tgetOnDisconnect(coeffects) {\n\t\tsuper.getOnDisconnect(coeffects);\n\t\tconst {\n\t\t\tproperties: { nowId }\n\t\t} = coeffects;\n\t\texpandedEmailTiles.delete(nowId);\n\t\texpandedFullEmailTiles.delete(nowId);\n\t}\n}\n\nconst emailTile = new EmailTile();\ncreateCustomElement(EMAIL_TILE, emailTile.getCustomElementParts());\nexport default emailTile.getComponentName();\n","import '@servicenow/now-label-value';\nimport ActivityTile from './ActivityTile';\nimport { SHOW_LESS, SHOW_MORE, EMPTY } from '../translations';\nimport { Fragment } from '@servicenow/ui-renderer-snabbdom';\nimport { createCustomElement } from '@servicenow/ui-core';\nimport { AS_EXPAND_ALL_EVENTS_ACTION, AS_COLLAPSE_ALL_EVENTS_ACTION } from '../actions';\n\nconst HTML = 'html';\nconst TRANSLATED_HTML = 'translated_html';\nconst STRING = 'string';\nconst AUDIT_TILE = 'audit-tile';\n\nexport class AuditTile extends ActivityTile {\n\tgetComponentName() {\n\t\treturn AUDIT_TILE;\n\t}\n\n\tgetPropertyDefinitions() {\n\t\treturn {\n\t\t\t...super.getPropertyDefinitions(),\n\t\t\theight: { default: '80' },\n\t\t\tauditValues: { default: [] }\n\t\t};\n\t}\n\n\tgetTileIcon(): string {\n\t\treturn 'pencil-page-outline';\n\t}\n\n\tgetJSX(state, coeffects) {\n\t\tconst {\n\t\t\tproperties: { auditValues, activated, eventSysId, expanded }\n\t\t} = state;\n\t\tconst { dispatch } = coeffects;\n\n\t\tlet items = [];\n\t\tlet i = 0;\n\n\t\tif (!auditValues)\n\t\t\treturn '';\n\n\t\titems = this.getLabelValues(auditValues, eventSysId);\n\n\t\tif (!activated) {\n\t\t\tlet searchable = [];\n\t\t\titems.forEach((item) => {\n\t\t\t\tsearchable.push(\n\t\t\t\t\t<tr key={`${eventSysId}${i++}`}>\n\t\t\t\t\t\t<td>{item.label}</td>\n\t\t\t\t\t\t<td>{item.value.value + (item.value.previous !== '' ? ' was ' + item.value.previous : '')}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t);\n\t\t\t});\n\t\t\treturn <table className={'hidden-searchable'}>{searchable}</table>;\n\t\t}\n\n\t\tif (items.length <= 4)\n\t\t\treturn <now-label-value-tabbed size=\"md\" items={items} />;\n\n\t\tconst buttonLabel = expanded ? SHOW_LESS : SHOW_MORE;\n\t\tconst displayItems = expanded ? items : items.slice(0, 4);\n\t\tconst tileAction = expanded ? AS_COLLAPSE_ALL_EVENTS_ACTION : AS_EXPAND_ALL_EVENTS_ACTION;\n\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<now-label-value-tabbed size=\"md\" items={displayItems} />\n\t\t\t\t<now-button-bare\n\t\t\t\t\tclassName=\"sn-as-card-body-toggler\"\n\t\t\t\t\tlabel={buttonLabel}\n\t\t\t\t\tsize=\"md\"\n\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\ton-click={() => {\n\t\t\t\t\t\tdispatch(tileAction, { eventSysId });\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</Fragment>\n\t\t);\n\t}\n\n\tgetLabelValues(auditValues, eventSysId) {\n\t\treturn auditValues.map(({ fieldLabel, newValue, oldValue, htmlNewValue, htmlOldValue, type }) => ({\n\t\t\tlabel: fieldLabel,\n\t\t\tvalue: this.getLabelValue(newValue, oldValue, htmlNewValue, htmlOldValue, type, eventSysId)\n\t\t}));\n\t}\n\n\tgetLabelValue(newValue, oldValue, htmlNewValue, htmlOldValue, type, eventSysId) {\n\t\tif (type === HTML || type === TRANSLATED_HTML)\n\t\t\treturn {\n\t\t\t\ttype: HTML,\n\t\t\t\t// need to wrap in span tags to render the entire html value\n\t\t\t\tvalue: `<span>${this.getDisplayValue(htmlNewValue)}</span>`,\n\t\t\t\tprevious: eventSysId !== '0' ? `<span>${this.getDisplayValue(htmlOldValue)}</span>` : ''\n\t\t\t};\n\n\t\treturn {\n\t\t\ttype: STRING,\n\t\t\tvalue: this.getDisplayValue(newValue),\n\t\t\tprevious: eventSysId !== '0' ? this.getDisplayValue(oldValue) : ''\n\t\t};\n\t}\n\n\tgetDisplayValue(value) {\n\t\treturn value || EMPTY;\n\t}\n}\n\nconst auditTile = new AuditTile();\ncreateCustomElement(AUDIT_TILE, auditTile.getCustomElementParts());\nexport default auditTile.getComponentName();\n","import { createCustomElement } from '@servicenow/ui-core';\nimport ActivityTile from './ActivityTile';\nimport '@servicenow/now-label-value';\nimport { t } from 'sn-translate';\n\nconst ADDED = 'added';\nconst REMOVED = 'removed';\nconst TARGET_DELETED = 'target_deleted';\nconst AUDIT_RELATION_TILE = 'audit-relation-tile';\n\nexport class AuditRelationTile extends ActivityTile {\n\tgetComponentName() {\n\t\treturn AUDIT_RELATION_TILE;\n\t}\n\n\tgetPropertyDefinitions() {\n\t\treturn {\n\t\t\t...super.getPropertyDefinitions(),\n\t\t\theight: { default: '80' },\n\t\t\ttargetTable: { default: '' },\n\t\t\ttargetName: { default: '' },\n\t\t\tfieldLabel: { default: '' },\n\t\t\ttargetLabel: { default: '' },\n\t\t\toperation: { default: '' }\n\t\t};\n\t}\n\n\tgetTileIcon(): string {\n\t\treturn 'handshake-outline';\n\t}\n\n\t// Audit Relation Entry Examples:\n\t//\t\"Catalog Task SCTASK0010001 'Request item' field added\"\n\t//\t\"Catalog Task SCTASK0010001 'Request item' field removed\"\n\t//\t\"Catalog Task SCTASK0010007 removed from 'task' table\"\n\t_getValue(properties): string {\n\t\tconst { targetTable, targetName, fieldLabel, targetLabel, operation } = properties;\n\n\t\tif (operation === ADDED)\n\t\t\treturn t(\"{0} {1} '{2}' field added\", targetLabel, targetName, fieldLabel);\n\n\t\tif (operation === REMOVED)\n\t\t\treturn t(\"{0} {1} '{2}' field removed\", targetLabel, targetName, fieldLabel);\n\n\t\tif (operation === TARGET_DELETED)\n\t\t\treturn t(\"{0} {1} removed from '{2}' table\", targetLabel, targetName, targetTable);\n\n\t\treturn '';\n\t}\n\n\tgetJSX(state): HTMLElement | HTMLElement[] | string {\n\t\tconst { properties } = state;\n\n\t\t// noinspection HtmlUnknownAttribute\n\t\treturn <div className=\"sn-as-card-body-journal\">{this._getValue(properties)}</div>;\n\t}\n}\n\nconst auditRelationTile = new AuditRelationTile();\ncreateCustomElement(AUDIT_RELATION_TILE, auditRelationTile.getCustomElementParts());\nexport default auditRelationTile.getComponentName();\n","import SeismicComponent from '../shared/SeismicComponent';\nimport '@servicenow/now-dropdown';\nimport '@servicenow/now-heading';\n// noinspection ES6CheckImport\nimport { actionTypes, createCustomElement } from '@servicenow/ui-core';\nimport styles from './activity.scss';\nimport emptySvg from './emptyActivityImage.svg';\nimport {\n\tDEFAULT_ACTIVITY_TITLE,\n\tNO_ACTIVITY_TO_DISPLAY,\n\tSOMETHING_WENT_WRONG,\n\tNEW_RECORD_EMPTY_ACTIVITY,\n\tNO_RESULTS_FOR_FILTER,\n\tNO_ACTIVITY_WAITING,\n\tCOLLAPSE_ALL_POST,\n\tEXPAND_ALL_POST,\n\tMORE_OPTIONS,\n\tLOADING_TEXT,\n\tSORT_DESCENDING,\n\tSORT_ASCENDING\n} from './translations';\n\nimport {\n\tEXPAND_ALL_POST_ACTION_ID,\n\tCOLLAPSE_ALL_POST_ACTION_ID,\n\tAS_FILTER_CHANGED_ACTION,\n\tAS_SORT_CHANGED_ACTION,\n\tAS_UPDATE_EVENT_SUPPLEMENTAL_STATE_ACTION,\n\tAS_EXPAND_ALL_EVENTS_ACTION,\n\tAS_COLLAPSE_ALL_EVENTS_ACTION,\n\tAS_FILTER_CHANGED_ACTION_IS_PRIVATE,\n\tAS_EXPAND_COLLAPSE_ALL_ACTIONS_ARE_PRIVATE,\n\tWS_PREVIEW_RECORD_ACTION,\n\tAS_PREVIEW_RECORD_REQUESTED\n} from './actions';\nimport { apiVersion } from './constants';\nimport ActivityDto from './ActivityDto';\nimport FluxCapacitorRepo from './FluxCapacitorRepo';\nimport { activityLazyRenderBehavior } from './activityLazyRenderBehavior';\nimport { tileFocusManagementBehavior } from './tiles/tileFocusManagementBehavior';\nimport { debounce, get } from 'lodash';\nimport { SnTimeAgo } from 'sn-component-timeago';\n\n//OOB Tiles\nimport TestTile from './tiles/TestTile';\nimport JournalTile from './tiles/JournalTile';\nimport AttachmentTile from './tiles/AttachmentTile';\nimport EmailTile from './tiles/EmailTile';\nimport AuditTile from './tiles/AuditTile';\nimport AuditRelationTile from './tiles/AuditRelationTile';\nimport UserReferenceDto from './UserReferenceDto';\nimport UserReferenceRepo from './UserReferenceRepo';\nimport { convertToSupplementalMap, fetchEmailReplies } from '../activity-connected/activityStreamGraphQLBehavior';\nimport { AS_REQUEST_AMB_CONNECTIONS_ACTION } from './actions';\nimport { isTrue, jsonStringToArray, jsonStringToObject } from '../shared/utils';\nimport TilesRepo from './TilesRepo';\nimport AttachmentRepo from './AttachmentRepo';\nimport AttachmentDto from './AttachmentDto';\nimport { ActivityFilter } from './activity-filter/ActivityFilter';\nimport { transformEvents } from '../activity-connected/activityStreamGraphQLBehavior';\nimport { updateRepos } from '../activity-connected/activityStreamGraphQLBehavior';\nimport { shouldFilterOutEvent } from './activity-filter/QuickFilters';\n\nconst NOW_ACTIVITY_STREAM = 'now-activity-stream';\nconst DEFINED_TILES = new Set([TestTile, JournalTile, AttachmentTile, EmailTile, AuditTile, AuditRelationTile]);\nconst { COMPONENT_CONNECTED, COMPONENT_DISCONNECTED, COMPONENT_PROPERTY_CHANGED } = actionTypes;\nconst NUM_SKIPPED_LAZY_RENDER_ITEMS = 3;\nconst EXPANDED_PROP = 'expanded';\nconst EMAIL_TILE = 'email-tile';\n\nconst getEmailIds = (events) => events.filter((event) => event.tile === EMAIL_TILE).map((event) => event.eventSysId);\n\nconst propertyDefs = {\n\t/**\n\t * List of events to display\n\t * @type {object[]}\n\t */\n\tevents: { default: [] },\n\n\t/**\n\t * Title for activity events section\n\t * @type {string}\n\t */\n\ttitle: { default: DEFAULT_ACTIVITY_TITLE },\n\n\t/**\n\t * Is this a new unsaved record, if true will provide a different message for an empty activity (Optional)\n\t * @type {boolean}\n\t */\n\tisNewRecord: { default: false },\n\n\t/**\n\t * Options for filter\n\t * @type {object[]}\n\t */\n\tfilterOptions: { default: null },\n\n\t/**\n\t * Default for sort direction (data comes in descending order from server)\n\t * Values can be -1 for descending order and 1 for ascending order\n\t * IMPORTANT NOTE: If specified, this property will be OVERRIDDEN by user preferences in supplemental data\n\t * @type {number}\n\t */\n\tsortDirection: { default: -1 },\n\n\t/**\n\t * Current timestamp, this is used to know when new data is coming in\n\t * @type {number}\n\t */\n\ttimestamp: {},\n\n\t/**\n\t * Time Ago options, provides a way to pass the user preference glide.ui.date_format\n\t * Example:\n\t * ```\n\t * \"{timeAgo: true, dateBoth: false}\"\n\t * ```\n\t * Or:\n\t * ```\n\t * {timeAgo: true, dateBoth: false}\n\t * ```\n\t * @type {string | object}\n\t */\n\ttimeAgoOptions: { default: '' },\n\n\t/**\n\t * Table name of the record that we want to display the activity stream for\n\t * @type {string}\n\t */\n\ttable: { default: null },\n\n\t/**\n\t * Unique identifier for the record\n\t * @type {string}\n\t */\n\tsysId: { default: null },\n\n\t/**\n\t * View to use for the record.\n\t * @type {string}\n\t */\n\tview: { default: '' },\n\n\t/**\n\t * Should component show the conversation quick filter? (Optional)\n\t * @type {boolean}\n\t */\n\tshowConversationFilter: { default: false },\n\n\t/**\n\t * Should component show author avatars in each event? (Optional)\n\t * @type {boolean}\n\t */\n\tshowTileAvatars: { default: false },\n\n\t/**\n\t * Should component show a descriptive icon in each event? (Optional)\n\t * @type {boolean}\n\t */\n\tshowTileIcons: { default: true },\n\n\t/**\n\t * Should component show favoriting functionality? (Optional)\n\t * @type {boolean}\n\t */\n\tshowFavoriting: { default: false },\n\n\t/**\n\t * Additional data to include for the tiles to consume in the form of\n\t * ```\n\t * { eventId, documentId, userSysId, payload }\n\t * ```\n\t * payload is a json string\n\t * @type {object[]}\n\t */\n\tsupplemental: { default: [] },\n\n\t/**\n\t * User information used for the tiles displayed, in the form of:\n\t * ```\n\t *\t[\n\t *\t\t{\n\t *\t\t\tactive: true,\n\t *\t\t\tavatar: 'avatar_url',\n\t *\t\t\temail: string = 'email@email.com',\n\t *\t\t\tname: 'System Administrator',\n\t *\t\t\tsysId: 'sysId_for_john_doe',\n\t *\t\t\tuserName: 'Admin'\n\t *\t\t}\n\t *\t];\n\t * ```\n\t * This is used to provide more detail when the tile only contains an email, user, or sysId as an author\n\t * @type {object[]}\n\t */\n\tuserReferences: { default: [] },\n\n\t/**\n\t * AMB channels to subscribe to\n\t * @type {string[]}\n\t */\n\tambChannels: { default: [] }\n};\n\nconst memoizedTilesByNowId: Map<string, { lastUpdateTimestamp: number, tiles: Object[] }> = new Map();\n\nexport class NowActivityStream extends SeismicComponent {\n\tgetComponentName() {\n\t\treturn NOW_ACTIVITY_STREAM;\n\t}\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis._addTileRef = this._addTileRef.bind(this);\n\t\tthis._renderActivities = this._renderActivities.bind(this);\n\t}\n\n\tgetPropertyDefinitions() {\n\t\treturn propertyDefs;\n\t}\n\n\tgetInitialState() {\n\t\treturn {\n\t\t\tloading: false,\n\t\t\terror: false,\n\t\t\tapiVersion: apiVersion\n\t\t};\n\t}\n\n\tgetBehaviors() {\n\t\tconst timeAgoBehaviors = SnTimeAgo.getBehaviors().map((b) => {\n\t\t\treturn {\n\t\t\t\tbehavior: b\n\t\t\t};\n\t\t});\n\t\treturn [\n\t\t\t{ behavior: activityLazyRenderBehavior },\n\t\t\t{ behavior: tileFocusManagementBehavior },\n\t\t\t...timeAgoBehaviors,\n\t\t\t...ActivityFilter.getFilterBehaviors()\n\t\t];\n\t}\n\n\tgetActions() {\n\t\treturn {\n\t\t\t'NOW_DROPDOWN#ITEM_CLICKED': {},\n\t\t\t'NOW_BUTTON#CLICKED': {},\n\t\t\t[AS_FILTER_CHANGED_ACTION]: { private: AS_FILTER_CHANGED_ACTION_IS_PRIVATE },\n\t\t\t[AS_EXPAND_ALL_EVENTS_ACTION]: { private: AS_EXPAND_COLLAPSE_ALL_ACTIONS_ARE_PRIVATE },\n\t\t\t[AS_COLLAPSE_ALL_EVENTS_ACTION]: { private: AS_EXPAND_COLLAPSE_ALL_ACTIONS_ARE_PRIVATE }\n\t\t};\n\t}\n\n\tgetRecordPreviewPrefix() {\n\t\treturn 'NOW_ACTIVITY_STREAM#';\n\t}\n\n\tcreateComponentPropertyChangedEffect() {\n\t\tconst updateLastUpdateTimestamp = debounce(\n\t\t\t(updateState) => updateState({ lastUpdateTimestamp: Date.now() }),\n\t\t\t100\n\t\t);\n\t\treturn {\n\t\t\tstopPropagation: true,\n\t\t\teffect: (coeffects) => {\n\t\t\t\tconst {\n\t\t\t\t\taction: {\n\t\t\t\t\t\tpayload: { name }\n\t\t\t\t\t},\n\t\t\t\t\tupdateState\n\t\t\t\t} = coeffects;\n\n\t\t\t\tif (name === 'showTileIcons' || name === 'showTileAvatars')\n\t\t\t\t\tupdateLastUpdateTimestamp(updateState);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActionHandlers() {\n\t\treturn {\n\t\t\t[COMPONENT_PROPERTY_CHANGED]: this.createComponentPropertyChangedEffect(),\n\t\t\t[WS_PREVIEW_RECORD_ACTION]: {\n\t\t\t\tstopPropagation: false,\n\t\t\t\teffect: (coeffects) => {\n\t\t\t\t\tconst {\n\t\t\t\t\t\taction: { payload },\n\t\t\t\t\t\tdispatch\n\t\t\t\t\t} = coeffects;\n\t\t\t\t\tdispatch(this.getRecordPreviewPrefix() + AS_PREVIEW_RECORD_REQUESTED, payload);\n\t\t\t\t}\n\t\t\t},\n\t\t\t[AS_UPDATE_EVENT_SUPPLEMENTAL_STATE_ACTION]: {\n\t\t\t\tstopPropagation: true,\n\t\t\t\teffect: (coeffects) => {\n\t\t\t\t\tconst {\n\t\t\t\t\t\taction: {\n\t\t\t\t\t\t\tpayload: { eventSysId, payload = {} }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstate: { supplemental },\n\t\t\t\t\t\tupdateState\n\t\t\t\t\t} = coeffects;\n\n\t\t\t\t\tif (!eventSysId)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tconst newSupplemental = {\n\t\t\t\t\t\t...supplemental,\n\t\t\t\t\t\tevent: {\n\t\t\t\t\t\t\t...supplemental.event,\n\t\t\t\t\t\t\t[eventSysId]: {\n\t\t\t\t\t\t\t\t...supplemental.event[eventSysId],\n\t\t\t\t\t\t\t\t...payload\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\tupdateState({ supplemental: newSupplemental, shouldRender: false });\n\t\t\t\t}\n\t\t\t},\n\t\t\t[AS_EXPAND_ALL_EVENTS_ACTION]: (coeffects) => {\n\t\t\t\tconst {\n\t\t\t\t\taction: {\n\t\t\t\t\t\tpayload: { eventSysId }\n\t\t\t\t\t},\n\t\t\t\t\tproperties: { nowId }\n\t\t\t\t} = coeffects;\n\t\t\t\tTilesRepo.updateProperty(nowId, EXPANDED_PROP, true, eventSysId);\n\t\t\t},\n\t\t\t[AS_COLLAPSE_ALL_EVENTS_ACTION]: (coeffects) => {\n\t\t\t\tconst {\n\t\t\t\t\taction: {\n\t\t\t\t\t\tpayload: { eventSysId }\n\t\t\t\t\t},\n\t\t\t\t\tproperties: { nowId }\n\t\t\t\t} = coeffects;\n\t\t\t\tTilesRepo.updateProperty(nowId, EXPANDED_PROP, false, eventSysId);\n\t\t\t},\n\t\t\t'NOW_DROPDOWN#ITEM_CLICKED': (coeffects) => {\n\t\t\t\tconst {\n\t\t\t\t\taction: {\n\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\titem: { id: actionId }\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tproperties: { nowId },\n\t\t\t\t\tstate: { events },\n\t\t\t\t\tdispatch\n\t\t\t\t} = coeffects;\n\n\t\t\t\tif (actionId === EXPAND_ALL_POST_ACTION_ID || actionId === COLLAPSE_ALL_POST_ACTION_ID) {\n\t\t\t\t\tTilesRepo.updateProperty(nowId, EXPANDED_PROP, actionId === EXPAND_ALL_POST_ACTION_ID);\n\n\t\t\t\t\tif (actionId === EXPAND_ALL_POST_ACTION_ID)\n\t\t\t\t\t\tfetchEmailReplies(nowId, getEmailIds(events), dispatch);\n\t\t\t\t}\n\t\t\t},\n\t\t\t'NOW_BUTTON#CLICKED': {\n\t\t\t\tstopPropagation: true,\n\t\t\t\teffect: (coeffects) => {\n\t\t\t\t\tconst {\n\t\t\t\t\t\tupdateState,\n\t\t\t\t\t\taction: {\n\t\t\t\t\t\t\tpayload: { activityAction, sortDirection }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdispatch,\n\t\t\t\t\t\tproperties: { table }\n\t\t\t\t\t} = coeffects;\n\n\t\t\t\t\tif (activityAction !== AS_SORT_CHANGED_ACTION)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tupdateState({\n\t\t\t\t\t\tsortDirection,\n\t\t\t\t\t\tlastUpdateTimestamp: Date.now()\n\t\t\t\t\t});\n\n\t\t\t\t\tdispatch(AS_SORT_CHANGED_ACTION, {\n\t\t\t\t\t\ttable,\n\t\t\t\t\t\tsortDirection\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t[COMPONENT_DISCONNECTED]: ({ properties: { nowId } }) => {\n\t\t\t\tTilesRepo.destroyTiles(nowId);\n\t\t\t\tFluxCapacitorRepo.destroyInstance(nowId);\n\t\t\t\tActivityFilter.destroy(nowId);\n\t\t\t\tUserReferenceRepo.deleteReferences(nowId);\n\t\t\t\tAttachmentRepo.removeAttachments(nowId);\n\t\t\t\tmemoizedTilesByNowId.delete(nowId);\n\t\t\t},\n\t\t\t[COMPONENT_CONNECTED]: ({ updateState, state, properties, dispatch }) => {\n\t\t\t\tconst { table, sysId } = properties;\n\t\t\t\tconst { apiVersion } = state;\n\t\t\t\tlet ambChannels = properties.ambChannels || [];\n\t\t\t\tif (apiVersion === 0 && ambChannels.length === 0) {\n\t\t\t\t\tconst filter = btoa(`sys_id=${sysId}`).replace(/=/g, '-');\n\t\t\t\t\tambChannels = [\n\t\t\t\t\t\t`/activity/supplemental/global`,\n\t\t\t\t\t\t`/activity/supplemental/${sysId}`,\n\t\t\t\t\t\t`/rw/default/${table}/${filter}`,\n\t\t\t\t\t\t`/rw/default/sys_attachment/${filter}`,\n\t\t\t\t\t\t`/history/update/${table}/${sysId}`\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\tif (ambChannels.length > 0)\n\t\t\t\t\tdispatch(AS_REQUEST_AMB_CONNECTIONS_ACTION, { ambChannels, subscribe: true });\n\n\t\t\t\tupdateState({\n\t\t\t\t\t...this.getInitialRenderState(state),\n\t\t\t\t\tshouldRender: false\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetInitialRenderState(state) {\n\t\tconst properties = state.properties || {};\n\t\tconst { nowId, supplemental = [], sortDirection = -1 } = properties;\n\t\tconst ambChannels = properties.ambChannels || [];\n\t\tconst events = transformEvents(state)(properties.events || []);\n\t\tconst userReferences = properties.userReferences || [];\n\n\t\tupdateRepos({\n\t\t\tnowId,\n\t\t\tevents,\n\t\t\tuserReferences\n\t\t});\n\n\t\tconst supplementalMap = convertToSupplementalMap(supplemental || []);\n\t\tconst filterStatus = ActivityFilter.getInitialFilterStatus(\n\t\t\tjsonStringToArray(properties.filterOptions) || [],\n\t\t\tsupplementalMap\n\t\t);\n\n\t\treturn {\n\t\t\t...state,\n\t\t\tsupplemental: supplementalMap,\n\t\t\tambChannels,\n\t\t\tevents,\n\t\t\tlastUpdateTimestamp: 0,\n\t\t\t...filterStatus,\n\t\t\tsortDirection: get(supplementalMap, ['document', 'sortDirection'], sortDirection)\n\t\t};\n\t}\n\n\t// noinspection JSCheckFunctionSignatures\n\tgetView(_state, { dispatch }) {\n\t\tconst state = typeof _state.events === 'undefined' ? this.getInitialRenderState(_state) : _state;\n\t\tconst { events = null } = state;\n\n\t\tconst { title } = state.properties;\n\n\t\tif (events === null)\n\t\t\treturn <div />;\n\n\t\t// noinspection HtmlUnknownBooleanAttribute, JSXNamespaceValidation\n\t\treturn (\n\t\t\t<div className=\"sn-as\">\n\t\t\t\t<section className=\"as-header\">\n\t\t\t\t\t<now-heading dir={document.dir} label={title} variant=\"header-secondary\" has-no-margin />\n\t\t\t\t\t<section className=\"actions\">\n\t\t\t\t\t\t{ActivityFilter.renderClearAll(state)}\n\t\t\t\t\t\t{ActivityFilter.renderFilterToggle(state)}\n\t\t\t\t\t\t{this._renderSort(state)}\n\t\t\t\t\t\t{this._renderExpandCollapseAll()}\n\t\t\t\t\t</section>\n\t\t\t\t</section>\n\t\t\t\t{ActivityFilter.renderFilters(state, dispatch)}\n\t\t\t\t<div className=\"activities\">{this._renderActivityContent(state)}</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tgetStyles() {\n\t\treturn styles;\n\t}\n\n\t_renderSort(state) {\n\t\tlet { sortDirection } = state;\n\t\tconst sortDisplay = {\n\t\t\ticon: `sort-${sortDirection > 0 ? 'ascending' : 'descending'}-outline`,\n\t\t\tlabel: sortDirection > 0 ? SORT_ASCENDING : SORT_DESCENDING\n\t\t};\n\n\t\treturn (\n\t\t\t<now-button\n\t\t\t\tid=\"sort-button\"\n\t\t\t\tbare\n\t\t\t\ticon-name={sortDisplay.icon}\n\t\t\t\tsize=\"md\"\n\t\t\t\tvariant=\"tertiary\"\n\t\t\t\tslot=\"select\"\n\t\t\t\ttooltip-content={sortDisplay.label}\n\t\t\t\tconfigAria={{ 'aria-label': sortDisplay.label }}\n\t\t\t\tappend-to-payload={{\n\t\t\t\t\tactivityAction: AS_SORT_CHANGED_ACTION,\n\t\t\t\t\tsortDirection: -sortDirection\n\t\t\t\t}}\n\t\t\t/>\n\t\t);\n\t}\n\n\t_renderExpandCollapseAll() {\n\t\tconst items = [\n\t\t\t{ id: EXPAND_ALL_POST_ACTION_ID, label: EXPAND_ALL_POST },\n\t\t\t{ id: COLLAPSE_ALL_POST_ACTION_ID, label: COLLAPSE_ALL_POST }\n\t\t];\n\n\t\tconst panelFitProps = {\n\t\t\tposition: document.dir === 'rtl' ? ['bottom-start top-start'] : ['bottom-end top-end']\n\t\t};\n\n\t\t// noinspection HtmlUnknownBooleanAttribute\n\t\treturn (\n\t\t\t<now-dropdown\n\t\t\t\tbare\n\t\t\t\thide-caret\n\t\t\t\tselect=\"none\"\n\t\t\t\titems={items}\n\t\t\t\ticon=\"ellipsis-h-fill\"\n\t\t\t\tsize=\"md\"\n\t\t\t\tvariant=\"secondary\"\n\t\t\t\ttooltip-content={MORE_OPTIONS}\n\t\t\t\tpanel-fit-props={panelFitProps}\n\t\t\t/>\n\t\t);\n\t}\n\n\t_renderActivityContent(state) {\n\t\tconst {\n\t\t\tloading,\n\t\t\terror,\n\t\t\tlastUpdateTimestamp,\n\t\t\tproperties: { nowId }\n\t\t} = state;\n\n\t\tif (error)\n\t\t\treturn this._renderEmptyActivities(state);\n\n\t\tif (loading)\n\t\t\t// noinspection JSXNamespaceValidation\n\t\t\treturn (\n\t\t\t\t<div className=\"sn-loading-state\">\n\t\t\t\t\t<now-loader label={LOADING_TEXT} />\n\t\t\t\t</div>\n\t\t\t);\n\n\t\tconst memoData = memoizedTilesByNowId.get(nowId);\n\t\tconst needUpdate = !memoData || memoData.lastUpdateTimestamp !== lastUpdateTimestamp;\n\t\tconst tiles = needUpdate ? this._renderActivities(state) : memoData.tiles;\n\t\tif (needUpdate)\n\t\t\tmemoizedTilesByNowId.set(nowId, { lastUpdateTimestamp: lastUpdateTimestamp || 0, tiles });\n\n\t\treturn tiles.length > 0 ? tiles : this._renderEmptyActivities(state);\n\t}\n\n\t_createTile(TILE: String, payload: Object, supplemental: Object, setRefCallback) {\n\t\tif (DEFINED_TILES.has(TILE))\n\t\t\t// noinspection JSXNamespaceValidation\n\t\t\treturn (\n\t\t\t\t<TILE\n\t\t\t\t\tclassName=\"tile\"\n\t\t\t\t\t{...payload}\n\t\t\t\t\tsupplemental={supplemental}\n\t\t\t\t\tref={(node) => setRefCallback(node)}\n\t\t\t\t\tkey={`${payload.activityNowId}_${payload.eventSysId}`}\n\t\t\t\t/>\n\t\t\t);\n\t\telse\n\t\t\treturn this._loadExternalTile(TILE, payload, supplemental, setRefCallback);\n\t}\n\n\t_loadExternalTile(TILE, payload, supplemental, setRefCallback) {\n\t\tconsole.error('Attempting to load ' + TILE + ' dynamic loading is not implemented yet', {\n\t\t\tTILE,\n\t\t\tpayload,\n\t\t\tsupplemental,\n\t\t\tsetRefCallback\n\t\t});\n\t\treturn '';\n\t}\n\n\t_getTileBackgroundColor(supplemental, activityDto) {\n\t\treturn get(supplemental, `global.background.subtype.${activityDto.subtype}`, '') || 'neutral';\n\t}\n\n\t_getHydratedTilePayload(activityDto: ActivityDto, supplemental: Object, tileIndex, properties: Object) {\n\t\t// Settings\n\t\tconst { nowId, showTileAvatars, showTileIcons, showFavoriting } = properties;\n\t\tconst payload = activityDto.payload;\n\n\t\tpayload.activityNowId = nowId;\n\t\tpayload.showAvatar = isTrue(showTileAvatars);\n\t\tpayload.showIcon = isTrue(showTileIcons);\n\t\tpayload.showFavorite = isTrue(showFavoriting);\n\n\t\t// ActivityDto stuff\n\t\tpayload.eventCreatedOn = activityDto.eventCreatedOn;\n\t\tpayload.documentTable = activityDto.documentTable;\n\t\tpayload.documentId = activityDto.documentId;\n\t\tpayload.subtype = activityDto.subtype;\n\t\tpayload.eventSysId = activityDto.eventSysId;\n\t\tpayload.eventTable = activityDto.eventTable;\n\t\tpayload.eventTitle = activityDto.eventTitle;\n\n\t\tpayload.activated = tileIndex <= NUM_SKIPPED_LAZY_RENDER_ITEMS;\n\t\tpayload.timeAgo = FluxCapacitorRepo.getTickTime(nowId, activityDto);\n\t\tpayload.backgroundColor = this._getTileBackgroundColor(supplemental, activityDto);\n\n\t\tif (payload.attachments)\n\t\t\tpayload.attachments = payload.attachments.map(\n\t\t\t\t(dto = {}) => AttachmentRepo.getAttachment(nowId, dto.attachment) || new AttachmentDto(dto)\n\t\t\t);\n\n\t\t// Mapped from references\n\t\tif (activityDto.eventCreatedBy) {\n\t\t\tconst userRef: UserReferenceDto = UserReferenceRepo.getFromReferences(nowId, activityDto.eventCreatedBy);\n\t\t\tpayload.author = payload.author\n\t\t\t\t? payload.author\n\t\t\t\t: userRef\n\t\t\t\t\t? userRef.displayName\n\t\t\t\t\t: activityDto.eventCreatedBy;\n\t\t\tpayload.image = payload.image ? payload.image : userRef ? userRef.avatar : '';\n\t\t}\n\n\t\treturn payload;\n\t}\n\n\t_renderActivities(state) {\n\t\tconst tiles = [];\n\t\tconst addTileRef = this._addTileRef;\n\t\tconst { sortDirection, filterOptions, quickFilterSelections, hasQuickFiltersApplied, isFiltering } = state;\n\t\tlet { events, supplemental } = state;\n\n\t\tif (!events || events.length === 0)\n\t\t\treturn tiles;\n\n\t\tFluxCapacitorRepo.createInstance(\n\t\t\tstate.properties.nowId,\n\t\t\tstate.behaviors,\n\t\t\tjsonStringToObject(state.properties.timeAgoOptions)\n\t\t);\n\n\t\tlet tileIndex = 0;\n\n\t\tconst transformedEvents = ActivityFilter.transformAndFilterEvents(events, filterOptions, isFiltering);\n\t\tif (transformedEvents.length === 0)\n\t\t\treturn [];\n\n\t\tconst maxBoundIndex = Math.max(0, transformedEvents.length - 1);\n\t\tconst bounds = sortDirection === 1 ? [maxBoundIndex, 0] : [0, maxBoundIndex];\n\n\t\tfor (let i = bounds[0]; i !== bounds[1] - sortDirection; i -= sortDirection) {\n\t\t\tconst activityDto = transformedEvents[i];\n\t\t\ttileIndex++;\n\t\t\tconst supplementalPayload = supplemental.event[activityDto.eventSysId] || {};\n\t\t\tconst payload = this._getHydratedTilePayload(activityDto, supplemental, tileIndex, state.properties);\n\t\t\tif (\n\t\t\t\thasQuickFiltersApplied &&\n\t\t\t\tshouldFilterOutEvent(activityDto, quickFilterSelections, payload, supplementalPayload)\n\t\t\t)\n\t\t\t\tcontinue;\n\t\t\tconst tile = this._createTile(activityDto.tile, payload, supplementalPayload, (node) =>\n\t\t\t\taddTileRef(activityDto, node, state, tileIndex)\n\t\t\t);\n\t\t\tif (tile)\n\t\t\t\ttiles.push(tile);\n\t\t}\n\n\t\treturn tiles;\n\t}\n\n\t_renderEmptyActivities(state) {\n\t\tconst { isNewRecord } = state.properties;\n\t\tconst { error, isFiltering } = state;\n\n\t\tconst body = error\n\t\t\t? SOMETHING_WENT_WRONG\n\t\t\t: isTrue(isNewRecord)\n\t\t\t\t? NEW_RECORD_EMPTY_ACTIVITY\n\t\t\t\t: isFiltering\n\t\t\t\t\t? NO_RESULTS_FOR_FILTER\n\t\t\t\t\t: NO_ACTIVITY_WAITING;\n\n\t\t// noinspection JSXNamespaceValidation\n\t\treturn (\n\t\t\t<div className=\"sn-as-empty-state\">\n\t\t\t\t<div className=\"sn-as-empty-state-row header\">\n\t\t\t\t\t<h3 className=\"sn-as-empty-state-header\">{NO_ACTIVITY_TO_DISPLAY}</h3>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"sn-as-empty-state-row\">\n\t\t\t\t\t<div className=\"sn-as-empty-state-image\">\n\t\t\t\t\t\t<img alt={NO_ACTIVITY_TO_DISPLAY} src={emptySvg} />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"sn-as-empty-state-row footer\">\n\t\t\t\t\t<span className=\"sn-as-empty-state-body\" id=\"noActivity\">\n\t\t\t\t\t\t{body}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t_addTileRef(activityDto: ActivityDto, tile, state, tileIndex) {\n\t\tconst nowId = state.properties.nowId;\n\n\t\tTilesRepo.setTile(nowId, activityDto.eventSysId, tile);\n\t\tFluxCapacitorRepo.addTimedTile(nowId, activityDto);\n\n\t\tif (tileIndex <= NUM_SKIPPED_LAZY_RENDER_ITEMS)\n\t\t\treturn;\n\n\t\tstate.properties.observeTile(nowId, tile);\n\t}\n}\n\nconst AS = new NowActivityStream();\n/**\n * Component that shows a list of events that have occurred to a record.\n *\n * Basic usage:\n *\n * ```js\n * const events = [\n * \t\t{\n *\t\t\tdocumentTable: 'incident',\n *\t\t\tdocumentId: 'record-sys-id-1',\n *\t\t\teventTable: 'sys_journal_field',\n *\t\t\teventSysId: 'event-sys-id-' + i,\n *\t\t\teventCreatedOn: eventDate,\n *\t\t\teventCreatedBy: 'System Administrator',\n *\t\t\tsubtype: 'work_notes',\n *\t\t\ttile: 'journal-tile',\n *\t\t\teventTitle: 'worknote',\n *\t\t\tpayload: {\n *\t\t\t\timage: 'c148e1d13741310042106710ce41f149.iix?t=small',\n *\t\t\t\tauthor: 'System Administrator',\n *\t\t\t\tbackgroundColor: 'yellow',\n *\t\t\t\tvalue: '<b>Lorem ipsum</b> dolor sit amet, consectetur adipiscing elit.'\n *\t\t\t}\n *\t\t}\n * ];\n * // On the above: Optionally you can omit image from payload and provide an email or sysId on author if userReferences data is provided\n *\n * const filterOptions = [\n * \t{ selected: true, label: 'Additional comments', name: 'comments', journal: true },\n * \t{ selected: true, label: 'Assigned to', name: 'assigned_to', journal: false },\n * \t{ selected: true, label: 'Attachments', name: '*Attachments*', journal: false },\n * \t{ selected: true, label: 'Configuration item', name: 'cmdb_ci', journal: false },\n * \t{ selected: true, label: 'Impact', name: 'impact', journal: false },\n * \t{ selected: true, label: 'Incident state', name: 'incident_state', journal: false },\n * \t{ selected: true, label: 'Opened by', name: 'opened_by', journal: false },\n * \t{ selected: true, label: 'Priority', name: 'priority', journal: false },\n * \t{ selected: true, label: 'Relationship Changes', name: '*Relations*', journal: false },\n * \t{ selected: true, label: 'Resolution code', name: 'close_code', journal: false },\n * \t{ selected: true, label: 'Resolution notes', name: 'close_notes', journal: false },\n * \t{ selected: true, label: 'Sent/Received Emails', name: '*Email*', journal: false },\n * \t{ selected: true, label: 'Work notes', name: 'work_notes', journal: true }\n * ];\n * // On the above: journal is use for knowing which fields are conversational for the conversation filter\n *\n * <now-activity-stream\n * \ttitle=\"Activity - Presentational\"\n * \tfilter-options={filterOptions}\n * \tevents={events}\n * />\n * ```\n *\n * @seismicElement now-activity-stream\n * @summary Component that shows a list of events that have occurred to a record.\n **/\ncreateCustomElement(NOW_ACTIVITY_STREAM, {\n\t...AS.getCustomElementParts(),\n\tproperties: propertyDefs\n});\nexport const NowActivityStreamElement = AS.getComponentName();\nexport default AS.getComponentName();\n","import { createGraphQLEffect } from '@servicenow/ui-effect-graphql';\nimport { cloneDeep, get, groupBy, set } from 'lodash';\nimport DataTransformer from '../activity/DataTransformer';\nimport {\n\tAS_FETCH_EMAIL_ATTACHMENTS_REQUESTED_ACTION,\n\tAS_FETCH_EMAIL_ATTACHMENTS_SUCCEEDED_ACTION,\n\tAS_FETCH_EMAIL_ATTACHMENTS_FAILED_ACTION\n} from './actions';\n\nconst EMAIL_ATTACHMENTS_QUERY = `\nquery($emailSysIds: [String!]) {\n\tGlideActivity_Query {\n\t\tgetEmailAttachments(emailSysIds: $emailSysIds) {\n\t\t\tfileName\n\t\t\tattachment\n\t\t\temail\n\t\t\tcontentDisposition\n\t\t\tsize\n\t\t\ttype\n\t\t}\n\t}\n}\n`;\nexport const EMAIL_ATTACHMENTS_DATA_PATH = ['payload', 'data', 'GlideActivity_Query', 'getEmailAttachments'];\nexport const emailAttachmentBehavior = {\n\tname: 'emailAttachmentBehavior',\n\n\tactions: {\n\t\t[AS_FETCH_EMAIL_ATTACHMENTS_REQUESTED_ACTION]: { private: true },\n\t\t[AS_FETCH_EMAIL_ATTACHMENTS_SUCCEEDED_ACTION]: { private: true },\n\t\t[AS_FETCH_EMAIL_ATTACHMENTS_FAILED_ACTION]: { private: true }\n\t},\n\n\tactionHandlers: {\n\t\t[AS_FETCH_EMAIL_ATTACHMENTS_REQUESTED_ACTION]: createGraphQLEffect(EMAIL_ATTACHMENTS_QUERY, {\n\t\t\tvariableList: ['emailSysIds'],\n\t\t\tsuccessActionType: AS_FETCH_EMAIL_ATTACHMENTS_SUCCEEDED_ACTION,\n\t\t\terrorActionType: AS_FETCH_EMAIL_ATTACHMENTS_FAILED_ACTION\n\t\t}),\n\n\t\t[AS_FETCH_EMAIL_ATTACHMENTS_SUCCEEDED_ACTION]: ({ action, updateState }) => {\n\t\t\tconst attachments = get(action, EMAIL_ATTACHMENTS_DATA_PATH, []);\n\t\t\tconst attachmentsByEmailId = groupBy(attachments, 'email');\n\n\t\t\tconst updateStateWithNoAttachments = ({ state }) => ({\n\t\t\t\tloading: false,\n\t\t\t\tshouldUpdate: state.loading\n\t\t\t});\n\n\t\t\tconst updateStateWithAttachments = ({ state, properties }) => {\n\t\t\t\tconst { events = [] } = state;\n\t\t\t\tconst { table, sysId } = properties;\n\t\t\t\tconst defaultEvents = properties.events || [];\n\n\t\t\t\tconst transformer = new DataTransformer();\n\t\t\t\tconst transformEvent = transformer.oldEventTransform(table, sysId);\n\n\t\t\t\tconst addAttachments = (attachments, event) =>\n\t\t\t\t\tattachments ? set(cloneDeep(event), ['payload', 'attachments'], attachments) : event;\n\t\t\t\tconst lookupAndAddAttachments = (event) =>\n\t\t\t\t\tevent.eventTable === 'sys_email'\n\t\t\t\t\t\t? addAttachments(attachmentsByEmailId[event.eventSysId], event)\n\t\t\t\t\t\t: event;\n\n\t\t\t\treturn {\n\t\t\t\t\tloading: false,\n\t\t\t\t\tlastUpdateTimestamp: Date.now(),\n\t\t\t\t\tevents:\n\t\t\t\t\t\tevents.length === 0\n\t\t\t\t\t\t\t? defaultEvents.map((event) => lookupAndAddAttachments(transformEvent(event)))\n\t\t\t\t\t\t\t: events.map(lookupAndAddAttachments)\n\t\t\t\t};\n\t\t\t};\n\n\t\t\tupdateState(attachments.length === 0 ? updateStateWithNoAttachments : updateStateWithAttachments);\n\t\t},\n\n\t\t[AS_FETCH_EMAIL_ATTACHMENTS_FAILED_ACTION]: ({ updateState }) => {\n\t\t\tconsole.error('Failed to fetch email attachments');\n\n\t\t\tupdateState({\n\t\t\t\tloading: false\n\t\t\t});\n\t\t}\n\t}\n};\n","import { createAmbSubscriptionEffect } from '@servicenow/ui-effect-amb';\nimport { get, debounce } from 'lodash';\nimport { jsonStringToObject, jsonStringToArray } from '../shared/utils';\nimport { addToSupplementalMap, getEventTransformer, updateRepos } from './activityStreamGraphQLBehavior';\n// noinspection ES6CheckImport\nimport { actionTypes } from '@servicenow/ui-core';\nimport {\n\tAS_REQUEST_AMB_ACTIONS_ARE_PRIVATE,\n\tAS_REQUEST_AMB_CONNECTIONS_ACTION,\n\tAS_REQUEST_AMB_DISCONNECTIONS_ACTION\n} from '../activity/actions';\nimport { AS_FETCH_ACTIVITY_REQUESTED_ACTION, AS_FETCH_EMAIL_ATTACHMENTS_REQUESTED_ACTION } from './actions';\n\nconst { COMPONENT_DISCONNECTED } = actionTypes;\nconst AS_AMB_ACTIONS = {\n\tMESSAGE_RECEIVED: 'MESSAGE_RECEIVED',\n\tSUBSCRIPTION_FAILED: 'SUBSCRIPTION_FAILED'\n};\n\nconst UPDATE = 'update';\nconst DELETE = 'delete';\nconst SUPPLEMENTAL_UPDATE = 'supplemental_update';\n\nconst deletedMap = new Map();\n\nconst _processMessage = (nowId, events = [], operation, data) => {\n\tconst newEvents = events.slice();\n\tconst {\n\t\teventCreatedOn: { numericValue: newEventCreatedTime },\n\t\teventSysId: newEventSysId\n\t} = data;\n\n\tconst deletedEvents: Set = deletedMap.get(nowId);\n\n\tfor (let index = 0, len = newEvents.length; index < len; index++) {\n\t\tif (newEvents[index].eventSysId !== newEventSysId)\n\t\t\tcontinue;\n\t\tif (operation === UPDATE) {\n\t\t\tnewEvents.splice(index, 1, data);\n\t\t\treturn newEvents;\n\t\t}\n\t\tif (operation === DELETE) {\n\t\t\tnewEvents.splice(index, 1);\n\t\t\tdeletedEvents.add(newEventSysId);\n\t\t\treturn newEvents;\n\t\t}\n\t}\n\n\tif (deletedEvents.has(newEventSysId))\n\t\treturn newEvents;\n\n\tfor (let i = 0; i < newEvents.length; i++) {\n\t\tconst {\n\t\t\teventCreatedOn: { numericValue },\n\t\t\teventSysId\n\t\t} = newEvents[i];\n\n\t\tif (eventSysId === newEventSysId)\n\t\t\treturn newEvents;\n\n\t\tif (numericValue > newEventCreatedTime) {\n\t\t\tnewEvents.splice(Math.max(i - 1, 0), 0, data);\n\t\t\treturn newEvents;\n\t\t}\n\t}\n\n\tnewEvents.splice(0, 0, data);\n\treturn newEvents;\n};\n\nconst messageBuffer = new Map();\nconst messageProcessors = new Map();\nconst effectsByNowIdAndChannel = new Map();\nconst MESSAGE_BUFFER_FLUSH_TIME = 500;\n\nconst createMessageProcessor = (nowId, events, updateState) => {\n\tif (messageBuffer.has(nowId))\n\t\treturn;\n\n\tmessageBuffer.set(nowId, []);\n\tdeletedMap.set(nowId, new Set());\n\tmessageProcessors.set(\n\t\tnowId,\n\t\tdebounce(() => {\n\t\t\tconst messages = messageBuffer.get(nowId);\n\t\t\tlet processedEvents = events.slice();\n\t\t\tlet processedUsers = [];\n\t\t\tmessages.forEach(({ messagePayload, userReferences, operation }) => {\n\t\t\t\tprocessedEvents = _processMessage(nowId, processedEvents, operation, messagePayload);\n\t\t\t\tprocessedUsers = processedUsers.concat(userReferences);\n\t\t\t});\n\n\t\t\tupdateRepos({\n\t\t\t\tnowId,\n\t\t\t\tevents: processedEvents,\n\t\t\t\tuserReferences: processedUsers\n\t\t\t});\n\n\t\t\tupdateState({\n\t\t\t\tevents: processedEvents,\n\t\t\t\tlastUpdateTimestamp: Date.now()\n\t\t\t});\n\n\t\t\tmessageBuffer.delete(nowId);\n\t\t}, MESSAGE_BUFFER_FLUSH_TIME)\n\t);\n};\nconst addMessage = (nowId, events, messagePayload, userReferences, operation, updateState) => {\n\tcreateMessageProcessor(nowId, events, updateState);\n\tmessageBuffer.get(nowId).push({ messagePayload, userReferences, operation });\n\tmessageProcessors.get(nowId)();\n};\n\nconst handleSuplementalUpdates = (state, data, updateState) => {\n\tconst { supplemental } = state;\n\n\tconst supplementalMap = addToSupplementalMap(supplemental, data);\n\n\tupdateState({\n\t\tsupplemental: { ...supplementalMap }\n\t});\n};\n\nexport const activityStreamAmbBehavior = {\n\tname: 'activityStreamAmbBehavior',\n\n\tactions: {\n\t\t[AS_REQUEST_AMB_CONNECTIONS_ACTION]: { private: AS_REQUEST_AMB_ACTIONS_ARE_PRIVATE },\n\t\t[AS_REQUEST_AMB_DISCONNECTIONS_ACTION]: { private: AS_REQUEST_AMB_ACTIONS_ARE_PRIVATE }\n\t},\n\n\tactionHandlers: {\n\t\t[AS_REQUEST_AMB_CONNECTIONS_ACTION]: (coeffects) => {\n\t\t\tconst {\n\t\t\t\taction,\n\t\t\t\tproperties: { nowId }\n\t\t\t} = coeffects;\n\t\t\tconst { ambChannels = [] } = action.payload;\n\t\t\tambChannels.forEach((channel) => {\n\t\t\t\tif (!effectsByNowIdAndChannel.get(nowId))\n\t\t\t\t\teffectsByNowIdAndChannel.set(nowId, new Map());\n\n\t\t\t\tconst effectsByChannel = effectsByNowIdAndChannel.get(nowId);\n\t\t\t\tif (!effectsByChannel.has(channel)) {\n\t\t\t\t\tconst channelEffect = createAmbSubscriptionEffect(channel, {\n\t\t\t\t\t\tmessageReceivedActionType: AS_AMB_ACTIONS.MESSAGE_RECEIVED,\n\t\t\t\t\t\tsubscribeFailedActionType: AS_AMB_ACTIONS.SUBSCRIPTION_FAILED\n\t\t\t\t\t});\n\n\t\t\t\t\teffectsByChannel.set(channel, channelEffect);\n\t\t\t\t\tchannelEffect.effect(...channelEffect.args, coeffects);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t[AS_REQUEST_AMB_DISCONNECTIONS_ACTION]: (coeffects) => {\n\t\t\tconst {\n\t\t\t\tproperties: { nowId }\n\t\t\t} = coeffects;\n\t\t\tconst effects: Map = effectsByNowIdAndChannel.get(nowId);\n\t\t\tfor (const ambEffect of effects.values())\n\t\t\t\tambEffect.effect(...ambEffect.args, coeffects);\n\t\t\teffectsByNowIdAndChannel.delete(nowId);\n\t\t},\n\n\t\t[AS_AMB_ACTIONS.SUBSCRIPTION_FAILED]: (coeffects) => {\n\t\t\tconst ambEffect = get(coeffects, 'action.payload.ambEffect', null);\n\t\t\tconsole.error('Something went wrong when creating the AMB connection for ' + ambEffect);\n\t\t},\n\n\t\t[AS_AMB_ACTIONS.MESSAGE_RECEIVED]: ({ dispatch, properties, state, updateState, action }) => {\n\t\t\ttry {\n\t\t\t\tconst { data: dataStr = null, userReferences: userStr = null, operation } = action.payload.data;\n\t\t\t\tconst data = jsonStringToObject(dataStr);\n\t\t\t\tconst userReferences = jsonStringToArray(userStr);\n\t\t\t\tif (operation === SUPPLEMENTAL_UPDATE) {\n\t\t\t\t\thandleSuplementalUpdates(state, data, updateState);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!data) {\n\t\t\t\t\tdispatch(AS_FETCH_ACTIVITY_REQUESTED_ACTION, {\n\t\t\t\t\t\ttable: properties.table,\n\t\t\t\t\t\tsysId: properties.sysId,\n\t\t\t\t\t\tview: properties.view,\n\t\t\t\t\t\ttimestamp: properties.timestamp\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst event = getEventTransformer(state)(data);\n\t\t\t\taddMessage(properties.nowId, state.events, event, userReferences, operation, updateState);\n\n\t\t\t\tif (state.apiVersion === 0 && operation !== DELETE && event.eventTable === 'sys_email')\n\t\t\t\t\tdispatch(AS_FETCH_EMAIL_ATTACHMENTS_REQUESTED_ACTION, {\n\t\t\t\t\t\temailSysIds: [event.eventSysId]\n\t\t\t\t\t});\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error('Activity Stream: AMB MESSAGE_RECEIVED ERROR', e);\n\t\t\t}\n\t\t},\n\n\t\t[COMPONENT_DISCONNECTED]: ({ dispatch, properties: { nowId } }) => {\n\t\t\tdispatch(AS_REQUEST_AMB_DISCONNECTIONS_ACTION, { subscribe: false });\n\n\t\t\tdeletedMap.delete(nowId);\n\n\t\t\tconst inTransitMessage = messageProcessors.get(nowId);\n\t\t\tif (inTransitMessage)\n\t\t\t\tinTransitMessage.cancel();\n\n\t\t\tmessageProcessors.delete(nowId);\n\t\t\tmessageBuffer.delete(nowId);\n\t\t}\n\t}\n};\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport { actionTypes } from '@servicenow/ui-core';\nimport { get } from 'lodash';\n\nconst { COMPONENT_RENDERED, COMPONENT_CONNECTED, COMPONENT_DISCONNECTED } = actionTypes;\n\nconst ACTION_FETCH_URLS_SUCCEEDED = 'NOW_LINK_INTERCEPTOR_FETCH_URLS_SUCCEEDED';\nconst ACTION_FETCH_URLS_FAILED = 'ACTION_FETCH_URLS_FAILED';\nconst ACTION_FETCH_URLS = 'ACTION_FETCH_URLS';\n\nconst NOW_LINK_INTERCEPTOR_MAX_RETRY = 3; //Attempts\nconst NOW_LINK_INTERCEPTOR_RETRY_AFTER = 1000; //Milliseconds\nconst NOW_LINK_INTERCEPTOR_PREVIEW_RECORD_ACTION = 'PREVIEW_RECORD'; // Workspace chrome action\nconst NOW_LINK_INTERCEPTOR_REQUESTED = 'REQUESTED'; // Temporary url state while waiting for rest call to complete\nconst TABLES_OPEN_OUTSIDE_WORKSPACE = new Set(['sys_attachment']);\n\nlet nowLinkInterceptorState = {\n\tretryHandler: null,\n\tretryCount: 0,\n\tcapturedUrls: {},\n\tpropsToHtmlArrayByComponentId: new Map(),\n\tcoeffectsToHtmlArrayByComponentId: new Map()\n};\n\nconst extractAnchorUrls = (html) => {\n\tconst foundUrls = new Set();\n\tconst regExp = /<a\\s*[^>]*?\\s?href\\s*=\\s*[\"']([^\"']*)[\"']/gi;\n\tconst results = [...html.matchAll(regExp)];\n\tresults.forEach((match) => {\n\t\tconst href = match[1];\n\t\tif (href)\n\t\t\tfoundUrls.add(href.replace(/&#61;/g, '='));\n\t});\n\treturn foundUrls;\n};\n\nconst processProps = (coeffects) => {\n\tconst nowId = coeffects.properties.nowId;\n\tconst fromCoeffectsFnc = nowLinkInterceptorState.coeffectsToHtmlArrayByComponentId.get(nowId);\n\tconst fromPropsFnc = nowLinkInterceptorState.propsToHtmlArrayByComponentId.get(nowId);\n\tconst toHtmlArray = fromCoeffectsFnc || fromPropsFnc;\n\tconst params = fromCoeffectsFnc ? coeffects : coeffects.properties;\n\n\tif (!toHtmlArray)\n\t\treturn;\n\n\tlet newUrls = new Set();\n\ttoHtmlArray(params).forEach((text) => {\n\t\textractAnchorUrls(text).forEach((t) => {\n\t\t\tconst toCapture = t[0] === '/' ? t.substring(1) : t;\n\t\t\tif (!nowLinkInterceptorState.capturedUrls[toCapture]) {\n\t\t\t\tnowLinkInterceptorState.capturedUrls[toCapture] = NOW_LINK_INTERCEPTOR_REQUESTED;\n\t\t\t\tnewUrls.add(toCapture);\n\t\t\t}\n\t\t});\n\t});\n\n\tif (newUrls.size > 0)\n\t\tcoeffects.dispatch(ACTION_FETCH_URLS, { sysparm_link: Array.from(newUrls) });\n};\n\nconst handleFetchUrlsError = (coeffects) => {\n\tlet newUrls = new Set();\n\n\tObject.keys(nowLinkInterceptorState.capturedUrls).forEach((k) => {\n\t\tif (nowLinkInterceptorState.capturedUrls[k] === NOW_LINK_INTERCEPTOR_REQUESTED)\n\t\t\tnewUrls.add(k);\n\t});\n\n\tif (nowLinkInterceptorState.retryHandler) {\n\t\tclearTimeout(nowLinkInterceptorState.retryHandler);\n\t\tnowLinkInterceptorState.retryHandler = null;\n\t}\n\n\tif (nowLinkInterceptorState.retryCount < NOW_LINK_INTERCEPTOR_MAX_RETRY)\n\t\tnowLinkInterceptorState.retryHandler = setTimeout(() => {\n\t\t\tnowLinkInterceptorState.retryHandler = null;\n\t\t\tnowLinkInterceptorState.retryCount++;\n\t\t\tcoeffects.dispatch(ACTION_FETCH_URLS, { sysparm_link: Array.from(newUrls) }); //REQUEST\n\t\t}, NOW_LINK_INTERCEPTOR_RETRY_AFTER);\n};\n\nexport const nowLinkInterceptorBehavior = {\n\tname: 'nowLinkInterceptorBehavior',\n\n\tproperties: {\n\t\tcapturedUrls: { default: {} },\n\t\tpropsToHtmlArray: { default: null },\n\t\tnowLinkInterceptor: {\n\t\t\tdefault: {\n\t\t\t\tretryHandler: null,\n\t\t\t\tretryCount: 0,\n\t\t\t\tcapturedUrls: {}\n\t\t\t}\n\t\t}\n\t},\n\n\tactionHandlers: {\n\t\t[ACTION_FETCH_URLS]: createHttpEffect('/api/now/ui/link_parser', {\n\t\t\tmethod: 'POST',\n\t\t\tbatch: true,\n\t\t\tsuccessActionType: ACTION_FETCH_URLS_SUCCEEDED,\n\t\t\terrorActionType: ACTION_FETCH_URLS_FAILED,\n\t\t\tqueryParams: ['sysparm_link']\n\t\t}),\n\t\t[ACTION_FETCH_URLS_SUCCEEDED]: (coeffects) => {\n\t\t\tconst {\n\t\t\t\taction: {\n\t\t\t\t\tpayload: { result = [] }\n\t\t\t\t}\n\t\t\t} = coeffects;\n\t\t\tif (result)\n\t\t\t\tresult.forEach((urlEntry) => {\n\t\t\t\t\tnowLinkInterceptorState.capturedUrls[urlEntry.url] = urlEntry;\n\t\t\t\t});\n\t\t},\n\t\t[ACTION_FETCH_URLS_FAILED]: handleFetchUrlsError,\n\t\t[COMPONENT_RENDERED]: processProps,\n\t\t[COMPONENT_CONNECTED]: (coeffects) => {\n\t\t\tconst {\n\t\t\t\tproperties,\n\t\t\t\taction: {\n\t\t\t\t\tpayload: {\n\t\t\t\t\t\toptions: { propsToHtmlArray = null, coeffectsToHtmlArray = null }\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} = coeffects;\n\n\t\t\tif (!propsToHtmlArray && !coeffectsToHtmlArray) {\n\t\t\t\tconsole.error(\n\t\t\t\t\t'No propsToHtmlArray or coeffectsToHtmlArray function passed to nowLinkInterceptorBehavior options or present in host component properties, interceptor will not work!'\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst nowId = properties.nowId;\n\n\t\t\tif (coeffectsToHtmlArray)\n\t\t\t\tnowLinkInterceptorState.coeffectsToHtmlArrayByComponentId.set(nowId, coeffectsToHtmlArray);\n\t\t\telse\n\t\t\t\tnowLinkInterceptorState.propsToHtmlArrayByComponentId.set(nowId, propsToHtmlArray);\n\n\t\t\tprocessProps(coeffects);\n\t\t},\n\t\t[COMPONENT_DISCONNECTED]: (coeffects) => {\n\t\t\tconst {\n\t\t\t\tproperties: { nowId }\n\t\t\t} = coeffects;\n\t\t\tnowLinkInterceptorState.propsToHtmlArrayByComponentId.delete(nowId);\n\t\t\tnowLinkInterceptorState.coeffectsToHtmlArrayByComponentId.delete(nowId);\n\t\t}\n\t},\n\n\teventHandlers: [\n\t\t{\n\t\t\tevents: ['click'],\n\t\t\teffect({\n\t\t\t\tdispatch,\n\t\t\t\taction: {\n\t\t\t\t\tpayload: { event }\n\t\t\t\t}\n\t\t\t}) {\n\t\t\t\tconst path = event.composedPath() || event.path || [];\n\n\t\t\t\tif (path.length === 0)\n\t\t\t\t\treturn true;\n\n\t\t\t\tlet anchor = null;\n\t\t\t\tfor (let i = 0; i < path.length; i++)\n\t\t\t\t\tif (path[i].tagName === 'A') {\n\t\t\t\t\t\tanchor = path[i];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\tif (!anchor || !anchor.getAttribute('href'))\n\t\t\t\t\treturn;\n\n\t\t\t\tconst url = anchor.getAttribute('href');\n\t\t\t\tconst cleanedUrl = url.length > 0 && url[0] === '/' ? url.substring(1) : url;\n\t\t\t\tconst captured = nowLinkInterceptorState.capturedUrls[cleanedUrl] || null;\n\t\t\t\tconst isOpenInNewTab =\n\t\t\t\t\tevent.ctrlKey || event.shiftKey || event.metaKey || (event.button && event.button === 1);\n\n\t\t\t\tif (\n\t\t\t\t\tisOpenInNewTab ||\n\t\t\t\t\t!captured ||\n\t\t\t\t\tcaptured === NOW_LINK_INTERCEPTOR_REQUESTED ||\n\t\t\t\t\t(captured.type || '') === 'NOT_FOUND'\n\t\t\t\t)\n\t\t\t\t\treturn;\n\n\t\t\t\tconst openInWorkspace = (table, sys_id) => {\n\t\t\t\t\tdispatch(NOW_LINK_INTERCEPTOR_PREVIEW_RECORD_ACTION, {\n\t\t\t\t\t\ttable,\n\t\t\t\t\t\tsys_id\n\t\t\t\t\t});\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t};\n\n\t\t\t\tconst table = get(captured, 'type_metadata.table', '');\n\t\t\t\tconst sysId = get(captured, 'type_metadata.sys_id', '');\n\t\t\t\tif (table && sysId && !TABLES_OPEN_OUTSIDE_WORKSPACE.has(table))\n\t\t\t\t\topenInWorkspace(table, sysId);\n\n\t\t\t\tconst sysKBId = get(captured, 'query_params.sys_kb_id', '');\n\t\t\t\tif (sysKBId && captured.type === 'UIPAGE' && captured.url.indexOf('kb_view.do') !== -1)\n\t\t\t\t\topenInWorkspace('kb_knowledge', sysKBId);\n\t\t\t}\n\t\t}\n\t]\n};\n","import { AS_FILTER_CHANGED_ACTION } from '../activity/actions';\nimport {\n\tAS_SAVE_FILTER_REQUESTED_ACTION,\n\tAS_SAVE_FILTER_FAILED_ACTION,\n\tAS_SAVE_FILTER_REQUESTED_ACTION_IS_PRIVATE,\n\tAS_SAVE_FILTER_SUCCEEDED_ACTION\n} from './actions';\nimport { registerSupplementalBehavior } from './supplementalDataBehavior';\nimport { isTrue } from '../shared/utils';\n\nregisterSupplementalBehavior({\n\tsaveAction: AS_SAVE_FILTER_REQUESTED_ACTION,\n\tsaveSucceededAction: AS_SAVE_FILTER_SUCCEEDED_ACTION,\n\tsaveFailedAction: AS_SAVE_FILTER_FAILED_ACTION,\n\tisPrivate: AS_SAVE_FILTER_REQUESTED_ACTION_IS_PRIVATE\n});\n\nexport const saveFiltersBehavior = {\n\tname: 'saveFiltersBehavior',\n\tactionHandlers: {\n\t\t[AS_FILTER_CHANGED_ACTION]: (coeffects) => {\n\t\t\tconst {\n\t\t\t\taction: {\n\t\t\t\t\tpayload: { filterOptions, quickFilterSelections }\n\t\t\t\t},\n\t\t\t\tproperties: { sysId },\n\t\t\t\tdispatch\n\t\t\t} = coeffects;\n\n\t\t\tconst selections = {};\n\t\t\tfilterOptions.forEach((field) => {\n\t\t\t\tselections[field.name] = isTrue(field.selected);\n\t\t\t});\n\t\t\tconst payload = JSON.stringify({ filterOptions: selections, quickFilterSelections });\n\t\t\tdispatch(AS_SAVE_FILTER_REQUESTED_ACTION, {\n\t\t\t\tdocumentSysId: sysId,\n\t\t\t\teventId: null,\n\t\t\t\tpayload,\n\t\t\t\tisForAllUsers: false\n\t\t\t});\n\t\t}\n\t}\n};\n","import { AS_SORT_CHANGED_ACTION, AS_SORT_CHANGED_ACTION_IS_PRIVATE } from '../activity/actions';\nimport {\n\tAS_SAVE_SORT_DIRECTION_REQUESTED_ACTION,\n\tAS_SAVE_SORT_DIRECTION_SUCCEEDED_ACTION,\n\tAS_SAVE_SORT_DIRECTION_FAILED_ACTION,\n\tAS_SAVE_SORT_DIRECTION_REQUESTED_ACTION_IS_PRIVATE\n} from './actions';\nimport { registerSupplementalBehavior } from './supplementalDataBehavior';\n\nregisterSupplementalBehavior({\n\tsaveAction: AS_SAVE_SORT_DIRECTION_REQUESTED_ACTION,\n\tsaveSucceededAction: AS_SAVE_SORT_DIRECTION_SUCCEEDED_ACTION,\n\tsaveFailedAction: AS_SAVE_SORT_DIRECTION_FAILED_ACTION,\n\tisPrivate: AS_SAVE_SORT_DIRECTION_REQUESTED_ACTION_IS_PRIVATE\n});\n\nexport const saveSortDirectionBehavior = {\n\tname: 'saveSortDirectionBehavior',\n\tactions: {\n\t\t[AS_SORT_CHANGED_ACTION]: { private: AS_SORT_CHANGED_ACTION_IS_PRIVATE }\n\t},\n\tactionHandlers: {\n\t\t[AS_SORT_CHANGED_ACTION]: ({ action, dispatch, properties }) => {\n\t\t\tconst { sortDirection } = action.payload;\n\t\t\tconst { sysId } = properties;\n\n\t\t\tdispatch(AS_SAVE_SORT_DIRECTION_REQUESTED_ACTION, {\n\t\t\t\tdocumentSysId: sysId,\n\t\t\t\teventId: '',\n\t\t\t\tpayload: JSON.stringify({ sortDirection }),\n\t\t\t\tisForAllUsers: false\n\t\t\t});\n\t\t}\n\t}\n};\n","import { get } from 'lodash';\nimport { getProperty } from 'sn-uxpage-presource';\nimport { NowActivityStream } from '../activity/NowActivityStream';\nimport { activityStreamGraphQLBehavior } from './activityStreamGraphQLBehavior';\nimport { emailAttachmentBehavior } from './emailAttachmentBehavior';\nimport { activityStreamAmbBehavior } from './activityStreamAmbBehavior';\nimport { supplementalBehaviors } from './supplementalDataBehavior';\nimport { nowLinkInterceptorBehavior } from '../now-link-interceptor/nowLinkInterceptorBehavior';\nimport { saveFiltersBehavior } from './saveFiltersBehavior';\nimport { saveSortDirectionBehavior } from './saveSortDirectionBehavior';\nimport { userPreferencesBehavior } from 'sn-user-preferences';\nimport ActivityDto from '../activity/ActivityDto';\nimport DataTransformer from '../activity/DataTransformer';\nimport { EVENT_TABLES } from '../activity/constants';\nimport { createCustomElement } from '@servicenow/ui-core';\n\nconst NOW_ACTIVITY_STREAM_CONNECTED = 'now-activity-stream-connected';\nconst SHOW_CONVERSATION_FILTER_SETTING = 'com.glide.activity.show_conversation_filter';\nconst SHOW_TILE_AVATARS = 'glide.activity.show_tile_avatars';\nconst SHOW_TILE_ICONS = 'glide.activity.show_tile_icons';\nconst SHOW_FAVORITING = 'com.glide.activity.show_favoriting';\n\nexport class NowActivityStreamConnected extends NowActivityStream {\n\tgetComponentName() {\n\t\treturn NOW_ACTIVITY_STREAM_CONNECTED;\n\t}\n\n\tgetInitialState() {\n\t\treturn {\n\t\t\t...super.getInitialState(),\n\t\t\tloading: true\n\t\t};\n\t}\n\n\tgetInitialRenderState(state) {\n\t\tconst events = state.properties.events || [];\n\t\treturn {\n\t\t\t...super.getInitialRenderState(state),\n\t\t\tloading: events.length === 0\n\t\t};\n\t}\n\n\tgetRecordPreviewPrefix() {\n\t\treturn 'NOW_ACTIVITY_STREAM_CONNECTED#';\n\t}\n\n\tgetPropertyDefinitions() {\n\t\treturn {\n\t\t\t...super.getPropertyDefinitions(),\n\t\t\tshowConversationFilter: { default: getProperty(SHOW_CONVERSATION_FILTER_SETTING, true) },\n\t\t\tshowTileAvatars: { default: getProperty(SHOW_TILE_AVATARS, false) },\n\t\t\tshowTileIcons: { default: getProperty(SHOW_TILE_ICONS, true) },\n\t\t\tshowFavoriting: { default: getProperty(SHOW_FAVORITING, false) }\n\t\t};\n\t}\n\n\tgetBehaviors() {\n\t\treturn [\n\t\t\t...super.getBehaviors(),\n\t\t\t{ behavior: activityStreamGraphQLBehavior },\n\t\t\t{ behavior: emailAttachmentBehavior },\n\t\t\t{\n\t\t\t\tbehavior: nowLinkInterceptorBehavior,\n\t\t\t\toptions: {\n\t\t\t\t\tcoeffectsToHtmlArray: this.getHtmlArrayFromCoeffects\n\t\t\t\t}\n\t\t\t},\n\t\t\t{ behavior: saveFiltersBehavior },\n\t\t\t{ behavior: saveSortDirectionBehavior },\n\t\t\t{ behavior: userPreferencesBehavior },\n\t\t\t{ behavior: activityStreamAmbBehavior },\n\t\t\t...supplementalBehaviors\n\t\t];\n\t}\n\n\tgetHtmlArrayFromCoeffects(coeffects) {\n\t\tconst dataTransformer = new DataTransformer();\n\t\tconst {\n\t\t\tproperties: { table, sysId, events: eventsFromProps = [] },\n\t\t\tstate: { events: eventsFromState = null }\n\t\t} = coeffects;\n\t\tlet events = eventsFromState || eventsFromProps || [];\n\t\tif (events.length > 0 && events[0].entryItem)\n\t\t\tevents = dataTransformer.transformOldEvents(events, table, sysId);\n\n\t\tconst textArray = [];\n\t\tevents.forEach((activityDto: ActivityDto) => {\n\t\t\tif (activityDto.eventTable === EVENT_TABLES.JOURNAL) {\n\t\t\t\tconst rawPayload = activityDto.payload;\n\t\t\t\tconst payload =\n\t\t\t\t\ttypeof rawPayload !== 'string' ? rawPayload : rawPayload === '' ? {} : JSON.parse(rawPayload);\n\n\t\t\t\tconst content = get(payload, 'value', '');\n\t\t\t\tif (content)\n\t\t\t\t\ttextArray.push(content);\n\t\t\t}\n\t\t});\n\t\treturn textArray;\n\t}\n}\n\nconst ASConnected = new NowActivityStreamConnected();\n/**\n * Component that shows a list of events that have occurred to a record.\n *\n * Basic usage:\n *\n * ```js\n *\t<now-activity-stream-connected\n *\t\ttable=\"incident\"\n *\t\tsys-id=\"85071a1347c12200e0ef563dbb9a71c1\"\n *\t\ttitle=\"Activities\"\n *\t/>\n * ```\n *\n * Note: This component extends the definition of `now-activity-stream`,\n * optionally you can pass the same properties of now-activity-stream in order to save queries on the initial load.\n *\n * @seismicElement now-activity-stream-connected\n * @summary Component that shows a list of events that have occurred to a record.\n **/\ncreateCustomElement(NOW_ACTIVITY_STREAM_CONNECTED, {\n\t...ASConnected.getCustomElementParts(),\n\tproperties: {\n\t\t/**\n\t\t * Table name of the record that we want to display the activity stream for\n\t\t * @type {string}\n\t\t */\n\t\ttable: {},\n\n\t\t/**\n\t\t * Unique identifier for the record\n\t\t * @type {string}\n\t\t */\n\t\tsysId: {},\n\n\t\t/**\n\t\t * Title for activity events section\n\t\t * @type {string}\n\t\t */\n\t\ttitle: { default: 'Activity' },\n\n\t\t// The above props are for documentation, the following is the real definition\n\t\t...ASConnected.getPropertyDefinitions()\n\t}\n});\nexport const NowActivityStreamConnectedElement = ASConnected.getComponentName();\nexport default ASConnected.getComponentName();\n","import { actionTypes } from '@servicenow/ui-core';\nimport { isFunction, debounce, noop } from 'lodash';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport { shouldRenderCompose } from './utils';\n\nconst { COMPONENT_CONNECTED, COMPONENT_DISCONNECTED } = actionTypes;\nexport const MOUNT_RESIZE_OBSERVER = 'AS#MOUNT_RESIZE_OBSERVER';\nexport const UNMOUNT_RESIZE_OBSERVER = 'AS#UNMOUNT_RESIZE_OBSERVER';\nexport const BEHAVIOR_NAME = 'resize';\nconst observedMap = new WeakMap();\nconst RESIZE_ACTION = 'ACTIVITY_STREAM#ELEMENT_RESIZED';\n\n/**\n * This value is driven based on css `rem` unit(16px), Expected minimum column width should be `355px`(22.1875rem), and doubling it for two column layout.\n * Make sure to update css variable($column-layout-width) too whenever we change column width. CSS file: _nowActivityCombo.scss\n * And adding extra 25px to accommodate gutter.\n * */\nexport const MIN_COLUMN_LAYOUT_WIDTH = 355 * 2 + 25;\n\nconst resize = new ResizeObserver((entries) => {\n\twindow.requestAnimationFrame(() => {\n\t\tfor (const entry of entries) {\n\t\t\tconst {\n\t\t\t\ttarget,\n\t\t\t\tcontentRect: { width, height }\n\t\t\t} = entry;\n\t\t\t(observedMap.get(target) || noop)({ width, height });\n\t\t}\n\t});\n});\n\nconst mountResizeObserver = ({\n\thost,\n\tdispatch,\n\taction: {\n\t\tpayload: {\n\t\t\toptions: { wait = 300 }\n\t\t}\n\t}\n}) => {\n\tconst fn = debounce(({ width, height }) => {\n\t\tdispatch(() => {\n\t\t\treturn {\n\t\t\t\ttype: RESIZE_ACTION,\n\t\t\t\tpayload: { width, height }\n\t\t\t};\n\t\t});\n\t}, wait);\n\n\tresize.observe(host);\n\tobservedMap.set(host, fn);\n};\n\nconst connectedHandler = (coeffects) => {\n\tconst {\n\t\thost: { offsetWidth },\n\t\tupdateState,\n\t\tstate,\n\t\tproperties: { isSideBySideViewAvailable }\n\t} = coeffects;\n\n\tif (!isSideBySideViewAvailable && !shouldRenderCompose(state))\n\t\treturn;\n\n\tupdateState({\n\t\toperation: 'set',\n\t\tpath: `behaviors.${BEHAVIOR_NAME}.size.width`,\n\t\tvalue: offsetWidth\n\t});\n\n\tmountResizeObserver(coeffects);\n};\n\nconst disconnectedHandler = ({\n\taction: {\n\t\tpayload: { host }\n\t}\n}) => {\n\tresize.disconnect(host);\n\tobservedMap.delete(host);\n};\n\nconst resizeHandler = (coeffects) => {\n\tconst {\n\t\taction: { payload }\n\t} = coeffects;\n\tconst {\n\t\toptions: { handlerFn }\n\t} = payload;\n\n\tif (isFunction(handlerFn)) {\n\t\thandlerFn(coeffects);\n\t\treturn;\n\t}\n\tconst { width, height } = payload;\n\tconst { updateState } = coeffects;\n\tupdateState(() => {\n\t\treturn {\n\t\t\toperation: 'set',\n\t\t\tpath: `behaviors.${BEHAVIOR_NAME}.size`,\n\t\t\tvalue: { width, height }\n\t\t};\n\t});\n};\n\nexport const resizeObserverBehavior = {\n\tname: BEHAVIOR_NAME,\n\tinitialState: {\n\t\tsize: {\n\t\t\twidth: 0,\n\t\t\theight: 0\n\t\t}\n\t},\n\tactionHandlers: {\n\t\t[COMPONENT_CONNECTED]: connectedHandler,\n\t\t[COMPONENT_DISCONNECTED]: disconnectedHandler,\n\t\t[MOUNT_RESIZE_OBSERVER]: mountResizeObserver,\n\t\t[UNMOUNT_RESIZE_OBSERVER]: disconnectedHandler,\n\t\t[RESIZE_ACTION]: {\n\t\t\tstopPropagation: true,\n\t\t\teffect: resizeHandler\n\t\t}\n\t}\n};\n","import { actionTypes } from '@servicenow/ui-core';\nimport { SIDE_BY_SIDE_VIEW_SETTING_NAME } from '../activity-compose/inputConfig';\nimport { shouldEnableSideBySideView } from '../activity/utils';\nimport {\n\tWS_PREVIEW_RECORD_ACTION,\n\tAS_PREVIEW_RECORD_REQUESTED\n} from '../activity/actions';\nimport {\n\tEMAIL_DRAFT_MODIFIED_ACTION,\n\tNOW_MODAL_FOOTER_ACTION_CLICKED_ACTION,\n\tNOW_MODAL_OPENED_SET_ACTION,\n\tNOW_MODAL_FOOTER_CONTINUE_ACTION_ID,\n\tAS_COMBO_PREVIEW_RECORD_REQUESTED\n} from './actions';\nimport { AC_SET_SETTING_REQUESTED_ACTION } from '../activity-compose/actions';\nimport {\n\tBEHAVIOR_NAME,\n\tMIN_COLUMN_LAYOUT_WIDTH,\n\tMOUNT_RESIZE_OBSERVER,\n\tUNMOUNT_RESIZE_OBSERVER\n} from '../activity/resizeObserverBehavior';\nimport { emailComposerActionTypes } from '@servicenow/now-email-client';\nimport EmailTile from '../activity/tiles/EmailTile';\nimport { isEqual } from 'lodash';\n\nconst { COMPONENT_PROPERTY_CHANGED } = actionTypes;\nconst { EMAIL_DRAFT_SEND_SUCCESS, EMAIL_DRAFT_SAVE_SUCCESS } = emailComposerActionTypes;\n\nexport const activiyComboResizeHandler = ({\n\tstate: {\n\t\tbehaviors: {\n\t\t\tresize: {\n\t\t\t\tsize: { width: prevWidth }\n\t\t\t}\n\t\t}\n\t},\n\tupdateState,\n\thost: { clientWidth },\n\taction: { payload }\n}) => {\n\tconst { width, height } = payload;\n\n\tif (width === 0 && height === 0)\n\t\treturn;\n\n\tlet shouldRender = prevWidth === 0 && clientWidth >= MIN_COLUMN_LAYOUT_WIDTH;\n\n\tif (!shouldRender)\n\t\tshouldRender = !(\n\t\t\t(width >= MIN_COLUMN_LAYOUT_WIDTH && MIN_COLUMN_LAYOUT_WIDTH <= prevWidth) ||\n\t\t\t(width <= MIN_COLUMN_LAYOUT_WIDTH && MIN_COLUMN_LAYOUT_WIDTH >= prevWidth)\n\t\t);\n\n\tupdateState(() => {\n\t\treturn {\n\t\t\toperation: 'set',\n\t\t\tpath: `behaviors.${BEHAVIOR_NAME}.size`,\n\t\t\tvalue: { width, height },\n\t\t\tshouldRender\n\t\t};\n\t});\n};\n\nconst activityComboPropertyChangedHandler = ({\n\taction: {\n\t\tpayload: { name, value }\n\t},\n\tdispatch,\n\tupdateState\n}) => {\n\tif (name !== 'isSideBySideViewAvailable')\n\t\treturn;\n\n\tconst isSideBySideViewEnabled = shouldEnableSideBySideView(value);\n\n\tdispatch(value ? MOUNT_RESIZE_OBSERVER : UNMOUNT_RESIZE_OBSERVER, {});\n\n\tupdateState({\n\t\tisSideBySideViewEnabled: value ? isSideBySideViewEnabled : value\n\t});\n};\n\nexport const comboActionHandlers = {\n\t[COMPONENT_PROPERTY_CHANGED]: activityComboPropertyChangedHandler,\n\t[AC_SET_SETTING_REQUESTED_ACTION]: ({\n\t\taction: {\n\t\t\tpayload: { name, value: isSideBySideViewEnabled }\n\t\t},\n\t\tupdateState\n\t}) => {\n\t\tif (name !== SIDE_BY_SIDE_VIEW_SETTING_NAME)\n\t\t\treturn;\n\n\t\tupdateState({\n\t\t\tisSideBySideViewEnabled\n\t\t});\n\t}\n};\n\nconst getEmailActionFromPayload = (coeffects) => {\n\tconst {\n\t\taction: {\n\t\t\tpayload: {\n\t\t\t\tparams: { parentTable: targetTable, parentSysId: targetRecord, replyId, replyType },\n\t\t\t\tsys_id: sysId,\n\t\t\t\ttable\n\t\t\t}\n\t\t}\n\t} = coeffects;\n\n\treturn {\n\t\ttargetTable,\n\t\ttargetRecord,\n\t\treplyId,\n\t\treplyType,\n\t\tsysId,\n\t\ttable\n\t};\n};\n\nconst saveActionHandler = ({ updateState }) => {\n\tupdateState({\n\t\tensuedEmailAction: null,\n\t\tshowEmailComposeConfirmation: false,\n\t\tisEmailComposeDirty: false\n\t});\n};\n\nconst toggleModal = ({ state: { showEmailComposeConfirmation }, updateState }) => {\n\tupdateState({\n\t\tshowEmailComposeConfirmation: !showEmailComposeConfirmation\n\t});\n};\n\nconst resetEmailCompose = ({ updateState }) => {\n\tupdateState({\n\t\temailAction: null,\n\t\tensuedEmailAction: null,\n\t\tisEmailComposeDirty: false,\n\t\tshowEmailComposeConfirmation: false\n\t});\n};\n\nconst composeEmailHandler = (coeffects) => {\n\tconst {\n\t\tupdateState,\n\t\tstate: { isEmailComposeDirty, emailAction }\n\t} = coeffects;\n\n\tconst ensuedEmailAction = getEmailActionFromPayload(coeffects);\n\n\tif (isEmailComposeDirty && !isEqual(emailAction, ensuedEmailAction)) {\n\t\tupdateState({ ensuedEmailAction });\n\t\ttoggleModal(coeffects);\n\t\treturn;\n\t}\n\n\tupdateState({\n\t\temailAction: ensuedEmailAction,\n\t\tensuedEmailAction\n\t});\n};\n\nconst emailActionHandler = (coeffects) => {\n\tconst {\n\t\taction: {\n\t\t\tmeta: { actionOrigin },\n\t\t\tstopPropagation\n\t\t}\n\t} = coeffects;\n\n\tif (actionOrigin === EmailTile) {\n\t\tstopPropagation();\n\t\tcomposeEmailHandler(coeffects);\n\t} else\n\t\tresetEmailCompose(coeffects);\n};\n\nconst previewActionHandler = (coeffects) => {\n\tconst {\n\t\taction: {\n\t\t\tstopPropagation,\n\t\t\tpayload,\n\t\t\tmeta: { actionOrigin }\n\t\t},\n\t\tdispatch,\n\t\tproperties: {\n\t\t\tsuppressPreviewRecord\n\t\t}\n\t} = coeffects;\n\n\tif (suppressPreviewRecord) {\n\t\tstopPropagation();\n\t\tif (actionOrigin !== EmailTile)\n\t\t\tdispatch(AS_COMBO_PREVIEW_RECORD_REQUESTED, payload);\n\t}\n\temailActionHandler(coeffects);\n};\n\nconst cancelIfFromEmailHandler = (coeffects) => {\n\tconst {\n\t\taction: {\n\t\t\tmeta: { actionOrigin },\n\t\t\tstopPropagation\n\t\t}\n\t} = coeffects;\n\n\tif (actionOrigin === EmailTile)\n\t\tstopPropagation();\n};\n\nconst emailActionModalFooterHandler = (coeffects) => {\n\tconst {\n\t\tupdateState,\n\t\taction: {\n\t\t\tpayload: {\n\t\t\t\tfooterAction: { id }\n\t\t\t}\n\t\t},\n\t\tstate: { ensuedEmailAction, showEmailComposeConfirmation }\n\t} = coeffects;\n\n\tconst emailActionState =\n\t\tid === NOW_MODAL_FOOTER_CONTINUE_ACTION_ID ? { emailAction: { ...ensuedEmailAction } } : {};\n\n\tupdateState({\n\t\tensuedEmailAction: null,\n\t\tshowEmailComposeConfirmation: !showEmailComposeConfirmation,\n\t\t...emailActionState\n\t});\n};\n\nconst setEmailComposeDirty = ({ updateState }) => {\n\tupdateState({\n\t\tisEmailComposeDirty: true\n\t});\n};\n\nexport const emailActivityActionHandlers = {\n\t[WS_PREVIEW_RECORD_ACTION]: {\n\t\teffect: previewActionHandler,\n\t\tstopPropagation: false\n\t},\n\t['NOW_ACTIVITY_STREAM_CONNECTED#' + AS_PREVIEW_RECORD_REQUESTED]: {\n\t\teffect: cancelIfFromEmailHandler,\n\t\tstopPropagation: false\n\t},\n\t[EMAIL_DRAFT_SEND_SUCCESS]: {\n\t\teffect: emailActionHandler,\n\t\tstopPropagation: true\n\t},\n\t[EMAIL_DRAFT_SAVE_SUCCESS]: {\n\t\teffect: saveActionHandler,\n\t\tstopPropagation: true\n\t},\n\t[EMAIL_DRAFT_MODIFIED_ACTION]: {\n\t\teffect: setEmailComposeDirty,\n\t\tstopPropagation: true\n\t},\n\t[NOW_MODAL_FOOTER_ACTION_CLICKED_ACTION]: {\n\t\teffect: emailActionModalFooterHandler,\n\t\tstopPropagation: true\n\t},\n\t[NOW_MODAL_OPENED_SET_ACTION]: {\n\t\teffect: toggleModal,\n\t\tstopPropagation: true\n\t}\n};\n","//PRIVATE ACTIONS, HANDLED NOT DISPATCHED\nexport const EMAIL_DRAFT_MODIFIED_ACTION = 'NOW_EMAIL_CLIENT_MINI_COMPOSER_CONNECTED#DRAFT_MODIFIED';\nexport const NOW_MODAL_FOOTER_ACTION_CLICKED_ACTION = 'NOW_MODAL#FOOTER_ACTION_CLICKED';\nexport const NOW_MODAL_OPENED_SET_ACTION = 'NOW_MODAL#OPENED_SET';\n\n//ACTION IDS (Identify intention in the payload of a shared action)\nexport const NOW_MODAL_FOOTER_CONTINUE_ACTION_ID = 'NOW_MODAL_FOOTER_CONTINUE_ACTION_ID';\nexport const NOW_MODAL_FOOTER_CANCEL_ACTION_ID = 'NOW_MODAL_FOOTER_CANCEL_ACTION_ID';\n\n//PUBLIC ACTIONS\nexport const AS_COMBO_PREVIEW_RECORD_REQUESTED = 'NOW_ACTIVITY_COMBO#PREVIEW_RECORD_REQUESTED';\n","import { createCustomElement } from '@servicenow/ui-core';\nimport { nowActivityStreamComposeConnectedBehavior } from './nowActivityStreamComposeConnectedBehavior';\nimport {\n\tcommonCreateComponentParts,\n\tgetIsRichTextAvailable,\n\tgetIsStackedViewAvailable,\n\tgetIsRichTextMentionsEnabled,\n\tgetComposeShouldUseTabs,\n\tgetAllowJournalFieldSettingsOverrides\n} from './nowActivityStreamCompose';\n\nexport const NowActivityStreamComposeConnected = 'now-activity-stream-compose-connected';\n\n/**\n * Component that enables users to create new journal entries for the activity stream.\n *\n *\n * ```js\n *\n * const fields = {\n *\t\t\"comments\": {\n *\t\t\tname : \"comments\",\n *\t\t\tlabel : \"Additional comments (Customer Visible)\",\n *\t\t\tsys_readonly: false,\n *\t\t\treadonly : false,\n *\t\t\tvisible: true,\n *\t\t\ttype: 'journal_input',\n *\t\t\tmaxLength: 4000\n *\t\t},\n *\t\t\"work_notes\": {\n *\t\t\tname : \"work_notes\",\n *\t\t\tlabel : \"Work Notes\",\n *\t\t\tsys_readonly: false,\n *\t\t\treadonly : false,\n *\t\t\tvisible: true,\n *\t\t\ttype: 'journal_input',\n *\t\t\tmaxLength: 4000\n *\t\t}\n *\t};\n *\n * \t// journalFieldSettings - (Optional) allows to add colors, help text and icons\n * \tconst journalFieldSettings = {\n *\t\twork_notes: {\n *\t\t\ticon: 'document-fill',\n *\t\t\tcolorVariant: 'yellow',\n *\t\t\thelpText: 'John Doe will see this comment',\n *\t\t\thelpTextIcon: 'eye-outline'\n *\t\t},\n *\t\tcomments: {\n *\t\t\ticon: 'user-group-fill',\n *\t\t\tcolorVariant: '',\n *\t\t\thelpText: '',\n *\t\t\thelpTextIcon: ''\n *\t\t}\n *\t};\n *\n *\t<now-activity-compose-connected\n *\t\ttable=\"incident\"\n *\t\tsysId=\"85071a1347c12200e0ef563dbb9a71c1\"\n *\t\tfields={fields}\n *\t\tjournalFieldSettings={journalFieldSettings}\n *\t/>\n *\n * \t//Or using default journalFieldSettings\n * \t<now-activity-compose-connected\n *\t\ttable=\"incident\"\n *\t\tsysId=\"85071a1347c12200e0ef563dbb9a71c1\"\n *\t\tfields={fields}\n *\t/>\n * ```\n *\n * @seismicElement now-activity-stream-compose-connected\n * @summary Allows an alternate UI for a user to easily post journal field entries to a record.\n **/\ncreateCustomElement(NowActivityStreamComposeConnected, {\n\t...commonCreateComponentParts,\n\tproperties: {\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tcomponentId: {},\n\t\t/**\n\t\t * Object containing journal fields available to the user. For example:\n\t\t *\n\t\t * ```\n\t\t * {\n\t\t *\t \"comments\": {\n\t\t *\t\t  name : \"comments\",\n\t\t *\t\t  label : \"Additional comments (Customer Visible)\",\n\t\t *\t\t  sys_readonly: false,\n\t\t *\t\t  readonly : false,\n\t\t *\t \t  visible: true,\n\t\t *\t\t  type: 'journal_input',\n\t\t *\t  \tmaxLength: 1000\n\t\t *\t },\n\t\t *\t \"work_notes\": {\n\t\t *\t\t  name : \"work_notes\",\n\t\t *\t\t  label : \"Work Notes\",\n\t\t *\t\t  sys_readonly: false,\n\t\t *\t\t  readonly : false,\n\t\t *\t\t  visible: true,\n\t\t *\t\t  type: 'journal_input',\n\t\t *\t\t  maxLength: 2000\n\t\t *\t }\n\t\t * }\n\t\t *```\n\t\t *\n\t\t * @type {object}\n\t\t */\n\t\tfields: { default: {} },\n\t\t/**\n\t\t * When true, the Post button(s) is disabled.\n\t\t * @type {boolean}\n\t\t */\n\t\tisPostDisabled: { default: false },\n\t\t/**\n\t\t * When true, the user can turn the rich text editor on or off. When false, a regular text area input is used.\n\t\t * @type {boolean}\n\t\t */\n\t\tisRichTextAvailable: { default: getIsRichTextAvailable() },\n\t\t/**\n\t\t * When true, the user can select the stacked view from the settings dropdown. When false, only the tabbed view is available.\n\t\t * @type {boolean}\n\t\t */\n\t\tisStackedViewAvailable: { default: getIsStackedViewAvailable() },\n\t\t/**\n\t\t * When true, the user can add user mentions in the rich text view, such as `@user`.\n\t\t *\n\t\t * @type {boolean}\n\t\t */\n\t\tisRichTextMentionsEnabled: { default: getIsRichTextMentionsEnabled() },\n\t\t/**\n\t\t * When true, displays fields in tabs instead of a dropdown if space allows. Does not apply when using stacked mode.\n\t\t */\n\t\tuseTabs: { default: getComposeShouldUseTabs() },\n\t\t/**\n\t\t * When true, `journalFieldSettings` properties will override journal field data, when false `journalFieldSettings` is used as defaults only.\n\t\t *\n\t\t * @type {boolean}\n\t\t */\n\t\tallowJournalFieldSettingsOverrides: { default: getAllowJournalFieldSettingsOverrides() },\n\t\t/**\n\t\t * When true and if space allows, the user can select the side-by-side view in the settings dropdown.\n\t\t * @type {boolean}\n\t\t */\n\t\tisSideBySideViewAvailable: { default: false },\n\t\t/**\n\t\t * Name of the table to post the new journal entry to.\n\t\t *\n\t\t * @type {string}\n\t\t */\n\t\ttable: { default: '' },\n\t\t/**\n\t\t * The Sys ID of the record to post the new journal entry to.\n\t\t *\n\t\t * @type {string}\n\t\t */\n\t\tsysId: { default: '' },\n\n\t\t/**\n\t\t * When true, the current record is new and the component is invisible.\n\t\t *\n\t\t * @type {boolean}\n\t\t */\n\t\tisNewRecord: { default: false },\n\t\t/**\n\t\t * Defines extra display settings per journal field. Depending on the value of `allowJournalFieldSettingsOverrides` will provide overrides (`true`)\n\t\t * or default values (`false`) for the fields received in the `fields` property.\n\t\t *\n\t\t * This should be an object with the field names as properties and JournalFieldSettings as values, field names should match the ones passed in the `fields` property.\n\t\t *\n\t\t * See the example in basic usage.\n\t\t * @type {{field_name: JournalFieldSettings}}\n\t\t */\n\t\tjournalFieldSettings: { default: {} },\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tmentions: {},\n\t\t/**\n\t\t * Title for the compose component. Default value: Compose.\n\t\t *\n\t\t * @type {string}\n\t\t */\n\t\ttitle: { default: '' },\n\t\t/**\n\t\t * Enables the Email tab alongside Worknotes and Additional comments, and defines the email settings.\n\t\t * @type {EmailClientComposerAction}\n\t\t */\n\t\temailAction: {\n\t\t\tdefault: null\n\t\t}\n\t},\n\tbehaviors: [nowActivityStreamComposeConnectedBehavior]\n});\n","import { createCustomElement } from '@servicenow/ui-core';\nimport snabbdom from '@servicenow/ui-renderer-snabbdom';\nimport '@servicenow/now-modal';\nimport { get } from 'lodash';\nimport { activiyComboResizeHandler, comboActionHandlers, emailActivityActionHandlers } from './actionHandlers';\nimport { NowActivityStreamComposeConnected } from '../activity-compose/nowActivityStreamComposeConnected';\nimport NowActivityStreamConnected from '../activity-connected/NowActivityStreamConnected';\nimport { resizeObserverBehavior, MIN_COLUMN_LAYOUT_WIDTH } from '../activity/resizeObserverBehavior';\nimport { shouldRenderCompose, shouldEnableSideBySideView, disableSibeBySide } from '../activity/utils';\nimport styles from './_nowActivityCombo.scss';\nimport { EMAIL_COMPOSE_MODAL_CONTENT, NEW_EMAIL, CONTINUE, CANCEL } from '../activity/translations';\nimport { NOW_MODAL_FOOTER_CONTINUE_ACTION_ID, NOW_MODAL_FOOTER_CANCEL_ACTION_ID } from './actions';\n\nexport const ActivityComboElement = 'now-activity-combo';\n\nconst FOOTER_ACTIONS_CONFIG = [\n\t{\n\t\tlabel: CANCEL,\n\t\tvariant: 'primary',\n\t\tid: NOW_MODAL_FOOTER_CANCEL_ACTION_ID\n\t},\n\t{\n\t\tlabel: CONTINUE,\n\t\tvariant: 'secondary',\n\t\tid: NOW_MODAL_FOOTER_CONTINUE_ACTION_ID\n\t}\n];\n\nconst resizeBehavior = disableSibeBySide()\n\t? {}\n\t: {\n\t\tbehavior: resizeObserverBehavior,\n\t\toptions: {\n\t\t\thandlerFn: activiyComboResizeHandler\n\t\t}\n\t  };\n\nexport const view = (state) => {\n\tconst {\n\t\tproperties: {\n\t\t\tcomponentId,\n\t\t\ttable,\n\t\t\tsysId,\n\t\t\tfields,\n\t\t\tevents,\n\t\t\tsupplemental,\n\t\t\tambChannels,\n\t\t\tuserReferences,\n\t\t\tfilterOptions,\n\t\t\ttimestamp,\n\t\t\tisNewRecord,\n\t\t\tview,\n\t\t\tactive,\n\t\t\tactivityStreamTitle,\n\t\t\tcomposeTitle,\n\t\t\tisSideBySideViewAvailable\n\t\t},\n\t\tisSideBySideViewEnabled = shouldEnableSideBySideView(isSideBySideViewAvailable),\n\t\temailAction,\n\t\tshowEmailComposeConfirmation\n\t} = state;\n\n\tlet className = '';\n\tlet showSideBySideOption = false;\n\tconst renderCompose = shouldRenderCompose(state);\n\tconst width = get(state, 'behaviors.resize.size.width', 0);\n\n\tif (isSideBySideViewAvailable && renderCompose) {\n\t\tconst hasMinWidth = width >= MIN_COLUMN_LAYOUT_WIDTH;\n\t\tclassName = isSideBySideViewEnabled && hasMinWidth ? ' combo--column-mode' : '';\n\t\tshowSideBySideOption = isSideBySideViewAvailable && hasMinWidth;\n\t}\n\n\treturn (\n\t\t<div className={`combo${className}`}>\n\t\t\t{renderCompose ? (\n\t\t\t\t<NowActivityStreamComposeConnected\n\t\t\t\t\tcomponentId={`${componentId}_activity_stream_compose`}\n\t\t\t\t\ttable={table}\n\t\t\t\t\tsysId={sysId}\n\t\t\t\t\tfields={fields}\n\t\t\t\t\tisNewRecord={isNewRecord}\n\t\t\t\t\ttitle={composeTitle}\n\t\t\t\t\tisSideBySideViewAvailable={showSideBySideOption}\n\t\t\t\t\temailAction={emailAction}\n\t\t\t\t>\n\t\t\t\t\t{emailAction && <now-email-client-mini-composer-connected {...emailAction} slot=\"email-compose\" />}\n\t\t\t\t</NowActivityStreamComposeConnected>\n\t\t\t) : (\n\t\t\t\t''\n\t\t\t)}\n\t\t\t{isSideBySideViewEnabled && renderCompose ? <div className=\"gutter\" /> : ''}\n\t\t\t<NowActivityStreamConnected\n\t\t\t\tcomponentId={`${componentId}_activity_stream`}\n\t\t\t\ttable={table}\n\t\t\t\tsysId={sysId}\n\t\t\t\tfields={fields}\n\t\t\t\tevents={events}\n\t\t\t\tsupplemental={supplemental}\n\t\t\t\tambChannels={ambChannels}\n\t\t\t\tuserReferences={userReferences}\n\t\t\t\tfilterOptions={filterOptions}\n\t\t\t\ttimestamp={timestamp}\n\t\t\t\tisNewRecord={isNewRecord}\n\t\t\t\tview={view}\n\t\t\t\tactive={active}\n\t\t\t\ttitle={activityStreamTitle}\n\t\t\t/>\n\t\t\t{showEmailComposeConfirmation ? (\n\t\t\t\t<now-modal\n\t\t\t\t\theaderLabel={NEW_EMAIL}\n\t\t\t\t\tcontent={EMAIL_COMPOSE_MODAL_CONTENT}\n\t\t\t\t\tfooterActions={FOOTER_ACTIONS_CONFIG}\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\topened\n\t\t\t\t/>\n\t\t\t) : (\n\t\t\t\t''\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\n/**\n * Component that combines `now-activity-stream-connected` and now-activity-stream-compose-connected`.\n *\n * Basic usage:\n *\n * ```\n * <now-activity-combo\n * \tcomponent-id=\"cid1\"\n * \ttable=\"incident\"\n * \tsysId=\"85071a1347c12200e0ef563dbb9a71c1\"\n * />\n * ```\n *\n * @seismicElement now-activity-combo\n * @summary Component that combines `now-activity-stream-connected` and now-activity-stream-compose-connected`.\n **/\nexport default createCustomElement(ActivityComboElement, {\n\tstyles,\n\tinitialState: {\n\t\tshowEmailComposeConfirmation: false,\n\t\tisEmailComposeDirty: false\n\t},\n\trenderer: {\n\t\ttype: snabbdom,\n\t\t// eslint-disable-next-line no-unused-vars\n\t\tview\n\t},\n\tproperties: {\n\t\tcomponentId: {},\n\t\t/**\n\t\t * Table name of the record that we want to display the activity stream for\n\t\t * @type {string}\n\t\t */\n\t\ttable: {},\n\n\t\t/**\n\t\t * Unique identifier for the record\n\t\t * @type {string}\n\t\t */\n\t\tsysId: {},\n\n\t\t/**\n\t\t * Object containing journal fields available in compose. For example:\n\t\t *\n\t\t * ```\n\t\t * {\n\t\t *\t \"comments\": {\n\t\t *\t\t  name : \"comments\",\n\t\t *\t\t  label : \"Additional comments (Customer Visible)\",\n\t\t *\t\t  sys_readonly: false,\n\t\t *\t\t  readonly : false,\n\t\t *\t \t  visible: true,\n\t\t *\t\t  type: 'journal_input',\n\t\t *\t  \tmaxLength: 1000\n\t\t *\t },\n\t\t *\t \"work_notes\": {\n\t\t *\t\t  name : \"work_notes\",\n\t\t *\t\t  label : \"Work Notes\",\n\t\t *\t\t  sys_readonly: false,\n\t\t *\t\t  readonly : false,\n\t\t *\t\t  visible: true,\n\t\t *\t\t  type: 'journal_input',\n\t\t *\t\t  maxLength: 2000\n\t\t *\t }\n\t\t * }\n\t\t *```\n\t\t *\n\t\t * @type {object}\n\t\t */\n\t\tfields: {},\n\n\t\t/**\n\t\t * List of events to display\n\t\t * @type {object[]}\n\t\t */\n\t\tevents: {},\n\n\t\t/**\n\t\t * Additional data to include for the tiles to consume in the form of\n\t\t * ```\n\t\t * { eventId, documentId, userSysId, payload }\n\t\t * ```\n\t\t * payload is a json string\n\t\t * @type {object[]}\n\t\t */\n\t\tsupplemental: {},\n\n\t\t/**\n\t\t * User information used for the tiles displayed, in the form of:\n\t\t * ```\n\t\t *\t[\n\t\t *\t\t{\n\t\t *\t\t\tactive: true,\n\t\t *\t\t\tavatar: 'avatar_url',\n\t\t *\t\t\temail: string = 'email@email.com',\n\t\t *\t\t\tname: 'System Administrator',\n\t\t *\t\t\tsysId: 'sysId_for_john_doe',\n\t\t *\t\t\tuserName: 'Admin'\n\t\t *\t\t}\n\t\t *\t];\n\t\t * ```\n\t\t * This is used to provide more detail when the tile only contains an email, user, or sysId as an author\n\t\t * @type {object[]}\n\t\t */\n\t\tuserReferences: {},\n\n\t\t/**\n\t\t * AMB channels to subscribe to\n\t\t * @type {string[]}\n\t\t */\n\t\tambChannels: {},\n\n\t\t/**\n\t\t * Options for filter in activity stream\n\t\t * @type {object[]}\n\t\t */\n\t\tfilterOptions: {},\n\n\t\t/**\n\t\t * Current timestamp, this is used to know when new data is coming in\n\t\t * @type {number}\n\t\t */\n\t\ttimestamp: {},\n\n\t\t/**\n\t\t * Is this a new unsaved record, if true will provide a different message for an empty activity (Optional)\n\t\t * @type {boolean}\n\t\t */\n\t\tisNewRecord: {},\n\n\t\t/**\n\t\t * View to use for the record.\n\t\t * @type {string}\n\t\t */\n\t\tview: {},\n\t\t/**\n\t\t * Is the component active?\n\t\t * @type {boolean}\n\t\t */\n\t\tactive: {},\n\n\t\t/**\n\t\t * Title for activity events section\n\t\t * @type {string}\n\t\t */\n\t\tactivityStreamTitle: {},\n\n\t\t/**\n\t\t * Title for the compose section.\n\t\t *\n\t\t * @type {string}\n\t\t */\n\t\tcomposeTitle: {},\n\n\t\t/**\n\t\t * Allows the side by side view to be available.\n\t\t *\n\t\t * @type {boolean}\n\t\t */\n\t\tisSideBySideViewAvailable: {\n\t\t\tdefault: false\n\t\t},\n\t\t/**\n\t\t * whether or not the activity combo component should supporess PREVIEW_RECORD and redispatch NOW_ACTIVITY_COMBO#PREVIEW_RECORD_REQUESTED\n\t\t * @type {boolean}\n\t\t * @private\n\t\t */\n\t\tsuppressPreviewRecord: {\n\t\t\tdefault: false,\n\t\t\tschema: {\n\t\t\t\ttype: 'boolean'\n\t\t\t}\n\t\t}\n\t},\n\tactionHandlers: {\n\t\t...comboActionHandlers,\n\t\t...emailActivityActionHandlers\n\t},\n\tbehaviors: [resizeBehavior]\n});\n","export { NowActivityStreamElement } from './activity/NowActivityStream';\n\nexport { NowActivityStreamConnectedElement } from './activity-connected/NowActivityStreamConnected';\n\nexport { default as nowActivityComboElement } from './activity-combo/nowActivityComboElement';\n\nexport { NowActivityStreamCompose as NowActivityStreamComposeElement } from './activity-compose/nowActivityStreamCompose';\n\nexport { NowActivityStreamComposeConnected as NowActivityStreamComposeConnectedElement } from './activity-compose/nowActivityStreamComposeConnected';\n\nexport { nowLinkInterceptorBehavior } from './now-link-interceptor/nowLinkInterceptorBehavior';\n\nimport {\n\tACTIVITY_STREAM_INNER_SCHEMA,\n\tACTIVITY_STREAM_FILTER_INNER_SCHEMA\n} from './activity-connected/activityQueries';\nexport function getQueryFragments() {\n\treturn `\n\t${ACTIVITY_STREAM_INNER_SCHEMA}\n\t${ACTIVITY_STREAM_FILTER_INNER_SCHEMA}\n\t`;\n}\n\nexport {\n\tgetQueryMethod as getQuery,\n\tQUERY_METHOD,\n\tENTRIES_FIELD,\n\tFIELDS_FIELD\n} from './activity-connected/activityQueries';\n"],"sourceRoot":""}