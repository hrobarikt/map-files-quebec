{"version":3,"sources":["webpack://__TECTONIC__sn_agent_messaging/webpack/bootstrap","webpack://__TECTONIC__sn_agent_messaging/./src/sn-agent-messaging/constants.js","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_ui_renderer_snabbdom\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__sn_translate\"","webpack://__TECTONIC__sn_agent_messaging/./src/sn-agent-messaging/selectors.js","webpack://__TECTONIC__sn_agent_messaging/./src/sn-agent-messaging/utils.js","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__lodash_4_17_4\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__sn_component_timeago\"","webpack://__TECTONIC__sn_agent_messaging/./src/index.js","webpack://__TECTONIC__sn_agent_messaging/./src/sn-agent-messaging/agentSMSModalElement.js","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_ui_core\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_now_dropdown\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_now_label_value\"","webpack://__TECTONIC__sn_agent_messaging/./src/sn-agent-messaging/agentSMSModal.js","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_now_textarea\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_now_button\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_now_tooltip\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_now_alert\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_now_icon\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_now_loader\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_now_input\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__lodash_4_17_4[\\\"get\\\"]\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__lodash_4_17_4[\\\"isNil\\\"]\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__lodash_4_17_4[\\\"remove\\\"]\"","webpack://__TECTONIC__sn_agent_messaging/./src/sn-agent-messaging/actionHandlers.js","webpack://__TECTONIC__sn_agent_messaging/./src/sn-agent-messaging/dataSources.js","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_ui_effect_http\"","webpack://__TECTONIC__sn_agent_messaging/external \"__TECTONIC__$servicenow_ui_effect_graphql\"","webpack://__TECTONIC__sn_agent_messaging/./src/sn-agent-messaging/agentSMSModal.scss?4454","webpack://__TECTONIC__sn_agent_messaging/./src/sn-agent-messaging/agentSMSModal.scss","webpack://__TECTONIC__sn_agent_messaging/./node_modules/css-loader/lib/css-base.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","NOW_BUTTON_CLICKED","FILE_CHANGED","ATTACH_CLICKED","TRASH_BUTON_CLICKED","VALIDATE_SENDSMS_BOTTON","NOW_DROPDOWN_ITEM_CLICKED","NOW_DROPDOWN_SELECTED_ITEMS_SET","VALIDATE_PHONE_NUMBER","VALIDATE_PHONE_NUMBER_SUCCESS","NOW_ALERT_LIST_ITEMS_SET","FILE_UPLOAD_PROGRESS","FILE_UPLOAD_SUCCESS","FILE_UPLOAD_FAILED","ATTACH_FILE","DELETE_FILE","NOW_TEXTAREA_VALUE_SET","NOW_TEXTAREA_INPUT","SN_SCRIPTED_MODAL_BUTTON_ENABLED_SET","SN_SCRIPTED_MODAL_DATA_SET","INTERACTION_FETCHED","CHANNEL_USER_PROFILE_VALIDATION","TO_VALUE","FROM_VALUE","NOW_INPUT_VALUE_SET","NOW_INPUT_INPUT","HANDLE_VALUE_UPDATE","VIRUS_SCAN_TIMEOUT","FILE_STATE","SCAN_TURNED_OFF","AVAILABLE_CONDITIONALLY","PENDING","AVAILABLE","NOT_AVAILABLE","UPLOAD_WATCHER_MESSAGE_RECEIVED","SUBSCRIBE_TO_SYS_ATTACHMENT","UPLOAD_STATE_MESSAGE_RECEIVED","QUERY_ATTACHMENT_STATE","VIRTUAL_AGENT_SYSID","BUTTON_ENABLED_SET","SEND_DATA_SET","SMS_CHANNEL_ID","SET_FROM_TO_PROPERTY","FETCH_CHANNEL_DETAILS","CHANNEL_SPECIFIC_VALIDATION","__TECTONIC__$servicenow_ui_renderer_snabbdom","__TECTONIC__sn_translate","getPhoneNumber","action","getDropDownType","getFromNumber","state","getFirstFromNumber","length","getToNumber","getInteractionData","getToNumberFromAction","getOtherNumber","getUserDocument","getUserDocumentSysId","validate164PhoneNumer","gete164Number","removeWarningAlert","alerts","alert","type","extractFieldName","interaction","getUserSysId","getIfOtherNumber","getFirstSelection","determineUser","getAttachmentFilesPayload","event","target","files","dataTransfer","getFileNames","Array","from","map","file","join","processToNumber","toNumber","getInfoMessage","userDocument","properties","assigned_to","sys_id","consumer","contact","opened_for","__TECTONIC__lodash_4_17_4","__TECTONIC__sn_component_timeago","default","timeAgoBehaviors","SnTimeAgo","getBehaviors","COMPONENT_CONNECTED","actionTypes","COMPONENT_BOOTSTRAPPED","COMPONENT_PROPERTY_CHANGED","createCustomElement","renderer","snabbdom","view","AgentSMSModal","transformState","lastUpdated","time","getTickTime","initialState","data","attachment","isAttachmentUploading","targetRef","renderProfileAlert","showOtherField","showInteractionRecord","uploadErrMessage","timer","otherToPhoneNumber","errorPhoneField","isTextAreaRequired","isTextAreaInvalid","existingUser","showExistingUserRecord","fromNumbers","reflected","toNumbers","uniqueSysId","channels","actionHandlers","handleOnConnect","handleOnBootstarp","effect","dropDownHandler","stopPropagation","textAreaHandler","fileChangedHandler","buttonClickedHandler","validateEnableSendSMS","validatePhoneNumberEffect","postPhoneNumberValidationHandler","alertDismissHandler","uploadAttachment","fileUploadSuccessHandler","fileUploadFailedHandler","fileUploadProgressHandler","deleteAttachment","channelUserProfileValidation","interactionFetchHandler","validatePhoneNumber","clearPhoneNumberValidationAlert","handleValueUpdate","sysAttachmentGraphqlSubscription","uploadWatcherMessageHandler","sysAttachmentGraphqlQuery","updateAttachmentState","textAreaInputHandler","handlePropertyChange","fetchChannelDetails","setChannelValue","channelSpecificValidation","behaviors","styles","__TECTONIC__$servicenow_ui_core","__TECTONIC__$servicenow_now_dropdown","__TECTONIC__$servicenow_now_label_value","updateState","dispatch","fileInputRef","createRef","fromNumber","channel","userProfileAlert","setToInputRef","ref","setTimeout","isNil","toInputRef","determineSendFromClassName","determineSendToClassName","evaluateOtherValue","renderAlerts","renderChannelsDropDown","isEmpty","className","label","configAria","items","bare","selectedItems","selectedItem","id","icon","placeholder","size","variant","select","invalid","hook-insert","elm","hook-destroy","renderExistingUserRecord","renderCardDetails","required","undefined","resize","style","renderAttachment","number","num","push","tooltipContent","setIconRef","iconRef","target-ref","content","delay","renderLoader","disabled","iconName","append-to-payload","command","file_input_ref","display","onchange","e","accept","renderAttachmentCard","setTargetRef","status","header","textLinkProps","existingUserIconRef","aria-describedby","display_name","setUpdateFn","remove","update","interactionIconRef","subtype","index","configAriaLive","__TECTONIC__$servicenow_now_textarea","__TECTONIC__$servicenow_now_button","__TECTONIC__$servicenow_now_tooltip","__TECTONIC__$servicenow_now_alert","__TECTONIC__$servicenow_now_icon","__TECTONIC__$servicenow_now_loader","__TECTONIC__$servicenow_now_input","channel_id","user_table","table","user_sys_id","show_other_field","path","operation","updateProperties","payload","result","fromValue","toValue","clearAlertsByType","current","click","handleAttachClicked","attachmentSysId","newData","assign","sysId","handleTrashButtonClicked","fileList","FormData","append","requestId","uniqueId","itemId","channelId","item","showOtherOption","otherValue","filter","actionSource","validateSendToValue","validateSendToVal","sendToValue","constructData","isButtonEnabled","user_document","unique_sys_id","response","message","formattedValue","isValid","handleSuccessUploads","e164PhoneNumber","newErrorPhoneField","phone","verifiedToNumber","interactionData","other_profile_matching","profile_matching","other_profile_record","newAlerts","Date","parse","sys_updated_on","systemTime","timeAgo","lastUpdatedOn","fileState","uploadingFileContent","handleFailedUploads","handlePendingUploads","clearTimerAndGraphqlSubscription","clearTimeout","subscribe","handleTimedoutUploads","attachmentState","errMsg","sendAlertAndTerminateUploading","file_name","firstSelection","createHttpEffect","batch","method","dataParams","successActionType","progressActionType","errorActionType","pathParams","queryParams","createGraphQLEffect","SYS_ATTACHMENT_SUBSCRIPTION","templateVarList","itemChangedActionType","SYS_ATTACHMENT_QUERY","__TECTONIC__$servicenow_ui_effect_http","__TECTONIC__$servicenow_ui_effect_graphql","toString","useSourceMap","list","this","cssMapping","btoa","sourceMapping","sourceMap","unescape","encodeURIComponent","JSON","stringify","sourceURLs","sources","source","sourceRoot","concat","cssWithMappingToString","mediaQuery","alreadyImportedModules"],"mappings":"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","file":"sn-agent-messaging.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","export const NOW_BUTTON_CLICKED = 'NOW_BUTTON#CLICKED';\n\nexport const FILE_CHANGED = 'FILE_CHANGED';\nexport const ATTACH_CLICKED = 'ATTACH_CLICKED';\nexport const TRASH_BUTON_CLICKED = 'TRASH_BUTON_CLICKED';\nexport const VALIDATE_SENDSMS_BOTTON = 'VALIDATE_SENDSMS_BOTTON';\nexport const NOW_DROPDOWN_ITEM_CLICKED = 'NOW_DROPDOWN#ITEM_CLICKED';\nexport const NOW_DROPDOWN_SELECTED_ITEMS_SET = 'NOW_DROPDOWN#SELECTED_ITEMS_SET';\nexport const VALIDATE_PHONE_NUMBER = 'VALIDATE_PHONE_NUMBER';\nexport const VALIDATE_PHONE_NUMBER_SUCCESS = 'VALIDATE_PHONE_NUMBER_SUCCESS';\nexport const NOW_ALERT_LIST_ITEMS_SET = 'NOW_ALERT_LIST#ITEMS_SET';\nexport const FILE_UPLOAD_PROGRESS = 'FILE_UPLOAD_PROGRESS';\nexport const FILE_UPLOAD_SUCCESS = 'FILE_UPLOAD_SUCCESS';\nexport const FILE_UPLOAD_FAILED = 'FILE_UPLOAD_FAILED';\nexport const ATTACH_FILE = 'ATTACH_FILE';\nexport const DELETE_FILE = 'DELETE_FILE';\nexport const NOW_TEXTAREA_VALUE_SET = 'NOW_TEXTAREA#VALUE_SET';\nexport const NOW_TEXTAREA_INPUT = 'NOW_TEXTAREA#INPUT';\nexport const SN_SCRIPTED_MODAL_BUTTON_ENABLED_SET = 'SN_SCRIPTED_MODAL#BUTTON_ENABLED_SET';\nexport const SN_SCRIPTED_MODAL_DATA_SET = 'SN_SCRIPTED_MODAL#DATA_SET';\nexport const INTERACTION_FETCHED = 'INTERACTION_FETCHED';\nexport const CHANNEL_USER_PROFILE_VALIDATION = 'CHANNEL_USER_PROFILE_VALIDATION';\nexport const TO_VALUE = 'toField';\nexport const FROM_VALUE = 'fromField';\nexport const NOW_INPUT_VALUE_SET = 'NOW_INPUT#VALUE_SET';\nexport const NOW_INPUT_INPUT = 'NOW_INPUT#INPUT';\nexport const HANDLE_VALUE_UPDATE = 'HANDLE_VALUE_UPDATE';\n\nexport const VIRUS_SCAN_TIMEOUT = 30000;\nexport const FILE_STATE = {\n\tSCAN_TURNED_OFF: '',\n\tAVAILABLE_CONDITIONALLY: 'available_conditionally',\n\tPENDING: 'pending',\n\tAVAILABLE: 'available',\n\tNOT_AVAILABLE: 'not_available',\n\n};\nexport const UPLOAD_WATCHER_MESSAGE_RECEIVED = 'UPLOAD_WATCHER_MESSAGE_RECEIVED';\nexport const SUBSCRIBE_TO_SYS_ATTACHMENT= 'SUBSCRIBE_TO_SYS_ATTACHMENT';\nexport const UPLOAD_STATE_MESSAGE_RECEIVED = 'UPLOAD_STATE_MESSAGE_RECEIVED';\nexport const QUERY_ATTACHMENT_STATE = 'QUERY_ATTACHMENT_STATE';\nexport const VIRTUAL_AGENT_SYSID = '1483d402db911010672dae3b13961984';\nexport const BUTTON_ENABLED_SET = 'SN_AGENT_MESSAGING#BUTTON_ENABLED_SET';\nexport const SEND_DATA_SET = 'SN_AGENT_MESSAGING#SEND_DATA_SET';\nexport const SMS_CHANNEL_ID = \"5ae1b3e3771700105d7b3882a91061bd\";\nexport const SET_FROM_TO_PROPERTY = \"SET_FROM_TO_PROPERTY\";\nexport const FETCH_CHANNEL_DETAILS = \"FETCH_CHANNEL_DETAILS\";\nexport const CHANNEL_SPECIFIC_VALIDATION = \"CHANNEL_SPECIFIC_VALIDATION\";\n","module.exports = __TECTONIC__$servicenow_ui_renderer_snabbdom;","module.exports = __TECTONIC__sn_translate;","import get from 'lodash/get';\nimport isNil from 'lodash/isNil';\nimport remove from 'lodash/remove';\n\nexport function getPhoneNumber(action) {\n\treturn get(action, 'payload.item.id');\n}\n\nexport function getDropDownType(action) {\n\treturn get(action, 'payload.item.dropdown');\n}\n\nexport function getFromNumber(state) {\n\treturn get(state, 'data.fromNumber.item.id', null);\n}\n\nexport function getFirstFromNumber(state) {\n\tif(get(state, 'properties.fromNumbers', []).length == 0)\n\t\treturn null;\n\treturn get(state, 'properties.fromNumbers')[0];\n}\n\nexport function getToNumber(state) {\n\treturn get(state, 'data.toNumber.item.id', null);\n}\n\nexport function getInteractionData(action) {\n\treturn get(action, 'payload.result', null);\n}\n\nexport function getToNumberFromAction(action) {\n\treturn get(action, 'payload.value');\n}\n\nexport function getOtherNumber(state) {\n\treturn get(state, 'otherNumber');\n}\n\nexport function getUserDocument(state) {\n\treturn get(state,'properties.userDocument.table');\n}\n\nexport function getUserDocumentSysId(state) {\n\treturn get(state,'properties.userDocument.sys_id');\n}\n\nexport function validate164PhoneNumer(state) {\n\treturn get(state,'data.toNumber.phone.isValid', false);\n}\n\nexport function gete164Number(state) {\n\treturn get(state,'data.toNumber.phone.e164PhoneNumber');\n}\n\nexport function removeWarningAlert(alerts) {\n\talerts = remove(alerts, (alert) => {\n\t\treturn alert.type === 'other_profile_matching';\n\t});\n\treturn alerts;\n}\n\nexport function extractFieldName(interaction, t) {\n\tif (get(interaction, 'consumer.name')) {\n\t\treturn t('Consumer');\n\t} else if (get(interaction, 'contact.name')) {\n\t\treturn t('Contact');\n\t} else if (get(interaction, 'opened_for.name')) {\n\t\treturn t('Opened for');\n\t}\n}\n\nexport function getUserSysId(interaction) {\n\tif (get(interaction, 'consumer.sys_id')) {\n\t\treturn get(interaction, 'consumer.sys_id');\n\t} else if (get(interaction, 'contact.sys_id')) {\n\t\treturn get(interaction, 'contact.sys_id');\n\t} else if (get(interaction, 'opened_for.sys_id')) {\n\t\treturn get(interaction, 'opened_for.sys_id');\n\t}\n}\n\nexport function getIfOtherNumber(state) {\n\treturn get(state,'data.toNumber.item.id', null);\n}\n\nexport function getFirstSelection(state) {\n\treturn get(state, 'firstSelection', false);\n}\n","import {t} from \"sn-translate\";\nimport {VIRTUAL_AGENT_SYSID} from './constants';\nimport {getUserSysId} from './selectors';\n\nexport const getAttachmentFilesPayload = event => {\n\treturn event.target.files || event.dataTransfer.files;\n};\n\nexport const getFileNames = files => {\n\treturn Array.from(files).map(file => file.name).join();\n};\n\nexport const processToNumber = (toNumber) => {\n\treturn toNumber && toNumber!=='other' && toNumber!=='Other';\n};\n\nexport const getInfoMessage = (state) => {\n\tconst {interaction} = state;\n\tconst {userDocument} = state.properties;\n\tif (interaction.assigned_to.sys_id === VIRTUAL_AGENT_SYSID) {\n\t\treturn t('Sending a new message will end the ongoing interaction');\n\t} else if (userDocument.sys_id != getUserSysId(interaction)) {\n\t\treturn t('Details of the ongoing interaction currently associated with {0}. Sending a message will end the ongoing interaction. ',  determineUser(interaction));\n\t} else {\n\t\treturn t('Details of the ongoing interaction currently associated with {0}. Sending a message will add the message to the ongoing interaction. ',  determineUser(interaction));\n\t}\n};\n\nconst determineUser = (interaction) => {\n\treturn interaction.consumer.name || interaction.contact.name || interaction.opened_for.name;\n};\n","module.exports = __TECTONIC__lodash_4_17_4;","module.exports = __TECTONIC__sn_component_timeago;","export {default as agentSMSModal} from './sn-agent-messaging/agentSMSModalElement';\n","import { createCustomElement, actionTypes } from '@servicenow/ui-core';\nimport snabbdom from '@servicenow/ui-renderer-snabbdom';\nimport '@servicenow/now-dropdown';\nimport '@servicenow/now-label-value';\nimport AgentSMSModal from './agentSMSModal';\nimport {\n\tFILE_CHANGED,\n\tNOW_BUTTON_CLICKED,\n\tNOW_DROPDOWN_ITEM_CLICKED,\n\tVALIDATE_SENDSMS_BOTTON,\n\tVALIDATE_PHONE_NUMBER,\n\tVALIDATE_PHONE_NUMBER_SUCCESS,\n\tNOW_ALERT_LIST_ITEMS_SET,\n\tATTACH_FILE,\n\tFILE_UPLOAD_SUCCESS,\n\tFILE_UPLOAD_PROGRESS,\n\tFILE_UPLOAD_FAILED,\n\tDELETE_FILE,\n\tNOW_TEXTAREA_VALUE_SET,\n\tSN_SCRIPTED_MODAL_BUTTON_ENABLED_SET,\n\tINTERACTION_FETCHED,\n\tCHANNEL_USER_PROFILE_VALIDATION,\n\tNOW_INPUT_VALUE_SET,\n\tHANDLE_VALUE_UPDATE,\n\tUPLOAD_WATCHER_MESSAGE_RECEIVED,\n\tSUBSCRIBE_TO_SYS_ATTACHMENT,\n\tUPLOAD_STATE_MESSAGE_RECEIVED,\n\tNOW_INPUT_INPUT,\n\tNOW_TEXTAREA_INPUT,\n\tQUERY_ATTACHMENT_STATE,\n\tFETCH_CHANNEL_DETAILS,\n\tSET_FROM_TO_PROPERTY,\n\tCHANNEL_SPECIFIC_VALIDATION\n} from './constants';\nimport {\n\tbuttonClickedHandler,\n\tfileChangedHandler,\n\tdropDownHandler,\n\tvalidateEnableSendSMS,\n\tpostPhoneNumberValidationHandler,\n\talertDismissHandler,\n\tfileUploadSuccessHandler,\n\tfileUploadProgressHandler,\n\tfileUploadFailedHandler,\n\ttextAreaHandler,\n\tinteractionFetchHandler,\n\tvalidatePhoneNumber,\n\thandleValueUpdate,\n\tuploadWatcherMessageHandler,\n\tclearPhoneNumberValidationAlert,\n\thandleOnConnect,\n\thandleOnBootstarp,\n\ttextAreaInputHandler,\n\tupdateAttachmentState,\n\thandlePropertyChange,\n\tsetChannelValue\n} from './actionHandlers';\nimport {\n\tvalidatePhoneNumberEffect,\n\tuploadAttachment,\n\tdeleteAttachment,\n\tsysAttachmentGraphqlSubscription,\n\tsysAttachmentGraphqlQuery,\n\tfetchChannelDetails,\n\tchannelSpecificValidation\n} from './dataSources';\nimport styles from './agentSMSModal.scss';\nimport {channelUserProfileValidation} from \"./dataSources\";\nimport {SnTimeAgo} from 'sn-component-timeago';\nconst timeAgoBehaviors = SnTimeAgo.getBehaviors();\nconst {COMPONENT_CONNECTED, COMPONENT_BOOTSTRAPPED, COMPONENT_PROPERTY_CHANGED} = actionTypes;\n\ncreateCustomElement('sn-agent-messaging', {\n\trenderer: {\n\t\ttype: snabbdom,\n\t\tview: AgentSMSModal,\n\t\ttransformState(state) {\n\t\t\tif (state.lastUpdated) {\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\ttime: state.lastUpdated.getTickTime().time\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t};\n\t\t}\n\t},\n\tinitialState: {\n\t\tdata: {},\n\t\tattachment: null,\n\t\tisAttachmentUploading: false,\n\t\ttargetRef: {},\n\t\trenderProfileAlert: null,\n\t\tshowOtherField: {\n\t\t\tvalue: false\n\t\t},\n\t\tshowInteractionRecord: {\n\t\t\tvalue: false\n\t\t},\n\t\talerts: [],\n\t\tuploadErrMessage: null,\n\t\ttimer: null,\n\t\tlastUpdated: null,\n\t\totherToPhoneNumber: '',\n\t\terrorPhoneField: {\n\t\t\tvalue: false\n\t\t},\n\t\tisTextAreaRequired: true,\n\t\tisTextAreaInvalid: false,\n\t\texistingUser: null,\n\t\tshowExistingUserRecord: {\n\t\t\tvalue: false\n\t\t}\n\t},\n\tproperties: {\n\t\tfromNumbers: {\n\t\t\treflected: true\n\t\t},\n\t\ttoNumbers: {\n\t\t\treflected: true\n\t\t},\n\t\tuniqueSysId: {\n\t\t\treflected: true\n\t\t},\n\t\tuserDocument: {\n\t\t\treflected: true\n\t\t},\n\t\tchannels: {\n\t\t\tdefault: []\n\t\t}\n\t},\n\tactionHandlers: {\n\t\t[COMPONENT_CONNECTED]: handleOnConnect,\n\t\t[COMPONENT_BOOTSTRAPPED]: handleOnBootstarp,\n\t\t[NOW_DROPDOWN_ITEM_CLICKED]: {\n\t\t\teffect: dropDownHandler,\n\t\t\tstopPropagation: true\n\t\t},\n\t\t[NOW_TEXTAREA_VALUE_SET]: {\n\t\t\teffect: textAreaHandler,\n\t\t\tstopPropagation: true\n\t\t},\n\t\t[FILE_CHANGED]: fileChangedHandler,\n\t\t[NOW_BUTTON_CLICKED]: buttonClickedHandler,\n\t\t[VALIDATE_SENDSMS_BOTTON]: validateEnableSendSMS,\n\t\t[VALIDATE_PHONE_NUMBER]: validatePhoneNumberEffect,\n\t\t[VALIDATE_PHONE_NUMBER_SUCCESS]: postPhoneNumberValidationHandler,\n\t\t[NOW_ALERT_LIST_ITEMS_SET]: alertDismissHandler,\n\t\t[ATTACH_FILE]: uploadAttachment,\n\t\t[FILE_UPLOAD_SUCCESS]: fileUploadSuccessHandler,\n\t\t[FILE_UPLOAD_FAILED]: fileUploadFailedHandler,\n\t\t[FILE_UPLOAD_PROGRESS]: fileUploadProgressHandler,\n\t\t[DELETE_FILE]: deleteAttachment,\n\t\t[CHANNEL_USER_PROFILE_VALIDATION]: channelUserProfileValidation,\n\t\t[INTERACTION_FETCHED]: interactionFetchHandler,\n\t\t[NOW_INPUT_VALUE_SET]: validatePhoneNumber,\n\t\t[NOW_INPUT_INPUT]: clearPhoneNumberValidationAlert,\n\t\t[HANDLE_VALUE_UPDATE]: handleValueUpdate,\n\t\t[SUBSCRIBE_TO_SYS_ATTACHMENT]: sysAttachmentGraphqlSubscription,\n\t\t[UPLOAD_WATCHER_MESSAGE_RECEIVED]: uploadWatcherMessageHandler,\n\t\t[QUERY_ATTACHMENT_STATE]: sysAttachmentGraphqlQuery,\n\t\t[UPLOAD_STATE_MESSAGE_RECEIVED]: updateAttachmentState,\n\t\t[NOW_TEXTAREA_INPUT]: textAreaInputHandler,\n\t\t[COMPONENT_PROPERTY_CHANGED]: handlePropertyChange,\n\t\t[FETCH_CHANNEL_DETAILS]: fetchChannelDetails,\n\t\t[SET_FROM_TO_PROPERTY]: setChannelValue,\n\t\t[CHANNEL_SPECIFIC_VALIDATION]: channelSpecificValidation\n\t},\n\tbehaviors: [...timeAgoBehaviors],\n\tstyles\n});\n","module.exports = __TECTONIC__$servicenow_ui_core;","module.exports = __TECTONIC__$servicenow_now_dropdown;","module.exports = __TECTONIC__$servicenow_now_label_value;","import '@servicenow/now-textarea';\nimport '@servicenow/now-button';\nimport '@servicenow/now-tooltip';\nimport '@servicenow/now-alert';\nimport '@servicenow/now-icon';\nimport '@servicenow/now-loader';\nimport '@servicenow/now-input';\n\nimport { t } from 'sn-translate';\nimport {\n\tFILE_CHANGED,\n\tATTACH_CLICKED,\n\tTRASH_BUTON_CLICKED\n} from './constants';\nimport { getAttachmentFilesPayload, getFileNames, getInfoMessage } from './utils';\nimport { createRef } from '@servicenow/ui-renderer-snabbdom';\nimport { isNil, get, head, isEmpty } from 'lodash';\nimport { extractFieldName } from './selectors';\n\nconst update = lastUpdated => {\n\treturn () => {\n\t\tlastUpdated.remove();\n\t};\n};\n\nconst selectedItem = (number) => {\n\tconst num = [];\n\tif(number) {\n\t\tnum.push(get(number, \"item.id\"));\n\t\treturn num;\n\t}\n\treturn num;\n};\n\nexport default function AgentSMSModal(state, { updateState, dispatch }) {\n\tconst fileInputRef = createRef();\n\tconst { fromNumbers, toNumbers, channels } = state.properties;\n\tconst { fromNumber, toNumber, channel } = state.data;\n\tconst {\n\t\talerts,\n\t\tshowOtherField,\n\t\tuserProfileAlert,\n\t\tshowInteractionRecord,\n\t\ttime,\n\t\tlastUpdated,\n\t\terrorPhoneField,\n\t\tisTextAreaRequired,\n\t\tisTextAreaInvalid,\n\t\tshowExistingUserRecord\n\t} = state;\n\tconst setToInputRef = (ref) => setTimeout(() => {\n\t\tif (isNil(ref)) {\n\t\t\tupdateState({ toInputRef: {} });\n\t\t} else {\n\t\t\tupdateState({ toInputRef: ref });\n\t\t}\n\t});\n\n\tconst determineSendFromClassName = (channels) => {\n\t\tif(channels.length > 0) {\n\t\t\treturn \"from-value-when-channels\"\n\t\t}\n\t\treturn \"from-value\"\n\t};\n\n\tconst determineSendToClassName = (channels) => {\n\t\tif(channels.length > 0) {\n\t\t\treturn \"to-value-when-channels\"\n\t\t}\n\t\treturn \"to-value\"\n\t};\n\n\tconst evaluateOtherValue = (channels) => {\n\t\tif(channels.length > 0) {\n\t\t\treturn t(\"Other\");\n\t\t} else {\n\t\t\treturn t(\"Other Number\");\n\t\t}\n\t};\n\treturn (\n\t\t<div>\n\t\t\t{renderAlerts(alerts)}\n\t\t\t{!userProfileAlert ? null : renderProfileAlert(userProfileAlert)}\n\t\t\t{channels.length > 0 ? renderChannelsDropDown(channels, channel) : null}\n\t\t\t{!isEmpty(fromNumbers) ?\n\t\t\t\t<div className={determineSendFromClassName(channels)}>\n\t\t\t\t\t<div className={determineSendFromClassName(channels) + \"-wrapper\"}>\n\t\t\t\t\t\t<now-label-value-inline label={t(\"From\")}\n\t\t\t\t\t\t\tconfigAria={{'aria-label': t('From')}}></now-label-value-inline>\n\t\t\t\t\t\t<now-dropdown\n\t\t\t\t\t\t\titems={fromNumbers}\n\t\t\t\t\t\t\tbare={true}\n\t\t\t\t\t\t\tselectedItems={selectedItem(fromNumber)}\n\t\t\t\t\t\t\tid=\"fromNumberId\"\n\t\t\t\t\t\t\ticon=\"\"\n\t\t\t\t\t\t\tplaceholder={t(\"-- Select a value --\")}\n\t\t\t\t\t\t\tsize=\"md\"\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tselect=\"single\"\n\t\t\t\t\t\t\tconfigAria={{'aria-label': t('From'),}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>: null\n\t\t\t}\n\t\t\t{!isEmpty(toNumbers) ?\n\t\t\t\t<div className={determineSendToClassName(channels)}>\n\t\t\t\t\t<div className={determineSendToClassName(channels) + \"-wrapper\"}>\n\t\t\t\t\t\t<now-label-value-inline label={t(\"To\")} configAria={{'aria-label': t('To'),}}></now-label-value-inline>\n\t\t\t\t\t\t<now-dropdown\n\t\t\t\t\t\t\titems={toNumbers}\n\t\t\t\t\t\t\tbare={true}\n\t\t\t\t\t\t\tselectedItems={selectedItem(toNumber)}\n\t\t\t\t\t\t\tid=\"toNumberId\"\n\t\t\t\t\t\t\ticon=\"\"\n\t\t\t\t\t\t\tplaceholder={t(\"-- Select a value --\")}\n\t\t\t\t\t\t\tsize=\"md\"\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tselect=\"single\"\n\t\t\t\t\t\t\tconfigAria={{'aria-label': t('To'),}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={determineSendToClassName(channels) + \"-input\"}>\n\t\t\t\t\t\t{showOtherField.value ?\n\t\t\t\t\t\t\t<now-input\n\t\t\t\t\t\t\t\tclassName=\"other-phone-number\"\n\t\t\t\t\t\t\t\tname={evaluateOtherValue(channels)}\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tlabel={evaluateOtherValue(channels)}\n\t\t\t\t\t\t\t\tsize=\"md\"\n\t\t\t\t\t\t\t\tinvalid={errorPhoneField.value}\n\t\t\t\t\t\t\t\thook-insert={({elm}) => setToInputRef(elm)}\n\t\t\t\t\t\t\t\thook-destroy={() => setToInputRef(null)}\n\t\t\t\t\t\t\t/> : null}\n\t\t\t\t\t</div>\n\t\t\t\t</div>: null\n\t\t\t}\n\t\t\t{showExistingUserRecord.value ? renderExistingUserRecord(state, updateState) : null}\n\t\t\t{showInteractionRecord.value ? renderCardDetails(state, updateState) : null}\n\t\t\t<now-textarea\n\t\t\t\tlabel={t('Message')}\n\t\t\t\trequired={isTextAreaRequired && isNil(get(state, 'data.attachmentSysId'))}\n\t\t\t\tinvalid={!(isTextAreaRequired && isNil(get(state, 'data.attachmentSysId')))\n\t\t\t\t\t? undefined : isTextAreaInvalid}\n\t\t\t\tresize=\"none\"\n\t\t\t\tconfigAria={{ 'aria-label': t('Type in message'), }}\n\t\t\t\tstyle={{ \"width\": \"100%\" }}\n\t\t\t\tname=\"message\"\n\t\t\t/>\n\t\t\t{renderAttachment(state, dispatch, fileInputRef, updateState)}\n\t\t</div>\n\t);\n};\n\nconst renderChannelsDropDown = (channels, channel) => {\n\treturn (\n\t\t<div className=\"channels\">\n\t\t\t<div className=\"channels-wrapper\">\n\t\t\t\t<now-label-value-inline label={t(\"Channel\")} configAria={{ 'aria-label': t('Channel'), }}></now-label-value-inline>\n\t\t\t\t<now-dropdown\n\t\t\t\t\titems={channels}\n\t\t\t\t\tbare={true}\n\t\t\t\t\tselectedItems={selectedItem(channel)}\n\t\t\t\t\tid=\"channelsId\"\n\t\t\t\t\ticon=\"\"\n\t\t\t\t\tplaceholder={t(\"-- Select a Channel --\")}\n\t\t\t\t\ttooltipContent={t(\"Select a Channel\")}\n\t\t\t\t\tsize=\"md\"\n\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\tselect=\"single\"\n\t\t\t\t\tconfigAria={{ 'aria-label': t('Select a Channel'), }}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nconst renderAttachment = (state, dispatch, fileInputRef, updateState) => {\n\tconst { attachment = {}, targetRef = {}, isAttachmentUploading } = state;\n\tconst setTargetRef = (ref) => setTimeout(() => {\n\t\tif (isNil(ref)) {\n\t\t\tupdateState({ targetRef: {} });\n\t\t} else {\n\t\t\tupdateState({ targetRef: ref });\n\t\t}\n\t});\n\tconst setIconRef = (ref) => setTimeout(() => {\n\t\tif (isNil(ref)) {\n\t\t\tupdateState({ iconRef: {} });\n\t\t} else {\n\t\t\tupdateState({ iconRef: ref });\n\t\t}\n\t});\n\treturn (\n\t\t<div>\n\t\t\t<now-label-value-inline label={t('Attachment')}></now-label-value-inline>\n\t\t\t<now-icon hook-insert={({ elm }) => setIconRef(elm)} hook-destroy={() => setIconRef(null)} icon=\"circle-info-outline\" size=\"md\"></now-icon>\n\t\t\t<now-tooltip\n\t\t\t\tid={\"attachment-icon-tooltip\"}\n\t\t\t\ttarget-ref={get(state, `iconRef`)}\n\t\t\t\tcontent={t('Supports only image files')}\n\t\t\t\tdelay={500}\n\t\t\t/>\n\t\t\t{\n\t\t\t\tisAttachmentUploading ? renderLoader() :\n\t\t\t\t\t<div className=\"sn-attachments\">\n\t\t\t\t\t\t<now-button\n\t\t\t\t\t\t\tbare\n\t\t\t\t\t\t\tdisabled={!isNil(attachment)}\n\t\t\t\t\t\t\ticonName=\"paperclip-outline\"\n\t\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\t\tsize=\"md\"\n\t\t\t\t\t\t\tlabel={isNil(attachment) ? t('Attach file') : ''}\n\t\t\t\t\t\t\ttooltipContent={t('Add attachment to message')}\n\t\t\t\t\t\t\tappend-to-payload={{ command: ATTACH_CLICKED, file_input_ref: fileInputRef }} />\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\tstyle={{ display: 'none' }}\n\t\t\t\t\t\t\tonchange={e => dispatch(FILE_CHANGED, getAttachmentFilesPayload(e))}\n\t\t\t\t\t\t\tref={fileInputRef}\n\t\t\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div className=\"sn-attachments-container\">\n\t\t\t\t\t\t\t{isNil(attachment) ? null : renderAttachmentCard(attachment, state, setTargetRef)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t}\n\t\t</div>\n\t);\n};\n\nconst renderLoader = () => {\n\treturn (\n\t\t<div className=\"sn-attachments\">\n\t\t\t<div className=\"sn-attachments-container\">\n\t\t\t\t<div className=\"sn-attachment\">\n\t\t\t\t\t<div className=\"sn-attachment-loader\">\n\t\t\t\t\t\t<now-loader label=\"\" action=\"\" size=\"md\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"sn-attachment-text\">{t('Uploading File...')}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nconst renderAttachmentCard = (attachment, state, setTargetRef) => {\n\treturn (\n\t\t<div className=\"sn-attachment\">\n\t\t\t<div className=\"sn-attachment-name\"\n\t\t\t\thook-insert={({ elm }) => setTargetRef(elm)}\n\t\t\t\thook-destroy={() => setTargetRef(null)}>\n\t\t\t\t{attachment.name}\n\t\t\t</div>\n\t\t\t<now-tooltip\n\t\t\t\tid={\"attachment tooltip\"}\n\t\t\t\ttarget-ref={get(state, 'targetRef')}\n\t\t\t\tcontent={attachment.name}\n\t\t\t\tdelay={500}\n\t\t\t/>\n\t\t\t<div className=\"sn-attachment-trash-button\">\n\t\t\t\t<now-button\n\t\t\t\t\tbare\n\t\t\t\t\tvariant='tertiary'\n\t\t\t\t\tsize='md'\n\t\t\t\t\ticonName='trash-outline'\n\t\t\t\t\ttooltipContent={t(\"Remove the attachment\")}\n\t\t\t\t\tappend-to-payload={{ command: TRASH_BUTON_CLICKED }} />\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nconst renderProfileAlert = (alert) => {\n\tconst { content, status, icon } = alert;\n\treturn <now-alert status={status} icon={icon} header=\"\" content={content} textLinkProps={{}} action={{ \"type\": \"dismiss\" }}></now-alert>;\n};\n\nconst renderExistingUserRecord = (state, updateState) => {\n\tconst {existingUser} = state;\n\tconst setIconRef = (ref) => setTimeout(() => {\n\t\tif (isNil(ref)) {\n\t\t\tupdateState({ existingUserIconRef: {} });\n\t\t} else {\n\t\t\tupdateState({ existingUserIconRef: ref });\n\t\t}\n\t});\n\treturn (\n\t\t<div className=\"agent-messaging-card\">\n\t\t\t<div className=\"agent-messaging-card-header\">\n\t\t\t\t<font>{t('Existing user details')}</font>\n\t\t\t\t<now-icon hook-insert={({ elm }) => setIconRef(elm)} hook-destroy={() => setIconRef(null)} aria-describedby=\"existing-user-icon-tooltip\" icon=\"circle-question-outline\" size=\"md\"></now-icon>\n\t\t\t\t<now-tooltip\n\t\t\t\t\tid={\"existing-user-icon-tooltip\"}\n\t\t\t\t\ttarget-ref={get(state, `existingUserIconRef`)}\n\t\t\t\t\tcontent={t('Details of the existing user. Sending a message will associate the ID with the current user instead.')}\n\t\t\t\t\tdelay={500}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className=\"agent-messaging-card-footer\">\n\t\t\t\t<font>{t('Name')} </font>{existingUser.display_name}\n\t\t\t\t<now-icon className=\"footer-indicator\" icon=\"status-fill\" size=\"sm\" ></now-icon>\n\t\t\t\t<font>{t('ID')} </font>{existingUser.id}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nconst renderCardDetails = (state, updateState) => {\n\tconst { interaction, lastUpdated, time } = state;\n\tlastUpdated.setUpdateFn(update(lastUpdated));\n\tconst setIconRef = (ref) => setTimeout(() => {\n\t\tif (isNil(ref)) {\n\t\t\tupdateState({ interactionIconRef: {} });\n\t\t} else {\n\t\t\tupdateState({ interactionIconRef: ref });\n\t\t}\n\t});\n\treturn (\n\t\t<div className=\"agent-messaging-card\">\n\t\t\t<div className=\"agent-messaging-card-header\">\n\t\t\t\t<font>{t('Ongoing Interaction')}</font>\n\t\t\t\t<now-icon hook-insert={({ elm }) => setIconRef(elm)} hook-destroy={() => setIconRef(null)} aria-describedby=\"ongoing-icon-tooltip\" icon=\"circle-question-outline\" size=\"md\"></now-icon>\n\t\t\t\t<now-tooltip\n\t\t\t\t\tid={\"ongoing-icon-tooltip\"}\n\t\t\t\t\ttarget-ref={get(state, `interactionIconRef`)}\n\t\t\t\t\tcontent={getInfoMessage(state)}\n\t\t\t\t\tdelay={500}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className=\"agent-messaging-card-footer\">\n\t\t\t\t<font>{interaction.number}</font>\n\t\t\t\t<now-icon className=\"footer-indicator\" icon=\"status-fill\" size=\"sm\" ></now-icon>\n\t\t\t\t<font>{interaction.subtype}</font>\n\t\t\t\t<now-icon className=\"footer-indicator\" icon=\"status-fill\" size=\"sm\" ></now-icon>\n\t\t\t\t<font>{t('Last updated')} </font>\n\t\t\t\t<time>\n\t\t\t\t\t{time}\n\t\t\t\t</time>\n\t\t\t\t{(interaction.contact.name ||\n\t\t\t\t\tinteraction.consumer.name ||\n\t\t\t\t\tinteraction.opened_for.name) ? <now-icon className=\"footer-indicator\" icon=\"status-fill\" size=\"sm\" ></now-icon> : null}\n\t\t\t\t<font>{extractFieldName(interaction, t)} </font>{ interaction.consumer.name || interaction.contact.name || interaction.opened_for.name}\n\t\t\t\t<now-icon className=\"footer-indicator\" icon=\"status-fill\" size=\"sm\" ></now-icon>\n\t\t\t\t<font>{t('Assigned to')} </font>{interaction.assigned_to.name}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\nconst renderAlerts = (alerts) => {\n\tconst items = alerts.map((alert, index) => {\n\t\tconst { content, status, icon, header } = alert;\n\t\treturn {\n\t\t\tid: `${index}`,\n\t\t\tstatus,\n\t\t\ticon,\n\t\t\tcontent,\n\t\t\theader,\n\t\t\taction: {\n\t\t\t\ttype: 'dismiss'\n\t\t\t}\n\t\t}\n\t});\n\treturn <now-alert-list configAriaLive=\"polite\" items={items}></now-alert-list>\n};\n","module.exports = __TECTONIC__$servicenow_now_textarea;","module.exports = __TECTONIC__$servicenow_now_button;","module.exports = __TECTONIC__$servicenow_now_tooltip;","module.exports = __TECTONIC__$servicenow_now_alert;","module.exports = __TECTONIC__$servicenow_now_icon;","module.exports = __TECTONIC__$servicenow_now_loader;","module.exports = __TECTONIC__$servicenow_now_input;","module.exports = __TECTONIC__lodash_4_17_4[\"get\"];","module.exports = __TECTONIC__lodash_4_17_4[\"isNil\"];","module.exports = __TECTONIC__lodash_4_17_4[\"remove\"];","import {\n\tATTACH_CLICKED,\n\tTRASH_BUTON_CLICKED,\n\tVALIDATE_SENDSMS_BOTTON,\n\tSN_SCRIPTED_MODAL_BUTTON_ENABLED_SET,\n\tSN_SCRIPTED_MODAL_DATA_SET,\n\tCHANNEL_USER_PROFILE_VALIDATION,\n\tFROM_VALUE,\n\tTO_VALUE,\n\tVALIDATE_PHONE_NUMBER,\n\tHANDLE_VALUE_UPDATE,\n\tATTACH_FILE,\n\tDELETE_FILE,\n\tFILE_STATE,\n\tVIRUS_SCAN_TIMEOUT,\n\tSUBSCRIBE_TO_SYS_ATTACHMENT,\n\tQUERY_ATTACHMENT_STATE,\n\tSEND_DATA_SET,\n\tBUTTON_ENABLED_SET,\n\tFETCH_CHANNEL_DETAILS,\n\tCHANNEL_SPECIFIC_VALIDATION,\n\tSMS_CHANNEL_ID\n} from './constants';\nimport {get, isNil, uniqueId, isEmpty} from 'lodash';\nimport {t} from 'sn-translate';\nimport {\n\tgetDropDownType,\n\tgetFromNumber,\n\tgetInteractionData,\n\tgetPhoneNumber,\n\tgetToNumber,\n\tgetToNumberFromAction,\n\tgetOtherNumber,\n\tgetUserDocument,\n\tgetUserDocumentSysId,\n\tvalidate164PhoneNumer,\n\tgete164Number,\n\tremoveWarningAlert,\n\tgetFirstFromNumber,\n\tgetIfOtherNumber,\n\tgetFirstSelection\n} from './selectors';\nimport { processToNumber } from './utils'\nimport { SnTimeAgo } from 'sn-component-timeago';\n\nconst handleAttachClicked = (action, state, updateState) => {\n\tclearAlertsByType(state, updateState, 'uploading');\n\tconst current = get(action, 'payload.file_input_ref.current');\n\tconst { attachment } = state;\n\tif (!isNil(current)) {\n\t\tif (isNil(attachment)) {\n\t\t\tcurrent.value = '';\n\t\t}\n\t\tcurrent.click();\n\t}\n};\n\nconst handleTrashButtonClicked = (dispatch, updateState, state) => {\n\tconst attachmentSysId = get(state, 'data.attachmentSysId');\n\tlet { data } = state;\n\tconst newData = Object.assign({}, data);\n\tnewData.attachmentSysId = null;\n\n\tupdateState({\n\t\tattachment: null,\n\t\tisAttachmentUploading: false,\n\t\tuploadErrMessage: null,\n\t\tdata: newData\n\t});\n\tdispatch(DELETE_FILE, {\n\t\tsysId: attachmentSysId\n\t});\n\tdispatch(VALIDATE_SENDSMS_BOTTON);\n};\n\nconst uploadAttachment = (dispatch, attachment, state) => {\n\tconst data = new FormData();\n\tdata.append('table_name', 'interaction');\n\tdata.append('table_sys_id', get(state, 'properties.uniqueSysId'));\n\tdata.append('file', attachment);\n\tdispatch(ATTACH_FILE, {\n\t\tdata\n\t}, { requestId: uniqueId() });\n};\n\nexport const handleOnConnect = ({ state, updateState, dispatch }) => {\n\tupdateState({\n\t\talerts:[]\n\t});\n\tdispatch(SN_SCRIPTED_MODAL_BUTTON_ENABLED_SET, false);\n\n\tconst {channels, userDocument} = state.properties;\n\tif (channels.length > 0) {\n\t\tdispatch(FETCH_CHANNEL_DETAILS, {\n\t\t\tdata: {\n\t\t\t\tchannel_id: channels[0].channel_id,\n\t\t\t\tuser_table: userDocument.table,\n\t\t\t\tuser_sys_id: userDocument.sys_id,\n\t\t\t\tshow_other_field: channels[0].show_other_field\n\t\t\t}\n\t\t});\n\t\tupdateState({\n\t\t\tpath: 'data.channel.item',\n\t\t\tvalue: channels[0],\n\t\t\toperation: 'set'\n\t\t});\n\t}\n};\n\nexport const setChannelValue = ({dispatch, state, action, updateState, updateProperties}) => {\n\tif (get(action, 'payload.result.fromValue', null) &&\n\t\tget(action, 'payload.result.toValue', null)) {\n\t\tupdateProperties({\n\t\t\tfromNumbers: action.payload.result.fromValue,\n\t\t\ttoNumbers: action.payload.result.toValue\n\t\t});\n\t\tupdateState({\n\t\t\tpath: 'data.fromNumber.item',\n\t\t\tvalue: action.payload.result.fromValue[0],\n\t\t\toperation: 'set'\n\t\t});\n\t}\n\tif (get(state, 'showInteractionRecord.value', false)) {\n\t\tlet {showInteractionRecord} = state;\n\t\tshowInteractionRecord.value = false;\n\t\tupdateState({\n\t\t\tshowInteractionRecord:  showInteractionRecord,\n\t\t\tinteraction: null\n\t\t});\n\t}\n\tif (get(state, 'showExistingUserRecord.value', false)) {\n\t\tlet {showExistingUserRecord} = state;\n\t\tshowExistingUserRecord.value = false;\n\t\tupdateState({\n\t\t\tshowExistingUserRecord: showExistingUserRecord,\n\t\t\texistingUser: null\n\t\t});\n\t}\n\tdispatch(VALIDATE_SENDSMS_BOTTON);\n};\n\nexport const handleOnBootstarp = ({ state, updateState }) => {\n\tif(get(state, 'properties.fromNumbers', []).length == 1){\n\t\tupdateState({\n\t\t\tpath: 'data.fromNumber.item',\n\t\t\tvalue: getFirstFromNumber(state),\n\t\t\toperation: 'set'\n\t\t});\n\t}\n};\n\nexport const buttonClickedHandler = ({ action, updateState, state, dispatch }) => {\n\tconst command = get(action, 'payload.command')\n\tswitch (command) {\n\t\tcase ATTACH_CLICKED:\n\t\t\thandleAttachClicked(action, state, updateState);\n\t\t\tbreak;\n\t\tcase TRASH_BUTON_CLICKED:\n\t\t\thandleTrashButtonClicked(dispatch, updateState, state);\n\t\t\tbreak;\n\t}\n};\n\nexport const fileChangedHandler = ({ action, updateState, dispatch, state }) => {\n\tdispatch(SN_SCRIPTED_MODAL_BUTTON_ENABLED_SET, false);\n\tconst fileList = get(action, 'payload');\n\tconst attachment = get(fileList, '[0]');\n\tupdateState({\n\t\tattachment,\n\t\tuploadErrMessage: null\n\t});\n\tuploadAttachment(dispatch, attachment, state);\n};\n\nexport const dropDownHandler = ({ updateState, dispatch, state, action }) => {\n\tlet itemId = getDropDownType(action);\n\tif (itemId === 'channels') {\n\t\tconst channelId = action.payload.item.channel_id;\n\t\tconst showOtherOption = action.payload.item.show_other_field;\n\t\tconst {userDocument} = state.properties;\n\t\tupdateState({\n\t\t\tpath: 'data.channel',\n\t\t\tvalue: {...action.payload},\n\t\t\toperation: 'set'\n\t\t});\n\n\t\tlet {showOtherField} = state;\n\t\tshowOtherField.value = false;\n\t\tupdateState({\n\t\t\tpath: 'data.toNumber',\n\t\t\tvalue: null,\n\t\t\toperation: 'set'\n\t\t});\n\t\tupdateState({\n\t\t\tshowOtherField: { ...showOtherField },\n\t\t});\n\t\tdispatch(FETCH_CHANNEL_DETAILS, {\n\t\t\tdata: {\n\t\t\t\tchannel_id: channelId,\n\t\t\t\tuser_table: userDocument.table,\n\t\t\t\tuser_sys_id: userDocument.sys_id,\n\t\t\t\tshow_other_field: showOtherOption\n\t\t\t}\n\t\t});\n\t} else {\n\t\tif (itemId === FROM_VALUE) {\n\t\t\tupdateState({\n\t\t\t\tpath: 'data.fromNumber',\n\t\t\t\tvalue: { ...action.payload },\n\t\t\t\toperation: 'set'\n\t\t\t});\n\t\t} else if (itemId === TO_VALUE) {\n\t\t\tlet toValue = getPhoneNumber(action);\n\t\t\tlet otherValue = false;\n\t\t\tlet {showInteractionRecord, showExistingUserRecord} = state;\n\t\t\tif (toValue === 'other' || toValue === 'Other') {\n\t\t\t\totherValue = true;\n\t\t\t\tif (getIfOtherNumber(state) != toValue) {\n\t\t\t\t\tshowInteractionRecord.value = false;\n\t\t\t\t\tshowExistingUserRecord.value = false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\totherValue = false;\n\t\t\t}\n\t\t\tconst newData = Object.assign({}, state.data);\n\t\t\tnewData.toNumber = { ...action.payload };\n\t\t\tconst showOtherField = { value: otherValue };\n\t\t\tconst { alerts } = state;\n\t\t\tupdateState({\n\t\t\t\tshowOtherField,\n\t\t\t\tshowInteractionRecord: { value: showInteractionRecord.value },\n\t\t\t\tshowExistingUserRecord: { value: showExistingUserRecord.value },\n\t\t\t\tdata: { ...newData },\n\t\t\t\talerts: alerts.filter(alert => alert.header !== t('Send to') && alert.type !== 'other_profile_matching'),\n\t\t\t});\n\t\t}\n\t\tdispatch(HANDLE_VALUE_UPDATE, {actionSource: 'dropDownHanlder'});\n\t}\n};\n\nexport const validateSendToValue = (state, dispatch) => {\n\tconst toNumber = getToNumber(state);\n\tconst {channels} = state.properties;\n\tconst {data} = state;\n\tif (channels.length == 0) {\n\t\tdispatch(VALIDATE_PHONE_NUMBER, {\n\t\t\tdata: {\n\t\t\t\t'user_table': getUserDocument(state),\n\t\t\t\t'user_document': getUserDocumentSysId(state),\n\t\t\t\t'client_phone_number': toNumber\n\t\t\t}\n\t\t});\n\t} else {\n\t\tdispatch(CHANNEL_SPECIFIC_VALIDATION, {\n\t\t\tdata: {\n\t\t\t\t'user_table': getUserDocument(state),\n\t\t\t\t'user_document': getUserDocumentSysId(state),\n\t\t\t\t'channel_id': data.channel.item.id,\n\t\t\t\t'send_to_value': toNumber\n\t\t\t}\n\t\t});\n\t}\n};\n\nexport const validateSendToVal = (state, dispatch, sendToValue) => {\n\tconst {channels} = state.properties;\n\tconst {data} = state;\n\tif (channels.length == 0) {\n\t\tdispatch(VALIDATE_PHONE_NUMBER, {\n\t\t\tdata: {\n\t\t\t\t'user_table': getUserDocument(state),\n\t\t\t\t'user_document': getUserDocumentSysId(state),\n\t\t\t\t'client_phone_number': sendToValue\n\t\t\t}\n\t\t});\n\t} else {\n\t\tdispatch(CHANNEL_SPECIFIC_VALIDATION, {\n\t\t\tdata: {\n\t\t\t\t'user_table': getUserDocument(state),\n\t\t\t\t'user_document': getUserDocumentSysId(state),\n\t\t\t\t'channel_id': data.channel.item.id,\n\t\t\t\t'send_to_value': sendToValue\n\t\t\t}\n\t\t});\n\t}\n};\n\nexport const handleValueUpdate = ({state, dispatch, action}) => {\n\tconst actionSource = get(action, 'payload.actionSource');\n\tconst fromNumber = getFromNumber(state);\n\tconst toNumber = getToNumber(state);\n\tconst {channels} = state.properties;\n\tif (fromNumber && toNumber) {\n\t\tif (!validate164PhoneNumer(state)) {\n\t\t\tif (toNumber != 'other' && toNumber != 'Other') {\n\t\t\t\tactionSource === 'dropDownHanlder' && validateSendToValue(state, dispatch);\n\t\t\t}\n\t\t} else {\n\t\t\tif (channels.length == 0) {\n\t\t\t\tdispatch(CHANNEL_USER_PROFILE_VALIDATION, {\n\t\t\t\t\t'user_table': getUserDocument(state),\n\t\t\t\t\t'user_document': getUserDocumentSysId(state),\n\t\t\t\t\t'agent_phone_number': getFromNumber(state),\n\t\t\t\t\t'client_phone_number': gete164Number(state),\n\t\t\t\t\t'channel_sys_id': SMS_CHANNEL_ID\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tdispatch(CHANNEL_USER_PROFILE_VALIDATION, {\n\t\t\t\t\t'user_table': getUserDocument(state),\n\t\t\t\t\t'user_document': getUserDocumentSysId(state),\n\t\t\t\t\t'agent_phone_number': getFromNumber(state),\n\t\t\t\t\t'client_phone_number': gete164Number(state),\n\t\t\t\t\t'channel_sys_id': get(state, 'data.channel.item.channel_id')\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t} else if (processToNumber(toNumber) && !validate164PhoneNumer(state)) {\n\t\tactionSource === 'dropDownHanlder' && validateSendToValue(state, dispatch);\n\t}\n\tdispatch(VALIDATE_SENDSMS_BOTTON);\n};\n\nexport const textAreaHandler = ({ updateState, dispatch, state, action }) => {\n\tif (get(action, \"payload.name\") == \"message\") {\n\t\tupdateState({\n\t\t\tpath: 'data.message',\n\t\t\tvalue: get(action, \"payload\"),\n\t\t\toperation: 'set'\n\t\t});\n\t}\n\tdispatch(VALIDATE_SENDSMS_BOTTON);\n};\n\nexport const validateEnableSendSMS = ({ updateState, dispatch, state, action }) => {\n\t//TODO : Validate message and/or attachment availability before sending the message\n\t// enable below line once phoneValidation is fixed\n\t//if (get(state, 'data.fromNumber') && get(state, 'data.toNumber') && get(state, 'data.toNumber.phoneValidation.isValid')) {\n\tconst {channels} = state.properties;\n\tconst isButtonEnabled = get(state, 'data.fromNumber', false)\n\t\t&& get(state, 'data.toNumber', false)\n\t\t&& get(state, 'data.toNumber.phone.isValid', false) && get(state, 'data.toNumber.phone.e164PhoneNumber', false)\n\t\t&& (get(state, 'data.message.value', '') !== '' || !isNil(get(state, 'data.attachmentSysId')));\n\n\tif(channels.length == 0) {\n\t\tdispatch(SN_SCRIPTED_MODAL_BUTTON_ENABLED_SET, isButtonEnabled);\n\t\tdispatch(SN_SCRIPTED_MODAL_DATA_SET, state.data);\n\t} else if (channels.length > 0) {\n\t\tdispatch(BUTTON_ENABLED_SET, {'isButtonEnabled': isButtonEnabled});\n\t\tdispatch(SEND_DATA_SET, {\n\t\t\tdata: constructData(state.data),\n\t\t\tuser_document: {\n\t\t\t\t'table': getUserDocument(state),\n\t\t\t\t'sys_id': getUserDocumentSysId(state)\n\t\t\t},\n\t\t\tunique_sys_id: state.properties.uniqueSysId\n\t\t});\n\t}\n};\n\nconst constructData = (data) => {\n\tlet response = {\n\t\tchannel: null,\n\t\tfromValue: null,\n\t\tmessage: null,\n\t\ttoValue: null,\n\t\tattachmentSysId: null\n\t};\n\n\tif (get(data,'channel', null)) {\n\t\tresponse.channel = get(data,'channel');\n\t}\n\tif (get(data,'fromNumber', null)) {\n\t\tresponse.fromValue = get(data,'fromNumber');\n\t}\n\tif (get(data,'message', null)) {\n\t\tresponse.message = get(data,'message');\n\t}\n\tif (get(data, 'toNumber', null)) {\n\t\tconst toValue = {\n\t\t\titem: get(data, 'toNumber.item'),\n\t\t\tformattedValue: {\n\t\t\t\tisValid: get(data, 'toNumber.phone.isValid'),\n\t\t\t\tvalue: get(data, 'toNumber.phone.e164PhoneNumber', null)\n\t\t\t}\n\t\t};\n\t\tresponse.toValue = toValue;\n\t}\n\tif (get(data, 'attachmentSysId')) {\n\t\tresponse.attachmentSysId = get(data, 'attachmentSysId');\n\t}\n\treturn response;\n};\n\nexport const postPhoneNumberValidationHandler = ({ state, action, updateState, dispatch }) => {\n\tconst result = get(action, 'payload.result');\n\tlet { isValid, e164PhoneNumber } = result;\n\tconst {channels} = state.properties;\n\tlet { errorPhoneField } = state;\n\tconst newErrorPhoneField = Object.assign({}, errorPhoneField);\n\n\tif (channels.length > 0) {\n\t\tconst {formattedValue} = result;\n\t\te164PhoneNumber = formattedValue;\n\t}\n\tif (isValid === true) {\n\t\tconst { data } = state;\n\t\tdata.toNumber.phone = {e164PhoneNumber: e164PhoneNumber, isValid: true};\n\t\tconst newData = Object.assign({}, data);\n\t\tif (get(state, 'showOtherField.value') === true) {\n\t\t\tconst { toInputRef } = state;\n\t\t\ttoInputRef.value = e164PhoneNumber;\n\t\t\tnewErrorPhoneField.value = false;\n\t\t\tupdateState({\n\t\t\t\tdata: newData,\n\t\t\t\tverifiedToNumber: e164PhoneNumber,\n\t\t\t\totherToPhoneNumber: e164PhoneNumber,\n\t\t\t\terrorPhoneField: { ...newErrorPhoneField }\n\t\t\t});\n\t\t} else {\n\t\t\tnewErrorPhoneField.value = false;\n\t\t\tupdateState({\n\t\t\t\tdata: newData,\n\t\t\t\tverifiedToNumber: e164PhoneNumber,\n\t\t\t\terrorPhoneField: { ...newErrorPhoneField }\n\t\t\t});\n\t\t}\n\n\t} else {\n\t\tconst { data } = state;\n\t\tdata.toNumber.phone = { e164PhoneNumber: null, isValid: false };\n\t\tconst newData = Object.assign({}, data);\n\t\tconst { alerts } = state;\n\t\talerts.push({\n\t\t\tcontent: t('Enter a value in the format specified for the selected channel.'),\n\t\t\tstatus: 'critical',\n\t\t\ticon: 'bell-outline',\n\t\t\ttype: 'phoneValidation'\n\t\t});\n\t\tupdateState({\n\t\t\tdata: newData,\n\t\t\talerts: [...alerts],\n\t\t\tshowInteractionRecord: { value: false },\n\t\t\tshowExistingUserRecord: { value: false },\n\t\t\terrorPhoneField: { value: true }\n\t\t});\n\t}\n\tdispatch(HANDLE_VALUE_UPDATE);\n};\n\nexport const alertDismissHandler = ({ action, updateState, state }) => {\n\tconst alerts = get(action, 'payload.value', []);\n\tupdateState({\n\t\tpath: 'alerts',\n\t\tvalue: [...alerts],\n\t\toperation: 'set'\n\t});\n};\n\nexport const interactionFetchHandler = ({ state, action, updateState, dispatch }) => {\n\tconst interactionData = getInteractionData(action);\n\tif (interactionData.other_profile_matching &&\n\t\t!interactionData.profile_matching &&\n\t\tinteractionData.other_profile_record) {\n\n\t\tconst { alerts } = state;\n\t\tlet newAlerts = alerts.filter((alert) => {\n\t\t\treturn alert.type !== 'other_profile_matching';\n\t\t});\n\t\tnewAlerts.push({\n\t\t\tcontent: t('This recipient ID is currently associated with the user {0}. Sending a message will associate this recipient ID with the selected user', interactionData.other_profile_record.display_name),\n\t\t\tstatus: 'warning',\n\t\t\ticon: 'bell-outline',\n\t\t\ttype: 'other_profile_matching'\n\t\t});\n\t\tupdateState({\n\t\t\tpath: 'alerts',\n\t\t\tvalue: [...newAlerts],\n\t\t\toperation: 'set'\n\t\t});\n\t\tupdateState({\n\t\t\texistingUser: interactionData.other_profile_record,\n\t\t\tshowExistingUserRecord: {value: true}\n\t\t});\n\t} else {\n\t\tupdateState({\n\t\t\texistingUser: null,\n\t\t\tshowExistingUserRecord: {value: false}\n\t\t});\n\t}\n\tif (interactionData.interaction) {\n\t\tlet { lastUpdated } = state;\n\t\tif (lastUpdated) {\n\t\t\tlastUpdated.remove();\n\t\t}\n\t\tvar option = {\n\t\t\tsystemTime: true,\n\t\t\ttimeAgo: true\n\t\t};\n\t\tupdateState({\n\t\t\tshowInteractionRecord: { value: true },\n\t\t\tinteraction: interactionData.interaction,\n\t\t\tlastUpdated: new SnTimeAgo(state, Date.parse(interactionData.interaction.sys_updated_on), option)\n\t\t});\n\t} else {\n\t\tupdateState({\n\t\t\tshowInteractionRecord: { value: false },\n\t\t\tinteraction: null,\n\t\t\tlastUpdatedOn: null\n\t\t});\n\t}\n\tdispatch(VALIDATE_SENDSMS_BOTTON);\n};\n\nexport const uploadWatcherMessageHandler = ({ action, state, updateState, dispatch }) => {\n\tconst { timer = null } = state;\n\tif (isNil(timer)) {\n\t\treturn;\n\t}\n\n\tconst fileState = isNil(get(action, 'payload.data.GlideRecord_Subscription.sys_attachment._results[0].state.value')) ?\n\t\tget(action, 'payload.GlideRecord_Subscription.sys_attachment._results[0].state.value') :\n\t\tget(action, 'payload.data.GlideRecord_Subscription.sys_attachment._results[0].state.value');\n\tconst { uploadingFileContent } = state;\n\tswitch (fileState) {\n\t\tcase FILE_STATE.AVAILABLE:\n\t\tcase FILE_STATE.AVAILABLE_CONDITIONALLY:\n\t\t\thandleSuccessUploads(state, uploadingFileContent, updateState, dispatch);\n\t\t\tbreak;\n\t\tcase FILE_STATE.NOT_AVAILABLE:\n\t\t\thandleFailedUploads(state, uploadingFileContent, updateState, dispatch);\n\t\t\tbreak;\n\t}\n};\n\nexport const fileUploadSuccessHandler = ({ dispatch, state, action, updateState }) => {\n\tconst result = get(action, 'payload.result');\n\tconst fileState = get(result, 'state');\n\tupdateState({\n\t\tuploadingFileContent: result\n\t});\n\tswitch (fileState) {\n\t\tcase FILE_STATE.SCAN_TURNED_OFF:\n\t\t\t// the virus scan is disabled\n\t\t\thandleSuccessUploads(state, result, updateState, dispatch);\n\t\t\tbreak;\n\t\tcase FILE_STATE.PENDING:\n\t\t\thandlePendingUploads(dispatch, result, updateState, state);\n\t\t\tbreak;\n\t\tcase FILE_STATE.AVAILABLE:\n\t\tcase FILE_STATE.AVAILABLE_CONDITIONALLY:\n\t\t\t// the virus scan is passed\n\t\t\thandleSuccessUploads(state, result, updateState, dispatch);\n\t\t\tbreak;\n\t\tcase FILE_STATE.NOT_AVAILABLE:\n\t\t\thandleFailedUploads(state, result, updateState, dispatch);\n\t\t\tbreak;\n\t}\n};\n\nconst handleSuccessUploads = (state, result, updateState, dispatch) => {\n\tconst { data } = state;\n\tlet newData = Object.assign({}, data);\n\tnewData.attachmentSysId = result.sys_id;\n\tupdateState({\n\t\tdata : newData,\n\t\tisAttachmentUploading : false\n\t});\n\tclearTimerAndGraphqlSubscription(state, result, updateState, dispatch);\n\tdispatch(VALIDATE_SENDSMS_BOTTON);\n};\n\nconst clearTimerAndGraphqlSubscription = (state, result, updateState, dispatch) => {\n\tlet { timer } = state;\n\tif (!isNil(timer)) {\n\t\tclearTimeout(timer);\n\t}\n\ttimer = null;\n\tupdateState({\n\t\ttimer\n\t});\n\tdispatch(SUBSCRIBE_TO_SYS_ATTACHMENT, {\n\t\tsubscribe: false,\n\t\tsys_id: result.sys_id\n\t});\n};\n\nconst handlePendingUploads = (dispatch, result, updateState, state) => {\n\tconst timer = setTimeout(() => {\n\t\thandleTimedoutUploads(dispatch, result, updateState, state);\n\t}, VIRUS_SCAN_TIMEOUT);\n\tdispatch(SUBSCRIBE_TO_SYS_ATTACHMENT, {\n\t\tsubscribe: true,\n\t\tsys_id: result.sys_id\n\t});\n\tupdateState({\n\t\ttimer\n\t});\n};\n\nexport const updateAttachmentState = ({dispatch, action, state, updateState}) => {\n\tconst attachmentState = get(action, 'payload.data.GlideRecord_Query.sys_attachment._results[0].state.value');\n\tconst attachmentSysId = get(action, 'payload.data.GlideRecord_Query.sys_attachment._results[0].sys_id.value');\n\tswitch (attachmentState) {\n\t\tcase FILE_STATE.AVAILABLE:\n\t\tcase FILE_STATE.AVAILABLE_CONDITIONALLY:\n\t\t\t// the virus scan is passed\n\t\t\tconst { data } = state;\n\t\t\tlet newData = Object.assign({}, data);\n\t\t\tnewData.attachmentSysId = attachmentSysId;\n\t\t\tupdateState({\n\t\t\t\tdata : newData,\n\t\t\t\tisAttachmentUploading : false\n\t\t\t});\n\t\t\tdispatch(VALIDATE_SENDSMS_BOTTON);\n\t\t\tbreak;\n\t\tcase FILE_STATE.PENDING:\n\t\tcase FILE_STATE.NOT_AVAILABLE:\n\t\t\tconst errMsg = t('The virus scan has timed out. Please try uploading the file again.');\n\t\t\tsendAlertAndTerminateUploading(errMsg, state, updateState, dispatch);\n\t\t\tbreak;\n\t}\n};\n\nconst handleTimedoutUploads = (dispatch, result, updateState, state) => {\n\tdispatch(QUERY_ATTACHMENT_STATE, {\n\t\tsys_id: result.sys_id\n\t});\n\tclearTimerAndGraphqlSubscription(state, result, updateState, dispatch);\n};\n\nconst handleFailedUploads = (state, result, updateState, dispatch) => {\n\tconst errMsg = t('The file {0} did not pass the security scan. Please try uploading again.', result.file_name);\n\tsendAlertAndTerminateUploading(errMsg, state, updateState, dispatch);\n\tclearTimerAndGraphqlSubscription(state, result, updateState, dispatch);\n};\n\nexport const fileUploadFailedHandler = ({ action, updateState, state, dispatch }) => {\n\tconst errMsg = get(action, 'payload.data.message', t('An error has occurred. Please try again later.'));\n\tsendAlertAndTerminateUploading(errMsg, state, updateState, dispatch);\n};\n\nconst sendAlertAndTerminateUploading = (errMsg, state, updateState, dispatch) => {\n\tconst { alerts = [] } = state;\n\talerts.push({\n\t\tcontent: errMsg,\n\t\tstatus: 'critical',\n\t\ticon: 'bell-outline',\n\t\ttype: 'uploading'\n\t});\n\tupdateState({\n\t\talerts: [...alerts],\n\t\tisAttachmentUploading: false,\n\t\tattachment: null\n\t});\n\tdispatch(VALIDATE_SENDSMS_BOTTON);\n};\n\nexport const fileUploadProgressHandler = ({ action, updateState }) => {\n\tupdateState({\n\t\tisAttachmentUploading: true\n\t});\n};\n\nexport const validatePhoneNumber = ({ state, action, dispatch, updateState }) => {\n\tconst toNumber = getToNumberFromAction(action);\n\tif (toNumber.length > 0) {\n\t\tvalidateSendToVal(state, dispatch, toNumber);\n\t} else {\n\t\tupdateState({\n\t\t\tshowInteractionRecord: { value: false },\n\t\t\tshowExistingUserRecord: { value: false },\n\t\t\terrorPhoneField: { value: false }\n\t\t});\n\t\tclearAlertsByType(state, updateState, 'other_profile_matching');\n\t\tif (get(state, 'data.toNumber.phone.isValid', false) || get(state, 'data.toNumber.phone.e164PhoneNumber', false)) {\n\t\t\tconst { data } = state;\n\t\t\tlet newData = Object.assign({}, data);\n\t\t\tnewData.toNumber.phone.isValid = false;\n\t\t\tnewData.toNumber.phone.e164PhoneNumber = null;\n\t\t\tupdateState({\n\t\t\t\tdata: newData\n\t\t\t});\n\t\t\tdispatch(VALIDATE_SENDSMS_BOTTON);\n\t\t}\n\t}\n};\n\nexport const clearPhoneNumberValidationAlert = ({ state, action, updateState }) => {\n\tif (get(action, 'payload.name') === 'Other Number') {\n\t\tclearAlertsByType(state, updateState, 'phoneValidation');\n\t\tconst otherToPhoneNumber = get(action, 'payload.fieldValue');\n\t\tupdateState({\n\t\t\totherToPhoneNumber\n\t\t});\n\t}\n\n};\n\nconst clearAlertsByType = (state, updateState, type) => {\n\tconst { alerts = [] } = state;\n\tif (alerts.length > 0) {\n\t\tconst newAlerts = alerts.filter(alert => alert.type !== type);\n\t\tupdateState({\n\t\t\tpath: 'alerts',\n\t\t\tvalue: [...newAlerts],\n\t\t\toperation: 'set'\n\t\t});\n\t}\n};\n\nexport const textAreaInputHandler = ({action, updateState, dispatch}) => {\n\tconst isTextAreaRequired = isEmpty(get(action, 'payload.fieldValue'));\n\tdispatch(SN_SCRIPTED_MODAL_BUTTON_ENABLED_SET, false);\n\tupdateState({\n\t\tisTextAreaRequired,\n\t\tisTextAreaInvalid: isTextAreaRequired\n\t});\n};\n\nexport const handlePropertyChange = ({action, state, updateState, dispatch}) => {\n\tconst {name, value} = action.payload;\n\tswitch (name) {\n\t\tcase 'fromNumbers': {\n\t\t\tconst {data} = state;\n\t\t\tconst firstSelection = getFirstSelection(state);\n\t\t\tif(!firstSelection && !isEmpty(value) && !get(data, 'fromNumber.item', false)) {\n\t\t\t\tupdateState({\n\t\t\t\t\tfirstSelection: true,\n\t\t\t\t});\n\t\t\t\tupdateState({\n\t\t\t\t\tpath: 'data.fromNumber.item',\n\t\t\t\t\tvalue: getFirstFromNumber(state),\n\t\t\t\t\toperation: 'set'\n\t\t\t\t});\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tcase 'channels': {\n\t\t\tconst {channels, userDocument} = state.properties;\n\t\t\tif (channels.length > 0) {\n\t\t\t\tdispatch(FETCH_CHANNEL_DETAILS, {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tchannel_id: channels[0].channel_id,\n\t\t\t\t\t\tuser_table: userDocument.table,\n\t\t\t\t\t\tuser_sys_id: userDocument.sys_id,\n\t\t\t\t\t\tshow_other_field: channels[0].show_other_field\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tupdateState({\n\t\t\t\t\tpath: 'data.channel.item',\n\t\t\t\t\tvalue: channels[0],\n\t\t\t\t\toperation: 'set'\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n};\n","import {createHttpEffect} from '@servicenow/ui-effect-http';\nimport {createGraphQLEffect} from \"@servicenow/ui-effect-graphql\";\nimport {\n    VALIDATE_PHONE_NUMBER_SUCCESS,\n    FILE_UPLOAD_PROGRESS,\n    FILE_UPLOAD_SUCCESS,\n    FILE_UPLOAD_FAILED,\n    INTERACTION_FETCHED,\n    UPLOAD_WATCHER_MESSAGE_RECEIVED,\n    UPLOAD_STATE_MESSAGE_RECEIVED,\n\tSET_FROM_TO_PROPERTY\n} from './constants';\n\nconst SYS_ATTACHMENT_SUBSCRIPTION = `\nsubscription {\n    GlideRecord_Subscription {\n      sys_attachment(sys_id: \"{{sys_id}}\") {\n        _subscription {\n          subscription_state\n          subscription_channel\n          subscription_operation\n          serialized_subscription\n        }\n        _results {\n          state {\n            value\n          }\n        }\n      }\n    }\n  }`;\n\nconst SYS_ATTACHMENT_QUERY = `\nquery {\n  GlideRecord_Query {\n    sys_attachment(sys_id: \"{{sys_id}}\") {\n      _results {\n        state {\n          value\n        }\n        sys_id {\n          value\n        }\n      }\n    }\n  }\n}\n`;\n\nexport const validatePhoneNumberEffect = createHttpEffect('api/now/initiate_message/validate_phone_number', {\n    batch: false,\n    method: 'POST',\n    dataParams: ['user_table', 'user_document', 'client_phone_number'],\n    successActionType: VALIDATE_PHONE_NUMBER_SUCCESS\n});\n\nexport const channelSpecificValidation = createHttpEffect('/api/now/agent_initiated_message/channel_specific_validation', {\n\tbatch: false,\n\tmethod: 'POST',\n\tdataParams: ['user_table', 'user_document', 'send_to_value', 'channel_id'],\n\tsuccessActionType: VALIDATE_PHONE_NUMBER_SUCCESS\n});\n\nexport const fetchChannelDetails = createHttpEffect('/api/now/agent_initiated_message/get_from_to_value', {\n\tbatch: false,\n\tmethod: 'POST',\n\tdataParams: ['channel_id', 'user_table', 'user_sys_id', 'show_other_field'],\n\tsuccessActionType: SET_FROM_TO_PROPERTY\n});\n\nexport const uploadAttachment = createHttpEffect('/api/now/attachment/upload', {\n    batch: false,\n\tmethod: 'POST',\n\tprogressActionType: FILE_UPLOAD_PROGRESS,\n\tsuccessActionType: FILE_UPLOAD_SUCCESS,\n\terrorActionType: FILE_UPLOAD_FAILED\n});\n\nexport const deleteAttachment = createHttpEffect('/api/now/attachment/:sysId', {\n    batch: false,\n    method: 'DELETE',\n    pathParams: ['sysId']\n});\n\nexport const channelUserProfileValidation = createHttpEffect('/api/now/initiate_message/validate_profile', {\n\tbatch: false,\n\tmethod: 'GET',\n\tqueryParams: ['user_table', 'user_document', 'agent_phone_number', 'client_phone_number', 'channel_sys_id'],\n\tsuccessActionType: INTERACTION_FETCHED\n});\n\nexport const sysAttachmentGraphqlSubscription = createGraphQLEffect(SYS_ATTACHMENT_SUBSCRIPTION, {\n    templateVarList: ['sys_id'],\n    successActionType: UPLOAD_WATCHER_MESSAGE_RECEIVED,\n\titemChangedActionType: UPLOAD_WATCHER_MESSAGE_RECEIVED\n});\n\nexport const sysAttachmentGraphqlQuery = createGraphQLEffect(SYS_ATTACHMENT_QUERY, {\n  templateVarList: ['sys_id'],\n  successActionType: UPLOAD_STATE_MESSAGE_RECEIVED\n});\n","module.exports = __TECTONIC__$servicenow_ui_effect_http;","module.exports = __TECTONIC__$servicenow_ui_effect_graphql;","\n        var result = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/postcss-loader/src/index.js??ref--6-2!../../node_modules/sass-loader/dist/cjs.js??ref--6-3!./agentSMSModal.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \":host{box-sizing:border-box;line-height:var(--now-line-height,1.25);font-family:var(--now-font-family,\\\"Source Sans Pro\\\",\\\"Helvetica Neue\\\",helvetica,arial,sans-serif)}:host([hidden]){display:none}*,:after,:before{box-sizing:border-box}.now-a11y-label{position:absolute;overflow:hidden;width:1px;height:auto;margin:0;border:none;padding:0;white-space:nowrap;clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%)}.sn-attachments{display:flex;flex-direction:row}.sn-attachments-container{display:flex;flex-direction:column}.sn-attachment{display:flex;flex-direction:row}.sn-attachment-name{margin-top:.25rem}.sn-attachment-name,.sn-attachment-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:12.5rem}.sn-attachment-text{margin-top:.5rem;font-size:1rem}.sn-attachment-loader{margin:.5rem}.channels{margin-bottom:1.5rem;width:49%;float:left}.channels-wrapper{width:100%}.channels-wrapper now-label-value-inline{display:block;margin-top:.5rem}.channels-wrapper now-dropdown{width:100%;border-bottom:RGB(var(--now-color--divider-tertiary,var(--now-color--neutral-3,209,214,214))) solid 1px}.from-value-when-channels{margin-bottom:1.5rem;width:49%;float:right}.from-value-when-channels-wrapper{width:100%}.from-value-when-channels-wrapper now-label-value-inline{display:block;margin-top:.5rem}.from-value-when-channels-wrapper now-dropdown{width:100%;border-bottom:RGB(var(--now-color--divider-tertiary,var(--now-color--neutral-3,209,214,214))) solid 1px}.from-value{margin-bottom:1.5rem;width:100%}.from-value-wrapper{width:50%}.from-value-wrapper now-label-value-inline{display:block;margin-top:.5rem}.from-value-wrapper now-dropdown{width:100%;border-bottom:RGB(var(--now-color--divider-tertiary,var(--now-color--neutral-3,209,214,214))) solid 1px}.to-value{margin-bottom:1.5rem;width:100%}.to-value-wrapper{width:50%;float:left;margin-bottom:1.5rem}.to-value-wrapper now-label-value-inline{display:block;margin-bottom:.25rem}.to-value-wrapper now-dropdown{width:100%;padding-bottom:.25rem;border-bottom:RGB(var(--now-color--divider-tertiary,var(--now-color--neutral-3,209,214,214))) solid 1px}.to-value-input{margin-bottom:1.5rem;width:45%;float:right}.to-value-input now-input{float:right;width:100%}.to-value-when-channels{margin-bottom:1.5rem;width:100%}.to-value-when-channels-wrapper{width:49%;float:left;margin-bottom:1.5rem}.to-value-when-channels-wrapper now-label-value-inline{display:block;margin-bottom:.25rem}.to-value-when-channels-wrapper now-dropdown{width:100%;padding-bottom:.25rem;border-bottom:RGB(var(--now-color--divider-tertiary,var(--now-color--neutral-3,209,214,214))) solid 1px}.to-value-when-channels-input{margin-bottom:1.5rem;width:49%;float:right}.to-value-when-channels-input now-input{float:right;width:100%}now-textarea{margin-bottom:1.5rem}.agent-messaging-card{border:RGB(var(--now-color--divider-tertiary,var(--now-color--neutral-3,209,214,214))) solid 1px;margin-bottom:1.5rem;width:100%;float:left}.agent-messaging-card-header{padding-top:1.5rem;font-size:1rem}.agent-messaging-card-footer,.agent-messaging-card-header{padding-left:1rem;padding-right:1rem;color:RGB(var(--now-color--text-secondary,var(--now-color--neutral-12,66,80,81)))}.agent-messaging-card-footer{padding-top:.5rem;padding-bottom:1.5rem;font-size:.75rem}.agent-messaging-card-footer now-icon.footer-indicator{margin-left:.25rem;margin-right:.25rem;vertical-align:-1px}.agent-messaging-card-footer font{font-weight:700;color:RGB(var(--now-color--text-secondary,var(--now-color--neutral-12,66,80,81)))}.agent-messaging-card now-icon,.other-phone-number{margin-left:.5rem}.to-number-dropdown{width:50%}\", \"\"]);\n\n// exports\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n"],"sourceRoot":""}