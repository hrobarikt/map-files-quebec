{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"get\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"cloneDeep\\\"]\"","webpack:///./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack:///external \"__TECTONIC__$servicenow_ui_renderer_snabbdom\"","webpack:///external \"__TECTONIC__$servicenow_ui_effect_http\"","webpack:///./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"isEmpty\\\"]\"","webpack:///./node_modules/@babel/runtime/helpers/getPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///./node_modules/@babel/runtime/regenerator/index.js","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"isEqual\\\"]\"","webpack:///./node_modules/@babel/runtime/helpers/inherits.js","webpack:///./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","webpack:///./node_modules/@babel/runtime/helpers/typeof.js","webpack:///external \"__TECTONIC__cuid_2_1_6\"","webpack:///external \"__TECTONIC__$servicenow_ui_core\"","webpack:///external \"__TECTONIC__$devsnc_library_uxf_19_50_6\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"set\\\"]\"","webpack:///external \"__TECTONIC__sn_translate\"","webpack:///./node_modules/@babel/runtime/helpers/asyncToGenerator.js","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"isNil\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"reject\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"find\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"flatMap\\\"]\"","webpack:///./node_modules/@babel/runtime/helpers/createClass.js","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"isUndefined\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"map\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"reduce\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"isNull\\\"]\"","webpack:///./node_modules/@babel/runtime/helpers/extends.js","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"isArray\\\"]\"","webpack:///./node_modules/@babel/runtime/helpers/objectWithoutProperties.js","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"omit\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"pick\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"groupBy\\\"]\"","webpack:///./src/sn-uxf-renderer/sn-uxf-renderer.scss?b740","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"mapValues\\\"]\"","webpack:///./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack:///external \"__TECTONIC__$servicenow_now_uxf_page\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"uniq\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"trim\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"isString\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"isNaN\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"has\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"flatten\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"flow\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"zip\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"last\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"unionBy\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"uniqBy\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"merge\\\"]\"","webpack:///external \"__TECTONIC__esprima_4_0_1\"","webpack:///external \"__TECTONIC__$servicenow_ui_effect_amb\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"assign\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"camelCase\\\"]\"","webpack:///external \"__TECTONIC__lodash_4_17_4[\\\"forEach\\\"]\"","webpack:///./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack:///./node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack:///external \"__TECTONIC__regenerator_runtime_0_13_5\"","webpack:///./node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js","webpack:///external \"__TECTONIC__$servicenow_now_modal\"","webpack:///./src/sn-uxf-renderer/sn-uxf-renderer.scss","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///external \"__TECTONIC__$servicenow_now_empty_state\"","webpack:///external \"__TECTONIC__$devsnc_sn_layout\"","webpack:///./src/constants.js","webpack:///./src/factories/constants.js","webpack:///./src/models/model.js","webpack:///./src/models/property.js","webpack:///./src/models/slot.js","webpack:///./src/models/layout/layout.js","webpack:///./src/models/component.js","webpack:///./src/models/eventMapping.js","webpack:///./src/models/utils/seismicifyIds.js","webpack:///./src/factories/util.js","webpack:///./src/models/element.js","webpack:///./src/sn-uxf-builder-middleware/element/utils/layout.js","webpack:///./src/sn-uxf-builder-middleware/element/utils/createElementArray.js","webpack:///./src/sn-uxf-builder-middleware/element/utils/element.js","webpack:///./src/factories/binding.js","webpack:///./src/lintWorker.js","webpack:///./src/utils.js","webpack:///./src/models/pageTree.js","webpack:///./src/sn-uxf-builder-middleware/componentList/componentListActions.js","webpack:///./src/models/action.js","webpack:///./src/models/clientScript.js","webpack:///./src/models/clientStateParameter.js","webpack:///./src/models/dataBrokerInstance.js","webpack:///./src/models/elementEvent.js","webpack:///./src/models/eventHandler.js","webpack:///./src/models/eventMappingTarget.js","webpack:///./src/models/macroponentProperty.js","webpack:///./src/models/baseModel.js","webpack:///./src/factories/json-literal.js","webpack:///./src/factories/list-container.js","webpack:///./src/factories/map-container.js","webpack:///./src/factories/client-transform-script.js","webpack:///./src/factories/versioned-client-transform-script.js","webpack:///./src/factories/translation-literal.js","webpack:///./src/factories/index.js","webpack:///./src/sn-uxf-builder-middleware/viewportHandlers/templateLoader.js","webpack:///./src/sn-uxf-builder-middleware/componentList/utils.js","webpack:///./src/sn-uxf-builder-middleware/elementEventMappings/constants.js","webpack:///./src/sn-uxf-builder-middleware/page/constants.js","webpack:///./src/sn-uxf-builder-middleware/page/utils/shared.js","webpack:///./src/sn-uxf-builder-middleware/pageProperties/utils/createContextBindings.js","webpack:///./src/sn-uxf-builder-middleware/elementEventMappings/utils.js","webpack:///./src/sn-uxf-builder-middleware/pageProperties/utils/reduceContextBindingsWithAncestors.js","webpack:///./src/sn-uxf-builder-middleware/templates/utils/getLayoutFromMacroponent.js","webpack:///./src/models/createPageState.js","webpack:///./src/sn-uxf-builder-middleware/element/elementActions.js","webpack:///./src/sn-uxf-builder-middleware/element/defaultLayoutElementHandlers/defaultHandlers.js","webpack:///./src/sn-uxf-builder-middleware/element/defaultLayoutElementHandlers/slottedElementHandlers.js","webpack:///./src/sn-uxf-builder-middleware/elementEventMappings/elementEventMappingsActions.js","webpack:///./src/sn-uxf-builder-middleware/dataBrokers/dataBrokerInstances/dataBrokerInstancesActions.js","webpack:///./src/sn-uxf-builder-middleware/clientState/clientStateActions.js","webpack:///./src/sn-uxf-builder-middleware/utils.js","webpack:///./src/sn-uxf-builder-middleware/element/reservedPropertyIds.js","webpack:///./src/sn-uxf-builder-middleware/viewportHandlers/utils.js","webpack:///./src/models/pageState.js","webpack:///./src/sn-uxf-builder-middleware/helpers/effectProxy.js","webpack:///./src/sn-uxf-builder-middleware/componentList/componentListHandlers.js","webpack:///./src/sn-uxf-builder-middleware/dataBrokers/dataBrokerDefinitions/dataBrokerDefinitionsActions.js","webpack:///./src/sn-uxf-builder-middleware/dataBrokers/dataBrokerDefinitions/dataBrokerDefinitionsHandlers.js","webpack:///./src/sn-uxf-builder-middleware/dataBrokers/dataBrokerFactory/index.js","webpack:///./src/sn-uxf-builder-middleware/dataBrokers/dataBrokerInstances/dataBrokerInstancesHandlers.js","webpack:///./src/sn-uxf-builder-middleware/dataBrokers/dataBrokerRuntimeActions.js","webpack:///./src/sn-uxf-builder-middleware/dataBrokers/utils/transformDataBrokerInstancesToDataBrokerRuntime.js","webpack:///./src/sn-uxf-builder-middleware/updatedTables/updatedTablesActions.js","webpack:///./src/sn-uxf-builder-middleware/dataBrokers/dataBrokerRuntimeHandlers.js","webpack:///./src/sn-uxf-builder-middleware/element/utils/getLayoutType.js","webpack:///./src/models/layout/columnElement.js","webpack:///./src/models/layout/rowElement.js","webpack:///./src/models/layout/rowColumn.js","webpack:///./src/sn-uxf-builder-middleware/element/utils/api/layout.js","webpack:///./src/sn-uxf-builder-middleware/element/utils/createDefaultLayout.js","webpack:///./src/sn-uxf-builder-middleware/element/elementHandlers.js","webpack:///./src/sn-uxf-builder-middleware/element/rowColumnHandlers/elementCreatedHandlers.js","webpack:///./src/sn-uxf-builder-middleware/element/rowColumnHandlers/elementMovedHandlers.js","webpack:///./src/sn-uxf-builder-middleware/element/rowColumnHandlers/elementDeletedHandlers.js","webpack:///./src/sn-uxf-builder-middleware/element/utils/isLayoutEmpty.js","webpack:///./src/sn-uxf-builder-middleware/element/utils/reparentElementsToNewLayout.js","webpack:///./src/sn-uxf-builder-middleware/element/elementLayoutHandlers.js","webpack:///./src/sn-uxf-builder-middleware/element/elementStyleHandlers.js","webpack:///./src/sn-uxf-builder-middleware/element/elementResizeHandler.js","webpack:///./src/sn-uxf-builder-middleware/element/elementPropertyUpdatedHandler.js","webpack:///./src/sn-uxf-builder-middleware/element/utils/isCircular.js","webpack:///./src/sn-uxf-builder-middleware/element/elementMetadataUpdatedHandler.js","webpack:///./src/sn-uxf-builder-middleware/pageList/pageListActions.js","webpack:///./src/sn-uxf-builder-middleware/page/utils/pageStatus.js","webpack:///./src/sn-uxf-builder-middleware/page/utils/transformMacroponentToPageState.js","webpack:///./src/sn-uxf-builder-middleware/element/elementExplodedHandler.js","webpack:///./src/sn-uxf-builder-middleware/element/index.js","webpack:///./src/sn-uxf-builder-middleware/elementEventMappings/elementEventMappingsHandlers.js","webpack:///./src/sn-uxf-builder-middleware/page/pageActions.js","webpack:///./src/sn-uxf-builder-middleware/page/pageCreatedUtils.js","webpack:///./src/sn-uxf-builder-middleware/page/pageCreatedHandlers.js","webpack:///./src/sn-uxf-builder-middleware/page/utils/pageEndpointFromType.js","webpack:///./src/sn-uxf-builder-middleware/page/pageDeletedHandlers.js","webpack:///./src/sn-uxf-builder-middleware/contextState/utils/dataBrokerUtils.js","webpack:///./src/sn-uxf-builder-middleware/contextState/utils/pagePropertyUtils.js","webpack:///./src/sn-uxf-builder-middleware/contextState/utils/elementUtils.js","webpack:///./src/sn-uxf-builder-middleware/contextState/ancestorElementFactory/index.js","webpack:///./src/sn-uxf-builder-middleware/contextState/contextStateProcessor.js","webpack:///./src/sn-uxf-builder-middleware/contextState/utils/appChromeSettingsUtils.js","webpack:///./src/sn-uxf-builder-middleware/page/pageRequestedHandlers.js","webpack:///./src/sn-uxf-builder-middleware/element/utils/layoutMigration.js","webpack:///./src/sn-uxf-builder-middleware/page/pageRequestSucceededHandlers.js","webpack:///./src/sn-uxf-builder-middleware/componentSources/componentSourcesActions.js","webpack:///./src/sn-uxf-builder-middleware/page/utils/convertAncestorEventMappingsToRelays.js","webpack:///./src/sn-uxf-builder-middleware/page/utils/transformPageStateToMacroponent.js","webpack:///./src/sn-uxf-builder-middleware/dispatchedEvents/dispatchedEventsActions.js","webpack:///./src/sn-uxf-builder-middleware/page/utils/resolveInvalidEventMappingTargets.js","webpack:///./src/sn-uxf-builder-middleware/page/pageSavedHandlers.js","webpack:///./src/sn-uxf-builder-middleware/clientScripts/clientScriptsActions.js","webpack:///./src/sn-uxf-builder-middleware/page/pageUpdatedHandlers.js","webpack:///./src/sn-uxf-builder-middleware/page/utils/transformMetadata.js","webpack:///./src/sn-uxf-builder-middleware/page/pageMetadataHandlers.js","webpack:///./src/sn-uxf-builder-middleware/page/pageCopiedHandlers.js","webpack:///./src/sn-uxf-builder-middleware/page/index.js","webpack:///./src/sn-uxf-builder-middleware/configurationComponentByInterface/configurationComponentByInterfaceActions.js","webpack:///./src/sn-uxf-builder-middleware/pageList/pageListHandlers.js","webpack:///./src/sn-uxf-builder-middleware/screenProperties/screenPropertiesActions.js","webpack:///./src/sn-uxf-builder-middleware/screenProperties/utils.js","webpack:///./src/sn-uxf-builder-middleware/screenProperties/screenPropertiesUpdatedHandlers.js","webpack:///./src/sn-uxf-builder-middleware/screenProperties/index.js","webpack:///./src/sn-uxf-builder-middleware/pageProperties/pagePropertiesActions.js","webpack:///./src/sn-uxf-builder-middleware/pageProperties/pagePropertiesHandlers.js","webpack:///./src/sn-uxf-builder-middleware/pageLayout/pageLayoutActions.js","webpack:///./src/sn-uxf-builder-middleware/pageLayout/pageLayoutHandlers.js","webpack:///./src/sn-uxf-builder-middleware/templates/templatesActions.js","webpack:///./src/sn-uxf-builder-middleware/templates/utils/pageTypeLookup.js","webpack:///./src/sn-uxf-builder-middleware/templates/utils/getDefaultLayout.js","webpack:///./src/sn-uxf-builder-middleware/templates/templatesHandlers.js","webpack:///./src/sn-uxf-builder-middleware/pageTemplates/pageTemplatesActions.js","webpack:///./src/sn-uxf-builder-middleware/pageTemplates/pageTemplatesHandlers.js","webpack:///./src/sn-uxf-builder-middleware/pageTemplates/pageTemplateCreateHandlers.js","webpack:///./src/sn-uxf-builder-middleware/pageTemplates/index.js","webpack:///./src/sn-uxf-builder-middleware/layoutTemplates/layoutTemplatesActions.js","webpack:///./src/sn-uxf-builder-middleware/layoutTemplates/layoutTemplateCreateHandlers.js","webpack:///./src/sn-uxf-builder-middleware/clientScripts/utils.js","webpack:///./src/sn-uxf-builder-middleware/clientScripts/clientScriptsHandlers.js","webpack:///./src/sn-uxf-builder-middleware/clientState/clientStateHandlers.js","webpack:///./src/sn-uxf-builder-middleware/clientState/clientStateRuntimeHandlers.js","webpack:///./src/sn-uxf-builder-middleware/dispatchedEvents/utils/createScreenEventMapping.js","webpack:///./src/sn-uxf-builder-middleware/dispatchedEvents/dispatchedEventsHandlers.js","webpack:///./src/sn-uxf-builder-middleware/domReady/domReadyHandlers.js","webpack:///./src/sn-uxf-builder-middleware/ambSubscribers/ambSubscribersActions.js","webpack:///./src/sn-uxf-builder-middleware/ambSubscribers/ambSubscribersHandlers.js","webpack:///./src/sn-uxf-builder-middleware/ambSubscribers/utils.js","webpack:///./src/sn-uxf-builder-middleware/updatedTables/updatedTablesHandlers.js","webpack:///./src/sn-uxf-builder-middleware/newPage/newPageActions.js","webpack:///./src/sn-uxf-builder-middleware/newPage/newPageUtils.js","webpack:///./src/sn-uxf-builder-middleware/newPage/newPageCreateHandlers.js","webpack:///./src/sn-uxf-builder-middleware/newPage/newPageDeleteHandlers.js","webpack:///./src/sn-uxf-builder-middleware/newPage/utils.js","webpack:///./src/sn-uxf-builder-middleware/newPage/newPageSaveHandlers.js","webpack:///./src/sn-uxf-builder-middleware/newPage/newPageVariantCreateHandlers.js","webpack:///./src/sn-uxf-builder-middleware/newPage/newPageVariantDeleteHandlers.js","webpack:///./src/sn-uxf-builder-middleware/newPage/newPageVariantOverrideHandlers.js","webpack:///./src/sn-uxf-builder-middleware/configurationComponentByInterface/configurationComponentByInterfaceHandlers.js","webpack:///./src/sn-uxf-builder-middleware/componentSources/componentSourcesHandlers.js","webpack:///./src/sn-uxf-builder-middleware/modalhandlers/defaultCustomModalLayout.js","webpack:///./src/sn-uxf-builder-middleware/modalhandlers/utils.js","webpack:///./src/sn-uxf-builder-middleware/modalhandlers/modalCreatedHandler.js","webpack:///./src/sn-uxf-builder-middleware/modalhandlers/modalActions.js","webpack:///./src/sn-uxf-builder-middleware/modalhandlers/deleteModalHandler.js","webpack:///./src/sn-uxf-builder-middleware/modalhandlers/index.js","webpack:///./src/sn-uxf-builder-middleware/bindings/bindings.js","webpack:///./src/sn-uxf-builder-middleware/bindings/bindingActions.js","webpack:///./src/sn-uxf-builder-middleware/bindings/bindingHandlers.js","webpack:///./src/sn-uxf-builder-middleware/bindings/index.js","webpack:///./src/sn-uxf-builder-middleware/viewportHandlers/render.js","webpack:///./src/sn-uxf-builder-middleware/viewportHandlers/actions.js","webpack:///./src/sn-uxf-builder-middleware/viewportHandlers/update.js","webpack:///./src/sn-uxf-builder-middleware/viewportHandlers/dataDrivenViewport.js","webpack:///./src/sn-uxf-builder-middleware/viewportHandlers/index.js","webpack:///./src/sn-uxf-builder-middleware/dashboards/dashboardsActions.js","webpack:///./src/sn-uxf-builder-middleware/dashboards/dashboardsCreateHandlers.js","webpack:///./src/sn-uxf-builder-middleware/dashboards/dashboardsEditHandlers.js","webpack:///./src/sn-uxf-builder-middleware/dashboards/dashboardsDeleteHandlers.js","webpack:///./src/sn-uxf-builder-middleware/dashboards/dashboardsScreensHandlers.js","webpack:///./src/sn-uxf-builder-middleware/dashboards/index.js","webpack:///./src/sn-uxf-builder-middleware/domainScope/domainScopeActions.js","webpack:///./src/sn-uxf-builder-middleware/domainScope/domainScopeHandlers.js","webpack:///./src/sn-uxf-builder-middleware/configProperties.js","webpack:///./src/sn-uxf-builder-middleware/sn-uxf-builder-middleware.js","webpack:///./src/sn-uxf-builder-middleware/index.js","webpack:///./src/sn-uxf-renderer/utils.js","webpack:///./src/sn-uxf-renderer/sn-uib-value-renderer.js","webpack:///./src/sn-uxf-renderer/sn-uib-modal-content.js","webpack:///./src/sn-uxf-renderer/sn-uxf-renderer.js","webpack:///./src/sn-uxf-element-mount/utils.js","webpack:///./src/sn-uxf-element-mount/sn-uxf-element-mount.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","obj","configurable","writable","__TECTONIC__lodash_4_17_4","arrayWithoutHoles","require","iterableToArray","unsupportedIterableToArray","nonIterableSpread","arr","__TECTONIC__$servicenow_ui_renderer_snabbdom","__TECTONIC__$servicenow_ui_effect_http","arrayWithHoles","iterableToArrayLimit","nonIterableRest","_getPrototypeOf","setPrototypeOf","getPrototypeOf","__proto__","instance","Constructor","TypeError","subClass","superClass","constructor","_typeof","assertThisInitialized","self","iterator","__TECTONIC__cuid_2_1_6","__TECTONIC__$servicenow_ui_core","__TECTONIC__$devsnc_library_uxf_19_50_6","__TECTONIC__sn_translate","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","Promise","then","fn","this","args","arguments","apply","err","undefined","_defineProperties","target","props","length","descriptor","protoProps","staticProps","_extends","assign","source","objectWithoutPropertiesLoose","excluded","getOwnPropertySymbols","sourceSymbolKeys","indexOf","propertyIsEnumerable","result","toString","arrayLikeToArray","minLen","slice","Array","from","test","len","arr2","__TECTONIC__$servicenow_now_uxf_page","__TECTONIC__esprima_4_0_1","__TECTONIC__$servicenow_ui_effect_amb","isArray","_arr","_n","_d","_e","_s","_i","next","push","iter","_setPrototypeOf","ReferenceError","__TECTONIC__regenerator_runtime_0_13_5","sourceKeys","keys","__TECTONIC__$servicenow_now_modal","___CSS_LOADER_API_IMPORT___","useSourceMap","list","map","item","content","cssMapping","btoa","sourceMapping","sourceMap","base64","unescape","encodeURIComponent","JSON","stringify","data","concat","sourceURLs","sources","sourceRoot","join","cssWithMappingToString","mediaQuery","dedupe","alreadyImportedModules","id","__TECTONIC__$servicenow_now_empty_state","__TECTONIC__$devsnc_sn_layout","DATA_NAMESPACE","ELEMENT_TYPES","MODAL","CONTEXT_NAMESPACE","ELEMENT_NAMESPACE","PAYLOAD_NAMESPACE","STATE_NAMESPACE","CLIENT_TRANSFORM_SCRIPT_TEMPLATES","ELEMENT","EVENT","VALID_BINDING_TYPES_ENUM","ELEMENT_BINDING","CONTEXT_BINDING","DATA_OUTPUT_BINDING","EVENT_PAYLOAD_BINDING","STATE_BINDING","BINDING_SHORTHAND_PATTERN","RegExp","values","SCRIPT_SHORTHAND_PATTERN","TRANSLATE_SHORTHAND_PATTERN","Model","prop","Property","columnName","label","type","reference","referenceFilter","isStatic","choices","table","readOnly","order","interfaceApiName","emptyStateBehavior","selectable","description","defaultValue","variant","translatable","schema","Slot","parentElement","Layout","defaultLayout","Component","icon","tag","slots","properties","dispatchedEvents","actions","configuration","externalConfigurationSources","category","explodable","isEditable","EventMapping","eventMappingId","eventId","eventApiName","targets","idString","replace","toLowerCase","isSchemaTranslatable","oneOf","extractStringSchema","TRANSLATION_PREFIXES","removePrefixes","str","prefix","match","trim","extractTranslatablePaths","path","anyOf","items","val","newPath","uniq","translatePropbyPath","shorthand","set","translateKeys","translatablePaths","isString","splitPath","split","temp","index","newPaths","newSplit","Element","instanceName","slot","layout","component","macroponentProperties","propertyValues","propertyTestValues","eventMappings","children","listenTo","extendsSysId","styles","isModal","isModalDescendant","internalEventMappings","isHidden","scope","scopeName","sysPolicy","_getDefaultInstanceName","_setNewComponent","_setNewProperties","_setNewEventMappings","_setNewChildren","_setNewSlot","_setNewLayout","entries","every","entry","reduce","acc","mapping","child","allIds","targetName","seismicifyIds","highest","forEach","matcher","Number","highestMatchingInstanceIndex","_highestMatchingIdIndex","rootName","toProportion","nums","sum","toScale","processor","remainder","numbers","num","rem","newRemainder","newNumbers","Math","ceil","floor","getUpdatedSizesForNew","size","share","processed","updates","col","parseInt","updatedSizes","newSize","normalizeSizes","array","newCol","find","filter","flattenLayout","layoutPart","childType","flattenedParts","parent","flattenChildren","parts","newParts","childLayoutPart","rows","columns","slotName","row","column","treeifyLayout","flattenedLayout","populateChildren","currentKey","currentLayoutPart","ids","default","root","findLayoutElementByChild","childId","layoutElement","childCollectionType","getCollectionKey","getChildType","isLeaf","spliceInNewChild","childCollection","adjacentId","targetId","direction","ret","adjacentIdIndex","splice","replaceExistingChild","oldId","newId","parentType","insertParallelLeaf","layoutParent","existingId","newSlotName","childCollectionKey","cuid","newChildren","insertPerpendicularToLayout","collectionType","collectionKey","siblingId","pop","shift","hasChildren","getRoot","isParallel","layoutType","insertPerpendicularToSingleLeaf","layoutElementParent","targetSlotName","newLeafId","newChildCollectionKey","newChildCollection","newChildType","applyNewSizes","cols","columnId","insertAndGetUpdatedLayout","newLayoutElementType","newLayoutElementCollectionKey","newContainerId","newContainer","insertPerpendicularToLeaf","rootLayoutElement","newRootId","existingRoot","existingRootType","newRootType","newRootCollectionKey","newRoot","newLayoutElement","unshift","insertParallelToRoot","deleteAndGetUpdatedLayout","deletedElementParent","deletedElementParentId","deletedElementGrandParentId","newFlattenedLayout","soloLayoutChildId","currentSoloLayoutChildCollectionKey","grandParentCollectionKey","newGrandParentChildren","promoteAndDeleteElement","illegalLayoutElement","findIncongruentLayoutElement","illegalElementParent","illegalCollectionKey","mergedChildCollection","removeIncongruentLayoutElement","spliceOutChild","soloChildId","findLayoutElementsWithSingleChildLayout","singletonLayoutElement","singletonLayoutElementChildIds","singletonChildId","promoteSingltonAtRoot","childrenKey","getResizedRow","traverseChildren","createElementArray","element","callback","flatMap","componentUsesSNLayout","elementUsesSNLayout","getRootElementFromState","state","pageState","rootElement","findElementById","elementId","findElements","el","e","throwError","matchingElements","findParentElement","found","typedValue","isNil","pv","parseFloat","isNaN","createElementPropertiesFromComponent","propertyConfig","newProperty","getAllElementIds","createElementFromComponent","seismicCuid","tagName","isContainer","width","deleteChildElement","deletedElementId","BindingFactory","model","fType","getTypeFromShorthand","fShortHand","getShorthandFromModel","fModel","getModelFromShorthand","shorthandMatcher","binding","expressionRoot","address","getShorthand","getModel","workerFn","scriptImported","onmessage","payload","origin","scripts","importScripts","lintConfig","parserOptions","ecmaVersion","sourceType","ecmaFeatures","impliedStrict","rules","semi","globals","console","uibLinter","eslint","Linter","postMessage","script","verify","cuidToSeismicFriendlyId","getWithNullDefault","fallback","normalizeRowColumnSlots","walkRowColumnTree","node","childLookup","letterCode","String","fromCharCode","msg","MiddlewareError","Error","message","messageInfo","matchBindingSyntax","patternString","matchedValues","namespace","propName","matchScriptSyntax","matchedScript","matchContextAppBindingSyntax","appPatternString","matchContextSessionBindingSyntax","pattern","matchStateBindingSyntax","statePatternString","deserializeAndExecuteScript","inlineScript","api","resolved","newFn","Function","_","resolveScriptedPropertyValue","clientScriptApi","resolvePropertyBinding","bindings","ancestorPageProperties","dataBrokerInstances","ancestorDataBrokerInstances","ancestorElements","appChromeSettings","pathToUse","pagePropertiesSeen","has","boundPropertyValue","resolvedValues","dotWalkPath","dataExpression","resolvedPath","boundDbInstance","db","definition","propData","unstableResolvePropertySelectorValue","fullData","resolveBinding","stateBinding","propertyToProcess","parse","processLinting","lintWorker","Worker","window","URL","createObjectURL","Blob","location","setTimeout","addEventListener","onComplete","removeEventListener","childrenKeyLookup","createNode","nodeType","slotStyles","handlersByType","rowColumn","processLayoutTree","layoutNode","elements","parentId","processChildren","elementLayout","layoutRole","rootLayoutNode","processedElements","process","some","PageTreeModel","mergeTrees","COMPONENT_LIST_REQUESTED","COMPONENT_LIST_ALL_REQUESTED","COMPONENT_LIST_TYPE_REQUESTED","COMPONENT_LIST_REQUEST_STARTED","COMPONENT_LIST_REQUEST_FAILED","COMPONENT_LIST_REQUEST_SUCCEEDED","Action","ClientScript","includes","ClientStateParameter","initialValue","DataBrokerInstance","selectableProps","hydrationSysId","clientStateDataBrokerTagName","outputProperties","readEvaluationMode","simpleMutationBroker","definitionName","ElementEvent","eventName","payloadShape","apiName","EventHandler","sourceName","sourceId","payloadFields","ancestor","relay","EventMappingTarget","declarativeAction","event","operation","clientScript","clientTransformScript","fieldType","typeMetadata","valueType","shape","mandatory","inherited","testValue","BaseModel","initialValues","attributes","attr","JSONLiteralFactory","isUndefined","fShorthand","ListContainerFactory","fSchema","container","getShorthandFromUxValue","getUxValueFromShorthand","MapContainerFactory","ClientTransformScriptFactory","apiVersion","scriptMatcher","resolvedScript","VersionedClientTransformScriptFactory","a","scriptToLint","isCompatibilityMode","errors","TranslationLiteralFactory","comment","isTranslationLiteralType","isValidBindingShorthand","isValidClientTransformScriptShortHand","isMapContainerShorthand","hasBinding","getUxValueFactoryFromShorthand","isObject","isNull","isArrayObject","isTranslatableShorthand","isStringTranslatable","isBindingShorthand","isClientTransformScriptShorthand","isListContainerShorthand","getUxValueFactoryFromType","isUxValueModel","types","isValidBindingType","isValidContainerType","jsonLiteralType","isJSONLiteralType","Factory","getVersionedUxValueFromShorthand","ScriptFactory","createTemplateLoader","addTimestamp","getTemplates","deleteCache","defaultEmptyStateBehavior","condition_string","field_list","table_name","boolean","choice","field","html","json","number","string","emptyStateBehaviorMap","NULL","UNDEFINED","EMPTY_STRING","EMPTY_OBJ","EMPTY_ARRAY","getEmptyStateBehavior","getProperty","typeMetadataObj","DATABROKER_OP","ROOT_MACROPONENT_SOURCE_EVENTS","computeEventMappingTargetKeys","targetKey","valueKey","idKey","nonTargetKeys","coercePropertyValueToShorthand","getPayloadPropertiesFromHandlerDefinition","eventMappingTargetValues","handlerTypeId","eventHandlers","matchingEventHandler","eventMappingTargetSysId","operationName","handler","getTransformedEventTarget","screenEventMappings","eventMappingTargetApiName","targetEventHandler","relayMapping","convertToDataBrokerOp","ancestorType","eventMappingTargetScript","parentResourceId","eventMappingTargetProperties","newEventMappingTarget","relayOperation","cloneDeep","dataBrokerId","convertedEventMappingTargetProperties","generateEventMappings","eventMapping","eventMappingTargets","sourceEventApiName","transformedTargets","replacePropValuesWithNewId","previousId","startsWith","removePropertyReferencesToPreviousId","dataBrokers","stateParams","reconfigureEventMappingTargets","mappings","instanceId","handlerValues","removeEventReferencesToPreviousId","broker","eventHandler","isEmpty","formatEventNameAndLabel","rootId","screenName","toUpperCase","getInvalidTargetsByType","parentEventHandler","addInvalidHandlers","parentEventHandlers","typeKey","typeValue","currentInvalidHandlers","invalidValue","getInvalidEventMappingTargets","elementArr","invalidHandlers","getReducedHandlerList","invalidEventMappingTargets","existingDispatchedEvents","rootMacroponentId","invalidPredicateFn","handlerList","existingDispatchedEvent","getNewRootElementAndElementToUpdate","newRootElement","elementToUpdate","createEventMapping","createEventMappingHandler","mappingId","eventMappingToUpdate","deleteEventMappingHandler","handlerId","updateEventMappingHandler","handlerToUpdate","handlerValueId","scripted","clientStateParameters","typeId","selectedHandler","eventMappingHandlerType","targetValueToUpdate","actionValue","createExposedProperty","dependees","getDependentProperties","dependee","sysId","param","paramType","paramName","paramInitialValue","isContextPropBinding","isContextBoundProperty","isContextDataBinding","resolveAncestorPropertyValues","intermediateProps","resolvedProps","propValue","resolvedValue","onIntermediateValue","contextMatcher","dataMatcher","pathSplit","targetProp","parentKey","targetValue","substring","isDataBoundProperty","iterateAndResolveValues","intermediateProp","localPageProperties","mergePropertyValues","createContextBindings","getLayoutFromMacroponent","macroponent","createPageState","newProperties","sourcePageState","spreadPageState","cur","PageStateModel","ELEMENT_PROPERTY_UPDATED","ELEMENT_LAYOUT_CHANGED","SLOT_STYLES_CHANGED","SLOT_STYLES_PATCHED","ELEMENT_STYLES_UPDATED","COMPONENT_PLACED","ELEMENT_DELETED","ELEMENT_DETACHED","DETACHED_ELEMENT_RELOCATED","DETACHED_ELEMENT_RESTORED","ELEMENT_RESIZED","COMPONENT_PLACED_SUCCEEDED","COMPONENT_PLACED_FAILED","UPDATE_LAYOUT_SUCCEEDED","RELOCATE_ELEMENT_SUCCEEDED","RESTORE_ELEMENT_SUCCEEDED","DETACH_ELEMENT_SUCCEEDED","VIEWPORT_NAME_CHANGED","ELEMENT_METADATA_UPDATE_REQUESTED","ELEMENT_ID_CHANGED","ELEMENT_EXPLODED","ELEMENT_EXPLODED_MACROPONENT_REQUESTED","ELEMENT_EXPLODED_MACROPONENT_SUCCEEDED","ELEMENT_EXPLODED_SUBROUTE_COPY_REQUESTED","ELEMENT_EXPLODED_SUBROUTE_COPY_SUCCEEDED","ELEMENT_EXPLODED_UPDATE_PAGE_WITH_MACROPONENT_CONTENTS","ELEMENT_IS_HIDDEN_TEST_VALUE_CHANGED","COMPONENT_EDIT_REQUESTED","getDefaultSlotname","firstItem","compareLayouts","b","normalize","parsed","isEqual","directionLookup","insertAt","getInsertPosition","adjacent","formatted","insertOffset","adjacentIndex","findIndex","defaultSlotStylingToFlex","adjacentElement","layoutSlot","getSlot","display","ELEMENT_EVENT_MAPPING_CREATED","ELEMENT_EVENT_MAPPING_HANDLER_CHANGED","ELEMENT_EVENT_MAPPING_HANDLER_CREATED","ELEMENT_EVENT_MAPPING_HANDLER_DELETED","ELEMENT_COMPLETE_EVENT_MAPPING_CREATED","SCREEN_EVENT_MAPPING_CREATED","SCREEN_EVENT_MAPPING_HANDLER_ADDED","SCREEN_EVENT_MAPPING_HANDLER_DELETED","SCREEN_EVENT_MAPPING_HANDLER_CHANGED","PAGE_INTERNAL_EVENT_MAPPING_CREATED","PAGE_INTERNAL_EVENT_MAPPING_HANDLER_CREATED","PAGE_INTERNAL_EVENT_MAPPING_HANDLER_DELETED","PAGE_INTERNAL_EVENT_MAPPING_HANDLER_CHANGED","DATA_BROKER_INSTANCE_CREATED","DATA_BROKER_INSTANCE_DELETED","DATA_BROKER_INSTANCE_PROPERTY_UPDATED","DATA_BROKER_INSTANCE_METADATA_UPDATE_REQUESTED","DATA_BROKER_INSTANCE_ID_CHANGED","DATA_BROKER_INSTANCE_EVALUATION_MODE_UPDATED","DATA_BROKER_INSTANCE_EVENT_MAPPING_CREATED","DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_CREATED","DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_CHANGED","DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_DELETED","CLIENT_STATE_PARAMETER_CREATED","CLIENT_STATE_PARAMETER_DELETED","CLIENT_STATE_PARAMETER_CHANGED","CLIENT_STATE_DATA_REQUESTED","supportedPropertyTypes","typeTranslationLookup","Choice","Reference","rawProperty","typeMeta","requestedType","getElementTreeIcon","isRoot","sortChildrenUsingGrid","existingValue","sortChildrenUsingNamedSlots","elementHasNamedSlots","getHiddenElements","isHiddenValue","basicBindingMatcher","stateParamBindingMatcher","scriptBindingMatcher","resolveDynamicValue","getElementTree","hiddenElements","sortedChildren","layoutItems","tree","isNamedSlot","layoutTree","getElementStyles","getIsLayoutModified","templatesDefinitions","templateId","templateDefinition","templateLayout","layoutDefault","addTemplateId","getElementProperties","isScripted","alwaysBound","propertyReference","getElementLayouts","isLayoutModified","getElementEvents","getElementEventMappings","cumulativeEventMappings","getScreenEventMappings","getInternalEventMappings","getElementToEventMappingHandlerMap","elementEventMappings","eventMappingHandlers","handlers","getDataBrokerInstanceProperties","setOnChangeForDependeeProperties","propertiesMap","transformedProperties","dependents","onChange","updateElement","dependent","getDataBrokerInstances","selectablePropPreview","selectablePropExecutionTime","getDataBrokerEventMappings","cumulativeMappings","getEventMappingTargetKey","getHandlerTypeId","targetIdKey","getHandlerValuesCollection","targetValueKey","getEventMappingHandlers","cumulativeHandlers","handlerType","handlerName","getBoundValueFromClientScriptApi","bindingExpression","getDataBrokerInputPropertiesFromPageState","dataBrokerDataId","dataBrokerInstance","pageProperties","isContextPropsBinding","pagePropName","isContextSessionBinding","isContextAppBinding","getPageMetadata","uiTypeParameters","pageStatus","coerceJSONPagePropertyValue","valueToUse","getPageProperties","testValueToUse","stripViewportsProps","viewportElementIds","nodes","addAllEventHandlers","isAncestor","dataBrokerDefinitions","clientScripts","rootMacroponent","macroponentPublicHandledEvents","newHandlers","dbInstance","def","operationsEventHandlers","operations","eventProperties","dispatchedEvent","isRelay","generateDataBrokerProperties","dataBrokerDefinition","inputValues","targetPropertyKey","createDataBrokerInstances","datum","definitionId","dataBrokerInputProperties","dataBrokerOutputProperties","dataBrokerDispatchedEvents","ev","elementLabel","invalid","createDataBrokerInstancePropertiesFromDataBrokerDefinition","output","targetProperties","instanceProperties","getStateParams","params","getElementByProperty","propertyValue","getClientScriptApi","clientStateData","context","session","targetDefinition","reduceClientStateProps","selectablePropAcc","reduceContextBindingsWithAncestors","bindingMatcher","dataBrokerValue","app","accElements","accProps","createEventHandlerFromMcpEvent","handledEvent","mcpId","mcpName","getEventHandlersFromRootMacroponent","macroponentDefinitions","extensionParentId","extensionParent","handledEvents","processClientStateData","contextBindings","getTypeForValue","addInterfaceFromObjectKeys","interfaceName","interfaces","overridePropType","newType","intf","addInterfacesForContextSessionUser","user","defs","enumName","_interfaces","addTypesForNameValuePairs","preferences","addTypesForNameObjectKeys","roles","apiPaths","srcPath","apiPath","addInterfacesForContextSession","contextInterface","getClientScriptApiCompletions","isClientTransformScript","apiInterface","pathEntry","iface","propType","isAclViolation","runtimeErrors","ACL_ERROR_PATTERN","pageEventMappingRef","action","elementPropertyRef","propertyId","elementEventMappingRef","dataBrokerInstanceRef","dataBroker","dataBrokerEventMappingRef","clientStateParamRef","elementEventsRef","elementName","assessTarget","targetIsScriptOrOp","isItemReferencedFn","deleting","isReferenced","refs","isItemReferenced","parameter","renderPlaceholder","document","createElement","setAttribute","setViewportContent","host","range","createRange","selectNodeContents","deleteContents","insertNode","detach","resolveMacroponentConfig","macroponentConfiguration","mcpConfigAsProperties","MacroponentProperty","pagePropsAsObject","renderContents","mcp","macroponentSysId","mcpConfiguration","fields","resolvedMacroponentConfig","fragmentGenerator","fragment","renderEmptyState","hasRoutes","emptyState","shadowRoot","attachShadow","innerHTML","appendChild","getActiveRouteAndScreen","viewportRoutes","defaultRoute","variantId","route","routes","flatten","defaultRouteInfo","routeType","sort","getDefaultActiveRoute","screen","initializeDataDrivenViewportProperties","dataSource","transformAndResolveDataSource","isDataDrivenTab","sortViewportRoutes","sortedViewportRoutes","elem","isDefaultRouteNotPresent","routeNotPresent","isViewportComponent","isViewportIsolatedEditingDisabled","viewportConfigFromNowUi","disableIsolationEditing","getViewportElementAndProperties","viewportElement","activeRoute","activeScreen","dynamicViewportTabData","repeatedViewportTabData","getViewportElementIds","dataBrokersEnabled","domainId","domainName","applicationName","applications","canCopy","usingSharedPageDefinition","effect","coeffects","excludedComponents","typeComponentListRequested","createHttpEffect","method","pathParams","startActionType","errorActionType","successActionType","batch","allComponentListRequested","transformToolboxComponent","dispatch","pageType","effectProxy","updateProperties","isLoadingComponents","updateState","rawComponentList","componentsResponse","components","macroponentName","rootElementDefinition","availableSlots","rootComponentTag","propertyInstances","actionInstances","eventInstances","componentInstance","fetchComponentData","isLegacy","DATA_BROKER_DEFINITIONS_REQUESTED","DATA_BROKER_DEFINITIONS_REQUEST_STARTED","DATA_BROKER_DEFINITIONS_REQUEST_FAILED","DATA_BROKER_DEFINITIONS_REQUEST_SUCCEEDED","dataBrokerDefinitionsRequested","dataBrokerOperations","dbDef","dbOperations","createProperties","createDataBrokerRuntimeElement","inputProperties","createCustomElement","renderer","snabbdom","view","preview","executionTime","dataBrokerDefinitionId","descendentDataBrokerInstances","descendentDataBrokers","newDataBrokerInstances","newEventHandlers","dataBrokerInstanceToAdd","allDataBrokerInstanceIds","dbi","newDataBrokerInstance","initialize","createDataBrokerFromDefinition","dataBrokerTag","getComponentsByTagNames","updatedEventHandlers","updatedDataBrokerInstances","dataBrokerProperties","dataBrokerInstanceToUpdate","dataBrokerInstancePropertyToUpdate","dataBrokerInstanceProperties","updateProp","changes","newClientStateParameters","dataBrokerEventMapping","DATA_BROKER_RUNTIME_EXECUTE_REQUESTED","DATA_BROKER_RUNTIME_EXECUTE_HTTP_REQUESTED","DATA_BROKER_RUNTIME_EXECUTE_STARTED","DATA_BROKER_RUNTIME_EXECUTE_SUCCEEDED","DATA_BROKER_RUNTIME_EXECUTE_FAILED","DATA_BROKER_RUNTIME_RESET_AND_EXECUTE_REQUESTED","generateJSONLiteral","resolveDataBinding","splitExpression","dataBrokerInstanceId","outputPath","contextBindingValues","matchedContextSessionBinding","matchedContextAppBinding","bindingName","bindingNameSplitter","contextValue","resolveContextBinding","bindingValue","resolveStateBinding","transformDataBrokerInstancesToDataBrokerRuntime","includeDataBrokerId","resolvedDataBrokers","hydratedInputValues","dataBrokerid","definitionSysId","findMaxReferenceAddress","orderDataBrokerChainBreadthFirst","dataBrokerDependencyChain","idx","currentPosition","curChildIndexes","Set","newPosition","isChild","v","addr","add","counter","toBeVisited","n1","n2","childIndexes","childIdx","k","max","UPDATED_TABLES_RESET_REQUESTED","dataBrokerRuntimeExecuteHttpEffect","dataParam","parentDataBrokerInstances","isIsolatedEditAndEmptyState","ancestorDBkrIDs","dbr","dbkr","bindExpr","dataBrokerRuntime","dataBrokerLink","log","__data","inputProps","outputProps","actionType","changedDataBrokerDefinition","newInputProps","newOutputProps","inputParams","newInstanceProps","dbinst","outputSchema","newInstanceOutputProps","getLayoutType","ownerId","owner","ColumnElement","RowElement","RowColumn","placeElementOnLayout","slotToPlaceNewElementIn","flattenedInputLayout","flattenedOutputLayout","deleteElementFromLayout","treeLayout","rootIsALeaf","pageTypeLookup","landing","slottedComponent","createDefaultLayout","elementCreatedLookup","componentId","adjacentLayoutElementId","droppedComponent","newElement","allElementIds","getDefaultLayout","elementDetachedLookup","detachedElementId","detachedElement","detachedElements","elm","detachedLayoutNode","previousLayout","elementRelocatedLookup","detachedElementParent","detachedElementData","unflattenedLayout","lookup","findLayoutElementById","movedElement","slotToPlaceElementIn","newLayout","newSlot","targetParentElement","detachedIndex","elementDeletedLookup","newPageState","onlySlottedChild","targetElement","isOnlySlottedChild","detachedElementSlotName","layoutElementId","findLayoutElementIdFromSlotName","indexOfDeletedElem","elementRestoredLookup","elementIds","createdInSlot","actionFn","componentCreatedInSlot","newElementDefaultEventHandlers","defaultEventHandler","eventMappingTarget","componentMovedToSlot","newHiddenElements","elementTree","elementProperties","propertiesToCache","parsedValue","checkValue","sessionStorage","setItem","isLayoutEmpty","reparentElements","flow","status","ownerElement","currentLayout","current","orphanedComponents","nullSlottedChildren","results","matched","remaining","matchedResults","newItems","oldItems","matchedComponents","zip","groupBy","curr","unmatched","newElements","comp","lastItem","last","remaningOrphans","orphanSlot","combinedChildren","reparentElementsToNewLayout","layoutTemplateId","layoutTemplate","template","addTemplateIdToLayout","er","normalizedLayout","reparentedComponents","selectedSlotName","updateSlot","resizeLookup","side","directionString","targetIdx","part","neighbor","dir","neighbors","LEFT","reverse","RIGHT","getClosestNeighbor","neighborIndex","payloadPropertyId","payloadValue","payloadProperties","propertiesToUpdate","warn","checkElement","circularRefElements","isCircular","sourceElement","allElements","currentElement","iterCount","currentDepth","currEl","boundElementIds","boundElId","isCir","nextEl","PAGE_LIST_REQUESTED","PAGE_LIST_HTTP_REQUESTED","PAGE_LIST_REQUEST_STARTED","PAGE_LIST_REQUEST_FAILED","PAGE_LIST_REQUEST_SUCCEEDED","getPageStatus","isActive","getIsActive","getComponent","componentDefinitions","toolboxIcon","toolboxLabel","composition","getIsHiddenValue","viewportConfigurations","componentDerivedProperties","propertyName","incomingValue","finalValue","tempValue","viewportComponentProperties","currentDefaultRoute","modifiedViewportRoutes","viewportRoutesKeys","dataDrivenRouteType","initializeViewportElementProperties","createElementFromCompositionNode","compositionNode","isParentModal","overrides","EventMappings","getMergedPropertiesFromHierarchy","hierarchyItems","unionBy","formatLayout","createElementFromMacroponent","formattedLayout","macroThatHasProperties","hierarchyProperties","componentProperties","isPropertyDefined","rawProperties","transformSubroutesToViewportConfig","subroutes","entityMap","subrouteConfigurations","viewportElementId","viewportConfig","reMappedViewportConfig","newKey","transformMacroponentToPageState","isReadOnly","macroponentInstance","internalEventMappingsSourceEvents","stateProperties","stateParam","matchingParam","initialDataBrokerInstances","rootMacroponentEventMappings","transformedInternalEventMappings","associatedTypes","explodedMacroponentRequested","subroutesCopyRequested","updateBinding","originalContextProperties","entityIdMap","truncated","dbInstanceId","substr","explodedElement","macroponentId","explodedElementId","meta","macroponentDependencies","componentDependencies","originalExplodedElement","newExplodedElement","idMap","uniqueIdMapGenerator","originalIds","currentIds","currentElementIds","explodedElementIds","currentDataBrokerInstanceIds","explodedDataBrokerIds","generateIdMap","subroute","currentParentCompositionElementId","parentCompositionElementId","variantSysId","dataBrokerIdMap","newDbInstanceId","createDataBokerInstances","elementIndex","appConfig","keyToUse","sysIdToUse","isExplosion","elementHandlers","elementTypeHandlers","elementPropertyUpdatedHandler","elementLayoutHandlers","elementStyleHandlers","elementResizeHandler","elementMetadataUpdatedHandler","elementExplodedHandler","getPageState","elementEventMapping","newScreenEventMapping","existingScreenEventMappings","clonedScreenEventMappings","newScreenEventMappings","newInternalEventMapping","existingInternalEventMappings","PAGE_CREATE_REQUESTED","PAGE_CREATE_HTTP_REQUESTED","PAGE_CREATE_STARTED","PAGE_CREATE_FAILED","PAGE_CREATE_SUCCEEDED","PAGE_REQUESTED","PAGE_REQUESTED_STARTED","PAGE_REQUESTED_HTTP","PAGE_REQUEST_HTTP_STARTED","PAGE_REQUEST_HTTP_FAILED","PAGE_REQUEST_HTTP_SUCCEEDED","PAGE_UPDATE_REQUESTED","PAGE_UPDATE_STARTED","PAGE_UPDATE_FAILED","PAGE_UPDATE_SUCCEEDED","PAGE_DELETE_REQUESTED","PAGE_DELETE_REQUESTED_HTTP","PAGE_DELETE_STARTED","PAGE_DELETE_FAILED","PAGE_DELETE_SUCCEEDED","PAGE_SAVE_REQUESTED","PAGE_SAVE_HTTP_REQUESTED","PAGE_COMPONENTS_REQUESTED","PAGE_COPY_REQUESTED","PAGE_COPY_HTTP_REQUESTED","PAGE_COPY_STARTED","PAGE_COPY_FAILED","PAGE_COPY_SUCCEEDED","PAGE_DATA_RECEIVED","METADATA_UPDATE_REQUESTED","METADATA_UPDATE_HTTP_REQUESTED","METADATA_UPDATE_STARTED","METADATA_UPDATE_FAILED","METADATA_UPDATE_SUCCEEDED","ISOLATED_EDIT_MODE_REQUESTED","ISOLATED_EDIT_MODE_REQUEST_SUCCEEDED","ISOLATED_EDIT_MODE_REQUEST_FAILED","setupDefaultProperties","screenTypes","screenTypeId","getValuesFrom","getValuesForDefaultProperties","screenTypeFieldsAndParams","defaultProperties","uniqBy","defaultPropertyValues","createLandingPage","pageInformation","httpAction","applicability","copyFrom","applicablePage","pageEndpoint","sysparm_transaction_scope","createScreen","appConfigId","screenType","screenCondition","pageCreateStarted","isSavingPage","pageCreateSucceeded","pages","pageStatePristine","isLoadingPage","isPageReadOnly","isPageCopiable","clientScriptsPristine","pageCreateFailed","pageCreateHttpEffect","queryParams","ENDPOINT_TYPE_MAP","dashboard","METADATA_ENDPOINT_TYPE_MAP","pageEndpointFromType","metadata","pageDeletedHttpHandler","pageToDelete","page","pagesEndpoint","interceptors","deleteSysId","isDeletingPage","updatedProperties","pageMetadata","isPageStateDirty","createDataBrokerInstancesFromContextState","ancestorData","parentData","grandParentDataBrokerInstances","reduceProperties","testValues","reducedProperties","propTestValue","reduceElements","macroponentType","createAncestorElementsRuntimeElements","createRuntimeElement","processContextState","contextState","computeContextDataBrokerInstances","transformedAncestorDataBrokerInstances","transformedParentDataBrokerInstances","parentProperties","ancestorProperties","componentBuilderProps","getItem","parentPageProperties","computeContextPageProperties","transformedAppChromeSettings","reduceAppChromeSettings","parentElements","computeContextElements","dataBrokerTags","ancestorElementElements","parentHandledEvents","ancestorHandledEvents","ancestorDataBrokerTags","theme","parentInfo","convertToShorthand","propVal","pageRequestedHttp","isolatedEditModeRequested","noDomain","isCreatingPage","propsToUpdate","dataBrokerElements","createSimpleLayout","generatedSlotNames","createSlotsForEveryElement","slottedElements","newLayoutRoot","injectedCuid","claimedSlotNames","checkNode","childrenType","elementsInSlot","slottedElement","elementInSlot","divider","fixedLayout","convertedSlotNames","rootChildren","addIdsToLayout","addIdsToLayoutElement","elementsWithOrphanedElements","hasNoLayout","hasNoNamedSlots","pageRequestSucceeded","pageComponents","clientScriptsToUpdate","mcpEventHandlers","allEventHandlers","elementsInLayout","convertAncestorEventMappingsToRelays","updatedPageState","invalidTarget","rootElementId","internalEventMapping","eventMappingTargetToUpdate","relayTarget","pageStateType","transformToNodeProperties","isLegacyPageState","transformEventMappings","newEventMappings","targetValuesMap","targetValues","targetIsScripted","noTargetValuesExist","targetUxValues","transformedEventMappingTarget","getOverrides","hasLayout","createCompositionNodeFromElement","nodeProperties","transformedEventMappings","createMacroponentFromElement","omit","newInstance","removeViewportsTransientPropertiesFromComposition","elComposition","propsUxValueModel","tabs","shortHandVal","getTabsFromComposition","removeViewportsTransientProperties","topLevelComposition","createMacroponentInstanceFromElement","transformedScreenEventMappings","transformInternalEventMappings","transformedMappings","transformPageStateToMacroponent","MCP_CONTRACT_EVENT_CREATED","MCP_CONTRACT_EVENT_CREATE_SUCCEEDED","MCP_CONTRACT_EVENT_CREATE_FAILED","MCP_CONTRACT_EVENT_FETCH_REQUESTED","MCP_CONTRACT_EVENT_UPDATED","MCP_CONTRACT_EVENT_UPDATE_SUCCEEDED","MCP_CONTRACT_EVENT_UPDATE_FAILED","MCP_CONTRACT_EVENT_DELETED","MCP_CONTRACT_EVENT_DELETE_REQUESTED","dispatchMcpContractAction","savePayload","saveMeta","variantScope","payloadToSend","event_name","screenEventMappingHandler","createDispatchedEvents","dispatchedEventsToCreate","targetParentEventHandler","getReducedInvalidHandlerList","dispatchedEventsToUpdate","parentEventHandlerPayloadDef","existingDispatchedEventPayloadDef","dispatchedEventAndParentHandlerPayloadsCongruent","getReducedIncongruentHandlerList","pageSaveHandler","pageStateModel","forceActivate","forceDeactivate","CLIENT_SCRIPTS_SCRIPT_CREATED","CLIENT_SCRIPTS_SCRIPT_DELETED","CLIENT_SCRIPTS_SCRIPT_CHANGED","CLIENT_SCRIPTS_CREATE_REQUESTED","CLIENT_SCRIPTS_CREATE_SUCCEEDED","CLIENT_SCRIPTS_DELETE_REQUESTED","CLIENT_SCRIPTS_DELETE_SUCCEEDED","CLIENT_SCRIPTS_UPDATE_REQUESTED","CLIENT_SCRIPTS_UPDATE_HTTP_REQUESTED","CLIENT_SCRIPTS_UPDATE_SUCCEEDED","CLIENT_SCRIPTS_CREATE_STARTED","CLIENT_SCRIPTS_DELETE_STARTED","pageUpdateRequested","isChangingPage","currentPages","deleteTemplateCache","getMetadataUpdatePayload","updatePayload","transformMetadataToPageState","clonePageState","merge","metadataUpdateHttpEffect","pageToUpdate","options","pageSysId","updatedPageSysId","pageCopyRequested","copiedMacroponent","pageCopyHttpEffect","pageHandlers","pageCreatedHandlers","pageDeletedHandlers","pageRequestedHandlers","pageRequestSucceededHandlers","pageSavedHandlers","pageUpdatedHandler","pageMetadataHandlers","pageCopiedHandlers","CONFIGURATION_COMPONENT_BY_INTERFACE_REQUESTED","CONFIGURATION_COMPONENT_BY_INTERFACE_SUCCEEDED","CONFIGURATION_COMPONENT_BY_INTERFACE_FAILED","pageListHttpRequested","sysparm_query_no_domain","isDomainExpanded","pageResource","sysparm_macroponent_id","sysparm_page_registry_id","pageRegistrySysId","sysparm_app_config_id","appendToRequestPayload","isLoadingPages","queuedPageRequestId","newPages","pagePayload","workspaceMasterConfigSysId","screenConditions","pageDefinitionScopeId","SCREEN_PROPERTIES_UPDATE_REQUESTED","SCREEN_PROPERTIES_UPDATE_STARTED","SCREEN_PROPERTIES_UPDATE_FAILED","SCREEN_PROPERTIES_UPDATE_SUCCEEDED","updatePageState","screenPropertiesUpdateRequested","screenPropertiesHandlers","updatedScreen","changePageDefinition","PAGE_PROPERTIES_CHANGED","PAGE_PROPERTIES_CREATED","PAGE_PROPERTIES_DELETED","resolveValue","pagePropertyId","propertyToUpdate","pageProp","propertyToUpdateTypeMetadata","newMacroProp","PAGE_LAYOUT_CHANGED","normalizedParsedLayout","TEMPLATES_REQUESTED","TEMPLATES_REQUEST_STARTED","TEMPLATES_REQUEST_FAILED","TEMPLATES_REQUEST_SUCCEEDED","DEFAULT_LANDING_PAGE_LAYOUT","FALLBACK_DEFAULT_CONTAINER_LAYOUT","fallbackTemplateLookup","DEFAULT_PAGE_TEMPLATE_ID","DEFAULT_CONTAINER_TEMPLATE_ID","memoizeGetDefaultLayout","layoutsCache","defaultTemplateId","defaultTemplate","templatesRequested","templates","templateTypes","image","customized","memoizedGetDefaultLayout","PAGE_TEMPLATE_SELECTED","PAGE_TEMPLATE_CREATE_REQUESTED","PAGE_TEMPLATE_CREATE_HTTP_REQUESTED","PAGE_TEMPLATE_CREATE_STARTED","PAGE_TEMPLATE_CREATE_FAILED","PAGE_TEMPLATE_CREATE_SUCCEEDED","templatePageState","pageTemplateId","selectedPageTemplateAsPageState","reparentedElement","pageTemplateCreateHttpEffect","isSavingTemplate","pageTemplatesHandlers","select","LAYOUT_TEMPLATE_CREATE_REQUESTED","LAYOUT_TEMPLATE_CREATE_HTTP_REQUESTED","LAYOUT_TEMPLATE_CREATE_STARTED","LAYOUT_TEMPLATE_CREATE_FAILED","LAYOUT_TEMPLATE_CREATE_SUCCEEDED","layoutTemplateCreateHttpEffect","stripEndQuotes","charAt","createRequiredTranslations","tokens","tokenize","token","currValue","currIndex","sourceArray","matchExpr","clientScriptsCreateRequested","clientScriptsDeleteRequested","clientScriptsUpdateHttpEffect","clientScriptsUpdateRequested","hasError","requiredTranslations","code","returnValue","_get","defaultScriptNameCount","count","matches","newClientScript","screenId","filteredScripts","filteredEventHandlers","scriptId","isClientScriptsBusy","newClientScripts","newEventHandler","newClientStateParameter","fieldToUpdate","newClientStateParams","paramToUpdate","generatePayloadProperty","payloadField","macroponentContractEventCreated","macroponentContractEventUpdated","inputAction","existingLabel","url","effects","macroponentContractEventDeleteRequested","macroponentContractEventFetchRequested","rawResult","sys_id","newEvent","sourceEventId","targetHandler","createScreenEventMapping","messageMatcher","targetEventLabel","sysparm_query","clonedEvents","clonedEventHandlers","screenEventMappingToUpdate","failureMessage","filteredHandlers","filteredEvents","actionTypes","COMPONENT_DOM_READY","snUXFActions","AMB_SUBSCRIPTION_REQUESTED","subscribe","AMB_UNSUBSCRIBE_REQUESTED","ambSubscriptionRequestedHandler","targetTable","targetFilter","encodeFilterForAmb","messageReceivedActionType","subscribeSucceededActionType","subscribeFailedActionType","unsubscribeSucceededActionType","ambEffect","createAmbSubscriptionEffect","updatedTables","NEW_CREATE_PAGE","NEW_PAGE_SAVED","NEW_PAGE_SAVE_REQUEST","NEW_PAGE_SAVE_STARTED","NEW_PAGE_SAVE_SUCCEEDED","NEW_PAGE_SAVE_FAILED","NEW_PAGE_CREATE_REQUEST","NEW_PAGE_CREATE_STARTED","NEW_PAGE_CREATE_SUCCEEDED","NEW_PAGE_CREATE_FAILED","NEW_PAGE_DELETE_REQUEST","NEW_PAGE_DELETE_REQUEST_HTTP","NEW_PAGE_DELETE_STARTED","NEW_PAGE_DELETE_SUCCEEDED","NEW_PAGE_DELETE_FAILED","NEW_PAGE_VARIANT_CREATE_REQUEST","NEW_PAGE_VARIANT_CREATE_REQUEST_HTTP","NEW_PAGE_VARIANT_CREATE_STARTED","NEW_PAGE_VARIANT_CREATE_SUCCEEDED","NEW_PAGE_VARIANT_CREATE_FAILED","NEW_PAGE_VARIANT_CREATE_OVERRIDE_REQUEST","NEW_PAGE_VARIANT_CREATE_OVERRIDE_STARTED","NEW_PAGE_VARIANT_CREATE_OVERRIDE_SUCCEEDED","NEW_PAGE_VARIANT_CREATE_OVERRIDE_FAILED","NEW_PAGE_VARIANT_DELETE_REQUEST","NEW_PAGE_VARIANT_DELETE_REQUEST_HTTP","NEW_PAGE_VARIANT_DELETE_STARTED","NEW_PAGE_VARIANT_DELETE_SUCCEEDED","NEW_PAGE_VARIANT_DELETE_FAILED","addNewPageReceived","received","pathParamsFromPayload","appId","appsSysId","oldPageState","newPageDeleteRequestEffect","generateUpdatedMacroponentProperties","updatedMcpDefinitions","rootMcpId","rootMcpHydratedPropertyValues","rootMcpHydratedPropertyTestValues","rootMcpDef","newProp","createMcpProperty","pageName","parameters","currentlyLoadedScreen","newPageVariantCreateHttpEffect","newVariantDeletedHttpHandler","generateOverrideCreateHttpEffect","newPageVariantCreateOverrideHttpEffect","replacePageWithOverrideReceived","configurationComponentByInterfaceRequested","configComponentsToLoad","interfaceConfigurationComponent","configComponents","isCustomModalComponent","isViewportModalComponent","allowedModalSizes","selectedModalId","modal","modalComponent","elementInstanceName","modalCreatedHandler","deleteModalHandler","bindingTypes","contextTypes","dataBrokerInput","elementProperty","pageProperty","clientStateInitialValue","validBindingTypesForContextType","bindingTypesInContextType","sameContext","contextId","samePropertyId","samePropertyTestByContextType","isBindableDataBroker","createDataBrokerBindings","middlewareProperties","isParent","_flatMap","bindingType","resolvedBinding","_isEmpty","collectAllBindings","pageBindings","previewValue","createPageBindings","parentPageBindings","createParentPageBindings","elementBindings","createElementBindings","dataBrokerBindings","parentDataBrokerBindings","clientStateBindings","createStateBindings","sessionBindings","createSessionBindings","appChromeBindings","createAppBindings","filterBindings","contextBindingInfo","contextType","currentContextType","inValidBindingTypes","sameProperty","defaultBindingFilter","SN_UXF_CONTEXT_BINDINGS_REQUESTED","bindingsHandlers","allContextBindings","bindingsActions","dynamicTabData","ignoreCache","routeToRender","screenToRender","resolvedRepeatedTabs","activeViewportRoutes","activeViewportScreens","newViewportProperties","isViewportPropertySet","currentlyRendered","renderedScreenDefaultFields","newActiveRoute","newActiveScreen","dataDrivenTabInfo","newRouteAndScreen","routeId","dataDrivenViewportParentId","macroponents","calculateNewActiveRouteAndScreen","newDefaultRoute","isolationMode","newParentInfo","resolvedPropertiesBindings","viewportRenderHandlers","dataDrivenViewportHandler","updateViewportRouteHandlers","DASHBOARDS_CREATE_REQUEST","DASHBOARDS_CREATE_REQUEST_SUCCEEDED","DASHBOARDS_CREATE_REQUEST_FAILED","DASHBOARDS_CREATE_REQUEST_STARTED","DASHBOARDS_EDIT_REQUEST","DASHBOARDS_EDIT_REQUEST_SUCCEEDED","DASHBOARDS_EDIT_REQUEST_FAILED","DASHBOARDS_EDIT_REQUEST_STARTED","DASHBOARDS_DELETE_REQUEST","DASHBOARDS_DELETE_REQUEST_HTTP","DASHBOARDS_DELETE_REQUEST_SUCCEEDED","DASHBOARDS_DELETE_REQUEST_FAILED","DASHBOARDS_DELETE_REQUEST_STARTED","DASHBOARDS_SCREENS_LOADED","DASHBOARDS_CREATE_TAB_REQUEST","DASHBOARDS_CREATE_TAB_SUCCEEDED","DASHBOARDS_CREATE_TAB_FAILED","DASHBOARDS_CREATE_TAB_STARTED","DASHBOARDS_CREATE_OVERRIDE_REQUEST","DASHBOARDS_CREATE_OVERRIDE_REQUEST_SUCCEEDED","DASHBOARDS_CREATE_OVERRIDE_REQUEST_FAILED","DASHBOARDS_CREATE_OVERRIDE_REQUEST_STARTED","DASHBOARDS_CREATE_OVERRIDE_HTTP_REQUESTED","dashboardsCreateEffect","dashboardsCreateSucceeded","dashboardsCreateOverrideHttpRequested","dashboardsEditEffect","dashboardsDeleteEffect","dashboardId","deletedDashboardId","screens","isPagesLoading","pagesLoaded","dashboardsHandlers","dashboardsCreateHandlers","dashboardsEditHandlers","dashboardsDeleteHandlers","dashboardsScreensHandlers","SET_DOMAIN_EXPANDED","dataBrokerEventMappings","elementEvents","elementLayouts","elementStyles","pageTree","pageLayout","isDefaultPageLayout","eventHandlerElementMap","clientScriptApiCompletions","routeState","computed","dataBrokerData","clientSideDataBrokers","ancestorClientStateDataBrokers","dbinstance","serverSideDataBrokers","errorObj","DataBrokerElementName","targetData","targetDataBrokerInstance","serverSideDataBroker","outputs","outputKey","dateBrokerProps","dataBrokerRuntimeErrors","targetDataPreview","targetExecutionTime","component-id","clientSideDataBroker","TagName","ancestorClientStateDataBroker","AncestorElementTagName","initialState","configProperties","actionHandlers","COMPONENT_PROPERTY_CHANGED","previousValue","selectablePropsToUpdate","reexecuteDataBrokerRuntime","oldDataBrokerInstances","oldDataBrokerProperties","processedDataBrokerProperties","previousDataBrokerEventMappings","dataBrokerEventMappingHandlers","previousDataBrokerEventMappingHandlers","previousInternalEventMappings","internalEventMappingHandlers","previousInternalEventMappingHandlers","previousElementArr","previousElementProperties","currentHiddenElements","processedElementProperties","previousElementStyles","previousElementLayouts","previousElementEvents","previousElementEventMappings","previousEventMappingHandlers","elementToEventMappingHandlerMap","previousElementToEventMappingHandlerMap","previousDispatchedEvents","previousHandledEvents","previousScreenEventMappings","screenEventMappingHandlers","previousScreenEventMappingHandlers","previousPageTree","previousElementTree","previousPageMetadata","previousPageProperties","previousPageLayout","isDefaultLayout","previousBindings","clientStateParamsToUse","handlerValue","propNameProperty","matchingClientStateParam","updateDeclarativeClientStateUpdateEventHandlers","clientTransformScriptApiCompletions","pageStateWoViewportTabs","pageStatePristineWoViewportTabs","domReadyHandlers","componentListHandlers","dataBrokerDefinitionsHandlers","dataBrokerInstancesHandlers","dataBrokerRuntimeHandlers","elementEventMappingsHandlers","pageListHandlers","pagePropertiesHandlers","pageLayoutHandlers","templatesHandlers","layoutTemplatesHandlers","configurationComponentByInterfaceHandlers","componentSourcesHandlers","newPageCreateHandlers","newPageSaveHandlers","newPageDeleteHandlers","newPageVariantCreateHandlers","newPageVariantDeleteHandlers","newPageVariantOverrideHandlers","clientScriptsHandlers","modalhandlers","clientStateHandlers","clientStateRuntimeHandlers","dispatchedEventsHandlers","ambSubscribersHandlers","updatedTablesHandlers","viewportHandlers","domainScopeHandlers","COMPONENT_RENDER_REQUESTED","previousRenderState","clientScriptsActions","clientStateActions","componentListActions","dataBrokerDefinitionsActions","dataBrokerInstancesActions","dataBrokerRuntimeActions","elementActions","elementEventMappingsActions","layoutTemplatesActions","newPageActions","pageActions","pageLayoutActions","pageListActions","pagePropertiesActions","templatesActions","pageTemplatesActions","screenPropertiesActions","dispatchedEventsActions","ambSubscribersActions","updatedTablesActions","dashboardsActions","configurationComponentByInterfaceActions","domainScopeActions","PAGE_STATE_CLEARED","PAGE_STATE_RESET","SHOW_FAILURE_ALERT","search","stack","selectedElementId","closeModal","eventOrAction","stopPropagation","resolveBindingValue","stringVal","class","className","headerLabel","on-click","bare","renderModalHeader","isIframeModal","iframeSrc","title","frameBorder","scrolling","src","height","renderModalContent","isConfirmDestroyModal","primaryButtonLabel","secondaryButtonLabel","renderModalFooter","renderers","stageDimensions","selectedSlotParent","themeAsJson","top","selectedElement","findSelectedElement","resetThemeWithOverrides","resetTheme","modalStyle","hook-insert","vnode","installTheme","style","opened","overlayPositionAbsolute","disableDismiss","headerText","bodyText","renderBareModalContent","preventDefault","emptySlot","selectedSlotParentComponent","hostAllowList","stripSlotStyles","layouRole","defaultModel","pick","HostCss","cssObj","filteredObj","css","defaultElementRenderer","partialRendererFn","rendererFn","layoutArgs","nextFrame","requestAnimationFrame","doesSlotSeeMount","assignedSlot","assignedNodes","reattachSlotName","transformChildren","existingChildren","hook","insert","update","renderChildren","elementHasNoDefaultSlot","mountableChildren","formattedModel","layoutRendererParams","unslottedChildren","slotWrapper","slotParent","emptyRegion","parentElementId","rootNodeStyles","minHeight","minWidth","hostCss","dataProviderPropValues","MountedComponent","propertyTypeMap","mapValues","camelCase","processParentMcpBindingsForViewports","dbPath","routeConfiguration","renderViewportContents","styleSheets","adoptedStyleSheets","styleSheet","cssRules","rule","rxp","cssText","ruleText","rgx","exec","cssStringToObject","href","Boolean","getHostCSS","isContainerNode","hook-update","componentIcon","allowIsolatedEditing"],"mappings":"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","file":"sn-uxf-builder-middleware/sn-uxf-builder-middleware.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 59);\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","module.exports = __TECTONIC__lodash_4_17_4[\"get\"];","module.exports = __TECTONIC__lodash_4_17_4[\"cloneDeep\"];","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","module.exports = __TECTONIC__$servicenow_ui_renderer_snabbdom;","module.exports = __TECTONIC__$servicenow_ui_effect_http;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","module.exports = __TECTONIC__lodash_4_17_4[\"isEmpty\"];","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","module.exports = require(\"regenerator-runtime\");\n","module.exports = __TECTONIC__lodash_4_17_4[\"isEqual\"];","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","var _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","module.exports = __TECTONIC__cuid_2_1_6;","module.exports = __TECTONIC__$servicenow_ui_core;","module.exports = __TECTONIC__$devsnc_library_uxf_19_50_6;","module.exports = __TECTONIC__lodash_4_17_4[\"set\"];","module.exports = __TECTONIC__sn_translate;","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;","module.exports = __TECTONIC__lodash_4_17_4[\"isNil\"];","module.exports = __TECTONIC__lodash_4_17_4[\"reject\"];","module.exports = __TECTONIC__lodash_4_17_4[\"find\"];","module.exports = __TECTONIC__lodash_4_17_4[\"flatMap\"];","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","module.exports = __TECTONIC__lodash_4_17_4[\"isUndefined\"];","module.exports = __TECTONIC__lodash_4_17_4[\"map\"];","module.exports = __TECTONIC__lodash_4_17_4[\"reduce\"];","module.exports = __TECTONIC__lodash_4_17_4[\"isNull\"];","function _extends() {\n  module.exports = _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nmodule.exports = _extends;","module.exports = __TECTONIC__lodash_4_17_4[\"isArray\"];","var objectWithoutPropertiesLoose = require(\"./objectWithoutPropertiesLoose\");\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutProperties;","module.exports = __TECTONIC__lodash_4_17_4[\"omit\"];","module.exports = __TECTONIC__lodash_4_17_4[\"pick\"];","module.exports = __TECTONIC__lodash_4_17_4[\"groupBy\"];","\n        var result = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/src/index.js??ref--5-2!../../node_modules/resolve-url-loader/index.js??ref--5-3!../../node_modules/sass-loader/dist/cjs.js??ref--5-4!./sn-uxf-renderer.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","module.exports = __TECTONIC__lodash_4_17_4[\"mapValues\"];","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","module.exports = __TECTONIC__$servicenow_now_uxf_page;","module.exports = __TECTONIC__lodash_4_17_4[\"uniq\"];","module.exports = __TECTONIC__lodash_4_17_4[\"trim\"];","module.exports = __TECTONIC__lodash_4_17_4[\"isString\"];","module.exports = __TECTONIC__lodash_4_17_4[\"isNaN\"];","module.exports = __TECTONIC__lodash_4_17_4[\"has\"];","module.exports = __TECTONIC__lodash_4_17_4[\"flatten\"];","module.exports = __TECTONIC__lodash_4_17_4[\"flow\"];","module.exports = __TECTONIC__lodash_4_17_4[\"zip\"];","module.exports = __TECTONIC__lodash_4_17_4[\"last\"];","module.exports = __TECTONIC__lodash_4_17_4[\"unionBy\"];","module.exports = __TECTONIC__lodash_4_17_4[\"uniqBy\"];","module.exports = __TECTONIC__lodash_4_17_4[\"merge\"];","module.exports = __TECTONIC__esprima_4_0_1;","module.exports = __TECTONIC__$servicenow_ui_effect_amb;","module.exports = __TECTONIC__lodash_4_17_4[\"assign\"];","module.exports = __TECTONIC__lodash_4_17_4[\"camelCase\"];","module.exports = __TECTONIC__lodash_4_17_4[\"forEach\"];","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","module.exports = __TECTONIC__regenerator_runtime_0_13_5;","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;","module.exports = __TECTONIC__$servicenow_now_modal;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".stage-renderer{position:relative;height:auto;margin-left:auto;margin-right:auto;float:none;overflow:hidden}.stage-renderer.-modal{height:100%}.stage-renderer .stage-modal-overlay{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;z-index:3970;overflow-y:auto;background-color:RGBA(var(--now-color--neutral-21,0,0,0),.5)}.modal-content-container{display:flex;flex-direction:column;justify-content:center;justify-items:center;align-items:center}.stage-modal-container{position:relative;z-index:3980;font-family:var(--mv9-Tvprj--Pvmz-PrTAjO,var(--now-font-family));background-color:RGB(var(--mv9-Tvprj--krJUfZvWmp-JvjvZ,var(--now-color_background--primary,var(--now-color--neutral-0,255,255,255))));border:var(--mv9-Tvprj--kvZptZ-9Apz8,1px) solid rgb(var(--mv9-tvprj--kvzptz-jvjvz,var(--now-color--neutral-4,191,197,198)));border-radius:var(--mv9-Tvprj--kvZptZ-ZrpAW1,.25rem);box-shadow:0 4px .5rem 0 RGBA(var(--now-color--neutral-21,0,0,0),.25);padding:1.5rem}.stage-modal-container .modal-content{pointer-events:none}.stage-modal-container.custom-modal .modal-content{pointer-events:all;overflow-y:auto}.stage-modal-container.sm{width:26.25rem;max-height:19.6875rem}.stage-modal-container.sm .modal-content{max-height:12.8125rem}.stage-modal-container.md{width:37.5rem;max-height:28.125rem}.stage-modal-container.md .modal-content{max-height:21.25rem}.stage-modal-container.lg{width:50rem;max-height:37.5rem}.stage-modal-container.lg .modal-content{max-height:30.625rem}.stage-modal-container.fullscreen{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column}.stage-modal-container .now-modal-header{display:flex;justify-content:space-between;align-items:center;padding-bottom:1.5rem;flex:0 0 auto}.stage-modal-container .now-modal-header .now-modal-heading{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;width:100%;min-width:0;margin-top:0;margin-bottom:0;font-weight:600;font-size:1.25rem}.stage-modal-container .now-modal-body{overflow:auto;flex:1 1 auto;font-size:1rem;min-height:1.25rem}.stage-modal-container .now-modal-footer{display:flex;overflow-x:auto;overflow-y:hidden;flex-direction:row-reverse;padding-top:2.5rem;flex:0 0 auto}.stage-modal-container .now-modal-footer .footer-button-1{margin-left:.5rem}.stage-modal-container .now-modal-footer.confirm-destroy{flex-direction:row-reverse}.stage-modal-container .now-modal-footer.confirm-destroy .footer-button-1{margin:auto .5rem}#sn-uxf-renderer-theme-overrides{background-color:RGB(var(--now-color--background-primary));color:RGB(var(--now-color--text-primary));width:100%}:host{position:absolute;height:100%;width:100%}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","module.exports = __TECTONIC__$servicenow_now_empty_state;","module.exports = __TECTONIC__$devsnc_sn_layout;","export const CONTEXT_NAMESPACE = '@context';\nexport const ELEMENT_NAMESPACE = '@elements';\nexport const DATA_NAMESPACE = '@data';\nexport const PAYLOAD_NAMESPACE = '@payload';\nexport const STATE_NAMESPACE = '@state';\nexport const DATA_BROKER_INPUT_PROPERTIES_NAME = 'inputParams';\nexport const DATA_BROKER_OUTPUT_PROPERTIES_NAME = 'outputSchema';\nexport const DATA_OUTPUT_BINDING = 'DATA_OUTPUT_BINDING';\nexport const JSON_LITERAL = 'JSON_LITERAL';\nexport const MACROPONENT_CATEGORY = 'page';\nexport const SCREEN_TEMPLATE_SYS_ID = '19be392623033300f4b4c50947bf65ba';\nexport const UIB_TEMPLATES_SCOPE_ID = 'c30ef69f8ce5130886bd25a4b8f19b93';\nexport const UPDATE_CLIENT_STATE_HANDLER_ID =\n\t'32408b42ff7a10109046e490703bf176';\nexport const DEFER = 'defer';\nexport const CLIENT_TRANSFORM_SCRIPT_TEMPLATES = {\n\tELEMENT: `/**\n  * @param {params} params\n  * @param {api} params.api\n  * @param {any} params.imports\n  */\nfunction evaluateProperty({api}) {\n\treturn '';\n}`,\n\tEVENT: `/**\n* @param {params} params\n* @param {api} params.api\n* @param {any} params.event\n* @param {any} params.imports\n*/\nfunction evaluateEvent({api, event}) {\n\treturn {};\n}`\n};\nexport const ELEMENT_TYPES = {\n\tMODAL: 'modal'\n};\nexport const SN_UIB_APP_UPDATE_APP_ROUTE_STATE =\n\t'SN_UIB_APP#UPDATE_APP_ROUTE_STATE';\n\nexport default {\n\tCONTEXT_NAMESPACE,\n\tELEMENT_NAMESPACE,\n\tDATA_NAMESPACE,\n\tPAYLOAD_NAMESPACE,\n\tSTATE_NAMESPACE,\n\tCLIENT_TRANSFORM_SCRIPT_TEMPLATES,\n\tELEMENT_TYPES\n};\n","import {\n\tCONTEXT_NAMESPACE,\n\tELEMENT_NAMESPACE,\n\tDATA_NAMESPACE,\n\tPAYLOAD_NAMESPACE,\n\tSTATE_NAMESPACE\n} from '../constants';\n\nexport const JSON_LITERAL = 'JSON_LITERAL';\nexport const MAP_CONTAINER = 'MAP_CONTAINER';\nexport const LIST_CONTAINER = 'LIST_CONTAINER';\nexport const CLIENT_TRANSFORM_SCRIPT = 'CLIENT_TRANSFORM_SCRIPT';\nexport const TRANSLATION_LITERAL = 'TRANSLATION_LITERAL';\n\nexport const VALID_BINDING_TYPES_ENUM = {\n\tELEMENT_BINDING: ELEMENT_NAMESPACE,\n\tCONTEXT_BINDING: CONTEXT_NAMESPACE,\n\tDATA_OUTPUT_BINDING: DATA_NAMESPACE,\n\tEVENT_PAYLOAD_BINDING: PAYLOAD_NAMESPACE,\n\tSTATE_BINDING: STATE_NAMESPACE\n};\nexport const BINDING_SHORTHAND_PATTERN = new RegExp(\n\t`^(${Object.values(VALID_BINDING_TYPES_ENUM).join('|')})((\\\\.[a-zA-z0-9]+)+)$`\n);\n\nexport const SCRIPT_SHORTHAND_PATTERN = new RegExp(\n\t`^javascript\\\\(([\\\\n\\\\S\\\\d\\\\W\\\\w]*)\\\\)(\\\\!)?$`\n);\n\nexport const TRANSLATE_SHORTHAND_PATTERN = new RegExp(\n\t`^translate\\\\(([\\\\n\\\\S\\\\d\\\\W\\\\w]*)\\\\)$`\n);\n","export default class Model {\n\tset(prop, value) {\n\t\tthis[prop] = value;\n\t\treturn this[prop];\n\t}\n\n\tget(prop) {\n\t\treturn this[prop];\n\t}\n}\n","import Model from './model';\n\nexport default class Property extends Model {\n\tconstructor({\n\t\tname = '', // string\n\t\tcolumnName = '', // string\n\t\tlabel = '', // string\n\t\ttype = '', // string\n\t\treference = null, // object\n\t\treferenceFilter = '', // string\n\t\tvalue = null, // any\n\t\tisStatic = true, // bool,\n\t\tchoices = [],\n\t\ttable = '',\n\t\treadOnly = false,\n\t\torder = 0, // integer\n\t\tinterfaceApiName = null,\n\t\temptyStateBehavior = undefined,\n\t\tselectable = false,\n\t\tdescription = '', // string,\n\t\terror = null,\n\t\tdefaultValue = null,\n\t\tvariant = null,\n\t\ttranslatable = false,\n\t\tschema = null\n\t}) {\n\t\tsuper();\n\t\tthis.name = name;\n\t\tthis.columnName = columnName;\n\t\tthis.label = label;\n\t\tthis.type = type;\n\t\tthis.value = value;\n\t\tthis.isStatic = isStatic;\n\t\tthis.choices = choices;\n\t\tthis.readOnly = readOnly;\n\t\tthis.order = order;\n\t\tthis.table = table;\n\t\tif (reference) {\n\t\t\tthis.reference = reference;\n\t\t\tthis.referenceFilter = referenceFilter;\n\t\t}\n\t\tthis.interfaceApiName = interfaceApiName;\n\t\tthis.emptyStateBehavior = emptyStateBehavior;\n\t\tthis.selectable = selectable;\n\t\tthis.description = description;\n\t\tthis.error = error;\n\t\tthis.defaultValue = defaultValue;\n\t\tthis.variant = variant;\n\t\tthis.translatable = translatable;\n\t\tthis.schema = schema;\n\t\t/**\n\t\t * isStatic,\n\t\t * isSelectable,\n\t\t * if dynamic...\n\t\t *    id of element i am selecting\n\t\t *    property that i am selecting\n\t\t */\n\t}\n}\n","import Model from './model';\n\nexport default class Slot extends Model {\n\tconstructor({\n\t\tname = '', // String\n\t\tparentElement = null\n\t}) {\n\t\tsuper();\n\t\tthis.name = name;\n\t\tthis.parentElement = parentElement;\n\t}\n}\n","import Model from '../model';\n\nexport default class Layout extends Model {\n\tconstructor({ default: defaultLayout }) {\n\t\tsuper();\n\t\tthis.default = defaultLayout;\n\t}\n}\n","import Model from './model';\n\nexport default class Component extends Model {\n\tconstructor({\n\t\tid = '',\n\t\tname = '', // string,\n\t\tdescription = '', // string\n\t\ticon = '', // string\n\t\ttag = '', // string\n\t\tslots = [], // Array<Slot>\n\t\tproperties = [], // Array<Property>\n\t\tdispatchedEvents = [], // Array<Event>\n\t\tactions = [], //Array<Action>\n\t\tconfiguration = null, //Object || null\n\t\ttype = 'MACROPONENT', // string\n\t\texternalConfigurationSources = [],\n\t\tcategory,\n\t\texplodable = false,\n\t\tisEditable = false\n\t}) {\n\t\tsuper();\n\t\tthis.id = id;\n\t\tthis.name = name;\n\t\tthis.description = description;\n\t\tthis.icon = icon;\n\t\tthis.tag = tag;\n\t\tthis.slots = slots;\n\t\tthis.properties = properties; // If this is a charter, which ones are selectable?\n\t\tthis.dispatchedEvents = dispatchedEvents;\n\t\tthis.actions = actions;\n\t\tthis.configuration = configuration;\n\t\tthis.type =\n\t\t\tcategory === 'viewport' || tag === 'now-uxf-modal-viewport'\n\t\t\t\t? 'MACROPONENT_VIEWPORT'\n\t\t\t\t: type;\n\t\tthis.externalConfigurationSources = externalConfigurationSources;\n\t\tthis.category = category;\n\t\tthis.explodable = explodable;\n\t\tthis.isEditable = isEditable;\n\t}\n}\n","import Model from './model';\n\nexport default class EventMapping extends Model {\n\tconstructor({\n\t\teventMappingId = '', // string\n\t\teventId = '', // string\n\t\teventApiName = '', // string\n\t\ttargets = [] // array\n\t}) {\n\t\tsuper();\n\t\tthis.eventMappingId = eventMappingId;\n\t\tthis.eventId = eventId;\n\t\tthis.eventApiName = eventApiName;\n\t\tthis.targets = targets;\n\t}\n}\n","export default (idString) => {\n\treturn idString.replace(/\\s/g, '_').replace(/[^\\w]/g, '').toLowerCase();\n};\n","import get from 'lodash/get';\nimport set from 'lodash/set';\nimport map from 'lodash/map';\nimport uniq from 'lodash/uniq';\nimport trim from 'lodash/trim';\nimport isString from 'lodash/isString';\nimport isArray from 'lodash/isArray';\nimport { TRANSLATE_SHORTHAND_PATTERN } from './constants';\n\nconst extractStringSchema = (oneOf) => {\n\tlet obj = {};\n\tmap(oneOf, (item) => {\n\t\tif (item.type === 'string') {\n\t\t\tobj = item;\n\t\t}\n\t});\n\treturn obj;\n};\n\nexport const isSchemaTranslatable = (schema, value) => {\n\tif (!schema) {\n\t\treturn false;\n\t}\n\tconst { oneOf } = schema;\n\n\tif (oneOf && typeof value === 'string') {\n\t\tconst stringSchema = get(extractStringSchema(oneOf), 'translatable');\n\t\tif (stringSchema) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn JSON.stringify(schema).indexOf(`\"translatable\":true`) > -1;\n};\n\nconst TRANSLATION_PREFIXES = [\n\t/TRF:(.*)/,\n\t/MSG:(.*)/,\n\t/GMLD:(.*)/,\n\t/TRT:(.*)/,\n\t/CHC:(.*)/\n];\n\nexport const removePrefixes = (str) => {\n\tfor (const prefix of TRANSLATION_PREFIXES) {\n\t\tconst match = str.match(prefix);\n\t\tif (match) {\n\t\t\treturn trim(match[1]);\n\t\t}\n\t}\n\treturn str;\n};\n\nexport const extractTranslatablePaths = (schema, arr = [], path = '') => {\n\tconst { type, translatable, properties, oneOf, anyOf, items } = schema;\n\n\tif (type === 'string' && translatable) {\n\t\tpath.length && arr.push(path);\n\t\tpath = '';\n\t}\n\n\tif (type === 'object' && properties) {\n\t\tmap(properties, (val, key) => {\n\t\t\tconst newPath = path.length ? `${path}.${key}` : key;\n\t\t\textractTranslatablePaths(val, arr, newPath);\n\t\t});\n\t}\n\n\tif (type === 'array') {\n\t\tisArray(items)\n\t\t\t? items.map((item) => extractTranslatablePaths(item, arr, path))\n\t\t\t: extractTranslatablePaths(items, arr, path);\n\t}\n\n\tif (isArray(oneOf)) {\n\t\toneOf.map((obj) => extractTranslatablePaths(obj, arr, path));\n\t}\n\n\tif (isArray(anyOf)) {\n\t\tanyOf.map((obj) => extractTranslatablePaths(obj, arr, path));\n\t}\n\n\tpath = '';\n\treturn uniq(arr);\n};\n\nconst translate = (str) => {\n\tif (str.match(TRANSLATE_SHORTHAND_PATTERN)) {\n\t\treturn str;\n\t}\n\treturn `translate(${str})`;\n};\n\nconst translatePropbyPath = (shorthand, path) => {\n\tconst prop = get(shorthand, path);\n\tif (typeof prop === 'string') {\n\t\tset(shorthand, path, translate(prop));\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nexport const translateKeys = (shorthand, translatablePaths) => {\n\tmap(translatablePaths, (path) => {\n\t\tconst translated = translatePropbyPath(shorthand, path);\n\t\tif (!translated && isString(path)) {\n\t\t\tconst splitPath = path.split('.');\n\t\t\tlet temp = '';\n\t\t\tsplitPath.map((prop, index) => {\n\t\t\t\tconst newPath = `${temp}${prop}`;\n\t\t\t\tconst value = get(shorthand, newPath);\n\t\t\t\tif (isArray(value)) {\n\t\t\t\t\tconst newPaths = [];\n\t\t\t\t\tvalue.map((item, i) => {\n\t\t\t\t\t\tconst newSplit = [...splitPath];\n\t\t\t\t\t\tnewSplit[index] = `${newSplit[index]}[${i}]`;\n\t\t\t\t\t\tnewPaths.push(newSplit.join('.'));\n\t\t\t\t\t});\n\t\t\t\t\ttranslateKeys(shorthand, newPaths);\n\t\t\t\t} else {\n\t\t\t\t\ttemp = `${newPath}.`;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n\treturn shorthand;\n};\n","import Model from './model';\nimport Slot from './slot';\nimport Property from './property';\nimport Layout from './layout/layout';\nimport Component from './component';\nimport EventMapping from './eventMapping';\nimport seismicifyIds from './utils/seismicifyIds';\nimport { removePrefixes } from '../factories/util';\n\nexport default class Element extends Model {\n\tconstructor({\n\t\tid = '', // string\n\t\tinstanceName = '', // string\n\t\tslot = null, // Slot\n\t\tlayout = null, // object\n\t\tcomponent = null, // Component,\n\t\tproperties = {}, // object,\n\t\tmacroponentProperties = [],\n\t\tpropertyValues = {},\n\t\tpropertyTestValues = {},\n\t\teventMappings = [], // Array<EventMapping>\n\t\tchildren = [], // Array<Element>\n\t\tlistenTo = [],\n\t\textendsSysId = null, // string\n\t\terror = null,\n\t\tstyles = {},\n\t\tisModal = false,\n\t\tisModalDescendant = false,\n\t\tinternalEventMappings = {},\n\t\tisHidden = '', // string\n\t\tscope = null,\n\t\tscopeName = null,\n\t\tsysPolicy = null\n\t} = {}) {\n\t\tsuper();\n\t\tthis.id = id;\n\t\tthis.instanceName = instanceName || this._getDefaultInstanceName(component);\n\t\tthis.component = this._setNewComponent(component);\n\t\tthis.properties = this._setNewProperties(properties);\n\t\tthis.macroponentProperties = macroponentProperties;\n\t\tthis.propertyValues = propertyValues;\n\t\tthis.propertyTestValues = propertyTestValues;\n\t\tthis.eventMappings = this._setNewEventMappings(eventMappings);\n\t\tthis.children = this._setNewChildren(children);\n\t\tthis.slot = this._setNewSlot(slot);\n\t\tthis.layout = this._setNewLayout(layout);\n\t\tthis.listenTo = listenTo;\n\t\tthis.extendsSysId = extendsSysId;\n\t\tthis.styles = styles;\n\t\tthis.error = error;\n\t\tthis.isModal = isModal;\n\t\tthis.isModalDescendant = isModalDescendant;\n\t\tthis.internalEventMappings = internalEventMappings;\n\t\tthis.isHidden = isHidden;\n\t\tthis.scope = scope;\n\t\tthis.scopeName = scopeName;\n\t\tthis.sysPolicy = sysPolicy;\n\t}\n\n\t_getDefaultInstanceName(component) {\n\t\tif (!component || typeof component !== 'object') {\n\t\t\treturn '';\n\t\t}\n\t\treturn component.name || '';\n\t}\n\n\t_setNewProperties(properties) {\n\t\tif (!properties) {\n\t\t\treturn null;\n\t\t} else if (\n\t\t\tObject.entries(properties).every((entry) => entry[1] instanceof Property)\n\t\t) {\n\t\t\treturn properties;\n\t\t}\n\t\treturn Object.entries(properties).reduce((acc, [name, property]) => {\n\t\t\tacc[name] = new Property(property);\n\t\t\treturn acc;\n\t\t}, {});\n\t}\n\n\t_setNewEventMappings(eventMappings) {\n\t\tif (!Array.isArray(eventMappings)) {\n\t\t\treturn [];\n\t\t} else if (\n\t\t\teventMappings.every((mapping) => mapping instanceof EventMapping)\n\t\t) {\n\t\t\treturn eventMappings;\n\t\t}\n\t\treturn eventMappings.map((mapping) => new EventMapping(mapping));\n\t}\n\n\t_setNewChildren(children) {\n\t\tif (!Array.isArray(children)) {\n\t\t\treturn [];\n\t\t} else if (children.every((child) => child instanceof Element)) {\n\t\t\treturn children;\n\t\t}\n\t\treturn children.map((child) => new Element(child));\n\t}\n\n\t_setNewSlot(slot) {\n\t\tif (slot instanceof Slot) {\n\t\t\treturn slot;\n\t\t} else if (slot !== null) {\n\t\t\treturn new Slot(slot);\n\t\t}\n\t\treturn null;\n\t}\n\n\t_setNewLayout(layout) {\n\t\tif (layout instanceof Layout) {\n\t\t\treturn layout;\n\t\t} else if (layout !== null) {\n\t\t\treturn new Layout(layout);\n\t\t}\n\t\treturn null;\n\t}\n\n\t_setNewComponent(component) {\n\t\tif (component instanceof Component) {\n\t\t\treturn component;\n\t\t} else if (component !== null) {\n\t\t\treturn new Component(component);\n\t\t}\n\t\treturn null;\n\t}\n\n\t_highestMatchingIdIndex(component, allIds) {\n\t\tconst targetName = seismicifyIds(component.name);\n\t\tlet highest = 0;\n\t\tallIds.forEach((id) => {\n\t\t\tconst matcher = id.match(new RegExp(`^${targetName}\\\\_(\\\\d+)*$`));\n\t\t\tif (matcher) {\n\t\t\t\tconst index = Number(matcher[1]);\n\t\t\t\thighest = index > highest ? index : highest;\n\t\t\t}\n\t\t});\n\t\treturn highest;\n\t}\n\n\tinitialize(allIds) {\n\t\tconst highestMatchingInstanceIndex = this._highestMatchingIdIndex(\n\t\t\tthis.component,\n\t\t\tallIds\n\t\t);\n\t\t// Remove translation prefixes from the definition name.\n\t\tconst rootName = removePrefixes(this.component.name || '') || '';\n\t\t// Lower case the ID and remove characters other than alphanumeric, -, and _ to make it seismic-safe\n\t\tconst targetName = seismicifyIds(rootName);\n\t\tif (this.component.category !== 'viewport') {\n\t\t\tthis.id =\n\t\t\t\thighestMatchingInstanceIndex > 0\n\t\t\t\t\t? `${targetName}_${(highestMatchingInstanceIndex + 1).toString()}`\n\t\t\t\t\t: `${targetName}_1`;\n\t\t}\n\t\tthis.instanceName =\n\t\t\thighestMatchingInstanceIndex > 0\n\t\t\t\t? `${rootName} ${(highestMatchingInstanceIndex + 1).toString()}`\n\t\t\t\t: `${rootName} 1`;\n\t}\n}\n","import cuid from 'cuid';\nimport get from 'lodash/get';\n\nconst toProportion = (nums) => {\n\tconst sum = nums.reduce((s, n) => s + n, 0);\n\treturn nums.map((n) => n / sum);\n};\nconst toScale = (n) => [n * 12, (n * 12) % 1];\n\nconst processor = ({ remainder, numbers }, [num, rem]) => {\n\tlet newRemainder = remainder;\n\tconst newNumbers = [];\n\n\tif (num < 1) {\n\t\treturn {\n\t\t\tremainder: newRemainder - (rem - 1),\n\t\t\tnumbers: [...numbers, Math.ceil(num)]\n\t\t};\n\t}\n\n\tif (rem !== 0) {\n\t\tif (newRemainder + rem > 0.98) {\n\t\t\tnewNumbers.push(Math.ceil(num));\n\n\t\t\tnewRemainder -= 1 - rem;\n\t\t} else {\n\t\t\tnewNumbers.push(Math.floor(num));\n\t\t\tnewRemainder += rem;\n\t\t}\n\t\treturn {\n\t\t\tremainder: newRemainder,\n\t\t\tnumbers: [...numbers, ...newNumbers]\n\t\t};\n\t}\n\n\treturn {\n\t\tremainder,\n\t\tnumbers: [...numbers, num]\n\t};\n};\n\nconst updateProportions = (nums) =>\n\ttoProportion(nums)\n\t\t.map(toScale)\n\t\t.reduce(processor, { remainder: 0, numbers: [] }).numbers;\n\nconst updateProportionForNewSize = (size, nums) => {\n\tconst prop = 12 / size / 12;\n\tconst share = prop / nums.length;\n\n\tconst processed = toProportion(nums).map(\n\t\t(n) => n - share * (n / (1 / nums.length))\n\t);\n\treturn [...processed, prop]\n\t\t.map(toScale)\n\t\t.reduce(processor, { remainder: 0, numbers: [] }).numbers;\n};\nconst getUpdatedSizesForNew = (arr, len) => {\n\tconst updates = updateProportionForNewSize(\n\t\tlen,\n\t\tarr.map((col) => parseInt(col.size))\n\t);\n\n\treturn {\n\t\tupdatedSizes: updates\n\t\t\t.slice(0, -1)\n\t\t\t.reduce((acc, num, i) => ({ ...acc, [arr[i].id]: num.toString() }), {}),\n\t\tnewSize: updates.slice(-1)[0].toString()\n\t};\n};\nexport const normalizeSizes = (array) => {\n\tconst newCol = array.find((col) => !col.size);\n\tif (newCol) {\n\t\tconst { updatedSizes, newSize } = getUpdatedSizesForNew(\n\t\t\tarray.filter((col) => col.id !== newCol.id),\n\t\t\tarray.length\n\t\t);\n\t\treturn array.map((col) => {\n\t\t\tif (col.size) {\n\t\t\t\tcol.size = updatedSizes[col.id];\n\t\t\t} else {\n\t\t\t\tcol.size = newSize;\n\t\t\t}\n\t\t\treturn col;\n\t\t});\n\t}\n\treturn updateProportions(array.map((col) => parseInt(col.size))).map(\n\t\t(size, i) => {\n\t\t\tarray[i].size = size.toString();\n\t\t\treturn array[i];\n\t\t}\n\t);\n};\nexport const flattenLayout = (\n\tlayoutPart,\n\tflattenedParts = {},\n\tparent = 'root'\n) => {\n\tfunction flattenChildren(parts, childType) {\n\t\tlet newParts = parts;\n\t\tfor (const i in layoutPart[childType]) {\n\t\t\tconst childLayoutPart = layoutPart[childType][i];\n\t\t\tnewParts = flattenLayout(childLayoutPart, newParts, layoutPart.id);\n\t\t}\n\t\treturn newParts;\n\t}\n\n\tlet childType;\n\tif (layoutPart.rows) {\n\t\tchildType = 'rows';\n\t} else if (layoutPart.columns) {\n\t\tchildType = 'columns';\n\t}\n\tflattenedParts[layoutPart.id] = {\n\t\tparent: parent || 'root',\n\t\ttype: layoutPart.type,\n\t\tid: layoutPart.id\n\t};\n\tif (layoutPart.slotName) {\n\t\tflattenedParts[layoutPart.id].slotName = layoutPart.slotName;\n\t}\n\tif (flattenedParts[layoutPart.id].type === 'column') {\n\t\tflattenedParts[layoutPart.id].size = layoutPart.size;\n\t}\n\tif (!childType) {\n\t\treturn flattenedParts;\n\t}\n\tif (childType === 'rows' && layoutPart.rows.length) {\n\t\tflattenedParts[layoutPart.id].rows = layoutPart.rows.map((row) => row.id);\n\t} else if (childType === 'columns' && layoutPart.columns.length) {\n\t\tflattenedParts[layoutPart.id].columns = layoutPart.columns.map(\n\t\t\t(column) => column.id\n\t\t);\n\t}\n\n\treturn flattenChildren(flattenedParts, childType);\n};\n\nexport const treeifyLayout = (flattenedLayout) => {\n\tfunction populateChildren(type, flattenedLayout, key) {\n\t\tflattenedLayout[key][type] = flattenedLayout[key][type].map((id) => {\n\t\t\tdelete flattenedLayout[id].parent;\n\t\t\treturn flattenedLayout[id];\n\t\t});\n\t}\n\n\tconst ids = Object.keys(flattenedLayout);\n\tlet currentKey, currentLayoutPart;\n\tfor (const i in ids) {\n\t\tcurrentKey = ids[i];\n\t\tcurrentLayoutPart = flattenedLayout[currentKey];\n\t\tif (currentLayoutPart.rows) {\n\t\t\tpopulateChildren('rows', flattenedLayout, currentKey);\n\t\t} else if (currentLayoutPart.columns) {\n\t\t\tpopulateChildren('columns', flattenedLayout, currentKey);\n\t\t}\n\t}\n\treturn {\n\t\tdefault: {\n\t\t\ttype: 'rowColumn',\n\t\t\troot: Object.entries(flattenedLayout).reduce((acc, [key, val]) => {\n\t\t\t\tif (val.parent === 'root') {\n\t\t\t\t\tdelete flattenedLayout[key].parent;\n\t\t\t\t\treturn flattenedLayout[key];\n\t\t\t\t}\n\t\t\t\treturn acc;\n\t\t\t}, null)\n\t\t}\n\t};\n};\n\nexport const findLayoutElementByChild = (flattenedLayout, childId) => {\n\treturn Object.values(flattenedLayout).find((layoutElement) => {\n\t\tconst childCollectionType = getCollectionKey(\n\t\t\tgetChildType(layoutElement.type)\n\t\t);\n\t\tif (!isLeaf(layoutElement)) {\n\t\t\treturn layoutElement[childCollectionType].find((id) => id === childId);\n\t\t}\n\t\treturn false;\n\t});\n};\n\nconst findLayoutElementsWithSingleChildLayout = (flattenedLayout) => {\n\tconst ret = [];\n\tObject.keys(flattenedLayout).forEach((id) => {\n\t\tconst parentElement = flattenedLayout[id];\n\t\tconst childCollectionKey = getCollectionKey(\n\t\t\tgetChildType(parentElement.type)\n\t\t);\n\t\tif (\n\t\t\tparentElement[childCollectionKey] &&\n\t\t\tparentElement[childCollectionKey].length === 1\n\t\t) {\n\t\t\tconst soloChildId = parentElement[childCollectionKey][0];\n\t\t\t!isLeaf(flattenedLayout[soloChildId]) && ret.push(parentElement);\n\t\t}\n\t});\n\treturn ret;\n};\n\nexport const spliceInNewChild = (\n\tchildCollection,\n\tadjacentId,\n\ttargetId,\n\tdirection\n) => {\n\tconst ret = [...childCollection];\n\tconst adjacentIdIndex = ret.indexOf(adjacentId);\n\tret.splice(\n\t\tdirection.toLowerCase() === 'left' || direction.toLowerCase() === 'top'\n\t\t\t? adjacentIdIndex\n\t\t\t: adjacentIdIndex + 1,\n\t\t0,\n\t\ttargetId\n\t);\n\treturn ret;\n};\n\nconst spliceOutChild = (layoutParent, id) => {\n\tconst childType = getChildType(layoutParent.type);\n\tconst collectionKey = getCollectionKey(childType);\n\tconst childCollection = layoutParent[collectionKey];\n\tchildCollection.splice(childCollection.indexOf(id), 1);\n\treturn childCollection;\n};\n\nexport const replaceExistingChild = (childCollection, oldId, newId) => {\n\treturn childCollection.map((child) => (child === oldId ? newId : child));\n};\n\nexport const getChildType = (parentType) => {\n\treturn parentType === 'column' ? 'row' : 'column';\n};\n\nexport const getCollectionKey = (type) => {\n\treturn `${type}s`;\n};\n\nconst insertParallelLeaf = (\n\tlayoutParent,\n\tflattenedLayout,\n\tchildCollectionType,\n\texistingId,\n\tnewSlotName,\n\tdirection\n) => {\n\tconst childCollectionKey = getCollectionKey(childCollectionType);\n\tconst newId = cuid();\n\tconst newChildren = spliceInNewChild(\n\t\tlayoutParent[childCollectionKey],\n\t\texistingId,\n\t\tnewId,\n\t\tdirection\n\t);\n\tflattenedLayout[layoutParent.id][childCollectionKey] = newChildren;\n\tflattenedLayout[newId] = {\n\t\tparent: layoutParent.id,\n\t\ttype: childCollectionType,\n\t\tslotName: newSlotName,\n\t\tid: newId\n\t};\n\treturn flattenedLayout;\n};\n\nconst insertPerpendicularToLeaf = (\n\tlayoutParent,\n\tflattenedLayout,\n\tchildCollectionType,\n\texistingId,\n\tnewSlotName,\n\tdirection\n) => {\n\tconst childCollectionKey = getCollectionKey(childCollectionType);\n\tconst newLayoutElementType = getChildType(childCollectionType);\n\tconst newLayoutElementCollectionKey = getCollectionKey(newLayoutElementType);\n\tconst newLeafId = cuid();\n\tconst newContainerId = cuid();\n\tconst newChildren = replaceExistingChild(\n\t\tlayoutParent[childCollectionKey],\n\t\texistingId,\n\t\tnewContainerId\n\t);\n\tflattenedLayout[layoutParent.id][childCollectionKey] = newChildren;\n\tconst newContainer = {\n\t\tparent: layoutParent.id,\n\t\tid: newContainerId,\n\t\ttype: childCollectionType,\n\t\t[newLayoutElementCollectionKey]: spliceInNewChild(\n\t\t\t[existingId],\n\t\t\texistingId,\n\t\t\tnewLeafId,\n\t\t\tdirection\n\t\t)\n\t};\n\tflattenedLayout[newContainerId] = newContainer;\n\tflattenedLayout[existingId].parent = newContainerId;\n\n\tflattenedLayout[newLeafId] = {\n\t\tparent: newContainerId,\n\t\ttype: newLayoutElementType,\n\t\tslotName: newSlotName,\n\t\tid: newLeafId\n\t};\n\tflattenedLayout[existingId].type = newLayoutElementType;\n\tif (newLayoutElementType !== 'column') {\n\t\tdelete flattenedLayout[existingId].size;\n\t}\n\treturn flattenedLayout;\n};\n\nconst insertPerpendicularToLayout = (\n\tflattenedLayout,\n\texistingId,\n\tnewSlotName,\n\tdirection\n) => {\n\tconst collectionType = getChildType(flattenedLayout[existingId].type);\n\tconst collectionKey = getCollectionKey(collectionType);\n\tconst children = [...flattenedLayout[existingId][collectionKey]];\n\tconst siblingId =\n\t\tdirection.toLowerCase() === 'right' || direction.toLowerCase() === 'bottom'\n\t\t\t? children.pop()\n\t\t\t: children.shift();\n\treturn insertParallelLeaf(\n\t\tflattenedLayout[existingId],\n\t\tflattenedLayout,\n\t\tcollectionType,\n\t\tsiblingId,\n\t\tnewSlotName,\n\t\tdirection\n\t);\n};\n\nconst insertParallelToRoot = (flattenedLayout, newSlotName, direction) => {\n\tconst newLeafId = cuid();\n\tconst newRootId = cuid();\n\tconst existingRoot = getRoot(flattenedLayout);\n\tconst existingRootType = existingRoot.type;\n\texistingRoot.parent = newRootId;\n\tconst newRootType = getChildType(existingRootType);\n\tconst newRootCollectionKey = getCollectionKey(existingRootType);\n\tconst newRoot = {\n\t\tparent: 'root',\n\t\tid: newRootId,\n\t\ttype: newRootType,\n\t\t[newRootCollectionKey]: [existingRoot.id]\n\t};\n\tconst newLayoutElement = {\n\t\tparent: newRootId,\n\t\ttype: existingRootType,\n\t\tid: newLeafId,\n\t\tslotName: newSlotName\n\t};\n\tif (\n\t\tdirection.toLowerCase() === 'right' ||\n\t\tdirection.toLowerCase() === 'bottom'\n\t) {\n\t\tnewRoot[newRootCollectionKey].push(newLeafId);\n\t} else {\n\t\tnewRoot[newRootCollectionKey].unshift(newLeafId);\n\t}\n\tflattenedLayout[newRootId] = newRoot;\n\tflattenedLayout[newLeafId] = newLayoutElement;\n\treturn flattenedLayout;\n};\n\nexport const isLeaf = (layoutElement) => {\n\tlet hasChildren = false;\n\tfor (const key of Object.keys(layoutElement)) {\n\t\tif (Array.isArray(layoutElement[key]) && layoutElement[key].length) {\n\t\t\thasChildren = true;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn !hasChildren;\n};\n\nexport const getRoot = (flattenedLayout) => {\n\tconst ids = Object.keys(flattenedLayout);\n\tfor (const id of ids) {\n\t\tif (flattenedLayout[id].parent === 'root') {\n\t\t\treturn flattenedLayout[id];\n\t\t}\n\t}\n};\n\nexport const isParallel = (direction, layoutType) => {\n\treturn (\n\t\t((direction.toLowerCase() === 'right' ||\n\t\t\tdirection.toLowerCase() === 'left') &&\n\t\t\tlayoutType === 'column') ||\n\t\t((direction.toLowerCase() === 'top' ||\n\t\t\tdirection.toLowerCase() === 'bottom') &&\n\t\t\tlayoutType === 'row')\n\t);\n};\n\nexport const findLayoutElementById = (id, unflattenedLayout) => {\n\tconst lookup = {\n\t\tcolumn: 'rows',\n\t\trow: 'columns'\n\t};\n\tlet items = [unflattenedLayout.default.root];\n\tlet found = null;\n\twhile (!found && items.length > 0) {\n\t\tconst item = items.shift();\n\t\tif (item.id === id) {\n\t\t\tfound = item;\n\t\t} else {\n\t\t\titems = items.concat(get(item, lookup[item.type], []));\n\t\t}\n\t}\n\n\treturn found;\n};\n\nconst promoteAndDeleteElement = (\n\tflattenedLayout,\n\tdeletedElementParent,\n\tcollectionKey,\n\tid,\n\tdeletedElementParentId,\n\tdeletedElementGrandParentId\n) => {\n\tconst soloLayoutChildId = deletedElementParent[collectionKey].filter(\n\t\t(childId) => childId !== id\n\t)[0];\n\tconst currentSoloLayoutChildCollectionKey = getCollectionKey(\n\t\tgetChildType(flattenedLayout[soloLayoutChildId].type)\n\t);\n\tif (\n\t\tflattenedLayout[soloLayoutChildId][currentSoloLayoutChildCollectionKey] &&\n\t\t!flattenedLayout[soloLayoutChildId][currentSoloLayoutChildCollectionKey]\n\t\t\t.length\n\t) {\n\t\tdelete flattenedLayout[soloLayoutChildId][\n\t\t\tcurrentSoloLayoutChildCollectionKey\n\t\t];\n\t}\n\tflattenedLayout[soloLayoutChildId].type =\n\t\tflattenedLayout[deletedElementParentId].type;\n\tflattenedLayout[soloLayoutChildId].parent =\n\t\tflattenedLayout[deletedElementParentId].parent;\n\tflattenedLayout[soloLayoutChildId].type === 'row' &&\n\t\tdelete flattenedLayout[soloLayoutChildId].size;\n\tconst grandParentCollectionKey = getCollectionKey(\n\t\tgetChildType(flattenedLayout[deletedElementGrandParentId].type)\n\t);\n\tconst newGrandParentChildren = replaceExistingChild(\n\t\tflattenedLayout[deletedElementGrandParentId][grandParentCollectionKey],\n\t\tdeletedElementParentId,\n\t\tsoloLayoutChildId\n\t);\n\tflattenedLayout[deletedElementGrandParentId][\n\t\tgrandParentCollectionKey\n\t] = newGrandParentChildren;\n\tdelete flattenedLayout[deletedElementParentId];\n\tdelete flattenedLayout[id];\n\treturn flattenedLayout;\n};\n\nconst insertPerpendicularToSingleLeaf = (\n\tflattenedLayout,\n\tlayoutElementParent,\n\tchildCollectionType,\n\tchildCollectionKey,\n\tadjacentId,\n\ttargetSlotName,\n\tdirection\n) => {\n\tconst newLeafId = cuid();\n\tflattenedLayout[newLeafId] = {\n\t\tparent: layoutElementParent.slotName,\n\t\tid: newLeafId,\n\t\tslotName: targetSlotName\n\t};\n\tchildCollectionType === 'row' && delete layoutElementParent.size;\n\tconst newChildCollectionKey =\n\t\tchildCollectionKey === 'columns' ? 'rows' : 'columns';\n\tconst newChildCollection = spliceInNewChild(\n\t\tlayoutElementParent[childCollectionKey],\n\t\tadjacentId,\n\t\tnewLeafId,\n\t\tdirection\n\t);\n\tlayoutElementParent[newChildCollectionKey] = newChildCollection;\n\tconst newChildType = layoutElementParent.type;\n\tnewChildCollection.forEach((childId) => {\n\t\tnewChildType === 'row' && delete flattenedLayout[childId].size;\n\t\tflattenedLayout[childId].type = newChildType;\n\t});\n\tdelete layoutElementParent[childCollectionKey];\n\tlayoutElementParent.type = childCollectionType;\n\n\tflattenedLayout[layoutElementParent.id] = layoutElementParent;\n\treturn flattenedLayout;\n};\n\nconst promoteSingltonAtRoot = (flattenedLayout, layoutParent) => {\n\tconst childCollectionKey = getCollectionKey(getChildType(layoutParent.type));\n\tconst singletonLayoutElement =\n\t\tflattenedLayout[layoutParent[childCollectionKey][0]];\n\tconst singletonChildCollectionKey = getCollectionKey(\n\t\tgetChildType(singletonLayoutElement.type)\n\t);\n\tconst singletonLayoutElementChildIds =\n\t\tsingletonLayoutElement[singletonChildCollectionKey];\n\tsingletonLayoutElementChildIds.forEach((singletonChildId) => {\n\t\tflattenedLayout[singletonChildId].parent = layoutParent.id;\n\t});\n\tlayoutParent.type = layoutParent.type === 'column' ? 'row' : 'column';\n\tlayoutParent.type === 'row' && delete layoutParent.size;\n\tlayoutParent[childCollectionKey] = singletonLayoutElementChildIds;\n\tlayoutParent[childCollectionKey === 'columns' ? 'rows' : 'columns'] =\n\t\tlayoutParent[childCollectionKey];\n\tdelete layoutParent[childCollectionKey];\n\tflattenedLayout[layoutParent.id] = layoutParent;\n\tdelete flattenedLayout[singletonLayoutElement.id];\n\treturn flattenedLayout;\n};\n\nexport const findIncongruentLayoutElement = (flattenedLayout) => {\n\tconst ids = Object.keys(flattenedLayout);\n\tfor (const id of ids) {\n\t\tif (flattenedLayout[id][`${flattenedLayout[id].type}s`]) {\n\t\t\treturn flattenedLayout[id];\n\t\t}\n\t}\n\treturn false;\n};\n\nconst removeIncongruentLayoutElement = (\n\tflattenedLayout,\n\tillegalLayoutElement\n) => {\n\tconst illegalElementParent = flattenedLayout[illegalLayoutElement.parent];\n\tconst illegalCollectionKey = getCollectionKey(illegalLayoutElement.type);\n\tillegalLayoutElement[illegalCollectionKey].forEach(\n\t\t(id) => (flattenedLayout[id].parent = illegalElementParent.id)\n\t);\n\tconst mergedChildCollection = [\n\t\t...illegalElementParent[illegalCollectionKey],\n\t\t...illegalLayoutElement[illegalCollectionKey]\n\t].filter((id) => id !== illegalLayoutElement.id);\n\tillegalElementParent[illegalCollectionKey] = mergedChildCollection;\n\tflattenedLayout[illegalElementParent.id] = illegalElementParent;\n\tdelete flattenedLayout[illegalLayoutElement.id];\n\treturn flattenedLayout;\n};\n\nexport const applyNewSizes = (flattenedLayout) => {\n\tconst ids = Object.keys(flattenedLayout);\n\tfor (const id of ids) {\n\t\tconst layoutElement = flattenedLayout[id];\n\t\tif (layoutElement.parent === 'root' && layoutElement.type === 'column') {\n\t\t\tflattenedLayout[layoutElement.id].size = '12';\n\t\t}\n\t\tif (layoutElement.columns && layoutElement.columns.length) {\n\t\t\tconst cols = layoutElement.columns.map(\n\t\t\t\t(columnId) => flattenedLayout[columnId]\n\t\t\t);\n\t\t\tnormalizeSizes(cols);\n\t\t}\n\t}\n\treturn flattenedLayout;\n};\n\nexport const insertAndGetUpdatedLayout = (\n\tflattenedLayout,\n\tdirection,\n\tadjacentId,\n\ttargetSlotName\n) => {\n\tconst layoutElementParent = findLayoutElementByChild(\n\t\tflattenedLayout,\n\t\tadjacentId\n\t);\n\n\tif (layoutElementParent) {\n\t\tconst childCollectionType = getChildType(layoutElementParent.type);\n\t\tif (isParallel(direction, childCollectionType)) {\n\t\t\treturn applyNewSizes(\n\t\t\t\tinsertParallelLeaf(\n\t\t\t\t\tlayoutElementParent,\n\t\t\t\t\tflattenedLayout,\n\t\t\t\t\tchildCollectionType,\n\t\t\t\t\tadjacentId,\n\t\t\t\t\ttargetSlotName,\n\t\t\t\t\tdirection\n\t\t\t\t)\n\t\t\t);\n\t\t} else if (!isParallel(direction, childCollectionType)) {\n\t\t\tconst childCollectionKey = getCollectionKey(childCollectionType);\n\t\t\tif (\n\t\t\t\tlayoutElementParent.parent === 'root' &&\n\t\t\t\tlayoutElementParent[childCollectionKey].length === 1\n\t\t\t) {\n\t\t\t\treturn applyNewSizes(\n\t\t\t\t\tinsertPerpendicularToSingleLeaf(\n\t\t\t\t\t\tflattenedLayout,\n\t\t\t\t\t\tlayoutElementParent,\n\t\t\t\t\t\tchildCollectionType,\n\t\t\t\t\t\tchildCollectionKey,\n\t\t\t\t\t\tadjacentId,\n\t\t\t\t\t\ttargetSlotName,\n\t\t\t\t\t\tdirection\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t} else if (isLeaf(flattenedLayout[adjacentId])) {\n\t\t\t\treturn applyNewSizes(\n\t\t\t\t\tinsertPerpendicularToLeaf(\n\t\t\t\t\t\tlayoutElementParent,\n\t\t\t\t\t\tflattenedLayout,\n\t\t\t\t\t\tchildCollectionType,\n\t\t\t\t\t\tadjacentId,\n\t\t\t\t\t\ttargetSlotName,\n\t\t\t\t\t\tdirection\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\treturn applyNewSizes(\n\t\t\t\t\tinsertPerpendicularToLayout(\n\t\t\t\t\t\tflattenedLayout,\n\t\t\t\t\t\tadjacentId,\n\t\t\t\t\t\ttargetSlotName,\n\t\t\t\t\t\tdirection\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tconst rootLayoutElement = getRoot(flattenedLayout);\n\n\t\tif (\n\t\t\trootLayoutElement.type === 'row' &&\n\t\t\trootLayoutElement.columns.length === 1\n\t\t) {\n\t\t\tif (\n\t\t\t\tdirection.toLowerCase() === 'bottom' ||\n\t\t\t\tdirection.toLowerCase() === 'top'\n\t\t\t) {\n\t\t\t\tconst childCollectionKey = getCollectionKey(\n\t\t\t\t\tgetChildType(rootLayoutElement.type)\n\t\t\t\t);\n\t\t\t\tinsertPerpendicularToSingleLeaf(\n\t\t\t\t\tflattenedLayout,\n\t\t\t\t\trootLayoutElement,\n\t\t\t\t\t'column',\n\t\t\t\t\tchildCollectionKey,\n\t\t\t\t\trootLayoutElement.columns[0],\n\t\t\t\t\ttargetSlotName,\n\t\t\t\t\tdirection\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tinsertParallelLeaf(\n\t\t\t\t\trootLayoutElement,\n\t\t\t\t\tflattenedLayout,\n\t\t\t\t\t'column',\n\t\t\t\t\trootLayoutElement.columns[0],\n\t\t\t\t\ttargetSlotName,\n\t\t\t\t\tdirection\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (isParallel(direction, rootLayoutElement.type)) {\n\t\t\treturn applyNewSizes(\n\t\t\t\tinsertParallelToRoot(flattenedLayout, targetSlotName, direction)\n\t\t\t);\n\t\t} else {\n\t\t\treturn applyNewSizes(\n\t\t\t\tinsertPerpendicularToLayout(\n\t\t\t\t\tflattenedLayout,\n\t\t\t\t\tadjacentId,\n\t\t\t\t\ttargetSlotName,\n\t\t\t\t\tdirection\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\treturn applyNewSizes(flattenedLayout);\n};\n\nexport const deleteAndGetUpdatedLayout = (flattenedLayout, id) => {\n\tconst deletedElementParent = findLayoutElementByChild(flattenedLayout, id);\n\tconst collectionKey = getCollectionKey(\n\t\tgetChildType(deletedElementParent.type)\n\t);\n\tconst childCollection = deletedElementParent[collectionKey];\n\tconst deletedElementParentId = deletedElementParent.id;\n\tconst deletedElementGrandParentId =\n\t\tflattenedLayout[deletedElementParentId].parent;\n\tif (childCollection.length > 2 || deletedElementGrandParentId === 'root') {\n\t\tflattenedLayout[deletedElementParentId][collectionKey] = spliceOutChild(\n\t\t\tdeletedElementParent,\n\t\t\tid\n\t\t);\n\t\tdelete flattenedLayout[id];\n\t\tconst layoutParentsWithSingleChildLayout = findLayoutElementsWithSingleChildLayout(\n\t\t\tflattenedLayout\n\t\t);\n\t\tlayoutParentsWithSingleChildLayout.forEach((layoutParent) => {\n\t\t\tif (layoutParent.parent === 'root') {\n\t\t\t\treturn applyNewSizes(\n\t\t\t\t\tpromoteSingltonAtRoot(flattenedLayout, layoutParent)\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tconst newFlattenedLayout = promoteAndDeleteElement(\n\t\t\tflattenedLayout,\n\t\t\tdeletedElementParent,\n\t\t\tcollectionKey,\n\t\t\tid,\n\t\t\tdeletedElementParentId,\n\t\t\tdeletedElementGrandParentId\n\t\t);\n\t\tconst illegalLayoutElement = findIncongruentLayoutElement(\n\t\t\tnewFlattenedLayout\n\t\t);\n\t\tif (illegalLayoutElement) {\n\t\t\treturn applyNewSizes(\n\t\t\t\tremoveIncongruentLayoutElement(newFlattenedLayout, illegalLayoutElement)\n\t\t\t);\n\t\t}\n\t\treturn applyNewSizes(newFlattenedLayout);\n\t}\n\treturn applyNewSizes(flattenedLayout);\n};\n\nfunction addIdsToLayoutElment(layoutElement) {\n\tlayoutElement.id = layoutElement.id || cuid();\n\n\tif (layoutElement.slotName) {\n\t\treturn;\n\t}\n\n\tconst childAccessor = layoutElement.type === 'row' ? 'columns' : 'rows';\n\n\tfor (const childLayoutElement of layoutElement[childAccessor]) {\n\t\taddIdsToLayoutElment(childLayoutElement);\n\t}\n}\n\nexport const addIdsToLayout = (layout) => {\n\tif (!layout) {\n\t\treturn;\n\t}\n\n\tif (layout.default) {\n\t\tconst { root } = layout.default;\n\n\t\taddIdsToLayoutElment(root);\n\t}\n};\nexport const getClosestNeighbor = (array, index, side, dir) => {\n\tconst MIN_SIZE = 1;\n\tconst getSide = {\n\t\tLEFT() {\n\t\t\treturn array.slice(0, index).reverse();\n\t\t},\n\t\tRIGHT() {\n\t\t\treturn array.slice(index + 1);\n\t\t}\n\t};\n\n\tconst neighbors = getSide[side.toUpperCase()]();\n\tif (dir === 'EXPAND') {\n\t\treturn neighbors.filter((neighbor) => neighbor.size > MIN_SIZE)[0] || null;\n\t}\n\treturn neighbors.sort((a, b) => a.size - b.size)[0] || null;\n};\nconst childrenKey = (type) => (type === 'row' ? 'columns' : 'rows');\nconst traverseChildren = (children, { label, value }) => {\n\tif (!children) {\n\t\treturn null;\n\t}\n\n\tconst results = children\n\t\t.map((child) => {\n\t\t\tif (child[label] === value) {\n\t\t\t\treturn children;\n\t\t\t}\n\t\t\tconst key = childrenKey(child.type);\n\t\t\tconst items = child[key];\n\t\t\tif (!items) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn traverseChildren(items, { label, value });\n\t\t})\n\t\t.filter((child) => child);\n\n\treturn results[0];\n};\nexport const getResizedRow = (layout, { label, value }) => {\n\tconst { root } = layout.default;\n\tconst children = root[childrenKey(root.type)];\n\treturn traverseChildren(children, { label, value }) || [];\n};\n","import flatMap from 'lodash/flatMap';\n\nexport default function createElementArray(element, callback) {\n\treturn [\n\t\tcallback.call(null, element),\n\t\t...flatMap(element.children, (child) => createElementArray(child, callback))\n\t];\n}\n","import { seismicCuid, throwError } from '../../../utils';\nimport Property from '../../../models/property';\nimport Element from '../../../models/element';\nimport flatMap from 'lodash/flatMap';\nimport get from 'lodash/get';\nimport set from 'lodash/set';\n\nimport isNil from 'lodash/isNil';\nimport isNaN from 'lodash/isNaN';\nimport { flattenLayout } from './layout';\nimport createElementArray from './createElementArray';\n\nconst componentUsesSNLayout = (component) => {\n\treturn component.slots.indexOf('@default') > -1;\n};\nfunction elementUsesSNLayout(element) {\n\treturn componentUsesSNLayout(element.component);\n}\n\nfunction getRootElementFromState(state) {\n\treturn state.properties.pageState.rootElement;\n}\n\nfunction updateRootElementInState(state, newRootElement) {\n\tstate.properties.pageState.rootElement = newRootElement;\n}\n\nfunction findElementById(element, elementId) {\n\ttry {\n\t\treturn findElements(element, (el) => el.id === elementId)[0];\n\t} catch (e) {\n\t\treturn null;\n\t}\n}\n\nfunction findElements(element, callback) {\n\tif (typeof callback !== 'function') {\n\t\tthrowError('Callback must be a function', TypeError);\n\t}\n\n\tconst matchingElements = [];\n\tif (callback.call(null, element)) {\n\t\tmatchingElements.push(element);\n\t}\n\n\treturn matchingElements.concat(\n\t\tflatMap(element.children, (child) => findElements(child, callback))\n\t);\n}\n\nfunction findParentElement(element, elementId) {\n\tfor (const child of element.children) {\n\t\tif (child.id === elementId) {\n\t\t\treturn element;\n\t\t} else {\n\t\t\tconst found = findParentElement(child, elementId);\n\n\t\t\tif (found) {\n\t\t\t\treturn found;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn null;\n}\n\nfunction updateStaticProperty(element, changes) {\n\tfor (const change in changes) {\n\t\tif (element.properties[change]) {\n\t\t\telement.properties[change].value = changes[change];\n\t\t}\n\t}\n}\n\nfunction updateDynamicProperty(element, prop, charterId, charterProp) {\n\telement.properties[prop].isStatic = !element.properties[prop].isStatic;\n\tif (charterId) {\n\t\telement.properties[prop].value = {\n\t\t\tcharterId,\n\t\t\tcharterProp\n\t\t};\n\t} else {\n\t\telement.properties[prop].value = null;\n\t}\n}\nfunction typedValue(type, value) {\n\tif (isNil(value)) {\n\t\treturn null;\n\t}\n\tswitch (type) {\n\t\tcase 'boolean':\n\t\t\tif (typeof value === 'boolean') {\n\t\t\t\treturn value;\n\t\t\t} else {\n\t\t\t\treturn value.toString().toLowerCase() === 'true';\n\t\t\t}\n\t\tcase 'number':\n\t\t\tif (typeof value === 'number') {\n\t\t\t\treturn value;\n\t\t\t} else {\n\t\t\t\tconst pv = parseFloat(value);\n\t\t\t\treturn isNaN(pv) ? null : pv;\n\t\t\t}\n\t\tcase 'string':\n\t\t\treturn typeof value === 'string' ? value : '';\n\t\tdefault:\n\t\t\treturn value;\n\t}\n}\n\nfunction createElementPropertiesFromComponent(component) {\n\treturn component.properties.reduce((acc, propertyConfig) => {\n\t\tconst { type, readOnly, columnName, defaultValue } = propertyConfig;\n\t\tlet { value } = propertyConfig;\n\n\t\tif (readOnly) {\n\t\t\tvalue = isNil(value)\n\t\t\t\t? isNil(defaultValue)\n\t\t\t\t\t? null\n\t\t\t\t\t: defaultValue\n\t\t\t\t: typedValue(type, value);\n\t\t} else {\n\t\t\tvalue = typedValue(type, value);\n\t\t}\n\t\tconst newProperty = new Property({\n\t\t\t...propertyConfig,\n\t\t\tvalue\n\t\t});\n\n\t\tacc[columnName] = newProperty;\n\t\treturn acc;\n\t}, {});\n}\n\nfunction getAllElementIds(rootElement) {\n\treturn createElementArray(rootElement, (element) => ({\n\t\tid: element.id\n\t})).map((el) => el.id);\n}\n\nfunction createElementFromComponent(\n\tcomponent,\n\tparentElement,\n\tisModal = false,\n\tdefaultLayout\n) {\n\tlet layout;\n\tconst id = seismicCuid();\n\tif (componentUsesSNLayout(component)) {\n\t\tlayout = defaultLayout;\n\t}\n\n\t// DEF0162800: If container, make sure it has 100% width\n\tconst tagName = component.tag;\n\tconst isContainer =\n\t\ttagName === 'now-uxf-page-simple-container' ||\n\t\ttagName === 'now-resizable-panes' ||\n\t\ttagName === 'now-uxf-page-container';\n\treturn new Element({\n\t\tid,\n\t\tcomponent,\n\t\tisModal,\n\t\tlayout,\n\t\tisModalDescendant: parentElement.isModal || parentElement.isModalDescendant,\n\t\tproperties: createElementPropertiesFromComponent(component),\n\t\tstyles: isContainer ? { width: '100%' } : undefined\n\t});\n}\n\nfunction deleteChildElement(parentElement, deletedElementId) {\n\treturn set(\n\t\tparentElement,\n\t\t'children',\n\t\tparentElement.children.filter((child) => child.id !== deletedElementId)\n\t);\n}\n\nfunction isOnlySlottedChild(elementId, rootElement) {\n\tconst targetElement = findElementById(rootElement, elementId);\n\tconst targetParentElement = findParentElement(rootElement, elementId);\n\tfor (const i in get(targetParentElement, 'children', [])) {\n\t\tif (\n\t\t\tget(targetParentElement, `children[${i}].slot.name`) ===\n\t\t\t\tget(targetElement, 'slot.name') &&\n\t\t\ttargetParentElement.children[i].id !== targetElement.id\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nfunction getEmptyLayoutSlots(containerElement) {\n\tconst rootLayoutNode = get(containerElement, 'layout.default.root', null);\n\tif (!rootLayoutNode) {\n\t\treturn [];\n\t}\n\tconst flattenedLayout = flattenLayout(rootLayoutNode);\n\n\tconst layoutSlots = Object.keys(flattenedLayout).reduce(\n\t\t(acc, layoutNodeId) => {\n\t\t\tconst slotName = flattenedLayout[layoutNodeId].slotName;\n\t\t\tslotName && acc.push({ slot: slotName, id: layoutNodeId });\n\t\t\treturn acc;\n\t\t},\n\t\t[]\n\t);\n\n\treturn layoutSlots.reduce((acc, slotObj) => {\n\t\tconst slottedElements = findElements(\n\t\t\tcontainerElement,\n\t\t\t(element) => element.slot && element.slot.name === slotObj.slot\n\t\t);\n\t\tif (!slottedElements.length) {\n\t\t\tacc.push(slotObj);\n\t\t}\n\t\treturn acc;\n\t}, []);\n}\n\nconst getParentLayoutType = (parentElement) =>\n\tget(parentElement, 'layout.default.type', 'rowColumn');\n\nexport {\n\telementUsesSNLayout,\n\tcreateElementFromComponent,\n\tcreateElementPropertiesFromComponent,\n\tdeleteChildElement,\n\tgetRootElementFromState,\n\tfindElements,\n\tfindElementById,\n\tfindParentElement,\n\tupdateRootElementInState,\n\tupdateStaticProperty,\n\tupdateDynamicProperty,\n\tisOnlySlottedChild,\n\tgetEmptyLayoutSlots,\n\tgetParentLayoutType,\n\tgetAllElementIds\n};\n","import {\n\tVALID_BINDING_TYPES_ENUM,\n\tBINDING_SHORTHAND_PATTERN\n} from './constants';\nimport { CONTEXT_NAMESPACE } from '../constants';\n\nexport default function BindingFactory({\n\tshorthand = null, // string\n\tmodel = null // object\n} = {}) {\n\tif (!shorthand && !model) {\n\t\tthrow new TypeError('Something went wrong initializing BindingFactory');\n\t}\n\n\tconst fType = shorthand ? getTypeFromShorthand(shorthand) : model.type;\n\tconst fShortHand = shorthand || getShorthandFromModel(model);\n\tconst fModel = model || getModelFromShorthand(shorthand);\n\n\tfunction getTypeFromShorthand(shorthand) {\n\t\tconst shorthandMatcher = shorthand.match(BINDING_SHORTHAND_PATTERN);\n\t\tif (!shorthandMatcher) {\n\t\t\tthrow new TypeError('Invalid expression was supplied to Binding');\n\t\t}\n\n\t\treturn Object.entries(VALID_BINDING_TYPES_ENUM).find(\n\t\t\t([, prefix]) => prefix === shorthandMatcher[1]\n\t\t)[0];\n\t}\n\n\tfunction getShorthandFromModel(model) {\n\t\tif (!VALID_BINDING_TYPES_ENUM[model.type]) {\n\t\t\tthrow new TypeError('Invalid binding model was suppied to Binding');\n\t\t}\n\n\t\tif (\n\t\t\tVALID_BINDING_TYPES_ENUM[model.type] === CONTEXT_NAMESPACE &&\n\t\t\tmodel.binding.category\n\t\t) {\n\t\t\tconst expressionRoot = `${CONTEXT_NAMESPACE}.${model.binding.category}`;\n\n\t\t\tconst path = model.binding.address.join('.');\n\t\t\treturn path ? `${expressionRoot}.${path}` : expressionRoot;\n\t\t}\n\n\t\treturn `${\n\t\t\tVALID_BINDING_TYPES_ENUM[model.type]\n\t\t}.${model.binding.address.join('.')}`;\n\t}\n\n\tfunction getModelFromShorthand(shorthand = '') {\n\t\tconst shorthandMatcher = shorthand.match(BINDING_SHORTHAND_PATTERN);\n\n\t\tlet address = [];\n\t\tif (shorthandMatcher && shorthandMatcher[1] === CONTEXT_NAMESPACE) {\n\t\t\tconst parts = shorthandMatcher[2].split('.');\n\t\t\tparts.shift();\n\t\t\tconst category = parts.shift();\n\t\t\tconst address = parts;\n\t\t\treturn {\n\t\t\t\ttype: fType,\n\t\t\t\tbinding: { category, address }\n\t\t\t};\n\t\t}\n\t\tif (shorthandMatcher) {\n\t\t\tconst parts = shorthandMatcher[2].split('.');\n\t\t\tparts.shift();\n\t\t\taddress = parts;\n\t\t}\n\n\t\treturn {\n\t\t\ttype: fType,\n\t\t\tbinding: { address }\n\t\t};\n\t}\n\n\t// PUBLIC API\n\treturn {\n\t\tgetShorthand() {\n\t\t\treturn fShortHand;\n\t\t},\n\n\t\tgetModel() {\n\t\t\treturn fModel;\n\t\t}\n\t};\n}\n","const workerFn = () => {\n\tlet scriptImported = false;\n\tself.onmessage = ({\n\t\tdata: {\n\t\t\tname,\n\t\t\tpayload: { id, origin, scripts }\n\t\t}\n\t}) => {\n\t\tif (name !== 'UXF#LINT_REQUESTED') {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!scriptImported) {\n\t\t\t// eslint-disable-next-line no-undef\n\t\t\timportScripts(\n\t\t\t\t`${origin}/scripts/externals/sn-uxf-client-scripts-eslint-bundle.min.js?sysparm_substitute=false`\n\t\t\t);\n\t\t\tscriptImported = true;\n\t\t}\n\n\t\tconst lintConfig = {\n\t\t\tparserOptions: {\n\t\t\t\tecmaVersion: '2018',\n\t\t\t\tsourceType: 'script',\n\t\t\t\tecmaFeatures: {\n\t\t\t\t\timpliedStrict: true\n\t\t\t\t}\n\t\t\t},\n\t\t\trules: {\n\t\t\t\tsemi: 'warn',\n\t\t\t\t'no-undef': 'error'\n\t\t\t},\n\t\t\tglobals: {\n\t\t\t\tconsole: 'readonly',\n\t\t\t\tPromise: 'readonly'\n\t\t\t}\n\t\t};\n\n\t\t// eslint-disable-next-line no-undef\n\t\tconst uibLinter = new eslint.Linter();\n\t\tself.postMessage({\n\t\t\tname: 'UXF_LINT_WORKER#LINTING_COMPLETE',\n\t\t\tpayload: {\n\t\t\t\tid,\n\t\t\t\tresult: scripts.map((script) => uibLinter.verify(script, lintConfig))\n\t\t\t}\n\t\t});\n\t};\n};\n\nlet instance;\nexport default () => {\n\tif (!instance) {\n\t\tinstance = new Worker(\n\t\t\twindow.URL.createObjectURL(new Blob([`(${workerFn.toString()})()`]))\n\t\t);\n\t}\n\treturn instance;\n};\n","import {\n\tCONTEXT_NAMESPACE,\n\tDATA_NAMESPACE,\n\tELEMENT_NAMESPACE,\n\tSTATE_NAMESPACE\n} from './constants';\n\nimport { SCRIPT_SHORTHAND_PATTERN } from './factories/constants';\nimport cuid from 'cuid';\nimport { findElementById } from './sn-uxf-builder-middleware/element/utils/element';\nimport get from 'lodash/get';\nimport has from 'lodash/has';\nimport { unstableResolvePropertySelectorValue } from '@servicenow/ui-core';\n\nimport BindingFactory from './factories/binding';\n\nimport LintWorkerFactory from './lintWorker';\n\nexport const seismicCuid = () => cuidToSeismicFriendlyId(cuid());\nexport const getWithNullDefault = (obj, path, fallback) => {\n\tconst result = get(obj, path, fallback);\n\tif (result === null) {\n\t\treturn fallback;\n\t}\n\treturn result;\n};\n\nconst walkRowColumnTree = (node, acc = []) => {\n\tconst childLookup = {\n\t\tcolumn: 'rows',\n\t\trow: 'columns'\n\t};\n\tconst { id, type, slotName } = node;\n\tconst children = node[childLookup[type]] || [];\n\tif (slotName) {\n\t\tacc.push({ slotName, type, id });\n\t}\n\tchildren.forEach((child) => {\n\t\twalkRowColumnTree(child, acc);\n\t});\n\treturn acc;\n};\nexport const normalizeRowColumnSlots = (layout) => {\n\tconst { type, root } = get(layout, 'default', {});\n\tif (type !== 'rowColumn') {\n\t\treturn layout;\n\t}\n\tconst items = walkRowColumnTree(root);\n\treturn {\n\t\tdefault: {\n\t\t\t...layout.default,\n\t\t\titems\n\t\t}\n\t};\n};\n\nexport const cuidToSeismicFriendlyId = (cuid) =>\n\tcuid.replace(/[0-9]/g, function (num) {\n\t\tconst letterCode = String.fromCharCode(Number(num, 10) + 97);\n\t\treturn letterCode + letterCode;\n\t});\n\nexport const getURLParamOverrides = () => {\n\tconst params = new URL(window.location.href).searchParams;\n\n\tconst urlParamsOverrides = {};\n\tfor (const param of params.entries()) {\n\t\turlParamsOverrides[param[0]] = param[1];\n\t}\n\n\treturn urlParamsOverrides;\n};\n\nconst ERROR_MESSAGE_PREFIX = 'UXF Middleware';\nexport const throwError = (msg, MiddlewareError = Error) => {\n\tconst message = `${ERROR_MESSAGE_PREFIX} ${msg}`;\n\tthrow new MiddlewareError(message);\n};\n\nexport const messageInfo = (msg, data) => {\n\t// eslint-disable-next-line no-console\n\tconsole.info(`UXF Message: ${msg}`, data || null);\n};\n\nexport const matchBindingSyntax = (value) => {\n\tconst patternString = `^(${CONTEXT_NAMESPACE}|${ELEMENT_NAMESPACE}|${DATA_NAMESPACE})\\\\.([^\\\\.\\\\/]+){1}\\\\.?([^\\\\.\\\\/]+)*(\\\\.[^\\\\/]+)*$`;\n\tconst matchedValues =\n\t\ttypeof value === 'string' && (value || '').match(new RegExp(patternString));\n\tif (matchedValues) {\n\t\treturn {\n\t\t\tnamespace: matchedValues[1],\n\t\t\tid: matchedValues[2],\n\t\t\tpropName: matchedValues[3],\n\t\t\tpath: matchedValues[4] || null\n\t\t};\n\t}\n\treturn null;\n};\n\nexport const matchScriptSyntax = (value) => {\n\tconst patternString = SCRIPT_SHORTHAND_PATTERN;\n\tconst matchedScript =\n\t\ttypeof value === 'string' && (value || '').match(new RegExp(patternString));\n\tif (matchedScript) {\n\t\treturn matchedScript[1];\n\t} else {\n\t\treturn null;\n\t}\n};\n\nexport const matchContextAppBindingSyntax = (value) => {\n\tconst appPatternString = `^(${CONTEXT_NAMESPACE}\\\\.app\\\\.)(.+)*$`;\n\tconst matchedValues = value.match(new RegExp(appPatternString));\n\tif (matchedValues) {\n\t\treturn { path: matchedValues[2] };\n\t}\n\treturn null;\n};\n\nexport const matchContextSessionBindingSyntax = (value) => {\n\tconst pattern = `^${CONTEXT_NAMESPACE}\\\\.session(\\\\..+)*$`;\n\tconst matchedValues =\n\t\ttypeof value === 'string' && (value || '').match(new RegExp(pattern));\n\tif (matchedValues) {\n\t\treturn {\n\t\t\tpath: matchedValues[1]\n\t\t};\n\t}\n\treturn null;\n};\n\nexport const matchStateBindingSyntax = (value) => {\n\tconst statePatternString = `^(${STATE_NAMESPACE})\\\\.(.+)`;\n\tconst matchedValues =\n\t\ttypeof value === 'string' &&\n\t\t(value || '').match(new RegExp(statePatternString));\n\tif (matchedValues) {\n\t\tconst path = matchedValues[2];\n\t\treturn { name: path };\n\t}\n\treturn null;\n};\n\nexport const deserializeAndExecuteScript = (inlineScript, api) => {\n\tconst newFn = new Function('api', `return (${inlineScript})({api})`);\n\tlet resolved;\n\ttry {\n\t\tresolved = newFn.apply(this, [api]);\n\t} catch (_) {\n\t\tresolved = '';\n\t}\n\treturn resolved;\n};\n\nexport const resolveScriptedPropertyValue = ({\n\tmatchedScript,\n\tclientScriptApi\n}) => {\n\treturn deserializeAndExecuteScript(matchedScript, clientScriptApi);\n};\n\nexport const resolvePropertyBinding = ({\n\tmatchedValues = {},\n\tbindings = {},\n\tancestorPageProperties = {},\n\tdataBrokerInstances,\n\tancestorDataBrokerInstances,\n\trootElement,\n\tancestorElements,\n\tappChromeSettings,\n\tpathToUse = '',\n\tpagePropertiesSeen = []\n}) => {\n\tconst { namespace, id, propName, path } = matchedValues;\n\tif (namespace === CONTEXT_NAMESPACE) {\n\t\tif (id === 'props') {\n\t\t\tif (has(bindings, propName)) {\n\t\t\t\tconst boundPropertyValue = bindings[propName];\n\n\t\t\t\tconst resolvedValues =\n\t\t\t\t\ttypeof boundPropertyValue === 'string' &&\n\t\t\t\t\tmatchBindingSyntax(boundPropertyValue);\n\t\t\t\tlet dotWalkPath = '';\n\t\t\t\tdotWalkPath += path || '';\n\t\t\t\tdotWalkPath += pathToUse || '';\n\n\t\t\t\tif (typeof boundPropertyValue === 'object') {\n\t\t\t\t\treturn get(boundPropertyValue, dotWalkPath.slice(1));\n\t\t\t\t}\n\n\t\t\t\tif (resolvedValues) {\n\t\t\t\t\treturn resolvePropertyBinding({\n\t\t\t\t\t\tmatchedValues: resolvedValues,\n\t\t\t\t\t\tbindings: ancestorPageProperties,\n\t\t\t\t\t\tancestorPageProperties: {},\n\t\t\t\t\t\tdataBrokerInstances: ancestorDataBrokerInstances,\n\t\t\t\t\t\tancestorDataBrokerInstances: [],\n\t\t\t\t\t\trootElement,\n\t\t\t\t\t\tancestorElements,\n\t\t\t\t\t\tappChromeSettings,\n\t\t\t\t\t\tpathToUse: dotWalkPath,\n\t\t\t\t\t\tpagePropertiesSeen\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn boundPropertyValue;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (id === 'session') {\n\t\t\tlet dataExpression = `${DATA_NAMESPACE}.session.output`;\n\t\t\tdataExpression += propName ? `.${propName}` : '';\n\t\t\tdataExpression += propName && path ? path : '';\n\t\t\treturn resolvePropertyBinding({\n\t\t\t\tmatchedValues: matchBindingSyntax(dataExpression),\n\t\t\t\tbindings: {},\n\t\t\t\tappChromeSettings,\n\t\t\t\tdataBrokerInstances: [\n\t\t\t\t\t...dataBrokerInstances,\n\t\t\t\t\t...ancestorDataBrokerInstances\n\t\t\t\t]\n\t\t\t});\n\t\t} else if (id === 'app') {\n\t\t\tconst boundPropertyValue = appChromeSettings[propName];\n\n\t\t\tlet dotWalkPath = '';\n\t\t\tdotWalkPath += path || '';\n\t\t\tdotWalkPath += pathToUse || '';\n\n\t\t\tif (typeof boundPropertyValue === 'object') {\n\t\t\t\treturn get(boundPropertyValue, dotWalkPath.slice(1));\n\t\t\t}\n\n\t\t\treturn boundPropertyValue;\n\t\t}\n\t} else if (namespace === ELEMENT_NAMESPACE) {\n\t\tconst boundEl = findElementById(rootElement, id) || ancestorElements[id];\n\t\tif (boundEl) {\n\t\t\tconst resolvedPath = path ? `${propName}${path}` : propName;\n\t\t\treturn `@${id}/${resolvedPath}${pathToUse}`;\n\t\t}\n\t} else if (namespace === DATA_NAMESPACE) {\n\t\tconst boundDbInstance = dataBrokerInstances.find((db) => db.id === id);\n\n\t\tif (boundDbInstance) {\n\t\t\tconst resolvedPath = path ? `${propName}${path}` : propName;\n\n\t\t\ttry {\n\t\t\t\tconst bindingFactory = BindingFactory({\n\t\t\t\t\tshorthand: `${namespace}.${id}.${resolvedPath}${pathToUse}`\n\t\t\t\t});\n\n\t\t\t\tconst model = bindingFactory.getModel();\n\n\t\t\t\tif (boundDbInstance.definition.type === 'CLIENT_STATE') {\n\t\t\t\t\tconst propData = unstableResolvePropertySelectorValue(\n\t\t\t\t\t\t`@${id}/${propName}`\n\t\t\t\t\t);\n\n\t\t\t\t\treturn get(propData, model.binding.address.slice(2));\n\t\t\t\t}\n\n\t\t\t\tconst fullData = unstableResolvePropertySelectorValue(`@${id}/preview`);\n\n\t\t\t\treturn get(fullData, model.binding.address.slice(1));\n\t\t\t} catch (_) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n};\n\nexport const resolveBinding = (\n\tproperty,\n\t{\n\t\tbindings,\n\t\tancestorPageProperties,\n\t\tdataBrokerInstances,\n\t\tancestorDataBrokerInstances,\n\t\trootElement,\n\t\tancestorElements,\n\t\tclientScriptApi,\n\t\tappChromeSettings,\n\t\ttype\n\t}\n) => {\n\tconst stateBinding =\n\t\tproperty &&\n\t\ttypeof property === 'string' &&\n\t\tmatchStateBindingSyntax(property);\n\tif (stateBinding) {\n\t\treturn `@uxf/clientStateData.${stateBinding.name}`;\n\t}\n\n\tconst matchedScript =\n\t\tproperty && typeof property === 'string' && matchScriptSyntax(property);\n\tlet propertyToProcess = property;\n\t// Check to see if the property is either a binding or a script\n\tif (matchedScript) {\n\t\tpropertyToProcess = resolveScriptedPropertyValue({\n\t\t\tmatchedScript,\n\t\t\tclientScriptApi\n\t\t});\n\t\treturn propertyToProcess;\n\t}\n\n\tconst matchedValues =\n\t\tpropertyToProcess &&\n\t\ttypeof propertyToProcess === 'string' &&\n\t\tmatchBindingSyntax(propertyToProcess);\n\n\tif (matchedValues) {\n\t\tconst resolved = resolvePropertyBinding({\n\t\t\tmatchedValues,\n\t\t\tbindings,\n\t\t\tancestorPageProperties,\n\t\t\tdataBrokerInstances,\n\t\t\tancestorDataBrokerInstances,\n\t\t\trootElement,\n\t\t\tancestorElements,\n\t\t\tappChromeSettings\n\t\t});\n\t\tpropertyToProcess = resolved;\n\t}\n\n\tif (type === 'json' && typeof propertyToProcess === 'string') {\n\t\ttry {\n\t\t\treturn JSON.parse(propertyToProcess);\n\t\t} catch (error) {\n\t\t\t/*  */\n\t\t}\n\t}\n\n\treturn propertyToProcess;\n};\n\nexport const processLinting = (scripts) => {\n\tconst id = seismicCuid();\n\tconst lintWorker = LintWorkerFactory();\n\n\tlintWorker.postMessage({\n\t\tname: 'UXF#LINT_REQUESTED',\n\t\tpayload: {\n\t\t\tscripts,\n\t\t\torigin: window.location.origin,\n\t\t\tid\n\t\t}\n\t});\n\n\treturn new Promise((resolve, reject) => {\n\t\tsetTimeout(() => {\n\t\t\treturn reject();\n\t\t}, 5000);\n\t\tconst onComplete = ({ data }) => {\n\t\t\tif (\n\t\t\t\tdata.name === 'UXF_LINT_WORKER#LINTING_COMPLETE' &&\n\t\t\t\tdata.payload.id === id\n\t\t\t) {\n\t\t\t\tlintWorker.removeEventListener('message', onComplete);\n\t\t\t\treturn resolve(data.payload.result);\n\t\t\t}\n\t\t};\n\t\tlintWorker.addEventListener('message', onComplete);\n\t});\n};\n","import get from 'lodash/get';\nimport { getWithNullDefault, normalizeRowColumnSlots } from '../utils';\nconst LAYOUT_TYPE = 'layout';\nconst ELEMENT_TYPE = 'element';\nconst CONTAINER_TYPE = 'container';\nconst LEAF_TYPE = 'leaf';\nconst SLOT_TYPE = 'slot';\nconst ROW_TYPE = 'row';\nconst COLUMN_TYPE = 'column';\nconst childrenKeyLookup = {\n\t[ROW_TYPE]: 'columns',\n\t[COLUMN_TYPE]: 'rows'\n};\n\nconst createNode = ({\n\tnodeType,\n\ttype,\n\tchildren,\n\tid,\n\tslotStyles,\n\tslotName,\n\tsize = null,\n\tlayoutType\n}) => {\n\treturn {\n\t\ttype,\n\t\tnodeType,\n\t\tchildren,\n\t\tslotStyles,\n\t\tid,\n\t\tlayoutType,\n\t\tsize,\n\t\tslotName\n\t};\n};\nconst handlersByType = {\n\trowColumn: rowColHandlers,\n\tdefault: defaultHandlers\n};\n\nfunction rowColHandlers() {\n\tconst processLayoutTree = (\n\t\tlayoutNode = {},\n\t\telements = [],\n\t\tlayoutType,\n\t\tparentId\n\t) => {\n\t\tif (!layoutNode.id) {\n\t\t\treturn null;\n\t\t}\n\t\tconst type = layoutNode.type === ROW_TYPE ? ROW_TYPE : COLUMN_TYPE;\n\t\tconst nodeType = LAYOUT_TYPE;\n\n\t\tconst childrenKey = childrenKeyLookup[type];\n\n\t\tconst children = layoutNode.slotName\n\t\t\t? elements.filter(({ slotName }) => slotName === layoutNode.slotName)\n\t\t\t: (layoutNode[childrenKey] || []).map((node) =>\n\t\t\t\t\tprocessLayoutTree(node, elements, layoutType, parentId)\n\t\t\t  );\n\t\treturn createNode({\n\t\t\tnodeType,\n\t\t\tslotName: get(layoutNode, 'slotName') || null,\n\t\t\ttype,\n\t\t\tid: layoutNode.id,\n\t\t\tchildren,\n\t\t\tlayoutType,\n\t\t\tsize: layoutNode.size\n\t\t});\n\t};\n\tconst processChildren = (\n\t\tchildren = [],\n\t\telementLayout = {},\n\t\tlayoutRole,\n\t\tparentId\n\t) => {\n\t\tconst rootLayoutNode = elementLayout.root;\n\t\tconst processedElements = children.map((element) => {\n\t\t\tconst { children, id, layout = {} } = element;\n\t\t\tconst layoutType = get(layout, `${layoutRole}.type`, null);\n\t\t\tconst process = get(handlersByType, layoutType, handlersByType.default)()\n\t\t\t\t.processChildren;\n\n\t\t\tconst nodeType = ELEMENT_TYPE;\n\t\t\tconst type = get(layout, `${layoutRole}`, false)\n\t\t\t\t? CONTAINER_TYPE\n\t\t\t\t: LEAF_TYPE;\n\n\t\t\treturn createNode({\n\t\t\t\tchildren: process(\n\t\t\t\t\tchildren,\n\t\t\t\t\tget(layout, `${layoutRole}`, {}) || {},\n\t\t\t\t\tlayoutRole,\n\t\t\t\t\tparentId\n\t\t\t\t),\n\t\t\t\tid,\n\t\t\t\ttype,\n\t\t\t\tnodeType,\n\t\t\t\tslotName: get(element, 'slot.name')\n\t\t\t});\n\t\t});\n\n\t\treturn [\n\t\t\tprocessLayoutTree(\n\t\t\t\trootLayoutNode,\n\t\t\t\tprocessedElements,\n\t\t\t\telementLayout.type,\n\t\t\t\tparentId\n\t\t\t)\n\t\t].filter((node) => node);\n\t};\n\treturn { processChildren };\n}\nfunction defaultHandlers() {\n\tconst processLayoutTree = (layoutNode = {}, elements = [], parentId) => {\n\t\tconst { items = [] } = layoutNode;\n\t\treturn items.map((item) => {\n\t\t\tconst { slotName, styles = {} } = item;\n\n\t\t\tconst children = elements.filter(\n\t\t\t\t({ slotName }) => slotName === item.slotName\n\t\t\t);\n\n\t\t\treturn createNode({\n\t\t\t\tchildren,\n\t\t\t\tid: `${parentId}_${slotName}`,\n\t\t\t\ttype: LEAF_TYPE,\n\t\t\t\tnodeType: SLOT_TYPE,\n\t\t\t\tslotStyles: styles,\n\t\t\t\tlayoutType: layoutNode.type,\n\t\t\t\tslotName\n\t\t\t});\n\t\t});\n\t};\n\n\tconst processChildren = (\n\t\tchildren = [],\n\t\telementLayout = {},\n\t\tlayoutRole,\n\t\tparentId\n\t) => {\n\t\tconst processedElements = children.map((element) => {\n\t\t\tconst { children, id, layout = {} } = element;\n\t\t\tconst layoutType = get(layout, `${layoutRole}.type`, null);\n\t\t\tconst process = get(handlersByType, layoutType, handlersByType.default)()\n\t\t\t\t.processChildren;\n\t\t\tconst nodeType = ELEMENT_TYPE;\n\t\t\tconst slots = getWithNullDefault(\n\t\t\t\tnormalizeRowColumnSlots(layout),\n\t\t\t\t`${layoutRole}.items`,\n\t\t\t\t[]\n\t\t\t);\n\t\t\tconst type = [children, slots].some((arr) => arr.length > 0)\n\t\t\t\t? CONTAINER_TYPE\n\t\t\t\t: LEAF_TYPE;\n\n\t\t\treturn createNode({\n\t\t\t\tchildren: process(\n\t\t\t\t\tchildren,\n\t\t\t\t\tget(layout, `${layoutRole}`, {}) || {},\n\t\t\t\t\tlayoutRole,\n\t\t\t\t\tid\n\t\t\t\t),\n\t\t\t\tid,\n\t\t\t\ttype,\n\t\t\t\tnodeType,\n\t\t\t\tlayoutType: elementLayout.type,\n\t\t\t\tslotName: get(element, 'slot.name')\n\t\t\t});\n\t\t});\n\n\t\treturn processLayoutTree(elementLayout, processedElements, parentId).filter(\n\t\t\t(node) => node\n\t\t);\n\t};\n\treturn { processChildren };\n}\n\nconst mergeTrees = (rootElement, layoutRole) => {\n\tconst { children, id, layout } = rootElement;\n\tconst layoutType = get(layout, `${layoutRole}.type`, null);\n\tconst processChildren = get(\n\t\thandlersByType,\n\t\tlayoutType,\n\t\thandlersByType.default\n\t)().processChildren;\n\treturn createNode({\n\t\tchildren: processChildren(\n\t\t\tchildren,\n\t\t\tget(layout, `${layoutRole}`, {}),\n\t\t\tlayoutRole,\n\t\t\tid\n\t\t),\n\t\tid,\n\t\tnodeType: ELEMENT_TYPE,\n\t\tlayoutType,\n\t\ttype: CONTAINER_TYPE\n\t});\n};\n\nexport {\n\tLAYOUT_TYPE,\n\tELEMENT_TYPE,\n\tCONTAINER_TYPE,\n\tLEAF_TYPE,\n\tROW_TYPE,\n\tCOLUMN_TYPE\n};\n\nexport default class PageTreeModel {\n\tstatic attributes = {\n\t\troot: {\n\t\t\tdefault: {}\n\t\t}\n\t};\n\t// the role is being passed so we can soon support different layouts (breakpoints, etc) for the same page.\n\tconstructor({ rootElement, layoutRole = 'default' }) {\n\t\tthis.root = mergeTrees(rootElement, layoutRole);\n\t}\n}\n","export const COMPONENT_LIST_REQUESTED = 'SN_UXF#COMPONENT_LIST_REQUESTED';\nexport const COMPONENT_LIST_ALL_REQUESTED =\n\t'SN_UXF#COMPONENT_LIST_ALL_REQUESTED';\nexport const COMPONENT_LIST_TYPE_REQUESTED =\n\t'SN_UXF#COMPONENT_LIST_TYPE_REQUESTED';\nexport const COMPONENT_LIST_REQUEST_STARTED =\n\t'SN_UXF#COMPONENT_LIST_REQUEST_STARTED';\nexport const COMPONENT_LIST_REQUEST_FAILED =\n\t'SN_UXF#COMPONENT_LIST_REQUEST_FAILED';\nexport const COMPONENT_LIST_REQUEST_SUCCEEDED =\n\t'SN_UXF#COMPONENT_LIST_REQUEST_SUCCEEDED';\n","import Model from './model';\n\nexport default class Action extends Model {\n\tconstructor({ name = '', type = 'String' }) {\n\t\tsuper();\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t}\n}\n","import Model from './model';\n\nexport default class ClientScript extends Model {\n\tconstructor({\n\t\tid = '', //string\n\t\tname = '', // string,\n\t\tscript = '', // string\n\t\tscope = null, // string\n\t\tincludes = [] // array\n\t}) {\n\t\tsuper();\n\t\tthis.id = id;\n\t\tthis.name = name;\n\t\tthis.script = script;\n\t\tthis.includes = includes;\n\t\tthis.scope = scope;\n\t}\n}\n","import Model from './model';\n\nexport default class ClientStateParameter extends Model {\n\tconstructor({\n\t\tid = '', //string\n\t\tname = '', // string,\n\t\ttype = '', // string\n\t\tinitialValue = null // any\n\t}) {\n\t\tsuper();\n\t\tthis.id = id;\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.initialValue = initialValue;\n\t}\n}\n","import Model from './model';\nimport Property from './property';\nimport seismicifyIds from './utils/seismicifyIds';\nimport { removePrefixes } from '../factories/util';\nexport default class DataBrokerInstance extends Model {\n\tconstructor({\n\t\tid = '',\n\t\tdefinition = {},\n\t\tinstanceName = '',\n\t\tproperties = {},\n\t\tselectableProps = '',\n\t\thydrationSysId = null,\n\t\tclientStateDataBrokerTagName = '',\n\t\teventMappings = [],\n\t\toutputProperties = {},\n\t\tdispatchedEvents = [],\n\t\treadEvaluationMode = 'EAGER'\n\t} = {}) {\n\t\tsuper();\n\t\tthis.id = id;\n\t\tthis.definition = definition;\n\t\tthis.instanceName = instanceName;\n\t\tthis.properties = this._setNewProperties(properties);\n\t\tthis.selectableProps = selectableProps;\n\t\tthis.simpleMutationBroker = !hydrationSysId;\n\t\tthis.clientStateDataBrokerTagName = clientStateDataBrokerTagName;\n\t\tthis.eventMappings = eventMappings;\n\t\tthis.outputProperties = this._setNewProperties(outputProperties);\n\t\tthis.dispatchedEvents = dispatchedEvents;\n\t\tthis.readEvaluationMode = readEvaluationMode;\n\t}\n\n\t_setNewProperties(properties) {\n\t\tif (!properties) {\n\t\t\treturn null;\n\t\t} else if (\n\t\t\tObject.entries(properties).every((entry) => entry[1] instanceof Property)\n\t\t) {\n\t\t\treturn properties;\n\t\t}\n\t\treturn Object.entries(properties).reduce((acc, [name, property]) => {\n\t\t\tacc[name] = new Property(property);\n\t\t\treturn acc;\n\t\t}, {});\n\t}\n\n\t_highestMatchingIdIndex(definitionName, allIds) {\n\t\tconst targetName = seismicifyIds(definitionName);\n\t\tlet highest = 0;\n\t\tallIds.forEach((id) => {\n\t\t\tconst matcher = id.match(new RegExp(`^${targetName}\\\\_(\\\\d+)*$`));\n\t\t\tif (matcher) {\n\t\t\t\tconst index = Number(matcher[1]);\n\t\t\t\thighest = index > highest ? index : highest;\n\t\t\t}\n\t\t});\n\t\treturn highest;\n\t}\n\n\tinitialize(definitionName, allIds) {\n\t\tconst highestMatchingInstanceIndex = this._highestMatchingIdIndex(\n\t\t\tdefinitionName,\n\t\t\tallIds\n\t\t);\n\t\t// Remove translation prefixes from the definition name.\n\t\tconst rootName = removePrefixes(definitionName || '') || '';\n\t\t// Lower case the ID and remove characters other than alphanumeric, -, and _ to make it seismic-safe\n\t\tconst targetName = seismicifyIds(rootName);\n\t\tthis.id =\n\t\t\thighestMatchingInstanceIndex > 0\n\t\t\t\t? `${targetName}_${(highestMatchingInstanceIndex + 1).toString()}`\n\t\t\t\t: `${targetName}_1`;\n\t\tthis.instanceName =\n\t\t\thighestMatchingInstanceIndex > 0\n\t\t\t\t? `${rootName} ${(highestMatchingInstanceIndex + 1).toString()}`\n\t\t\t\t: `${rootName} 1`;\n\t}\n}\n","import Model from './model';\n\nexport default class ElementEvent extends Model {\n\tconstructor({\n\t\tid = '', // string\n\t\teventName = '', // string\n\t\tlabel = '', // string\n\t\tpayloadShape = [], // Array\n\t\tapiName = '' // string\n\t}) {\n\t\tsuper();\n\t\tthis.id = id;\n\t\tthis.eventName = eventName;\n\t\tthis.label = label || this.eventName;\n\t\tthis.payloadShape = payloadShape;\n\t\tthis.apiName = apiName;\n\t}\n}\n","import Model from './model';\nexport default class EventHandler extends Model {\n\tconstructor({\n\t\tid = '', // string\n\t\tapiName = '', // string\n\t\tlabel = '', // string\n\t\ttype = '', // string\n\t\tsourceName = '', // string\n\t\tsourceId = '', // string\n\t\tname = '', // string\n\t\tpayloadFields = [], // array\n\t\tancestor = false, // boolean\n\t\trelay = false // boolean\n\t}) {\n\t\tsuper();\n\t\tthis.id = id;\n\t\tthis.apiName = apiName;\n\t\tthis.label = label;\n\t\tthis.type = type;\n\t\tthis.sourceName = sourceName;\n\t\tthis.sourceId = sourceId || id;\n\t\tthis.name = name;\n\t\tthis.payloadFields = payloadFields;\n\t\tthis.ancestor = ancestor;\n\t\tthis.relay = relay;\n\t}\n}\n","import Model from './model';\nimport { seismicCuid } from '../utils';\n\nexport default class EventMappingTarget extends Model {\n\tconstructor({\n\t\ttargetId = '', // string\n\t\ttype = '', // string\n\t\tdeclarativeAction = null, // object\n\t\tevent = null, // object\n\t\toperation = null, // object\n\t\tclientScript = null,\n\t\tclientTransformScript = null // string\n\t}) {\n\t\tsuper();\n\t\tthis.targetId = targetId || seismicCuid();\n\t\tthis.type = type;\n\t\tthis.declarativeAction = declarativeAction;\n\t\tthis.event = event;\n\t\tthis.operation = operation;\n\t\tthis.clientScript = clientScript;\n\t\tthis.clientTransformScript = clientTransformScript;\n\t}\n}\n","import { seismicCuid } from '../utils.js';\n\n/**\n * @typedef {Object} MacroponentProperty\n * @property {string} id\n * @property {string} name\n * @property {string} label\n * @property {string} fieldType\n * @property {string} typeMetadata\n * @property {string} valueType\n * @property {string} shape\n * @property {boolean} mandatory\n * @property {string} defaultValue\n * @property {string} description\n * @property {boolean} readOnly\n * @property {boolean} selectable\n * @property {boolean} inherited Whether this property comes from a macroponent that is extended by this macroponent.\n *                               This property can not be deleted or have it's name changed.\n * @property {string} value\n * @property {string} testValue\n */\n\n/**\n * @description Provides reasonable defaults when constructing a macroponent property\n * @param {MacroponentProperty} config\n * @returns {MacroponentProperty}\n */\nexport const create = ({\n\tid = seismicCuid(),\n\tname = '',\n\tlabel,\n\tfieldType = 'string',\n\ttypeMetadata,\n\tvalueType = 'string',\n\tshape,\n\tmandatory = false,\n\tdefaultValue,\n\tdescription = '',\n\treadOnly = false,\n\tselectable = false,\n\tinherited = false,\n\tvalue,\n\ttestValue\n} = {}) => ({\n\tid,\n\tname: name,\n\tlabel: label === undefined ? name : label,\n\tfieldType,\n\ttypeMetadata,\n\tvalueType,\n\tshape,\n\tmandatory,\n\tdefaultValue,\n\tdescription,\n\treadOnly,\n\tselectable,\n\tinherited,\n\tvalue,\n\ttestValue\n});\n\n/**\n * @description Provides reasonable defaults when constructing a macroponent property\n * @param {MacroponentProperty} newInstance\n * @param {MacroponentProperty} old\n * @returns {MacroponentProperty}\n */\nexport const update = (newInstance, old) => ({\n\t...old,\n\t...newInstance\n});\n\nexport default {\n\tcreate,\n\tupdate\n};\n","/* eslint eqeqeq: \"off\" */\n\nexport default class BaseModel {\n\tconstructor(initialValues = {}) {\n\t\tconst { attributes } = this;\n\n\t\tfor (const attr in attributes) {\n\t\t\tif (this[attr] == null) {\n\t\t\t\tconst value = initialValues[attr];\n\t\t\t\tthis[attr] = value == null ? attributes[attr].default : value;\n\t\t\t}\n\t\t}\n\t}\n\n\tget attributes() {\n\t\treturn this.constructor.attributes;\n\t}\n}\n","import { JSON_LITERAL } from './constants';\nimport isUndefined from 'lodash/isUndefined';\n\nexport default function JSONLiteralFactory({\n\tmodel, // object\n\tshorthand // any\n} = {}) {\n\tif (isUndefined(shorthand) && !model) {\n\t\tthrow new TypeError('Something went wrong initializing JSONLiteralFactory');\n\t}\n\n\t// PRIVATE PROPERTIES\n\tconst fType = JSON_LITERAL;\n\tconst fShorthand = !isUndefined(shorthand)\n\t\t? shorthand\n\t\t: getShorthandFromModel(model);\n\tconst fModel = model || getModelFromShorthand(shorthand);\n\n\tfunction getShorthandFromModel(model) {\n\t\treturn model.value;\n\t}\n\n\tfunction getModelFromShorthand(shorthand) {\n\t\treturn {\n\t\t\ttype: fType,\n\t\t\tvalue: shorthand\n\t\t};\n\t}\n\n\t// PUBLIC API\n\treturn {\n\t\tgetShorthand() {\n\t\t\treturn fShorthand;\n\t\t},\n\n\t\tgetModel() {\n\t\t\treturn fModel;\n\t\t}\n\t};\n}\n","import { LIST_CONTAINER } from './constants';\nimport { getUxValueFromShorthand, getShorthandFromUxValue } from '.';\n\nexport default function ListContainerFactory({\n\tshorthand = null, // object\n\tmodel = null, // object\n\tschema\n} = {}) {\n\tif ((!shorthand && !model) || (shorthand && !Array.isArray(shorthand))) {\n\t\tthrow new TypeError(\n\t\t\t'Something went wrong initializing ListContainerFactory'\n\t\t);\n\t}\n\n\t// PRIVATE PROPERTIES\n\tconst fType = LIST_CONTAINER;\n\tconst fSchema = schema;\n\tconst fShorthand = shorthand || getShorthandFromModel(model);\n\tconst fModel = model || getModelFromShorthand(shorthand);\n\n\tfunction getShorthandFromModel(model) {\n\t\treturn model.container.map((element) => {\n\t\t\treturn getShorthandFromUxValue(element);\n\t\t});\n\t}\n\n\tfunction getModelFromShorthand(shorthand) {\n\t\treturn {\n\t\t\ttype: fType,\n\t\t\tcontainer: shorthand.map((element) => {\n\t\t\t\treturn getUxValueFromShorthand(element, fSchema);\n\t\t\t})\n\t\t};\n\t}\n\n\t// PUBLIC API\n\treturn {\n\t\tgetModel() {\n\t\t\treturn fModel;\n\t\t},\n\n\t\tgetShorthand() {\n\t\t\treturn fShorthand;\n\t\t}\n\t};\n}\n","import { MAP_CONTAINER } from './constants';\nimport { translateKeys, extractTranslatablePaths } from './util';\nimport { getUxValueFromShorthand, getShorthandFromUxValue } from '.';\n\nexport default function MapContainerFactory({\n\tshorthand = null, // object\n\tmodel = null, // object\n\tschema\n} = {}) {\n\tif (\n\t\t(!shorthand && !model) ||\n\t\t(shorthand && (typeof shorthand !== 'object' || Array.isArray(shorthand)))\n\t) {\n\t\tthrow new TypeError(\n\t\t\t'Something went wrong initializing MapContainerFactory'\n\t\t);\n\t}\n\n\t// PRIVATE PROPERTIES\n\tconst fType = MAP_CONTAINER;\n\tconst translatablePaths = schema ? extractTranslatablePaths(schema) : [];\n\tconst fShorthand = shorthand || getShorthandFromModel(model);\n\tconst fModel = model || getModelFromShorthand(shorthand);\n\n\tfunction getModelFromShorthand(shorthand) {\n\t\tshorthand = translateKeys(shorthand, translatablePaths);\n\t\treturn {\n\t\t\ttype: fType,\n\t\t\tcontainer: {\n\t\t\t\t...Object.entries(shorthand).reduce((acc, [key, value]) => {\n\t\t\t\t\tschema = typeof value === 'object' ? schema : null;\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...acc,\n\t\t\t\t\t\t[key]: getUxValueFromShorthand(value, schema)\n\t\t\t\t\t};\n\t\t\t\t}, {})\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction getShorthandFromModel(model) {\n\t\treturn Object.entries(model.container).reduce((acc, [key, value]) => {\n\t\t\treturn {\n\t\t\t\t...acc,\n\t\t\t\t[key]: getShorthandFromUxValue(value)\n\t\t\t};\n\t\t}, {});\n\t}\n\n\t// PUBLIC API\n\treturn {\n\t\tgetShorthand() {\n\t\t\treturn fShorthand;\n\t\t},\n\n\t\tgetModel() {\n\t\t\treturn fModel;\n\t\t}\n\t};\n}\n","import { CLIENT_TRANSFORM_SCRIPT, SCRIPT_SHORTHAND_PATTERN } from './constants';\nimport isUndefined from 'lodash/isUndefined';\n\nexport default function ClientTransformScriptFactory({\n\tmodel,\n\tshorthand\n} = {}) {\n\tif (!shorthand && !model) {\n\t\tthrow new TypeError(\n\t\t\t'Something went wrong initializing ClientTransformScriptFactory'\n\t\t);\n\t}\n\n\t// PRIVATE PROPERTIES\n\tconst fType = CLIENT_TRANSFORM_SCRIPT;\n\tconst fShorthand = !isUndefined(shorthand)\n\t\t? shorthand\n\t\t: getShorthandFromModel(model);\n\tconst fModel = model || getModelFromShorthand(shorthand);\n\n\tfunction getShorthandFromModel(model) {\n\t\treturn `javascript(${model.script.inlineScript})${\n\t\t\tmodel.script.apiVersion === '2.0.0' ? '!' : ''\n\t\t}`;\n\t}\n\n\tfunction getModelFromShorthand(shorthand) {\n\t\tconst scriptMatcher = shorthand.match(SCRIPT_SHORTHAND_PATTERN);\n\t\tlet resolvedScript = '',\n\t\t\tapiVersion = '1.0.0';\n\t\tif (scriptMatcher) {\n\t\t\tresolvedScript = scriptMatcher[1];\n\t\t\tapiVersion = scriptMatcher[2] ? '2.0.0' : '1.0.0';\n\t\t}\n\t\treturn {\n\t\t\ttype: fType,\n\t\t\tscript: {\n\t\t\t\tapiVersion,\n\t\t\t\tinlineScript: resolvedScript\n\t\t\t}\n\t\t};\n\t}\n\n\t// PUBLIC API\n\treturn {\n\t\tgetShorthand() {\n\t\t\treturn fShorthand;\n\t\t},\n\n\t\tgetModel() {\n\t\t\treturn fModel;\n\t\t}\n\t};\n}\n","import ClientTransformScriptFactory from './client-transform-script';\nimport { SCRIPT_SHORTHAND_PATTERN, CLIENT_TRANSFORM_SCRIPT } from './constants';\nimport { processLinting } from '../utils';\n\nexport default async function VersionedClientTransformScriptFactory({\n\tmodel,\n\tshorthand\n} = {}) {\n\tif (!shorthand && !model) {\n\t\tthrow new TypeError(\n\t\t\t'Something went wrong initializing ClientTransformScriptFactory'\n\t\t);\n\t}\n\n\tconst { getShorthand } = ClientTransformScriptFactory({\n\t\tmodel,\n\t\tshorthand\n\t});\n\n\tconst scriptMatcher = getShorthand().match(SCRIPT_SHORTHAND_PATTERN);\n\tconst scriptToLint = scriptMatcher ? scriptMatcher[1] : '';\n\tconst isCompatibilityMode = !(scriptMatcher && scriptMatcher[2]);\n\tconst errors = (await processLinting([scriptToLint]))[0];\n\tconst fModel = {\n\t\ttype: CLIENT_TRANSFORM_SCRIPT,\n\t\tscript: {\n\t\t\tinlineScript: scriptToLint\n\t\t}\n\t};\n\n\tif (errors.length && isCompatibilityMode) {\n\t\tfModel.script.apiVersion = '1.0.0';\n\t} else {\n\t\tfModel.script.apiVersion = '2.0.0';\n\t}\n\n\treturn {\n\t\tgetModel() {\n\t\t\treturn fModel;\n\t\t},\n\t\tgetShorthand\n\t};\n}\n","import isUndefined from 'lodash/isUndefined';\nimport get from 'lodash/get';\nimport { TRANSLATION_LITERAL, TRANSLATE_SHORTHAND_PATTERN } from './constants';\nimport { removePrefixes } from './util';\n\nexport default function TranslationLiteralFactory({\n\tmodel, // object\n\tshorthand // any\n} = {}) {\n\tif (isUndefined(shorthand) && !model) {\n\t\tthrow new TypeError(\n\t\t\t'Something went wrong initializing TranslationLiteralFactory'\n\t\t);\n\t}\n\n\tconst fShorthand = shorthand || getShorthandFromModel(model);\n\tconst fModel = model || getModelFromShorthand(shorthand);\n\n\tfunction getShorthandFromModel(model) {\n\t\treturn removePrefixes(get(model, 'value.message', ''));\n\t}\n\n\tfunction getModelFromShorthand(shorthand) {\n\t\tlet message = '';\n\t\tif (typeof shorthand === 'string') {\n\t\t\tconst scriptMatcher = shorthand.match(TRANSLATE_SHORTHAND_PATTERN);\n\t\t\tmessage = scriptMatcher ? scriptMatcher[1] : shorthand;\n\t\t} else {\n\t\t\tmessage = get(shorthand, 'value', '');\n\t\t}\n\n\t\treturn {\n\t\t\ttype: TRANSLATION_LITERAL,\n\t\t\tvalue: {\n\t\t\t\tmessage: removePrefixes(message),\n\t\t\t\tcomment: ''\n\t\t\t}\n\t\t};\n\t}\n\n\t// PUBLIC API\n\treturn {\n\t\tgetShorthand() {\n\t\t\treturn fShorthand;\n\t\t},\n\n\t\tgetModel() {\n\t\t\treturn fModel;\n\t\t}\n\t};\n}\n","import isNull from 'lodash/isNull';\nimport reduce from 'lodash/reduce';\nimport get from 'lodash/get';\nimport { default as BindingFactory } from './binding';\nimport { default as JSONLiteralFactory } from './json-literal';\nimport { default as ListContainerFactory } from './list-container';\nimport { default as MapContainerFactory } from './map-container';\nimport { default as ClientTransformScriptFactory } from './client-transform-script';\nimport { default as VersionedClientTransformScriptFactory } from './versioned-client-transform-script';\nimport { default as TranslationLiteralFactory } from './translation-literal';\nimport { isSchemaTranslatable } from './util';\n\nimport {\n\tJSON_LITERAL,\n\tLIST_CONTAINER,\n\tMAP_CONTAINER,\n\tCLIENT_TRANSFORM_SCRIPT,\n\tVALID_BINDING_TYPES_ENUM,\n\tBINDING_SHORTHAND_PATTERN,\n\tSCRIPT_SHORTHAND_PATTERN,\n\tTRANSLATE_SHORTHAND_PATTERN,\n\tTRANSLATION_LITERAL\n} from './constants';\n\nfunction isValidBindingType(type, types = {}) {\n\treturn type in types;\n}\n\nfunction isValidClientTransformScriptType(type, validType) {\n\treturn type === validType;\n}\n\nfunction isValidContainerType(type, types = []) {\n\treturn types.indexOf(type) !== -1;\n}\n\nfunction isJSONLiteralType(type, jsonLiteralType) {\n\treturn type === jsonLiteralType;\n}\n\nfunction isTranslationLiteralType(type) {\n\treturn type === TRANSLATION_LITERAL;\n}\n\nfunction isValidBindingShorthand(str) {\n\treturn !!str.match(BINDING_SHORTHAND_PATTERN);\n}\n\nfunction isValidClientTransformScriptShortHand(str) {\n\treturn !!str.match(SCRIPT_SHORTHAND_PATTERN);\n}\n\nfunction isMapContainerShorthand(obj) {\n\treturn Object.values(obj).reduce((hasBinding, val) => {\n\t\tif (hasBinding) {\n\t\t\treturn true;\n\t\t}\n\t\tif (val === null) {\n\t\t\treturn false;\n\t\t}\n\t\tswitch (typeof val) {\n\t\t\tcase 'boolean':\n\t\t\tcase 'number':\n\t\t\tcase 'undefined':\n\t\t\t\treturn false;\n\t\t\tcase 'string':\n\t\t\t\tif (\n\t\t\t\t\tisValidBindingShorthand(val) ||\n\t\t\t\t\tisValidClientTransformScriptShortHand(val) ||\n\t\t\t\t\tval.match(TRANSLATE_SHORTHAND_PATTERN)\n\t\t\t\t) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\tcase 'object':\n\t\t\t\treturn isMapContainerShorthand(val);\n\t\t}\n\t}, false);\n}\n\nfunction isListContainerShorthand(arr) {\n\treturn arr.reduce((hasBinding, val) => {\n\t\tif (hasBinding) {\n\t\t\treturn true;\n\t\t}\n\t\tif (val === null) {\n\t\t\treturn false;\n\t\t}\n\t\tswitch (typeof val) {\n\t\t\tcase 'boolean':\n\t\t\tcase 'number':\n\t\t\tcase 'undefined':\n\t\t\t\treturn false;\n\t\t\tcase 'string':\n\t\t\t\tif (\n\t\t\t\t\tisValidBindingShorthand(val) ||\n\t\t\t\t\tisValidClientTransformScriptShortHand(val)\n\t\t\t\t) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\tcase 'object':\n\t\t\t\tif (Array.isArray(val)) {\n\t\t\t\t\treturn isListContainerShorthand(val);\n\t\t\t\t}\n\t\t\t\treturn isMapContainerShorthand(val);\n\t\t}\n\t}, false);\n}\n\nfunction isStringTranslatable(value, schema) {\n\tconst { type, translatable, oneOf } = schema || {};\n\tif (value.match(TRANSLATE_SHORTHAND_PATTERN)) {\n\t\treturn true;\n\t} else if (!isNull(type) && type === 'string' && translatable) {\n\t\treturn true;\n\t} else if (\n\t\treduce(\n\t\t\toneOf,\n\t\t\t(acc, val) =>\n\t\t\t\tget(val, 'type') === 'string' && get(val, 'translatable') ? true : acc,\n\t\t\tfalse\n\t\t)\n\t) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction getUxValueFactoryFromShorthand(value, schema) {\n\tconst isObject = typeof value === 'object' && !isNull(value);\n\tconst isArrayObject = isObject && Array.isArray(value);\n\tconst isTranslatableShorthand =\n\t\ttypeof value === 'string' && isStringTranslatable(value, schema);\n\tconst isBindingShorthand =\n\t\ttypeof value === 'string' && value.match(BINDING_SHORTHAND_PATTERN);\n\tconst isClientTransformScriptShorthand =\n\t\ttypeof value === 'string' && value.match(SCRIPT_SHORTHAND_PATTERN);\n\n\tif (isObject && schema && isSchemaTranslatable(schema)) {\n\t\treturn isArrayObject ? ListContainerFactory : MapContainerFactory;\n\t} else if (isArrayObject) {\n\t\treturn isListContainerShorthand(value)\n\t\t\t? ListContainerFactory\n\t\t\t: JSONLiteralFactory;\n\t} else if (isObject) {\n\t\treturn isTranslationLiteralType(value.type)\n\t\t\t? TranslationLiteralFactory\n\t\t\t: isMapContainerShorthand(value)\n\t\t\t? MapContainerFactory\n\t\t\t: JSONLiteralFactory;\n\t} else if (isBindingShorthand) {\n\t\treturn BindingFactory;\n\t} else if (isClientTransformScriptShorthand) {\n\t\treturn ClientTransformScriptFactory;\n\t} else if (isTranslatableShorthand) {\n\t\treturn TranslationLiteralFactory;\n\t} else {\n\t\treturn JSONLiteralFactory;\n\t}\n}\n\nfunction getUxValueFactoryFromType(type) {\n\tswitch (type) {\n\t\tcase JSON_LITERAL:\n\t\t\treturn JSONLiteralFactory;\n\t\tcase MAP_CONTAINER:\n\t\t\treturn MapContainerFactory;\n\t\tcase LIST_CONTAINER:\n\t\t\treturn ListContainerFactory;\n\t\tcase CLIENT_TRANSFORM_SCRIPT:\n\t\t\treturn ClientTransformScriptFactory;\n\t\tcase TRANSLATION_LITERAL:\n\t\t\treturn TranslationLiteralFactory;\n\t\tdefault:\n\t\t\tif (type in VALID_BINDING_TYPES_ENUM) {\n\t\t\t\treturn BindingFactory;\n\t\t\t} else {\n\t\t\t\tthrow new TypeError('invalid UXValue model supplied');\n\t\t\t}\n\t}\n}\n\nexport const isUxValueModel = (obj) => {\n\tif (typeof obj !== 'object' || obj === null || !obj.type) {\n\t\treturn false;\n\t}\n\treturn (\n\t\tisValidBindingType(obj.type, VALID_BINDING_TYPES_ENUM) ||\n\t\tisValidClientTransformScriptType(obj.type, CLIENT_TRANSFORM_SCRIPT) ||\n\t\tisValidContainerType(obj.type, [MAP_CONTAINER, LIST_CONTAINER]) ||\n\t\tisJSONLiteralType(obj.type, JSON_LITERAL) ||\n\t\tisTranslationLiteralType(obj.type)\n\t);\n};\n\nexport const getUxValueFromShorthand = (shorthand = null, schema = null) => {\n\tconst Factory = getUxValueFactoryFromShorthand(shorthand, schema);\n\treturn Factory({ shorthand, schema }).getModel();\n};\n\nexport const getVersionedUxValueFromShorthand = async (\n\tshorthand = null,\n\tschema = null\n) => {\n\tconst Factory = getUxValueFactoryFromShorthand(shorthand, schema);\n\tif (Factory.name === 'ClientTransformScriptFactory') {\n\t\tconst ScriptFactory = await VersionedClientTransformScriptFactory({\n\t\t\tshorthand,\n\t\t\tschema\n\t\t});\n\t\treturn ScriptFactory.getModel();\n\t}\n\treturn Factory({ shorthand, schema }).getModel();\n};\n\nexport const getShorthandFromUxValue = (model = null, schema = null) => {\n\tif (!model) {\n\t\treturn model;\n\t} else {\n\t\tconst Factory = getUxValueFactoryFromType(model.type);\n\t\treturn Factory({ model, schema }).getShorthand();\n\t}\n};\n","import { createTemplateLoader } from '@devsnc/library-uxf';\n\nconst { getTemplates, deleteCache } = createTemplateLoader({\n\taddTimestamp: true\n});\n\nexport { getTemplates, deleteCache as deleteTemplateCache };\n","import { Property } from '../../models';\nimport isNull from 'lodash/isNull';\nimport isNil from 'lodash/isNil';\n\nexport const defaultEmptyStateBehavior = {\n\tcondition_string: '',\n\tfield_list: '',\n\ttable_name: '',\n\tboolean: false,\n\tchoice: null,\n\tfield: '',\n\thtml: '',\n\tjson: null,\n\tnumber: null,\n\treference: '',\n\tstring: '',\n\ticon: ''\n};\n\n//convert UXF constants to JS types\nconst emptyStateBehaviorMap = {\n\tNULL: null,\n\tUNDEFINED: undefined,\n\tEMPTY_STRING: '',\n\tEMPTY_OBJ: {},\n\tEMPTY_ARRAY: []\n};\n\n/**\n * @typedef EmptyStateBehavior\n * @property {*} value\n */\n/**\n * converts UXF constants to JS types if any are supplied, otherwise uses defaults for empty state behavior\n * @param {string} emptyStateBehavior\n * @param {string} type\n * @return {EmptyStateBehavior}\n */\nconst getEmptyStateBehavior = (emptyStateBehavior, type) => {\n\tconst emptyStateValue =\n\t\t!isNil(emptyStateBehavior) &&\n\t\temptyStateBehaviorMap.hasOwnProperty(emptyStateBehavior)\n\t\t\t? emptyStateBehaviorMap[emptyStateBehavior]\n\t\t\t: defaultEmptyStateBehavior[type];\n\n\treturn { value: emptyStateValue };\n};\n\nexport function getProperty({\n\tlabel,\n\tfieldType: type,\n\tdefaultValue,\n\tname: columnName,\n\treadOnly,\n\torder,\n\ttypeMetadata = {},\n\tinterfaceApiName,\n\tselectable = false,\n\tdescription = ''\n}) {\n\tconst typeMetadataObj =\n\t\tisNull(typeMetadata) || typeof typeMetadata !== 'object'\n\t\t\t? {}\n\t\t\t: typeMetadata;\n\n\tconst {\n\t\tchoices = [],\n\t\treference = null,\n\t\treferenceFilter = null,\n\t\ttable = null,\n\t\temptyStateBehavior = null,\n\t\tvariant = null,\n\t\ttranslatable = false,\n\t\tschema\n\t} = typeMetadataObj;\n\n\t// handle the casting of string true/false to boolean true/false\n\tconst processedDefaultValue =\n\t\ttype === 'True/False' ? defaultValue === 'true' : defaultValue;\n\n\treturn new Property({\n\t\tname: columnName,\n\t\tchoices,\n\t\tcolumnName,\n\t\tlabel,\n\t\ttable,\n\t\ttype,\n\t\tvalue: processedDefaultValue,\n\t\treference,\n\t\treferenceFilter,\n\t\treadOnly,\n\t\torder,\n\t\tinterfaceApiName,\n\t\temptyStateBehavior: getEmptyStateBehavior(emptyStateBehavior, type),\n\t\tselectable,\n\t\tdescription,\n\t\tdefaultValue,\n\t\tvariant,\n\t\ttranslatable,\n\t\tschema\n\t});\n}\n","export const DECLARATIVE_ACTION = 'DECLARATIVE_ACTION';\nexport const EVENT = 'EVENT';\nexport const DATABROKER_OP = 'DATABROKER_OP';\nexport const CLIENT_SCRIPT = 'CLIENT_SCRIPT';\nexport const PROPERTY_KEY_MAP = {\n\t[DECLARATIVE_ACTION]: 'name',\n\t[EVENT]: 'name',\n\t[DATABROKER_OP]: 'name'\n};\n","import { t } from 'sn-translate';\nimport { ElementEvent } from '../../models';\n\nexport const PAGE_STATUS_ACTIVE = 'active';\nexport const PAGE_STATUS_INACTIVE = 'inactive';\n\nexport const ROOT_MACROPONENT_SOURCE_EVENTS = [\n\tnew ElementEvent({\n\t\tid: 'MACROPONENT_READY',\n\t\teventName: 'MACROPONENT_READY',\n\t\tlabel: t('Page ready'),\n\t\tpayloadShape: [],\n\t\tapiName: 'MACROPONENT_READY'\n\t}),\n\tnew ElementEvent({\n\t\tid: 'MACROPONENT_PROPERTY_CHANGED',\n\t\teventName: 'MACROPONENT_PROPERTY_CHANGED',\n\t\tlabel: t('Page property changed'),\n\t\tpayloadShape: [],\n\t\tapiName: 'MACROPONENT_PROPERTY_CHANGED'\n\t})\n];\n","import {\n\tDECLARATIVE_ACTION,\n\tEVENT,\n\tDATABROKER_OP,\n\tCLIENT_SCRIPT\n} from '../../elementEventMappings/constants';\nimport { isUxValueModel, getShorthandFromUxValue } from '../../../factories';\nimport cloneDeep from 'lodash/cloneDeep';\nimport isNull from 'lodash/isNull';\nimport get from 'lodash/get';\nimport { getProperty } from '../../componentList/utils';\nimport EventMappingTarget from '../../../models/eventMappingTarget';\nimport EventMapping from '../../../models/eventMapping';\n\nexport const computeEventMappingTargetKeys = (type) => {\n\tconst isDeclarativeAction = type === DECLARATIVE_ACTION;\n\tconst isEvent = type === EVENT;\n\tconst isDataBrokerOp = type === DATABROKER_OP;\n\tconst isClientScript = type === CLIENT_SCRIPT;\n\treturn (\n\t\t(isDeclarativeAction && {\n\t\t\ttargetKey: 'declarativeAction',\n\t\t\tvalueKey: 'actionValues',\n\t\t\tidKey: 'sysId',\n\t\t\tnonTargetKeys: ['event', 'operation', 'clientScript']\n\t\t}) ||\n\t\t(isEvent && {\n\t\t\ttargetKey: 'event',\n\t\t\tvalueKey: 'payload',\n\t\t\tidKey: 'sysId',\n\t\t\tnonTargetKeys: ['declarativeAction', 'operation', 'clientScript']\n\t\t}) ||\n\t\t(isDataBrokerOp && {\n\t\t\ttargetKey: 'operation',\n\t\t\tvalueKey: 'payload',\n\t\t\tidKey: 'dataBrokerId',\n\t\t\tnonTargetKeys: ['declarativeAction', 'event', 'clientScript']\n\t\t}) ||\n\t\t(isClientScript && {\n\t\t\ttargetKey: 'clientScript',\n\t\t\tvalueKey: 'payload',\n\t\t\tidKey: 'sysId',\n\t\t\tnonTargetKeys: ['declarativeAction', 'event', 'operation']\n\t\t}) || {\n\t\t\ttargetKey: null,\n\t\t\tvalueKey: null,\n\t\t\tidKey: null,\n\t\t\tnonTargetKeys: []\n\t\t}\n\t);\n};\n\nexport const coercePropertyValueToShorthand = (value, type) => {\n\tconst shorthand = isUxValueModel(value)\n\t\t? getShorthandFromUxValue(value)\n\t\t: value;\n\n\tconst updatedValue =\n\t\ttype === 'json' && typeof shorthand === 'object' && !isNull(shorthand)\n\t\t\t? JSON.stringify(shorthand)\n\t\t\t: shorthand;\n\n\treturn updatedValue;\n};\n\nexport const getPayloadPropertiesFromHandlerDefinition = (\n\teventMappingTargetValues,\n\thandlerTypeId,\n\teventHandlers\n) => {\n\tconst [eventMappingTargetSysId, sourceId, operationName] = (\n\t\thandlerTypeId || ''\n\t).split(':');\n\tlet matchingEventHandler;\n\tif (operationName) {\n\t\tmatchingEventHandler = eventHandlers.find(\n\t\t\t(handler) =>\n\t\t\t\thandler.id === eventMappingTargetSysId &&\n\t\t\t\thandler.sourceId === sourceId &&\n\t\t\t\thandler.name === operationName\n\t\t);\n\t} else {\n\t\tmatchingEventHandler = eventHandlers.find(\n\t\t\t(handler) => handler.id === eventMappingTargetSysId\n\t\t);\n\t}\n\n\tif (matchingEventHandler) {\n\t\tconst matchingEventHandlerPayloadFields =\n\t\t\t// get payload fields from either an EVENT or DECLARATIVE_ACTION\n\t\t\tmatchingEventHandler.payloadFields ||\n\t\t\tget(matchingEventHandler, 'payloadDefinition.fields', []);\n\n\t\treturn matchingEventHandlerPayloadFields.map(\n\t\t\t({ name, columnName, label, interfaceApiName, type, typeMetadata }) => {\n\t\t\t\tconst value = coercePropertyValueToShorthand(\n\t\t\t\t\teventMappingTargetValues[name || columnName] || null,\n\t\t\t\t\ttype\n\t\t\t\t);\n\n\t\t\t\treturn getProperty({\n\t\t\t\t\tlabel,\n\t\t\t\t\tfieldType: type,\n\t\t\t\t\tdefaultValue: value,\n\t\t\t\t\tname: name || columnName,\n\t\t\t\t\treadOnly: false,\n\t\t\t\t\ttypeMetadata: typeMetadata,\n\t\t\t\t\tinterfaceApiName: interfaceApiName,\n\t\t\t\t\temptyStateBehavior: typeMetadata && typeMetadata.emptyStateBehavior\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n\n\treturn [];\n};\n\nexport const getTransformedEventTarget = (\n\ttarget,\n\teventHandlers,\n\tscreenEventMappings = []\n) => {\n\tconst { targetId, type } = target;\n\tconst { targetKey, valueKey, idKey } = computeEventMappingTargetKeys(type);\n\n\tlet eventMappingTargetSysId = get(target, `${targetKey}.${idKey}`, null);\n\tlet eventMappingTargetApiName = get(target, 'event.apiName', null);\n\tif (eventMappingTargetSysId === null && eventMappingTargetApiName) {\n\t\tconst targetEventHandler = eventHandlers.find(\n\t\t\t(handler) => handler.apiName === eventMappingTargetApiName\n\t\t);\n\t\tif (targetEventHandler) {\n\t\t\teventMappingTargetSysId = targetEventHandler.id;\n\t\t}\n\t}\n\n\tconst relayMapping = screenEventMappings.find(\n\t\t(mapping) => mapping.eventApiName === eventMappingTargetApiName\n\t);\n\tlet convertToDataBrokerOp = false;\n\tif (type === EVENT && relayMapping) {\n\t\t// if the handler is a relay event, convert it to display the ancestor handler in the UI\n\t\tconst ancestorType = get(relayMapping, 'targets[0].type', EVENT);\n\t\tif (ancestorType === EVENT) {\n\t\t\teventMappingTargetSysId = get(\n\t\t\t\trelayMapping,\n\t\t\t\t'targets[0].event.sysId',\n\t\t\t\tnull\n\t\t\t);\n\t\t\teventMappingTargetApiName = get(\n\t\t\t\trelayMapping,\n\t\t\t\t'targets[0].event.apiName',\n\t\t\t\tnull\n\t\t\t);\n\t\t} else if (ancestorType === DATABROKER_OP) {\n\t\t\tconvertToDataBrokerOp = true;\n\t\t}\n\t}\n\tconst eventMappingTargetValues =\n\t\tget(target, `${targetKey}.${valueKey}.container`, null) ||\n\t\tget(target, `${targetKey}.${valueKey}.value`, {});\n\n\tconst eventMappingTargetScript = get(\n\t\ttarget,\n\t\t`${targetKey}.${valueKey}.script`,\n\t\tnull\n\t);\n\n\tconst handlerTypeId = target.operation\n\t\t? `${eventMappingTargetSysId}:${target.operation.parentResourceId}:${target.operation.operationName}`\n\t\t: eventMappingTargetSysId;\n\tconst eventMappingTargetProperties = getPayloadPropertiesFromHandlerDefinition(\n\t\teventMappingTargetValues,\n\t\thandlerTypeId,\n\t\teventHandlers\n\t);\n\n\tlet clientTransformScript = null;\n\tif (eventMappingTargetScript) {\n\t\tclientTransformScript = getShorthandFromUxValue(\n\t\t\ttarget[targetKey][valueKey]\n\t\t);\n\t}\n\tconst newEventMappingTarget = new EventMappingTarget({\n\t\ttargetId,\n\t\ttype,\n\t\tclientTransformScript,\n\t\t[targetKey]: {\n\t\t\t[idKey]: eventMappingTargetSysId,\n\t\t\t[valueKey]: eventMappingTargetProperties\n\t\t}\n\t});\n\n\tif (newEventMappingTarget.type === EVENT) {\n\t\tnewEventMappingTarget[targetKey].apiName = eventMappingTargetApiName;\n\t}\n\n\tif (type === DATABROKER_OP) {\n\t\tnewEventMappingTarget[targetKey].operationName =\n\t\t\ttarget.operation.operationName;\n\t\tnewEventMappingTarget[targetKey].parentResourceId =\n\t\t\ttarget.operation.parentResourceId;\n\t}\n\n\tif (convertToDataBrokerOp) {\n\t\t// if the handler is a relay event to a data broker operation, convert it\n\t\t// to display the ancestor handler in the UI and conserve the configured payload fields\n\t\tnewEventMappingTarget.type = DATABROKER_OP;\n\t\tconst relayOperation = get(relayMapping, 'targets[0].operation', {});\n\t\tnewEventMappingTarget.operation = cloneDeep(relayOperation);\n\t\tconst handlerTypeId = `${relayOperation.dataBrokerId}:${relayOperation.parentResourceId}:${relayOperation.operationName}`;\n\t\tconst convertedEventMappingTargetProperties = getPayloadPropertiesFromHandlerDefinition(\n\t\t\teventMappingTargetValues,\n\t\t\thandlerTypeId,\n\t\t\teventHandlers\n\t\t);\n\t\tnewEventMappingTarget.operation.payload = convertedEventMappingTargetProperties;\n\t\tnewEventMappingTarget.event = null;\n\t}\n\n\treturn newEventMappingTarget;\n};\n\nexport const generateEventMappings = (\n\teventMappings = [],\n\teventHandlers,\n\tdispatchedEvents,\n\tscreenEventMappings = []\n) => {\n\treturn eventMappings.map((eventMapping) => {\n\t\tconst eventMappingTargets = get(eventMapping, 'targets', []);\n\t\tconst eventApiName = eventMapping.sourceEventApiName;\n\t\tconst eventId = dispatchedEvents.reduce((acc, event) => {\n\t\t\tif (event.apiName === eventApiName) {\n\t\t\t\treturn event.id;\n\t\t\t}\n\t\t\treturn acc;\n\t\t}, null);\n\n\t\tconst transformedTargets = eventMappingTargets.map((target) => {\n\t\t\treturn getTransformedEventTarget(\n\t\t\t\ttarget,\n\t\t\t\teventHandlers,\n\t\t\t\tscreenEventMappings\n\t\t\t);\n\t\t});\n\n\t\treturn new EventMapping({\n\t\t\t...eventMapping,\n\t\t\teventId,\n\t\t\teventApiName,\n\t\t\ttargets: transformedTargets\n\t\t});\n\t});\n};\n\nexport const replacePropValuesWithNewId = (\n\tproperties,\n\tkey,\n\tnamespace,\n\tpreviousId,\n\tnewId\n) => {\n\t(properties || []).map((prop = {}) => {\n\t\tif (\n\t\t\ttypeof prop[key] === 'string' &&\n\t\t\tprop[key].startsWith(`${namespace}.${previousId}`)\n\t\t) {\n\t\t\tprop[key] = prop[key].replace(\n\t\t\t\t`${namespace}.${previousId}`,\n\t\t\t\t`${namespace}.${newId}`\n\t\t\t);\n\t\t}\n\t});\n};\n\nexport const removePropertyReferencesToPreviousId = (\n\tpreviousId,\n\tnewId,\n\telements = [],\n\tdataBrokers = [],\n\tstateParams = [],\n\tnamespace\n) => {\n\t// if a data broker instance or element ID is changed, check to see whether any\n\t// existing element properties reference the old ID through binding expressions.\n\telements.map(({ properties = {} }) => {\n\t\treplacePropValuesWithNewId(\n\t\t\tObject.values(properties),\n\t\t\t'value',\n\t\t\tnamespace,\n\t\t\tpreviousId,\n\t\t\tnewId\n\t\t);\n\t});\n\t// then check to see whether any existing DB properties reference the old ID through binding expressions.\n\tdataBrokers.map(({ properties = {} }) => {\n\t\treplacePropValuesWithNewId(\n\t\t\tObject.values(properties),\n\t\t\t'value',\n\t\t\tnamespace,\n\t\t\tpreviousId,\n\t\t\tnewId\n\t\t);\n\t});\n\t// finally, check to see whether any existing state params reference the old ID through binding expressions.\n\treplacePropValuesWithNewId(\n\t\tstateParams,\n\t\t'initialValue',\n\t\tnamespace,\n\t\tpreviousId,\n\t\tnewId\n\t);\n};\n\nconst reconfigureEventMappingTargets = (\n\tmappings,\n\tnamespace,\n\tpreviousId,\n\tnewId\n) => {\n\tmappings.map((mapping) => {\n\t\tmapping.targets.map((target = {}) => {\n\t\t\t// if a data broker instance ID is changed, check to see whether an operation\n\t\t\t// from that broker is being used as a target in any existing event mappings.\n\t\t\tconst instanceId = get(target, 'operation.parentResourceId', null);\n\t\t\tif (instanceId && instanceId === previousId) {\n\t\t\t\ttarget.operation.parentResourceId = newId;\n\t\t\t}\n\t\t\t// if a data broker instance or element ID is being changed, check to see whether any\n\t\t\t// existing event mapping target values reference the old ID through binding expressions.\n\t\t\tconst { targetKey, valueKey } = computeEventMappingTargetKeys(\n\t\t\t\ttarget.type\n\t\t\t);\n\t\t\tconst handlerValues = get(target, `${targetKey}.${valueKey}`, []);\n\t\t\treplacePropValuesWithNewId(\n\t\t\t\thandlerValues,\n\t\t\t\t'value',\n\t\t\t\tnamespace,\n\t\t\t\tpreviousId,\n\t\t\t\tnewId\n\t\t\t);\n\t\t});\n\t});\n};\n\nexport const removeEventReferencesToPreviousId = (\n\tpreviousId,\n\tnewId,\n\telements = [],\n\teventHandlers = [],\n\tdataBrokers = [],\n\tinternalEventMappings = [],\n\tnamespace\n) => {\n\telements.map((element) => {\n\t\treconfigureEventMappingTargets(\n\t\t\telement.eventMappings || [],\n\t\t\tnamespace,\n\t\t\tpreviousId,\n\t\t\tnewId\n\t\t);\n\t});\n\tdataBrokers.map((broker) => {\n\t\treconfigureEventMappingTargets(\n\t\t\tbroker.eventMappings || [],\n\t\t\tnamespace,\n\t\t\tpreviousId,\n\t\t\tnewId\n\t\t);\n\t});\n\treconfigureEventMappingTargets(\n\t\tinternalEventMappings || [],\n\t\tnamespace,\n\t\tpreviousId,\n\t\tnewId\n\t);\n\n\t// if a data broker instance ID is changed, update event handler source IDs that reference the old ID.\n\teventHandlers.map((eventHandler) => {\n\t\tconst sourceId = get(eventHandler, 'sourceId', null);\n\t\tif (sourceId && sourceId === previousId) {\n\t\t\teventHandler.sourceId = newId;\n\t\t}\n\t});\n};\n","import get from 'lodash/get';\nimport isEmpty from 'lodash/isEmpty';\nexport default function (pageState) {\n\tconst rootElement = get(pageState, 'rootElement', {});\n\tif (isEmpty(rootElement)) {\n\t\treturn;\n\t}\n\n\treturn (rootElement.macroponentProperties || []).reduce((acc, prop) => {\n\t\treturn {\n\t\t\t...acc,\n\t\t\t[prop.name]: prop.testValue || prop.value\n\t\t};\n\t}, {});\n}\n","import createElementArray from '../element/utils/createElementArray';\nimport get from 'lodash/get';\nimport cloneDeep from 'lodash/cloneDeep';\nimport reject from 'lodash/reject';\nimport { EVENT, DATABROKER_OP } from './constants';\nimport { UPDATE_CLIENT_STATE_HANDLER_ID } from '../../constants';\nimport { getProperty } from '../componentList/utils';\nimport { createExposedProperty, getDependentProperties } from '../utils';\nimport { computeEventMappingTargetKeys } from '../page/utils/shared';\nimport { EventMapping, EventMappingTarget } from '../../models';\nimport { seismicCuid } from '../../utils';\n\nexport const formatEventNameAndLabel = (source, rootId, screenName) => {\n\tif (source.type === DATABROKER_OP) {\n\t\treturn {\n\t\t\tname: `${source.sourceId.toUpperCase()}_${source.name}_RELAY_${rootId}`,\n\t\t\tlabel: `${source.sourceName} ${source.label} Relay (${screenName})`\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tname: `${source.name}_RELAY_${rootId}`,\n\t\t\tlabel: `${source.label} Relay (${screenName})`\n\t\t};\n\t}\n};\n\nconst getInvalidTargetsByType = (target, parentEventHandler) => {\n\tif (target.type === EVENT) {\n\t\treturn !!(\n\t\t\tget(target, 'event.sysId', null) === parentEventHandler.id ||\n\t\t\tget(target, 'event.apiName', null) === parentEventHandler.apiName\n\t\t);\n\t} else if (target.type === DATABROKER_OP) {\n\t\tif (\n\t\t\tget(target, 'operation.parentResourceId', null) ===\n\t\t\t\tparentEventHandler.sourceId &&\n\t\t\tget(target, 'operation.dataBrokerId', null) === parentEventHandler.id &&\n\t\t\tget(target, 'operation.operationName', null) === parentEventHandler.name\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t} else {\n\t\treturn false;\n\t}\n};\n\nexport const addInvalidHandlers = (\n\teventMappings,\n\tparentEventHandlers,\n\ttypeKey,\n\ttypeValue,\n\tcurrentInvalidHandlers = []\n) => {\n\teventMappings.forEach((eventMapping) => {\n\t\teventMapping.targets.forEach((target) => {\n\t\t\tparentEventHandlers.forEach((parentEventHandler) => {\n\t\t\t\tif (getInvalidTargetsByType(target, parentEventHandler)) {\n\t\t\t\t\tconst invalidValue = {\n\t\t\t\t\t\teventMappingId: eventMapping.eventMappingId,\n\t\t\t\t\t\ttarget,\n\t\t\t\t\t\tparentEventHandler,\n\t\t\t\t\t\t[typeKey]: typeValue\n\t\t\t\t\t};\n\t\t\t\t\tcurrentInvalidHandlers.push(invalidValue);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t});\n\treturn currentInvalidHandlers;\n};\n\nexport const getInvalidEventMappingTargets = (\n\trootElement,\n\tparentEventHandlers = [],\n\tdataBrokerInstances\n) => {\n\tconst { internalEventMappings } = rootElement;\n\tconst elementArr = createElementArray(rootElement, (element) => ({\n\t\tid: element.id,\n\t\teventMappings: element.eventMappings\n\t}));\n\tconst invalidHandlers = [];\n\telementArr.forEach((el) => {\n\t\tel.eventMappings &&\n\t\t\taddInvalidHandlers(\n\t\t\t\tel.eventMappings,\n\t\t\t\tparentEventHandlers,\n\t\t\t\t'elementId',\n\t\t\t\tel.id,\n\t\t\t\tinvalidHandlers\n\t\t\t);\n\t});\n\tdataBrokerInstances.forEach((db) => {\n\t\tdb.eventMappings &&\n\t\t\taddInvalidHandlers(\n\t\t\t\tdb.eventMappings,\n\t\t\t\tparentEventHandlers,\n\t\t\t\t'dataBrokerId',\n\t\t\t\tdb.id,\n\t\t\t\tinvalidHandlers\n\t\t\t);\n\t});\n\tinternalEventMappings &&\n\t\tinternalEventMappings.length > 0 &&\n\t\taddInvalidHandlers(\n\t\t\tinternalEventMappings,\n\t\t\tparentEventHandlers,\n\t\t\t'rootElementId',\n\t\t\trootElement.id,\n\t\t\tinvalidHandlers\n\t\t);\n\treturn invalidHandlers;\n};\n\nexport const dispatchedEventAndParentHandlerPayloadsCongruent = (\n\texistingDispatchedEvent,\n\tparentEventHandler\n) => {\n\tconst { payloadFields: parentEventHandlerPayloadDef } = parentEventHandler;\n\tconst {\n\t\tpayloadShape: existingDispatchedEventPayloadDef\n\t} = existingDispatchedEvent;\n\treturn (\n\t\tparentEventHandlerPayloadDef.length ===\n\t\t\texistingDispatchedEventPayloadDef.length &&\n\t\tparentEventHandlerPayloadDef.every(({ name }) =>\n\t\t\texistingDispatchedEventPayloadDef.find((prop) => name === prop.name)\n\t\t)\n\t);\n};\n\nexport const getReducedHandlerList = (\n\tinvalidEventMappingTargets,\n\texistingDispatchedEvents,\n\trootMacroponentId,\n\tinvalidPredicateFn\n) => {\n\tconst handlerList = [];\n\tinvalidEventMappingTargets.forEach((target) => {\n\t\tconst { name } = formatEventNameAndLabel(\n\t\t\ttarget.parentEventHandler,\n\t\t\trootMacroponentId\n\t\t);\n\t\tconst existingDispatchedEvent = existingDispatchedEvents.find(\n\t\t\t(event) => event.eventName === name\n\t\t);\n\t\tif (\n\t\t\tinvalidPredicateFn(\n\t\t\t\texistingDispatchedEvent,\n\t\t\t\ttarget.parentEventHandler,\n\t\t\t\thandlerList\n\t\t\t)\n\t\t) {\n\t\t\thandlerList.push({\n\t\t\t\t...target.parentEventHandler,\n\t\t\t\texistingDispatchedEvent\n\t\t\t});\n\t\t}\n\t});\n\treturn handlerList;\n};\n\nexport const getReducedInvalidHandlerList = (\n\tinvalidEventMappingTargets,\n\texistingDispatchedEvents,\n\trootMacroponentId\n) => {\n\treturn getReducedHandlerList(\n\t\tinvalidEventMappingTargets,\n\t\texistingDispatchedEvents,\n\t\trootMacroponentId,\n\t\tfunction (existingDispatchedEvent, targetParentEventHandler, handlerList) {\n\t\t\treturn (\n\t\t\t\t!existingDispatchedEvent &&\n\t\t\t\t!handlerList.find(\n\t\t\t\t\t(eventHandler) => eventHandler.id === targetParentEventHandler.id\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t);\n};\n\nexport const getReducedIncongruentHandlerList = (\n\tinvalidEventMappingTargets,\n\texistingDispatchedEvents,\n\trootMacroponentId\n) => {\n\treturn getReducedHandlerList(\n\t\tinvalidEventMappingTargets,\n\t\texistingDispatchedEvents,\n\t\trootMacroponentId,\n\t\tfunction (existingDispatchedEvent, targetParentEventHandler, handlerList) {\n\t\t\treturn (\n\t\t\t\texistingDispatchedEvent &&\n\t\t\t\t!dispatchedEventAndParentHandlerPayloadsCongruent(\n\t\t\t\t\texistingDispatchedEvent,\n\t\t\t\t\ttargetParentEventHandler\n\t\t\t\t) &&\n\t\t\t\t!handlerList.find(\n\t\t\t\t\t(eventHandler) => eventHandler.id === targetParentEventHandler.id\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t);\n};\n\nexport const getNewRootElementAndElementToUpdate = (\n\tpageState,\n\telementId = null\n) => {\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst elements = createElementArray(newRootElement, (element) => element);\n\tconst elementToUpdate = elements.find((el) => el.id === elementId);\n\n\treturn {\n\t\tnewRootElement,\n\t\telementToUpdate\n\t};\n};\n\nexport const createEventMapping = (eventId, eventApiName) => {\n\treturn new EventMapping({\n\t\teventMappingId: seismicCuid(),\n\t\teventId,\n\t\teventApiName,\n\t\ttargets: [new EventMappingTarget({})]\n\t});\n};\n\nexport const createEventMappingHandler = (mappings, mappingId) => {\n\tconst eventMappingToUpdate =\n\t\tmappings.find((mapping) => mapping.eventMappingId === mappingId) || {};\n\teventMappingToUpdate.targets &&\n\t\teventMappingToUpdate.targets.push(new EventMappingTarget({}));\n\treturn eventMappingToUpdate;\n};\n\nexport const deleteEventMappingHandler = (\n\tinstance,\n\tmappings,\n\tmappingId,\n\thandlerId\n) => {\n\tconst eventMappingToUpdate =\n\t\tmappings.find((mapping) => mapping.eventMappingId === mappingId) || {};\n\tconst { targets = [] } = eventMappingToUpdate;\n\teventMappingToUpdate.targets = reject(targets, { targetId: handlerId });\n\n\t// if there was only one target for this event mapping, delete the whole mapping\n\tif (eventMappingToUpdate.targets.length === 0) {\n\t\tinstance.eventMappings = reject(instance.eventMappings, {\n\t\t\teventMappingId: mappingId\n\t\t});\n\t}\n\treturn instance;\n};\n\nexport const updateEventMappingHandler = (\n\thandlerToUpdate,\n\teventHandlers,\n\thandlerTypeId,\n\thandlerValueId,\n\tvalue,\n\tscripted,\n\tclientStateParameters\n) => {\n\tif (handlerTypeId) {\n\t\tconst [typeId, instanceId, operationName] = handlerTypeId.split(':');\n\t\tconst selectedHandler = operationName\n\t\t\t? eventHandlers.find(\n\t\t\t\t\t({ id, name, sourceId }) =>\n\t\t\t\t\t\tid === typeId && name === operationName && sourceId === instanceId\n\t\t\t  )\n\t\t\t: eventHandlers.find(({ id }) => id === typeId);\n\t\tconst eventMappingHandlerType = selectedHandler.type;\n\t\thandlerToUpdate.type = eventMappingHandlerType;\n\n\t\tconst {\n\t\t\ttargetKey,\n\t\t\tvalueKey,\n\t\t\tidKey,\n\t\t\tnonTargetKeys\n\t\t} = computeEventMappingTargetKeys(eventMappingHandlerType);\n\n\t\thandlerToUpdate[targetKey] = {\n\t\t\t[idKey]: typeId,\n\t\t\t[valueKey]: selectedHandler.payloadFields.map((field) =>\n\t\t\t\tgetProperty({ ...field, fieldType: field.type })\n\t\t\t)\n\t\t};\n\n\t\tif (eventMappingHandlerType === EVENT) {\n\t\t\thandlerToUpdate[targetKey].apiName = selectedHandler.apiName;\n\t\t}\n\n\t\tif (eventMappingHandlerType === DATABROKER_OP) {\n\t\t\thandlerToUpdate[targetKey].operationName = selectedHandler.name;\n\t\t\thandlerToUpdate[targetKey].parentResourceId = selectedHandler.sourceId;\n\t\t}\n\n\t\tnonTargetKeys.forEach((key) => (handlerToUpdate[key] = null));\n\t} else if (handlerValueId) {\n\t\t// Changes one of the values for an event mapping handler\n\t\tlet targetValueToUpdate = {};\n\t\tconst eventMappingHandlerType = handlerToUpdate.type;\n\n\t\tconst { targetKey, valueKey } = computeEventMappingTargetKeys(\n\t\t\teventMappingHandlerType\n\t\t);\n\t\ttargetValueToUpdate = handlerToUpdate[targetKey][valueKey].find(\n\t\t\t(actionValue) => actionValue.columnName === handlerValueId\n\t\t);\n\n\t\tconst values = handlerToUpdate[targetKey][valueKey].map((value) =>\n\t\t\tcreateExposedProperty(value)\n\t\t);\n\t\tconst propertyToUpdate = values.find((prop) => prop.id === handlerValueId);\n\n\t\tconst dependees = getDependentProperties(propertyToUpdate, values);\n\t\tif (dependees.length) {\n\t\t\t// If there are dependent properties, clear out those property values.\n\t\t\tdependees.forEach((dependee) => {\n\t\t\t\tconst { id } = dependee;\n\t\t\t\tconst dependentTargetValue = handlerToUpdate[targetKey][valueKey].find(\n\t\t\t\t\t(value) => value.columnName === id\n\t\t\t\t);\n\t\t\t\tdependentTargetValue.value = null;\n\t\t\t});\n\t\t}\n\n\t\ttargetValueToUpdate.value = value;\n\n\t\tif (\n\t\t\thandlerToUpdate.event &&\n\t\t\thandlerToUpdate.event.sysId === UPDATE_CLIENT_STATE_HANDLER_ID\n\t\t) {\n\t\t\tconst {\n\t\t\t\ttype: paramType,\n\t\t\t\tname: paramName,\n\t\t\t\tinitialValue: paramInitialValue\n\t\t\t} = clientStateParameters.find((param) => param.name === value) || {};\n\t\t\thandlerToUpdate.event.payload.forEach((prop) => {\n\t\t\t\tif (prop.name === 'value' && paramName) {\n\t\t\t\t\tprop.type = paramType || 'string';\n\t\t\t\t\tprop.value = paramInitialValue;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t} else if (scripted) {\n\t\thandlerToUpdate.clientTransformScript = value;\n\t}\n\n\treturn handlerToUpdate;\n};\n","import createContextBindings from './createContextBindings';\nimport { isContextBoundProperty, isDataBoundProperty } from '../../utils';\nimport { CONTEXT_NAMESPACE } from '../../../constants';\n\nfunction isContextPropBinding(value) {\n\tconst matcher = isContextBoundProperty(value);\n\tif (matcher && matcher[2] === 'props') {\n\t\treturn matcher;\n\t}\n\treturn null;\n}\n\nfunction isContextDataBinding(value) {\n\tconst matcher = isContextBoundProperty(value);\n\tif (matcher && matcher[2] === 'data') {\n\t\treturn matcher;\n\t}\n\treturn null;\n}\n\nfunction iterateAndResolveValues(properties, name, value, onIntermediateValue) {\n\tlet next = true,\n\t\tresolvedValue = value;\n\twhile (next) {\n\t\tconst contextMatcher = isContextPropBinding(resolvedValue);\n\t\tconst dataMatcher = isContextDataBinding(resolvedValue);\n\t\tif (contextMatcher) {\n\t\t\tconst pathSplit = contextMatcher[3].slice(1).split('.');\n\t\t\tconst targetProp = pathSplit.shift();\n\t\t\tif (targetProp === name) {\n\t\t\t\tconst parentKey = `${targetProp}.parent`;\n\t\t\t\tresolvedValue = properties[parentKey] || resolvedValue;\n\t\t\t\tonIntermediateValue(parentKey);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tconst targetValue = properties[targetProp];\n\t\t\ttargetValue && onIntermediateValue(targetProp);\n\t\t\tnext = !!targetValue;\n\t\t\tresolvedValue = !next ? resolvedValue : targetValue;\n\t\t\tresolvedValue +=\n\t\t\t\tnext && pathSplit.length > 0 ? `.${pathSplit.join('.')}` : '';\n\t\t} else if (dataMatcher) {\n\t\t\tconst dataExpression = resolvedValue.substring(\n\t\t\t\t`${CONTEXT_NAMESPACE}`.length + 1\n\t\t\t);\n\t\t\tconst dataMatcher = isDataBoundProperty(`@${dataExpression}`);\n\t\t\tresolvedValue = dataMatcher ? dataMatcher[0] : resolvedValue;\n\t\t\tnext = false;\n\t\t} else {\n\t\t\tnext = false;\n\t\t}\n\t}\n\treturn resolvedValue;\n}\n\nfunction resolveAncestorPropertyValues(properties) {\n\tconst intermediateProps = [];\n\tconst resolvedProps = Object.entries(properties).reduce(\n\t\t(acc, [propName, propValue]) => {\n\t\t\tif (!isContextBoundProperty(propValue)) {\n\t\t\t\treturn {\n\t\t\t\t\t...acc,\n\t\t\t\t\t[propName]: propValue\n\t\t\t\t};\n\t\t\t}\n\t\t\tconst resolvedValue = iterateAndResolveValues(\n\t\t\t\tproperties,\n\t\t\t\tpropName,\n\t\t\t\tpropValue,\n\t\t\t\t(intermediateProp) => {\n\t\t\t\t\tintermediateProps.push(intermediateProp);\n\t\t\t\t}\n\t\t\t);\n\t\t\treturn {\n\t\t\t\t...acc,\n\t\t\t\t[propName]: resolvedValue\n\t\t\t};\n\t\t},\n\t\t{}\n\t);\n\tintermediateProps.forEach((prop) => delete resolvedProps[prop]);\n\treturn resolvedProps;\n}\n\nfunction mergePropertyValues(\n\tancestorPageProperties = {},\n\tlocalPageProperties = {}\n) {\n\treturn Object.entries(ancestorPageProperties).reduce((acc, [name, value]) => {\n\t\tif (acc[name]) {\n\t\t\treturn {\n\t\t\t\t...acc,\n\t\t\t\t[`${name}.parent`]: value\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\t...acc,\n\t\t\t[name]: value\n\t\t};\n\t}, localPageProperties);\n}\n\nexport default function (pageState, ancestorPageProperties) {\n\tconst allPageProperties = mergePropertyValues(\n\t\tancestorPageProperties,\n\t\tcreateContextBindings(pageState)\n\t);\n\treturn resolveAncestorPropertyValues(allPageProperties);\n}\n","import get from 'lodash/get';\nexport const getLayoutFromMacroponent = (macroponent) => {\n\tconst rootMacroponentId = get(macroponent, 'rootMacroponentId', null);\n\n\tconst layout = get(\n\t\tmacroponent,\n\t\t`macroponentDefinitions.${rootMacroponentId}.layout`,\n\t\tnull\n\t);\n\treturn layout;\n};\n","import PageStateModel from './pageState';\n\nconst createPageState = (newProperties, sourcePageState) => {\n\tconst spreadPageState = Object.keys(sourcePageState.attributes).reduce(\n\t\t(acc, cur) => {\n\t\t\tacc[cur] = sourcePageState[cur];\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n\n\treturn new PageStateModel({\n\t\t...spreadPageState,\n\t\t...newProperties\n\t});\n};\n\nexport default createPageState;\n","export const ELEMENT_PROPERTY_UPDATED = 'SN_UXF#ELEMENT_PROPERTY_UPDATED';\nexport const ELEMENT_LAYOUT_CHANGED = 'SN_UXF#ELEMENT_LAYOUT_CHANGED';\nexport const SLOT_STYLES_CHANGED = 'SN_UXF#SLOT_STYLES_CHANGED';\nexport const SLOT_STYLES_PATCHED = 'SN_UXF#SLOT_STYLES_PATCHED';\nexport const ELEMENT_STYLES_UPDATED = 'SN_UXF#ELEMENT_STYLES_UPDATED';\nexport const COMPONENT_PLACED = 'SN_UXF#COMPONENT_PLACED';\nexport const ELEMENT_DELETED = 'SN_UXF#ELEMENT_DELETED';\nexport const ELEMENT_DETACHED = 'SN_UXF#ELEMENT_DETACHED';\nexport const DETACHED_ELEMENT_RELOCATED = 'SN_UXF#DETACHED_ELEMENT_RELOCATED';\nexport const DETACHED_ELEMENT_RESTORED = 'SN_UXF#DETACHED_ELEMENT_RESTORED';\nexport const ELEMENT_RESIZED = 'SN_UXF#ELEMENT_RESIZED';\nexport const COMPONENT_PLACED_SUCCEEDED = 'SN_UXF#PLACE_COMPONENT_SUCCEEDED';\nexport const COMPONENT_PLACED_FAILED = 'SN_UXF#PLACE_COMPONENT_FAILED';\nexport const UPDATE_LAYOUT_SUCCEEDED = 'SN_UXF#UPDATE_LAYOUT_SUCCEEDED';\nexport const RELOCATE_ELEMENT_SUCCEEDED = 'SN_UXF#RELOCATE_ELEMENT_SUCCEEDED';\nexport const RESTORE_ELEMENT_SUCCEEDED = 'SN_UXF#RESTORE_ELEMENT_SUCCEEDED';\nexport const DETACH_ELEMENT_SUCCEEDED = 'SN_UXF#DETACH_ELEMENT_SUCCEEDED';\nexport const VIEWPORT_NAME_CHANGED = 'SN_UXF#VIEWPORT_NAME_CHANGED';\nexport const ELEMENT_METADATA_UPDATE_REQUESTED =\n\t'SN_UXF#ELEMENT_METADATA_UPDATE_REQUESTED';\nexport const ELEMENT_ID_CHANGED = 'SN_UXF#ELEMENT_ID_CHANGED';\nexport const ELEMENT_EXPLODED = 'SN_UXF#ELEMENT_EXPLODED';\nexport const ELEMENT_EXPLODED_MACROPONENT_REQUESTED =\n\t'SN_UXF#ELEMENT_EXPLODED_MACROPONENT_REQUESTED';\nexport const ELEMENT_EXPLODED_MACROPONENT_SUCCEEDED =\n\t'SN_UXF#ELEMENT_EXPLODED_MACROPONENT_SUCCEEDED';\nexport const ELEMENT_EXPLODED_SUBROUTE_COPY_REQUESTED =\n\t'SN_UXF#ELEMENT_EXPLODED_SUBROUTE_COPY_REQUESTED';\nexport const ELEMENT_EXPLODED_SUBROUTE_COPY_SUCCEEDED =\n\t'SN_UXF#ELEMENT_EXPLODED_SUBROUTE_COPY_SUCCEEDED';\nexport const ELEMENT_EXPLODED_UPDATE_PAGE_WITH_MACROPONENT_CONTENTS =\n\t'SN_UXF#ELEMENT_EXPLODED_UPDATE_PAGE_WITH_MACROPONENT_CONTENTS';\nexport const ELEMENT_IS_HIDDEN_TEST_VALUE_CHANGED =\n\t'SN_UXF#ELEMENT_IS_HIDDEN_TEST_VALUE_CHANGED';\nexport const COMPONENT_EDIT_REQUESTED = 'SN_UXF#COMPONENT_EDIT_REQUESTED';\n","import cloneDeep from 'lodash/cloneDeep';\nimport createPageState from '../../../models/createPageState';\nimport get from 'lodash/get';\nimport {\n\tfindElementById,\n\tfindElements,\n\tfindParentElement,\n\tgetRootElementFromState,\n\tdeleteChildElement,\n\tcreateElementFromComponent,\n\telementUsesSNLayout,\n\tgetAllElementIds\n} from '../utils/element';\nimport { Element } from '../../../models';\nimport Slot from '../../../models/slot';\nimport isEqual from 'lodash/isEqual';\nimport { getTemplates } from '@devsnc/library-uxf';\nimport { throwError, normalizeRowColumnSlots } from '../../../utils';\n\nimport {\n\tRELOCATE_ELEMENT_SUCCEEDED,\n\tDETACH_ELEMENT_SUCCEEDED,\n\tRESTORE_ELEMENT_SUCCEEDED,\n\tCOMPONENT_PLACED_SUCCEEDED\n} from '../elementActions';\n\n//Get the slot name of the first item in a layout\nconst getDefaultSlotname = (layout) => {\n\tconst items = get(layout, 'default.items') || [];\n\tconst firstItem = items[0];\n\tif (firstItem) {\n\t\treturn firstItem.slotName;\n\t} else {\n\t\treturn null;\n\t}\n};\nexport const compareLayouts = (a, b) => {\n\tconst normalize = (obj) => {\n\t\tlet parsed;\n\t\ttry {\n\t\t\tparsed = JSON.parse(\n\t\t\t\tJSON.stringify(obj, (key, val) => {\n\t\t\t\t\tif (key !== 'id') {\n\t\t\t\t\t\treturn val;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tparsed = {};\n\t\t}\n\t\tif (parsed && parsed.default) {\n\t\t\tconst optionalNullkeys = ['root', 'children', 'styles', 'rules', 'items'];\n\t\t\toptionalNullkeys.forEach((key) => {\n\t\t\t\tif (key in parsed.default === false) {\n\t\t\t\t\tparsed.default[key] = null;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn parsed;\n\t};\n\n\treturn isEqual(normalize(a), normalize(b));\n};\n\nconst isDefaultLayout = (layout, getDefaultLayout) => {\n\tconst defaultLayout = get(layout, 'default');\n\tif (defaultLayout) {\n\t\tconst { items = [] } = normalizeRowColumnSlots(layout).default;\n\t\tconst pageType = defaultLayout.type === 'rowColumn' ? 'landing' : 'screen';\n\t\tif (items.length !== 1) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn compareLayouts(layout, getDefaultLayout(pageType));\n\t} else {\n\t\treturn false;\n\t}\n};\n\nconst elementDetached = ({\n\tstate,\n\taction,\n\tupdateState,\n\tdispatch,\n\tupdateProperties,\n\tproperties\n}) => {\n\tconst { elementId: detachedElementId } = action.payload;\n\tconst newRootElement = cloneDeep(getRootElementFromState(state));\n\tconst { pageState } = properties;\n\tconst parentElement = findParentElement(newRootElement, detachedElementId);\n\tif (!parentElement) {\n\t\tthrowError('Cannot detach root element');\n\t}\n\tconst detachedElements = findElements(\n\t\tgetRootElementFromState(state),\n\t\t(elm) => elm.slot && elm.id === detachedElementId\n\t);\n\tconst previousLayout = parentElement.layout;\n\n\tfindElementById(newRootElement, detachedElementId).slot.name = null;\n\tdispatch(DETACH_ELEMENT_SUCCEEDED, { elementId: detachedElementId });\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n\n\tupdateState({\n\t\tpath: 'detachedElementData',\n\t\toperation: 'set',\n\t\tvalue: { previousLayout, detachedElements, detachedElementId }\n\t});\n};\n\nconst detachedElementRelocated = ({\n\tstate,\n\taction,\n\tupdateState,\n\tupdateProperties,\n\tdispatch\n}) => {\n\tconst {\n\t\tdetachedElementData: { detachedElements, detachedElementId },\n\t\tproperties: { pageState },\n\t\tgetDefaultLayout\n\t} = state;\n\tconst { slotName: newSlot, parentId } = action.payload;\n\tconst newRootElement = cloneDeep(getRootElementFromState(state));\n\tconst targetParentElement = findElementById(newRootElement, parentId);\n\n\tlet detachedElementParent;\n\tdetachedElements.length &&\n\t\t(detachedElementParent = findParentElement(\n\t\t\tnewRootElement,\n\t\t\tdetachedElements[0].id\n\t\t));\n\tif (\n\t\tdetachedElementParent &&\n\t\tdetachedElementParent.id !== targetParentElement.id\n\t) {\n\t\tdetachedElements.forEach((detachedElement) =>\n\t\t\tdeleteChildElement(detachedElementParent, detachedElement.id)\n\t\t);\n\t\tdetachedElements.forEach((detachedElement) =>\n\t\t\ttargetParentElement.children.push(detachedElement)\n\t\t);\n\t}\n\n\tlet slotToPlaceNewElementIn = newSlot;\n\n\tif (!get(targetParentElement, 'layout.default.type')) {\n\t\tconst defaultLayout = getDefaultLayout();\n\t\tslotToPlaceNewElementIn = getDefaultSlotname(defaultLayout);\n\t\ttargetParentElement.layout = defaultLayout;\n\t}\n\tconst detachedIndex = targetParentElement.children.findIndex(\n\t\t(elem) => elem.id === detachedElementId\n\t);\n\ttargetParentElement.children[\n\t\tdetachedIndex\n\t].slot.name = slotToPlaceNewElementIn;\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n\tdispatch(RELOCATE_ELEMENT_SUCCEEDED, { elementId: detachedElementId });\n\n\tupdateState({ path: 'detachedElementData', operation: 'set', value: null });\n};\n\nconst detachedElementRestored = ({\n\tstate,\n\tupdateProperties,\n\tupdateState,\n\tdispatch\n}) => {\n\tconst {\n\t\tdetachedElementData: {\n\t\t\tdetachedElementId,\n\t\t\tdetachedElements,\n\t\t\tpreviousLayout\n\t\t},\n\t\tproperties: { pageState }\n\t} = state;\n\n\tif (!previousLayout) {\n\t\tupdateState({\n\t\t\tpath: 'detachedElementData',\n\t\t\toperation: 'set',\n\t\t\tvalue: null\n\t\t});\n\n\t\treturn;\n\t}\n\n\tconst newRootElement = cloneDeep(getRootElementFromState(state));\n\n\tif (detachedElements && detachedElements.length > 0) {\n\t\tconst parentElement = findParentElement(\n\t\t\tnewRootElement,\n\t\t\tdetachedElements[0].id\n\t\t);\n\t\tparentElement.layout = previousLayout;\n\t\tdispatch(RESTORE_ELEMENT_SUCCEEDED, {\n\t\t\telementIds: detachedElements.map((el) => el.id)\n\t\t});\n\n\t\tconst detachedIndex = parentElement.children.findIndex(\n\t\t\t(elem) => elem.id === detachedElementId\n\t\t);\n\t\tparentElement.children[detachedIndex].slot.name = get(\n\t\t\tdetachedElements,\n\t\t\t'[0].slot.name'\n\t\t);\n\n\t\tupdateProperties({\n\t\t\tpageState: createPageState(\n\t\t\t\t{\n\t\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t\t},\n\t\t\t\tpageState\n\t\t\t)\n\t\t});\n\t}\n\n\tupdateState({\n\t\tpath: 'detachedElementData',\n\t\toperation: 'set',\n\t\tvalue: null\n\t});\n};\n\nconst componentPlaced = ({ action, state, updateProperties, dispatch }) => {\n\tconst { componentId, parentId, slotName } = action.payload;\n\n\tconst {\n\t\trawComponentList,\n\t\tproperties: { pageState },\n\t\tgetDefaultLayout\n\t} = state;\n\n\tconst newRootElement = cloneDeep(getRootElementFromState(state));\n\tconst parentElement = findElementById(newRootElement, parentId);\n\n\tconst droppedComponent = rawComponentList.find(\n\t\t(component) => component.id === componentId\n\t);\n\n\t// Load component scripts dynamically\n\t// This is async, but shouldn't matter if the scripts are loaded after\n\t// the component tags have been rendered in the html\n\tgetTemplates([droppedComponent.id]);\n\n\tconst newElement = createElementFromComponent(\n\t\tdroppedComponent,\n\t\tparentElement,\n\t\tfalse,\n\t\tgetDefaultLayout('slotted-component')\n\t);\n\n\tconst allElementIds = getAllElementIds(newRootElement);\n\tnewElement.initialize(allElementIds);\n\n\tif (elementUsesSNLayout(parentElement)) {\n\t\tlet slotToPlaceNewElementIn = slotName;\n\t\tif (!get(parentElement, 'layout.default.type')) {\n\t\t\tconst defaultLayout = getDefaultLayout();\n\t\t\tslotToPlaceNewElementIn = getDefaultSlotname(defaultLayout);\n\t\t\tparentElement.layout = defaultLayout;\n\t\t}\n\t\tnewElement.slot = new Slot({\n\t\t\tname: slotToPlaceNewElementIn,\n\t\t\tparentElement: parentElement\n\t\t});\n\t} else if (slotName) {\n\t\tnewElement.slot = new Slot({\n\t\t\tname: slotName,\n\t\t\tparentElement: parentElement\n\t\t});\n\t}\n\n\tparentElement.children.push(newElement);\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n\tdispatch(COMPONENT_PLACED_SUCCEEDED, {\n\t\telementId: newElement.id,\n\t\tcomponentId: droppedComponent.id\n\t});\n};\n\nconst elementDeleted = ({ state, action, updateProperties }) => {\n\tconst {\n\t\tproperties: { pageState }\n\t} = state;\n\n\tconst { elementId: deletedElementId } = action.payload;\n\n\tconst newRootElement = cloneDeep(getRootElementFromState(state));\n\n\tif (newRootElement.id === deletedElementId) {\n\t\t// Don't allow deleting the root element\n\t\treturn;\n\t}\n\n\tconst parentElement = findParentElement(newRootElement, deletedElementId);\n\tif (parentElement) {\n\t\tconst indexOfDeletedElem = parentElement.children.findIndex(\n\t\t\t(elem) => elem.id === deletedElementId\n\t\t);\n\t\tif (indexOfDeletedElem > -1) {\n\t\t\tparentElement.children.splice(indexOfDeletedElem, 1);\n\t\t}\n\t}\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nexport {\n\tcomponentPlaced,\n\telementDetached,\n\tdetachedElementRelocated,\n\tdetachedElementRestored,\n\telementDeleted,\n\tisDefaultLayout\n};\n","import cloneDeep from 'lodash/cloneDeep';\nimport { getTemplates } from '@devsnc/library-uxf';\nimport createPageState from '../../../models/createPageState';\n\nimport {\n\tfindElementById,\n\tfindParentElement,\n\tgetRootElementFromState,\n\tdeleteChildElement,\n\tcreateElementFromComponent,\n\tgetAllElementIds\n} from '../utils/element';\nimport {\n\tRELOCATE_ELEMENT_SUCCEEDED,\n\tCOMPONENT_PLACED_SUCCEEDED\n} from '../elementActions';\n\nimport { Element } from '../../../models';\nimport Slot from '../../../models/slot';\nimport get from 'lodash/get';\nconst BEFORE = 'left';\nconst AFTER = 'right';\nconst directionLookup = {\n\t[BEFORE]: 0,\n\t[AFTER]: 1\n};\n\nconst insertAt = (arr, item, index) => {\n\tconst result = [...arr];\n\tresult.splice(index, 0, item);\n\treturn result;\n};\n\nconst getInsertPosition = (parent, adjacent, direction) => {\n\tconst formatted = (direction || '').toLowerCase();\n\tconst { children = [] } = parent;\n\tconst insertOffset = formatted\n\t\t? directionLookup[formatted]\n\t\t: directionLookup[AFTER];\n\tconst adjacentIndex = children.findIndex((child) => {\n\t\treturn child.id === adjacent.id;\n\t});\n\n\tconst insertPosition =\n\t\tadjacentIndex !== -1 ? adjacentIndex + insertOffset : children.length - 1;\n\treturn insertPosition;\n};\nconst getSlot = (name, layout = {}) => {\n\tif (!name) {\n\t\treturn null;\n\t}\n\treturn (layout.items || []).find(({ slotName }) => slotName === name) || null;\n};\n\nconst defaultSlotStylingToFlex = (adjacentElement, parentElement) => {\n\tconst layoutSlot = getSlot(\n\t\tget(adjacentElement, 'slot.name', null),\n\t\tget(parentElement, 'layout.default', {})\n\t);\n\n\tif (layoutSlot) {\n\t\tif (!layoutSlot.styles) {\n\t\t\tlayoutSlot.styles = {};\n\t\t}\n\t\tif (!layoutSlot.styles.display) {\n\t\t\tlayoutSlot.styles.display = 'flex';\n\t\t}\n\t}\n};\nconst componentCreatedInSlot = ({\n\taction,\n\tstate,\n\tupdateProperties,\n\tdispatch\n}) => {\n\tconst { componentId, elementId, direction } = action.payload;\n\n\tconst {\n\t\trawComponentList,\n\t\tproperties: { pageState },\n\t\tgetDefaultLayout\n\t} = state;\n\tconst newRootElement = cloneDeep(getRootElementFromState(state));\n\tconst adjacentElement = findElementById(newRootElement, elementId);\n\tconst parentElement = findParentElement(newRootElement, adjacentElement.id);\n\tconst droppedComponent = rawComponentList.find(\n\t\t(component) => component.id === componentId\n\t);\n\n\t// Load component scripts dynamically\n\t// This is async, but shouldn't matter if the scripts are loaded after\n\t// the component tags have been rendered in the html\n\tgetTemplates([droppedComponent.id]);\n\n\tconst newElement = createElementFromComponent(\n\t\tdroppedComponent,\n\t\tparentElement,\n\t\tfalse,\n\t\tgetDefaultLayout('slotted-component')\n\t);\n\tconst allElementIds = getAllElementIds(newRootElement);\n\tnewElement.initialize(allElementIds);\n\n\tnewElement.slot = new Slot({\n\t\tname: adjacentElement.slot.name,\n\t\tparentElement: parentElement\n\t});\n\tparentElement.children = insertAt(\n\t\tparentElement.children,\n\t\tnewElement,\n\t\tgetInsertPosition(parentElement, adjacentElement, direction)\n\t);\n\tdefaultSlotStylingToFlex(adjacentElement, parentElement);\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n\tdispatch(COMPONENT_PLACED_SUCCEEDED, {\n\t\telementId: newElement.id,\n\t\tcomponentId: droppedComponent.id\n\t});\n};\nconst componentMovedToSlot = ({\n\taction,\n\tstate,\n\tupdateProperties,\n\tupdateState,\n\tdispatch\n}) => {\n\tconst { elementId, direction } = action.payload;\n\n\tconst {\n\t\tdetachedElementData: { detachedElements, detachedElementId },\n\n\t\tproperties: { pageState }\n\t} = state;\n\tconst newRootElement = cloneDeep(getRootElementFromState(state));\n\tconst adjacentElement = findElementById(newRootElement, elementId);\n\tconst targetParentElement = findParentElement(\n\t\tnewRootElement,\n\t\tadjacentElement.id\n\t);\n\n\tlet detachedElementParent;\n\tdetachedElements.length &&\n\t\t(detachedElementParent = findParentElement(\n\t\t\tnewRootElement,\n\t\t\tdetachedElements[0].id\n\t\t));\n\tif (\n\t\tdetachedElementParent &&\n\t\tdetachedElementParent.id !== targetParentElement.id\n\t) {\n\t\tdetachedElements.forEach((detachedElement) =>\n\t\t\tdeleteChildElement(detachedElementParent, detachedElement.id)\n\t\t);\n\t} else {\n\t\ttargetParentElement.children = targetParentElement.children.filter(\n\t\t\t(child) => {\n\t\t\t\treturn child.id !== detachedElementId;\n\t\t\t}\n\t\t);\n\t}\n\tdetachedElements.forEach(\n\t\t(detachedElement) =>\n\t\t\t(targetParentElement.children = insertAt(\n\t\t\t\ttargetParentElement.children,\n\t\t\t\tdetachedElement,\n\t\t\t\tgetInsertPosition(targetParentElement, adjacentElement, direction)\n\t\t\t))\n\t);\n\tconst detachedIndex = targetParentElement.children.findIndex(\n\t\t(elem) => elem.id === detachedElementId\n\t);\n\ttargetParentElement.children[detachedIndex].slot.name =\n\t\tadjacentElement.slot.name;\n\tdefaultSlotStylingToFlex(adjacentElement, targetParentElement);\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n\tdispatch(RELOCATE_ELEMENT_SUCCEEDED, { elementId: detachedElementId });\n\n\tupdateState({ path: 'detachedElementData', operation: 'set', value: null });\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nexport { componentCreatedInSlot, componentMovedToSlot };\n","export const ELEMENT_EVENT_MAPPING_CREATED =\n\t'SN_UXF#ELEMENT_EVENT_MAPPING_CREATED';\nexport const ELEMENT_EVENT_MAPPING_HANDLER_CHANGED =\n\t'SN_UXF#ELEMENT_EVENT_MAPPING_HANDLER_CHANGED';\nexport const ELEMENT_EVENT_MAPPING_HANDLER_CREATED =\n\t'SN_UXF#ELEMENT_EVENT_MAPPING_HANDLER_CREATED';\nexport const ELEMENT_EVENT_MAPPING_HANDLER_DELETED =\n\t'SN_UXF#ELEMENT_EVENT_MAPPING_HANDLER_DELETED';\nexport const ELEMENT_COMPLETE_EVENT_MAPPING_CREATED =\n\t'SN_UXF#ELEMENT_COMPLETE_EVENT_MAPPING_CREATED';\nexport const SCREEN_EVENT_MAPPING_CREATED =\n\t'SN_UXF#SCREEN_EVENT_MAPPING_CREATED';\nexport const SCREEN_EVENT_MAPPING_HANDLER_ADDED =\n\t'SN_UXF#SCREEN_EVENT_MAPPING_HANDLER_ADDED';\nexport const SCREEN_EVENT_MAPPING_HANDLER_DELETED =\n\t'SN_UXF#SCREEN_EVENT_MAPPING_HANDLER_DELETED';\nexport const SCREEN_EVENT_MAPPING_HANDLER_CHANGED =\n\t'SN_UXF#SCREEN_EVENT_MAPPING_HANDLER_CHANGED';\nexport const PAGE_INTERNAL_EVENT_MAPPING_CREATED =\n\t'SN_UXF#PAGE_INTERNAL_EVENT_MAPPING_CREATED';\nexport const PAGE_INTERNAL_EVENT_MAPPING_HANDLER_CREATED =\n\t'SN_UXF#PAGE_INTERNAL_EVENT_MAPPING_HANDLER_CREATED';\nexport const PAGE_INTERNAL_EVENT_MAPPING_HANDLER_DELETED =\n\t'SN_UXF#PAGE_INTERNAL_EVENT_MAPPING_HANDLER_DELETED';\nexport const PAGE_INTERNAL_EVENT_MAPPING_HANDLER_CHANGED =\n\t'SN_UXF#PAGE_INTERNAL_EVENT_MAPPING_HANDLER_CHANGED';\n","export const DATA_BROKER_INSTANCE_CREATED =\n\t'SN_UXF#DATA_BROKER_INSTANCE_CREATED';\nexport const DATA_BROKER_INSTANCE_DELETED =\n\t'SN_UXF#DATA_BROKER_INSTANCE_DELETED';\nexport const DATA_BROKER_INSTANCE_PROPERTY_UPDATED =\n\t'SN_UXF#DATA_BROKER_INSTANCE_PROPERTY_UPDATED';\nexport const DATA_BROKER_INSTANCE_METADATA_UPDATE_REQUESTED =\n\t'SN_UXF#DATA_BROKER_INSTANCE_METADATA_UPDATE_REQUESTED';\nexport const DATA_BROKER_INSTANCE_ID_CHANGED =\n\t'SN_UXF#DATA_BROKER_INSTANCE_ID_CHANGED';\nexport const DATA_BROKER_INSTANCE_EVALUATION_MODE_UPDATED =\n\t'SN_UXF#DATA_BROKER_INSTANCE_EVALUATION_MODE_UPDATED';\nexport const DATA_BROKER_INSTANCE_EVENT_MAPPING_CREATED =\n\t'SN_UXF#DATA_BROKER_INSTANCE_EVENT_MAPPING_CREATED';\nexport const DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_CREATED =\n\t'SN_UXF#DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_CREATED';\nexport const DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_CHANGED =\n\t'SN_UXF#DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_CHANGED';\nexport const DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_DELETED =\n\t'SN_UXF#DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_DELETED';\n","export const CLIENT_STATE_PARAMETER_CREATED =\n\t'SN_UXF#CLIENT_STATE_PARAMETER_CREATED';\nexport const CLIENT_STATE_PARAMETER_DELETED =\n\t'SN_UXF#CLIENT_STATE_PARAMETER_DELETED';\nexport const CLIENT_STATE_PARAMETER_CHANGED =\n\t'SN_UXF#CLIENT_STATE_PARAMETER_CHANGED';\nexport const CLIENT_STATE_DATA_REQUESTED = 'SN_UXF#CLIENT_STATE_DATA_REQUESTED';\n","import { unstableResolvePropertySelectorValue } from '@servicenow/ui-core';\nimport { t } from 'sn-translate';\nimport cloneDeep from 'lodash/cloneDeep';\nimport find from 'lodash/find';\nimport get from 'lodash/get';\nimport isArray from 'lodash/isArray';\nimport isEmpty from 'lodash/isEmpty';\nimport isEqual from 'lodash/isEqual';\nimport reduce from 'lodash/reduce';\nimport {\n\tCONTEXT_NAMESPACE,\n\tDATA_BROKER_INPUT_PROPERTIES_NAME,\n\tDATA_BROKER_OUTPUT_PROPERTIES_NAME,\n\tDATA_NAMESPACE,\n\tUPDATE_CLIENT_STATE_HANDLER_ID\n} from '../constants';\nimport { DataBrokerInstance, ElementEvent, EventHandler } from '../models';\nimport PageTreeModel, { CONTAINER_TYPE, LEAF_TYPE } from '../models/pageTree';\nimport { getProperty } from './componentList/utils';\nimport {\n\tELEMENT_INSTANCE_NAME,\n\tACTIVE_ROUTE,\n\tACTIVE_SCREEN,\n\tREPEATED_VIEWPORT_TAB_DATA,\n\tVIEWPORT_ROUTES,\n\tIS_HIDDEN\n} from './element/reservedPropertyIds';\nimport {\n\tDATABROKER_OP,\n\tDECLARATIVE_ACTION,\n\tEVENT,\n\tCLIENT_SCRIPT\n} from './elementEventMappings/constants';\nimport {\n\tgetWithNullDefault,\n\tnormalizeRowColumnSlots,\n\tmatchBindingSyntax,\n\tmatchStateBindingSyntax,\n\tmatchContextSessionBindingSyntax,\n\tmatchScriptSyntax,\n\tresolveScriptedPropertyValue,\n\tresolvePropertyBinding\n} from '../utils';\nimport { PAGE_STATUS_ACTIVE } from './page/constants';\nimport { computeEventMappingTargetKeys } from './page/utils/shared';\nimport createContextBindings from './pageProperties/utils/createContextBindings';\nimport { getShorthandFromUxValue, isUxValueModel } from '../factories';\nimport { SCRIPT_SHORTHAND_PATTERN } from '../factories/constants';\nimport { formatEventNameAndLabel } from './elementEventMappings/utils';\nimport isNil from 'lodash/isNil';\nimport reduceContextBindingsWithAncestors from '../sn-uxf-builder-middleware/pageProperties/utils/reduceContextBindingsWithAncestors';\nimport { getLayoutFromMacroponent } from './templates/utils/getLayoutFromMacroponent';\nimport { compareLayouts } from './element/defaultLayoutElementHandlers';\nimport createElementArray from './element/utils/createElementArray';\nimport { ELEMENT_PROPERTY_UPDATED } from './element/elementActions';\nimport {\n\tELEMENT_EVENT_MAPPING_HANDLER_CHANGED,\n\tPAGE_INTERNAL_EVENT_MAPPING_HANDLER_CHANGED\n} from './elementEventMappings/elementEventMappingsActions';\nimport {\n\tDATA_BROKER_INSTANCE_PROPERTY_UPDATED,\n\tDATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_CHANGED\n} from './dataBrokers/dataBrokerInstances/dataBrokerInstancesActions';\nimport { CLIENT_STATE_PARAMETER_CHANGED } from './clientState/clientStateActions';\n\nconst supportedPropertyTypes = [\n\t'boolean',\n\t'choice',\n\t'condition_string',\n\t'field_list',\n\t'field',\n\t'html',\n\t'json',\n\t'number',\n\t'reference',\n\t'string',\n\t'table_name',\n\t'icon',\n\t'url',\n\t'variant',\n\t'css',\n\t'text'\n];\n\n// In place to maintain compatability with older Glide builds that return type in\n// the wrong format.\nconst typeTranslationLookup = {\n\t'True/False': 'boolean',\n\tChoice: 'choice',\n\tReference: 'reference',\n\tString: 'string',\n\t'Table Name': 'table_name'\n};\n\nconst createExposedProperty = (rawProperty) => {\n\tconst typeMeta = {};\n\tconst requestedType =\n\t\ttypeTranslationLookup[rawProperty.type] || rawProperty.type;\n\tconst type = supportedPropertyTypes.includes(requestedType)\n\t\t? requestedType\n\t\t: 'string';\n\n\tif (type === 'choice') {\n\t\ttypeMeta['choices'] = rawProperty.choices.map((choice) => ({\n\t\t\tlabel: choice.label,\n\t\t\tvalue: choice.value\n\t\t}));\n\t\tif (rawProperty.variant) {\n\t\t\ttypeMeta['variant'] = rawProperty.variant;\n\t\t}\n\t} else if (type === 'reference') {\n\t\ttypeMeta['reference'] = {\n\t\t\ttable: rawProperty.reference,\n\t\t\treferenceFilter: rawProperty.referenceFilter\n\t\t};\n\t} else if (\n\t\ttype === 'condition_string' ||\n\t\ttype === 'field' ||\n\t\ttype === 'field_list'\n\t) {\n\t\ttypeMeta['table'] = rawProperty.table;\n\t\tif (type !== 'condition_string' && rawProperty.variant) {\n\t\t\ttypeMeta['variant'] = rawProperty.variant;\n\t\t}\n\t}\n\n\ttypeMeta['translatable'] = rawProperty.translatable;\n\n\tconst propObj = {\n\t\tid: rawProperty.columnName,\n\t\tname: rawProperty.columnName,\n\t\tlabel: rawProperty.label,\n\t\tvalue: rawProperty.value,\n\t\treadOnly: rawProperty.readOnly,\n\t\ttype,\n\t\ttypeMeta,\n\t\tinterfaceApiName: rawProperty.interfaceApiName,\n\t\temptyStateBehavior: rawProperty.emptyStateBehavior,\n\t\tselectable: rawProperty.selectable,\n\t\tdescription: rawProperty.description,\n\t\terror: rawProperty.error,\n\t\tdefaultValue: rawProperty.defaultValue,\n\t\ttranslatable: rawProperty.translatable\n\t};\n\n\treturn propObj;\n};\n\nfunction getElementTreeIcon(tag, isRoot, isModal, isHidden) {\n\tif (isModal) {\n\t\treturn !isHidden ? 'square-fill' : 'eye-slash-fill';\n\t}\n\tif (isRoot) {\n\t\treturn 'grid-three-fill';\n\t}\n\tif (isHidden) {\n\t\treturn 'eye-slash-fill';\n\t}\n\tswitch (tag) {\n\t\tcase undefined:\n\t\t\treturn 'square-dashed-fill';\n\t\tcase 'now-uxf-page-container':\n\t\tcase 'now-uxf-page-simple-container':\n\t\t\treturn 'record-activity-outline';\n\t\tcase 'now-uxf-visualization-connected':\n\t\tcase 'sn-kpi-details':\n\t\tcase 'macroponent-3119f143532510102b54ddeeff7b126e': // Dashboard viewport\n\t\t\treturn 'chart-spline-outline';\n\t\tcase 'now-record-form-section-connected':\n\t\tcase 'now-record-form-section-column-layout':\n\t\tcase 'now-record-common-templates-connected':\n\t\tcase 'macroponent-4815dd32c7401010d00628caf4c2604f': // form-tabset\n\t\t\treturn 'score-list-outline';\n\t\tcase 'sn-component-filter':\n\t\tcase 'sn-tab-filter':\n\t\t\treturn 'filter-outline';\n\t\tcase 'now-email-client-composer-connected':\n\t\tcase 'now-email-client-mini-composer-connected':\n\t\tcase 'now-email-client-quick-messages':\n\t\tcase 'now-email-client-viewer-connected':\n\t\t\treturn 'envelope-outline';\n\t\tcase 'now-contextual-sidebar':\n\t\tcase 'now-uxf-tab-set':\n\t\t\treturn 'tabset-outline';\n\t\tcase 'now-link-set':\n\t\tcase 'now-link-set-group':\n\t\tcase 'now-text-link':\n\t\tcase 'now-iframe':\n\t\t\treturn 'link-outline';\n\t\tcase 'now-avatar':\n\t\tcase 'now-image':\n\t\tcase 'now-icon':\n\t\t\treturn 'image-outline';\n\t\tcase 'now-stylized-text':\n\t\tcase 'now-heading':\n\t\t\treturn 'text-outline';\n\t\tcase 'sn-search-results-container':\n\t\tcase 'sn-search-facets':\n\t\tcase 'sn-search-combobox':\n\t\t\treturn 'magnifying-glass-fill';\n\t\tcase 'now-record-list-connected-related':\n\t\tcase 'now-record-list-connected':\n\t\tcase 'now-record-list-connected-snapshot':\n\t\t\treturn 'table-outline';\n\t\tcase 'sn-catalog-action':\n\t\tcase 'sn-catalog-builder-bridge-modal':\n\t\tcase 'sn-cb-dashboard':\n\t\tcase 'sn-catalog-builder-item-modal':\n\t\tcase 'sn-catalog-builder-item-preview':\n\t\tcase 'sn-catalog-description':\n\t\tcase 'sn-catalog-form':\n\t\tcase 'sn-catalog-iframe':\n\t\tcase 'macroponent-afeef20635001010f877265d86f080df': // Catalog-item\n\t\tcase 'macroponent-9301c99b73031010e12d1e3014f6a778': // Catalog item templates\n\t\tcase 'sn-catalog-quantity':\n\t\tcase 'sn-catalog-wizard':\n\t\tcase 'sn-catalog-wizard-connected':\n\t\tcase 'sn-catalog-form-connected':\n\t\t\treturn 'shopping-cart-outline';\n\t\tdefault:\n\t\t\treturn 'component-outline';\n\t}\n}\n\n// TODO: this fn assumes that layout.items matches DOM order...which may not be true\nfunction sortChildrenUsingGrid(elementId, items, children) {\n\tconst childLookup = children.reduce((acc, child) => {\n\t\tconst key = child.slot && child.slot.name;\n\t\tconst existingValue = acc[key] || [];\n\t\treturn {\n\t\t\t...acc,\n\t\t\t[key]: [...existingValue, child]\n\t\t};\n\t}, {});\n\n\treturn items.map((item) => ({\n\t\tid: `${elementId}-${item.slotName}`,\n\t\telementId,\n\t\tslotName: item.slotName,\n\t\tinstanceName: item.slotName,\n\t\tchildren: childLookup[item.slotName] ? childLookup[item.slotName] : [],\n\t\tcomponent: {}\n\t}));\n}\n\nfunction sortChildrenUsingNamedSlots(elementId, slots, children) {\n\tconst childLookup = children.reduce((acc, child) => {\n\t\tconst key = child.slot && child.slot.name;\n\t\tconst existingValue = acc[key] || [];\n\t\treturn {\n\t\t\t...acc,\n\t\t\t[key]: [...existingValue, child]\n\t\t};\n\t}, {});\n\n\treturn slots.map((slot) => ({\n\t\tid: `${elementId}-${slot}`,\n\t\telementId,\n\t\tslotName: slot,\n\t\tinstanceName: slot,\n\t\tchildren: childLookup[slot] ? childLookup[slot] : [],\n\t\tcomponent: {}\n\t}));\n}\n\nfunction elementHasNamedSlots(element) {\n\tconst slots = get(element, 'component.slots', []);\n\n\treturn (\n\t\tslots.filter((slot) => {\n\t\t\treturn slot !== '@default';\n\t\t}).length > 0\n\t);\n}\n\nfunction resolveDynamicValue(isHiddenValue, clientScriptApi) {\n\tif (!isHiddenValue || typeof isHiddenValue !== 'string') {\n\t\treturn '';\n\t}\n\tconst basicBindingMatcher = matchBindingSyntax(isHiddenValue);\n\tconst stateParamBindingMatcher = matchStateBindingSyntax(isHiddenValue);\n\tconst scriptBindingMatcher = matchScriptSyntax(isHiddenValue);\n\n\tlet resolvedValue = '';\n\tif (stateParamBindingMatcher || basicBindingMatcher) {\n\t\tresolvedValue = get(clientScriptApi, isHiddenValue.slice(1));\n\t}\n\n\tif (scriptBindingMatcher) {\n\t\treturn resolveScriptedPropertyValue({\n\t\t\tmatchedScript: scriptBindingMatcher,\n\t\t\tclientScriptApi\n\t\t});\n\t}\n\treturn resolvedValue;\n}\n\nfunction getHiddenElements(elementArr, clientScriptApi) {\n\treturn elementArr.reduce((acc, cur) => {\n\t\treturn {\n\t\t\t...acc,\n\t\t\t[cur.id]: cur.isHidden\n\t\t\t\t? !!resolveDynamicValue(cur.isHidden, clientScriptApi)\n\t\t\t\t: false\n\t\t};\n\t}, {});\n}\n\nfunction getElementTree(\n\trootElement,\n\thiddenElements,\n\tisModalDescendant = false,\n\tparentElement = null\n) {\n\tif (!rootElement) {\n\t\treturn {};\n\t}\n\n\tconst {\n\t\tid,\n\t\telementId,\n\t\tslotName,\n\t\tinstanceName: label,\n\t\tchildren,\n\t\tcomponent,\n\t\tlayout,\n\t\tisModal\n\t} = rootElement;\n\n\tif (!id) {\n\t\treturn {};\n\t}\n\n\tlet sortedChildren = children;\n\n\tconst layoutItems = getWithNullDefault(\n\t\tnormalizeRowColumnSlots(layout),\n\t\t'default.items',\n\t\t[]\n\t);\n\n\tif (layoutItems.length > 0) {\n\t\tsortedChildren = sortChildrenUsingGrid(id, layoutItems, children);\n\t\t// concat modals since they are not assigned to a slot on the layout\n\t\tsortedChildren = sortedChildren.concat(\n\t\t\t...children.filter((child) => child.isModal)\n\t\t);\n\t}\n\n\tif (elementHasNamedSlots(rootElement)) {\n\t\tsortedChildren = sortChildrenUsingNamedSlots(\n\t\t\tid,\n\t\t\tget(rootElement, 'component.slots', []),\n\t\t\tchildren\n\t\t);\n\n\t\t// concat modals since they are not assigned to a slot on the layout\n\t\tsortedChildren = sortedChildren.concat(\n\t\t\t...children.filter((child) => child.isModal)\n\t\t);\n\t}\n\n\tconst isRoot = parentElement === null;\n\tconst tree = {\n\t\tid,\n\t\telementId: elementId || id,\n\t\tslotName,\n\t\tlabel,\n\t\tisModal: !!isModal,\n\t\tisRoot,\n\t\tisModalDescendant: !!isModalDescendant,\n\t\tisNamedSlot: elementHasNamedSlots(parentElement),\n\t\ticon: getElementTreeIcon(\n\t\t\tcomponent.tag,\n\t\t\tisRoot,\n\t\t\tisModal,\n\t\t\t!!hiddenElements[id]\n\t\t),\n\t\tchildren: sortedChildren.map((child) =>\n\t\t\tgetElementTree(\n\t\t\t\tchild,\n\t\t\t\thiddenElements,\n\t\t\t\t!!isModal || !!isModalDescendant,\n\t\t\t\trootElement\n\t\t\t)\n\t\t),\n\t\tcomponent\n\t};\n\n\tif (isModal) {\n\t\ttree.layoutTree = new PageTreeModel({\n\t\t\trootElement\n\t\t});\n\t}\n\n\treturn tree;\n}\n\nfunction getElementStyles(elementArr) {\n\treturn reduce(\n\t\telementArr,\n\t\t(acc, cur) => {\n\t\t\tacc[cur.id] = cur.styles;\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n}\n\nfunction addTemplateId(layout, templateId) {\n\tconst layoutDefault = get(layout, 'default', null);\n\tif (layoutDefault) {\n\t\tlayoutDefault.templateId = templateId;\n\t}\n\treturn layout;\n}\nfunction getIsLayoutModified(element, templatesDefinitions) {\n\tconst { layout } = element;\n\tif (layout) {\n\t\tconst templateId = get(layout, 'default.templateId', null);\n\n\t\tconst templateDefinition = templatesDefinitions.find(\n\t\t\t({ id }) => id === templateId\n\t\t);\n\t\tconst templateLayout = getLayoutFromMacroponent(\n\t\t\tget(templateDefinition, 'macroponentInstance', null)\n\t\t);\n\t\taddTemplateId(templateLayout, templateId);\n\n\t\tconst isLayoutModified = !compareLayouts(layout, templateLayout);\n\t\treturn isLayoutModified;\n\t}\n\treturn null;\n}\n\nfunction getElementProperties(elementArr) {\n\treturn reduce(\n\t\telementArr,\n\t\t(acc, cur) => {\n\t\t\tacc[cur.id] = cur.properties.map((property) => ({\n\t\t\t\t...property,\n\t\t\t\treadOnly: property.readOnly\n\t\t\t}));\n\t\t\tconst isScripted =\n\t\t\t\tcur.isHidden && typeof cur.isHidden === 'string'\n\t\t\t\t\t? !!cur.isHidden.match(SCRIPT_SHORTHAND_PATTERN)\n\t\t\t\t\t: false;\n\t\t\tacc[cur.id].unshift({\n\t\t\t\tid: IS_HIDDEN,\n\t\t\t\tname: IS_HIDDEN,\n\t\t\t\tlabel: t('Hide component'),\n\t\t\t\tdescription: t('Set component visibility via data resource or script'),\n\t\t\t\tvalue: cur.isHidden || '@',\n\t\t\t\treadOnly: false,\n\t\t\t\ttype: 'string',\n\t\t\t\talwaysBound: true,\n\t\t\t\tisScripted,\n\t\t\t\tisStatic: false\n\t\t\t});\n\t\t\tacc[cur.id].unshift({\n\t\t\t\tid: ELEMENT_INSTANCE_NAME,\n\t\t\t\tname: ELEMENT_INSTANCE_NAME,\n\t\t\t\tlabel: 'Instance Name', //TODO: Translate me\n\t\t\t\tvalue: cur.instanceName,\n\t\t\t\treadOnly: false,\n\t\t\t\ttype: 'string'\n\t\t\t});\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n}\n\nfunction getDependentProperties(property, properties) {\n\t/**\n\t * For each property, check whether there are any other properties\n\t * whose typeMeta objects contain references to that property.\n\t */\n\tconst propertyReference = `@${property.id}`;\n\tconst dependents = reduce(\n\t\tproperties,\n\t\t(acc, prop) => {\n\t\t\tconst { typeMeta } = prop;\n\t\t\ttypeMeta &&\n\t\t\t\tObject.entries(typeMeta).forEach(([, data]) => {\n\t\t\t\t\tif (typeof data === 'string') {\n\t\t\t\t\t\tif (data === propertyReference) {\n\t\t\t\t\t\t\tacc.push({ id: prop.id });\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (data && typeof data === 'object') {\n\t\t\t\t\t\tObject.values(data).forEach((val) => {\n\t\t\t\t\t\t\tif (val === propertyReference) {\n\t\t\t\t\t\t\t\tacc.push({ id: prop.id });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\treturn acc;\n\t\t},\n\t\t[]\n\t);\n\treturn dependents;\n}\n\nconst getElementLayouts = (elementArr, templatesDefinitions) => {\n\treturn reduce(\n\t\telementArr,\n\t\t(acc, cur) => {\n\t\t\tconst type = cur.elementUsesSNLayout ? CONTAINER_TYPE : LEAF_TYPE;\n\t\t\tacc[cur.id] = {\n\t\t\t\tlayout: cur.layout,\n\t\t\t\ttype,\n\t\t\t\tisLayoutModified: getIsLayoutModified(cur, templatesDefinitions)\n\t\t\t};\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n};\n\nconst getElementEvents = (elementArr) => {\n\treturn reduce(\n\t\telementArr,\n\t\t(acc, cur) => {\n\t\t\tacc[cur.id] = cur['dispatchedEvents'];\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n};\n\nconst getElementEventMappings = (elementArr) => {\n\treturn elementArr.reduce((cumulativeEventMappings, { id, eventMappings }) => {\n\t\treturn {\n\t\t\t...cumulativeEventMappings,\n\t\t\t[id]: eventMappings.map(({ eventId, eventMappingId }) => ({\n\t\t\t\teventId,\n\t\t\t\teventMappingId\n\t\t\t}))\n\t\t};\n\t}, {});\n};\n\nconst getScreenEventMappings = (screenEventMappings) => {\n\treturn screenEventMappings.map(({ eventId, eventMappingId }) => ({\n\t\teventId,\n\t\teventMappingId\n\t}));\n};\n\nconst getInternalEventMappings = (rootElement) => {\n\tconst mappings = get(rootElement, 'internalEventMappings', []);\n\tif (isEmpty(mappings)) {\n\t\treturn [];\n\t} else {\n\t\treturn mappings;\n\t}\n};\n\nconst getElementToEventMappingHandlerMap = (\n\telementArr,\n\telementEventMappings,\n\teventMappingHandlers\n) => {\n\tconst map = {};\n\tObject.values(eventMappingHandlers).forEach((handlers) => {\n\t\thandlers.forEach((handler) => {\n\t\t\tif (!map[handler.handlerTypeId]) {\n\t\t\t\tmap[handler.handlerTypeId] = [];\n\t\t\t}\n\t\t\tmap[handler.handlerTypeId].push(\n\t\t\t\telementArr.find((element) => {\n\t\t\t\t\treturn element.eventMappings.find((eventMapping) => {\n\t\t\t\t\t\treturn eventMapping.targets.find(\n\t\t\t\t\t\t\t(target) => target.targetId === handler.handlerId\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t);\n\t\t});\n\t});\n\treturn map;\n};\n\nfunction getDataBrokerInstanceProperties(dataBrokerInstances = []) {\n\treturn dataBrokerInstances.reduce((acc, { id, properties = {} }) => {\n\t\tacc[id] = Object.values(properties || {}).map((prop) => {\n\t\t\treturn createExposedProperty(prop);\n\t\t});\n\t\treturn acc;\n\t}, {});\n}\n\nfunction setOnChangeForDependeeProperties(propertiesMap) {\n\treturn Object.entries(propertiesMap || {}).reduce((acc, [id, props]) => {\n\t\tconst transformedProperties = (props || []).map((prop = {}) => {\n\t\t\tconst dependents = getDependentProperties(prop, props);\n\t\t\t// If there are dependent properties, create an onChange function for the\n\t\t\t// current property so that the dependees are updated when its value changes.\n\t\t\tif (dependents.length) {\n\t\t\t\tprop.onChange = (updateElement) => {\n\t\t\t\t\tdependents.forEach((dependent) => {\n\t\t\t\t\t\tconst { id } = dependent;\n\t\t\t\t\t\tupdateElement.properties[id].value = null;\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn prop;\n\t\t});\n\n\t\tacc[id] = transformedProperties;\n\t\treturn acc;\n\t}, {});\n}\n\nfunction getDataBrokerInstances(dataBrokerInstances) {\n\treturn dataBrokerInstances.map(\n\t\t({\n\t\t\tid,\n\t\t\tinstanceName,\n\t\t\treadEvaluationMode,\n\t\t\tdefinition,\n\t\t\tproperties,\n\t\t\tselectableProps,\n\t\t\tsimpleMutationBroker,\n\t\t\toutputProperties,\n\t\t\tclientStateDataBrokerTagName,\n\t\t\tdispatchedEvents,\n\t\t\teventMappings\n\t\t}) => {\n\t\t\tconst transformedPropertiesMap = Object.entries(properties).reduce(\n\t\t\t\t(acc, [key, value]) => {\n\t\t\t\t\tacc[key] = createExposedProperty(value);\n\t\t\t\t\treturn acc;\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\tid,\n\t\t\t\tinstanceName,\n\t\t\t\treadEvaluationMode,\n\t\t\t\tdefinition,\n\t\t\t\tproperties: transformedPropertiesMap,\n\t\t\t\tselectableProps,\n\t\t\t\tsimpleMutationBroker,\n\t\t\t\tselectablePropPreview: `@${id}/preview`,\n\t\t\t\tselectablePropExecutionTime: `@${id}/executionTime`,\n\t\t\t\toutputProperties,\n\t\t\t\tclientStateDataBrokerTagName,\n\t\t\t\tdispatchedEvents,\n\t\t\t\teventMappings\n\t\t\t};\n\t\t}\n\t);\n}\n\nconst getDataBrokerEventMappings = (dataBrokerInstances) => {\n\treturn dataBrokerInstances.reduce(\n\t\t(cumulativeMappings, { id, eventMappings = [] }) => {\n\t\t\treturn {\n\t\t\t\t...cumulativeMappings,\n\t\t\t\t[id]: eventMappings\n\t\t\t};\n\t\t},\n\t\t{}\n\t);\n};\n\nfunction getEventMappingTargetKey(\n\tdeclarativeAction,\n\tevent,\n\toperation,\n\tclientScript,\n\tkey\n) {\n\tlet targetKey;\n\tif (declarativeAction) {\n\t\ttargetKey = computeEventMappingTargetKeys(DECLARATIVE_ACTION)[key];\n\t} else if (event) {\n\t\ttargetKey = computeEventMappingTargetKeys(EVENT)[key];\n\t} else if (operation) {\n\t\ttargetKey = computeEventMappingTargetKeys(DATABROKER_OP)[key];\n\t} else if (clientScript) {\n\t\ttargetKey = computeEventMappingTargetKeys(CLIENT_SCRIPT)[key];\n\t} else {\n\t\ttargetKey = null;\n\t}\n\treturn targetKey;\n}\n\nfunction getHandlerTypeId(declarativeAction, event, operation, clientScript) {\n\tconst targetIdKey =\n\t\tgetEventMappingTargetKey(\n\t\t\tdeclarativeAction,\n\t\t\tevent,\n\t\t\toperation,\n\t\t\tclientScript,\n\t\t\t'idKey'\n\t\t) || 'sysId';\n\treturn get(\n\t\tdeclarativeAction || event || operation || clientScript,\n\t\ttargetIdKey,\n\t\tnull\n\t);\n}\n\nfunction getHandlerValuesCollection(\n\tdeclarativeAction,\n\tevent,\n\toperation,\n\tclientScript\n) {\n\tconst targetValueKey =\n\t\tgetEventMappingTargetKey(\n\t\t\tdeclarativeAction,\n\t\t\tevent,\n\t\t\toperation,\n\t\t\tclientScript,\n\t\t\t'valueKey'\n\t\t) || 'payload';\n\tconst values = get(\n\t\tdeclarativeAction || event || operation,\n\t\ttargetValueKey,\n\t\t[]\n\t);\n\treturn values.map((value) => createExposedProperty(value));\n}\n\nconst getEventMappingHandlers = (elementArr) => {\n\treturn elementArr.reduce((cumulativeHandlers, element) => {\n\t\treturn {\n\t\t\t...cumulativeHandlers,\n\t\t\t...element.eventMappings.reduce((cumulativeMappings, mapping) => {\n\t\t\t\treturn {\n\t\t\t\t\t...cumulativeMappings,\n\t\t\t\t\t[mapping.eventMappingId]: mapping.targets.map(\n\t\t\t\t\t\t({\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\ttargetId,\n\t\t\t\t\t\t\tclientTransformScript,\n\t\t\t\t\t\t\tdeclarativeAction,\n\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\toperation,\n\t\t\t\t\t\t\tclientScript\n\t\t\t\t\t\t}) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\thandlerType: type,\n\t\t\t\t\t\t\t\thandlerId: targetId,\n\t\t\t\t\t\t\t\thandlerTypeId: getHandlerTypeId(\n\t\t\t\t\t\t\t\t\tdeclarativeAction,\n\t\t\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\t\t\toperation,\n\t\t\t\t\t\t\t\t\tclientScript\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tsourceId: operation ? operation.parentResourceId : '',\n\t\t\t\t\t\t\t\thandlerName: operation ? operation.operationName : '',\n\t\t\t\t\t\t\t\tclientTransformScript,\n\t\t\t\t\t\t\t\tvalues: getHandlerValuesCollection(\n\t\t\t\t\t\t\t\t\tdeclarativeAction,\n\t\t\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\t\t\toperation,\n\t\t\t\t\t\t\t\t\tclientScript\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t};\n\t\t\t}, {})\n\t\t};\n\t}, {});\n};\n\nconst isContextBoundProperty = (property) =>\n\tproperty &&\n\ttypeof property === 'string' &&\n\tproperty.match(\n\t\tnew RegExp(`^(${CONTEXT_NAMESPACE})\\\\.(props|session|app)((\\\\.[\\\\w]+)+)$`)\n\t);\n\nconst isContextSessionBinding = (property) =>\n\tisContextBoundProperty(property) &&\n\tmatchContextSessionBindingSyntax(property);\n\nconst isContextPropsBinding = (property) =>\n\tisContextBoundProperty(property) &&\n\tget(matchBindingSyntax(property), 'id', null) === 'props';\n\nconst isContextAppBinding = (property) =>\n\tisContextBoundProperty(property) &&\n\tget(matchBindingSyntax(property), 'id', null) === 'app';\n\nconst isDataBoundProperty = (property) =>\n\tproperty &&\n\ttypeof property === 'string' &&\n\tproperty.match(\n\t\tnew RegExp(`^(${DATA_NAMESPACE})\\\\.([\\\\w\\\\s]+)((\\\\.[\\\\w]+)+)$`)\n\t);\n\nconst getBoundValueFromClientScriptApi = (\n\tbindingExpression,\n\tclientScriptApi\n) => {\n\treturn get(clientScriptApi, bindingExpression.slice(1), null);\n};\n\nconst getDataBrokerInputPropertiesFromPageState = (\n\tpageState,\n\tdataBrokerDataId,\n\tclientScriptApi\n) => {\n\tconst dataBrokerInstances = get(pageState, 'dataBrokerInstances', []);\n\n\tconst dataBrokerInstance = find(dataBrokerInstances, {\n\t\tid: dataBrokerDataId\n\t});\n\n\tif (!dataBrokerInstance) {\n\t\treturn {};\n\t}\n\n\tconst pageProperties = createContextBindings(pageState);\n\n\treturn Object.values(dataBrokerInstance.properties).reduce(\n\t\t(acc, property) => {\n\t\t\tif (property.value && isContextPropsBinding(property.value)) {\n\t\t\t\t// Context Prop Bindings\n\t\t\t\tconst pagePropName = property.value.substring(\n\t\t\t\t\t`${CONTEXT_NAMESPACE}.props`.length + 1\n\t\t\t\t);\n\n\t\t\t\tif (pageProperties[pagePropName]) {\n\t\t\t\t\tacc[property.name || property.columnName] =\n\t\t\t\t\t\tpageProperties[pagePropName];\n\t\t\t\t} else {\n\t\t\t\t\tacc[property.name || property.columnName] = '';\n\t\t\t\t}\n\t\t\t} else if (property.value && isContextSessionBinding(property.value)) {\n\t\t\t\t// Context session bindings\n\t\t\t\tacc[\n\t\t\t\t\tproperty.name || property.columnName\n\t\t\t\t] = getBoundValueFromClientScriptApi(property.value, clientScriptApi);\n\t\t\t} else if (property.value && isContextAppBinding(property.value)) {\n\t\t\t\t// Context app bindings\n\t\t\t\tacc[\n\t\t\t\t\tproperty.name || property.columnName\n\t\t\t\t] = getBoundValueFromClientScriptApi(property.value, clientScriptApi);\n\t\t\t} else if (\n\t\t\t\ttypeof property.value === 'string' &&\n\t\t\t\tmatchStateBindingSyntax(property.value)\n\t\t\t) {\n\t\t\t\t// State bindings\n\t\t\t\tacc[\n\t\t\t\t\tproperty.name || property.columnName\n\t\t\t\t] = getBoundValueFromClientScriptApi(property.value, clientScriptApi);\n\t\t\t} else {\n\t\t\t\tacc[property.name || property.columnName] = property.value;\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n};\n\nfunction getPageMetadata(value) {\n\treturn {\n\t\ttype: value.type,\n\t\tname: value.name,\n\t\tsysId: value.sysId,\n\t\tuiTypeParameters: value.uiTypeParameters || {},\n\t\tpageStatus: value.pageStatus || PAGE_STATUS_ACTIVE\n\t};\n}\n\nfunction coerceJSONPagePropertyValue(value) {\n\tlet valueToUse = value;\n\n\tif (typeof valueToUse === 'object') {\n\t\ttry {\n\t\t\tvalueToUse = JSON.stringify(valueToUse);\n\t\t} catch (_) {\n\t\t\t/*do nothing*/\n\t\t}\n\t}\n\n\treturn valueToUse;\n}\n\nfunction getPageProperties(rootElement) {\n\treturn rootElement.macroponentProperties.map(\n\t\t({\n\t\t\tname,\n\t\t\tid,\n\t\t\tvalue,\n\t\t\ttestValue,\n\t\t\tinherited,\n\t\t\tfieldType,\n\t\t\tdefaultValue,\n\t\t\tdescription,\n\t\t\ttypeMetadata,\n\t\t\tlabel\n\t\t}) => {\n\t\t\tlet valueToUse = value,\n\t\t\t\ttestValueToUse = testValue;\n\t\t\tif (fieldType === 'json') {\n\t\t\t\tvalueToUse = coerceJSONPagePropertyValue(value);\n\t\t\t\ttestValueToUse = coerceJSONPagePropertyValue(testValue);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tname,\n\t\t\t\tid,\n\t\t\t\tdescription,\n\t\t\t\tvalue: isNil(valueToUse) ? defaultValue : valueToUse,\n\t\t\t\ttestValue: testValueToUse,\n\t\t\t\tinherited,\n\t\t\t\tfieldType,\n\t\t\t\ttypeMetadata,\n\t\t\t\tlabel\n\t\t\t};\n\t\t}\n\t);\n}\n\nfunction stripViewportsProps(pageState) {\n\tif (!pageState.rootElement) {\n\t\treturn pageState;\n\t}\n\n\tconst viewportElementIds = pageState.viewportElementIds || [];\n\n\tconst nodes = [pageState.rootElement];\n\twhile (nodes.length) {\n\t\tconst node = nodes.shift();\n\t\tif (viewportElementIds.includes(node.id)) {\n\t\t\tdelete node.properties[ACTIVE_ROUTE];\n\t\t\tdelete node.properties[ACTIVE_SCREEN];\n\t\t\tdelete node.properties[REPEATED_VIEWPORT_TAB_DATA];\n\t\t\tdelete node.properties[VIEWPORT_ROUTES];\n\t\t} else {\n\t\t\tnodes.push(...node.children);\n\t\t}\n\t}\n\n\treturn {\n\t\tpageState\n\t};\n}\n\nfunction isPageStateDirty(pageState, pageStatePristine) {\n\tconst { pageState: pageStateWoViewportTabs } = stripViewportsProps(\n\t\tcloneDeep(pageState)\n\t);\n\tconst { pageState: pageStatePristineWoViewportTabs } = stripViewportsProps(\n\t\tcloneDeep(pageStatePristine)\n\t);\n\n\treturn !isEqual(pageStateWoViewportTabs, pageStatePristineWoViewportTabs);\n}\n\nconst addAllEventHandlers = (\n\teventHandlers = [],\n\tisAncestor = false,\n\tdataBrokerInstances,\n\tdataBrokerDefinitions,\n\tclientScripts = [],\n\tdispatchedEvents = [],\n\trootMacroponent = {},\n\tmacroponentPublicHandledEvents = []\n) => {\n\tlet newHandlers = dataBrokerInstances.reduce((acc, dbInstance) => {\n\t\tconst matchingHandler = eventHandlers.find(\n\t\t\t(handler) => handler.sourceId === dbInstance.id\n\t\t);\n\t\tif (matchingHandler) {\n\t\t\treturn acc;\n\t\t}\n\n\t\tconst definition = dataBrokerDefinitions.find(\n\t\t\t(def) => def.sysId === dbInstance.definition.id\n\t\t);\n\t\tconst operations = (definition && definition.operations) || [];\n\t\tconst operationsEventHandlers = operations.map((operation) => {\n\t\t\treturn new EventHandler({\n\t\t\t\tid: definition.sysId,\n\t\t\t\ttype: DATABROKER_OP,\n\t\t\t\tsourceName: dbInstance.instanceName,\n\t\t\t\tsourceId: dbInstance.id,\n\t\t\t\tlabel: operation.name,\n\t\t\t\tname: operation.name,\n\t\t\t\tancestor: isAncestor,\n\t\t\t\tpayloadFields: operation.eventProperties.map((prop) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...prop,\n\t\t\t\t\t\ttype: prop.fieldType\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t});\n\t\t});\n\t\treturn acc.concat(operationsEventHandlers);\n\t}, []);\n\n\tnewHandlers = newHandlers.concat(\n\t\tclientScripts.reduce((acc, clientScript) => {\n\t\t\tconst matchingHandler = eventHandlers.find(\n\t\t\t\t(handler) => handler.sourceId === clientScript.id\n\t\t\t);\n\n\t\t\tif (matchingHandler) {\n\t\t\t\treturn acc;\n\t\t\t}\n\n\t\t\tacc.push(\n\t\t\t\tnew EventHandler({\n\t\t\t\t\tid: clientScript.id,\n\t\t\t\t\tlabel: clientScript.name,\n\t\t\t\t\tincludes: clientScript.includes,\n\t\t\t\t\ttype: CLIENT_SCRIPT,\n\t\t\t\t\tsourceName: 'Client script',\n\t\t\t\t\tsourceId: clientScript.id,\n\t\t\t\t\tname: clientScript.name,\n\t\t\t\t\tancestor: isAncestor,\n\t\t\t\t\tpayloadFields: []\n\t\t\t\t})\n\t\t\t);\n\n\t\t\treturn acc;\n\t\t}, [])\n\t);\n\n\tnewHandlers = newHandlers.concat(\n\t\tmacroponentPublicHandledEvents.reduce((acc, dispatchedEvent) => {\n\t\t\tconst matchingHandler = eventHandlers.find(\n\t\t\t\t(handler) => handler.id === dispatchedEvent.id\n\t\t\t);\n\n\t\t\tif (matchingHandler) {\n\t\t\t\treturn acc;\n\t\t\t}\n\n\t\t\tacc.push(\n\t\t\t\tnew EventHandler({\n\t\t\t\t\tid: dispatchedEvent.id,\n\t\t\t\t\tapiName: dispatchedEvent.apiName,\n\t\t\t\t\tlabel: dispatchedEvent.label,\n\t\t\t\t\ttype: 'EVENT',\n\t\t\t\t\tsourceName: rootMacroponent.name,\n\t\t\t\t\tsourceId: rootMacroponent.id,\n\t\t\t\t\tname: dispatchedEvent.eventName,\n\t\t\t\t\tancestor: false,\n\t\t\t\t\tpayloadFields: dispatchedEvent.payloadShape.map((prop) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...prop,\n\t\t\t\t\t\t\ttype: prop.fieldType\n\t\t\t\t\t\t};\n\t\t\t\t\t}),\n\t\t\t\t\trelay: false\n\t\t\t\t})\n\t\t\t);\n\n\t\t\treturn acc;\n\t\t}, [])\n\t);\n\n\tnewHandlers = newHandlers.concat(\n\t\tdispatchedEvents.reduce((acc, dispatchedEvent) => {\n\t\t\tconst matchingHandler = eventHandlers.find(\n\t\t\t\t(handler) => handler.id === dispatchedEvent.id\n\t\t\t);\n\n\t\t\tif (matchingHandler) {\n\t\t\t\treturn acc;\n\t\t\t}\n\n\t\t\tconst isRelay = eventHandlers.find((handler) => {\n\t\t\t\tconst { name } = formatEventNameAndLabel(handler, rootMacroponent.id);\n\t\t\t\treturn name === dispatchedEvent.eventName;\n\t\t\t});\n\n\t\t\tacc.push(\n\t\t\t\tnew EventHandler({\n\t\t\t\t\tid: dispatchedEvent.id,\n\t\t\t\t\tapiName: dispatchedEvent.apiName,\n\t\t\t\t\tlabel: dispatchedEvent.label,\n\t\t\t\t\ttype: 'EVENT',\n\t\t\t\t\tsourceName: rootMacroponent.name,\n\t\t\t\t\tsourceId: rootMacroponent.id,\n\t\t\t\t\tname: dispatchedEvent.eventName,\n\t\t\t\t\tancestor: isAncestor,\n\t\t\t\t\tpayloadFields: dispatchedEvent.payloadShape.map((prop) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...prop,\n\t\t\t\t\t\t\ttype: prop.fieldType\n\t\t\t\t\t\t};\n\t\t\t\t\t}),\n\t\t\t\t\trelay: !!isRelay\n\t\t\t\t})\n\t\t\t);\n\n\t\t\treturn acc;\n\t\t}, [])\n\t);\n\n\treturn [...eventHandlers, ...newHandlers];\n};\n\n/**\n * generates data broker output & \"normal\" properties based on inputValues\n * @param {DataBrokerDefinition} dataBrokerDefinition\n * @param {Object} inputValues input values such as filter & graphqlData\n */\nconst generateDataBrokerProperties = (\n\tdataBrokerDefinition,\n\tinputValues = null\n) => {\n\tconst targetPropertyKey = inputValues\n\t\t? DATA_BROKER_INPUT_PROPERTIES_NAME\n\t\t: DATA_BROKER_OUTPUT_PROPERTIES_NAME;\n\tif (!dataBrokerDefinition[targetPropertyKey]) {\n\t\treturn {};\n\t}\n\treturn dataBrokerDefinition[targetPropertyKey].reduce(\n\t\t(acc, propertyConfig) => {\n\t\t\tacc[propertyConfig.name] = getProperty(propertyConfig);\n\t\t\tif (inputValues) {\n\t\t\t\tif (inputValues[propertyConfig.name]) {\n\t\t\t\t\tif (isUxValueModel(inputValues[propertyConfig.name])) {\n\t\t\t\t\t\tacc[propertyConfig.name].value = getShorthandFromUxValue(\n\t\t\t\t\t\t\tinputValues[propertyConfig.name]\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tacc[propertyConfig.name].value = inputValues[propertyConfig.name];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tacc[propertyConfig.name].value = propertyConfig.defaultValue;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n};\n\n/**\n * @typedef DBData\n * @property {Object} definition\n * @property {Object} inputValues\n * @property {String} elementLabel\n * @property {String} elementId\n */\n\n/**\n * @typedef DataBrokerDefinition\n * @property {Object} definition\n * @property {Object} inputParams\n * @property {String} name\n * @property {String} type\n * @property {String} sysId\n * @property {String} description\n * @property {String} hydrationSysId\n * @property {Object} outputSchema\n * @property {Object[]} operations\n * @property {Boolean} simpleMutationBroker\n */\n\n/**\n * @typedef dataBrokerInstance\n * @property {String} id\n * @property {String} definition\n * @property {String} instanceName\n * @property {Object} properties\n * @property {*} selectableProps\n * @property {Boolean} simpleMutationBroker\n * @property {Object[]} operations\n * @property {String} clientStateDataBrokerTagName\n * @property {Object} outputProperties\n */\n\n/**\n * this function creates DataBrokerInstances which will become part of the PageStateModel\n * @param {DBData[]} data information from the rootMacroponent associated with the data broker instance\n * @param {DataBrokerDefinition[]} dataBrokerDefinitions existing data broker definitions\n * @return {DataBrokerInstance[]}\n */\nconst createDataBrokerInstances = (data, dataBrokerDefinitions) => {\n\treturn isEmpty(dataBrokerDefinitions)\n\t\t? []\n\t\t: data.map((datum) => {\n\t\t\t\tconst definitionId = datum.definition.id;\n\n\t\t\t\tconst dataBrokerDefinition = find(dataBrokerDefinitions, {\n\t\t\t\t\tsysId: definitionId\n\t\t\t\t});\n\n\t\t\t\tif (!dataBrokerDefinition) {\n\t\t\t\t\treturn new DataBrokerInstance({\n\t\t\t\t\t\tid: datum.elementId,\n\t\t\t\t\t\tinstanceName: datum.elementLabel,\n\t\t\t\t\t\treadEvaluationMode: datum.readEvaluationMode,\n\t\t\t\t\t\tdefinition: {\n\t\t\t\t\t\t\t...(datum.definition || {}),\n\t\t\t\t\t\t\tinvalid: true\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconst dataBrokerInputProperties = generateDataBrokerProperties(\n\t\t\t\t\t\tdataBrokerDefinition,\n\t\t\t\t\t\tdatum.inputValues\n\t\t\t\t\t);\n\t\t\t\t\tconst dataBrokerOutputProperties = generateDataBrokerProperties(\n\t\t\t\t\t\tdataBrokerDefinition\n\t\t\t\t\t);\n\t\t\t\t\tconst { dispatchedEvents = [] } = dataBrokerDefinition;\n\t\t\t\t\tconst dataBrokerDispatchedEvents = dispatchedEvents.map(\n\t\t\t\t\t\t(ev) => new ElementEvent({ ...ev, id: ev.apiName })\n\t\t\t\t\t);\n\t\t\t\t\treturn new DataBrokerInstance({\n\t\t\t\t\t\tid: datum.elementId,\n\t\t\t\t\t\tinstanceName: datum.elementLabel,\n\t\t\t\t\t\treadEvaluationMode: datum.readEvaluationMode,\n\t\t\t\t\t\tdefinition: datum.definition,\n\t\t\t\t\t\tproperties: dataBrokerInputProperties,\n\t\t\t\t\t\tselectableProps: dataBrokerDefinition.selectableProps,\n\t\t\t\t\t\thydrationSysId: dataBrokerDefinition.hydrationSysId || null,\n\t\t\t\t\t\tclientStateDataBrokerTagName:\n\t\t\t\t\t\t\tdataBrokerDefinition.clientStateDataBrokerTagName,\n\t\t\t\t\t\teventMappings: datum.eventMappings,\n\t\t\t\t\t\toutputProperties: dataBrokerOutputProperties,\n\t\t\t\t\t\tdispatchedEvents: dataBrokerDispatchedEvents\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t  });\n};\n\nexport const createDataBrokerInstancePropertiesFromDataBrokerDefinition = (\n\tdataBrokerDefinition,\n\toutput = false\n) => {\n\tconst targetProperties = output\n\t\t? DATA_BROKER_OUTPUT_PROPERTIES_NAME\n\t\t: DATA_BROKER_INPUT_PROPERTIES_NAME;\n\tconst instanceProperties = dataBrokerDefinition[targetProperties].reduce(\n\t\t(acc, param) => {\n\t\t\tacc[param.name] = getProperty(param);\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n\treturn instanceProperties;\n};\n\nconst getStateParams = (params = []) => {\n\treturn params.map(({ name, type, initialValue }) => {\n\t\treturn { name, type, initialValue };\n\t});\n};\n\nconst mergeArray = (currentArr, updatedArr, prop) => {\n\treturn currentArr.map((currElem) => {\n\t\tconst updatedElem = updatedArr.find(\n\t\t\t(item) => item[prop] === currElem[prop]\n\t\t);\n\t\treturn { ...currElem, ...updatedElem };\n\t});\n};\n\nconst getElementByProperty = (element, propertyValue, path) => {\n\tconst nodes = [element];\n\tlet parent = null;\n\twhile (nodes.length && !parent) {\n\t\tconst node = nodes.shift();\n\t\tif (get(node, path, null) === propertyValue) {\n\t\t\tparent = node;\n\t\t} else {\n\t\t\tif (!isEmpty(node.children)) {\n\t\t\t\tnodes.push(...node.children);\n\t\t\t}\n\t\t}\n\t}\n\treturn parent;\n};\n\nconst getClientScriptApi = ({\n\telements = null,\n\tdataBrokerInstances = null,\n\tancestorPageProperties = null,\n\tclientStateData = null,\n\tdataBrokerDefinitions = null,\n\tpageState = null,\n\tappChromeSettings = null\n}) => {\n\tconst api = {\n\t\telements: null,\n\t\tdata: null,\n\t\tcontext: { props: null, session: null }\n\t};\n\n\t// process data brokers\n\tapi.data = dataBrokerInstances.reduce((acc, { id, definition }) => {\n\t\tif (definition.type === 'CLIENT_STATE') {\n\t\t\tconst targetDefinition =\n\t\t\t\tdataBrokerDefinitions.find((def) => def.sysId === definition.id) || {};\n\t\t\tconst selectableProps = get(targetDefinition, 'selectableProps', '[]');\n\t\t\tlet reduceClientStateProps = {};\n\t\t\ttry {\n\t\t\t\treduceClientStateProps = JSON.parse(selectableProps).reduce(\n\t\t\t\t\t(selectablePropAcc, prop) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...selectablePropAcc,\n\t\t\t\t\t\t\t[prop.name]: unstableResolvePropertySelectorValue(\n\t\t\t\t\t\t\t\t`@${id}/${prop.name}`\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t};\n\t\t\t\t\t},\n\t\t\t\t\t{}\n\t\t\t\t);\n\t\t\t} catch (_) {\n\t\t\t\t// do nothing\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...acc,\n\t\t\t\t[id]: reduceClientStateProps\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\t...acc,\n\t\t\t[id]: unstableResolvePropertySelectorValue(`@${id}/preview`)\n\t\t};\n\t}, {});\n\n\t// process context props\n\tconst pageProperties = reduceContextBindingsWithAncestors(\n\t\tpageState,\n\t\tancestorPageProperties\n\t);\n\tapi.context.props = Object.entries(pageProperties).reduce(\n\t\t(acc, [propName, propValue]) => {\n\t\t\tlet valueToUse = propValue;\n\t\t\tif (!propName.match(/\\.parent/)) {\n\t\t\t\tconst bindingMatcher =\n\t\t\t\t\ttypeof propValue === 'string' && matchBindingSyntax(propValue);\n\t\t\t\tif (bindingMatcher && bindingMatcher.namespace === DATA_NAMESPACE) {\n\t\t\t\t\tconst { id, propName: output, path } = bindingMatcher;\n\t\t\t\t\tconst dataBrokerValue = unstableResolvePropertySelectorValue(\n\t\t\t\t\t\t`@${id}/preview`\n\t\t\t\t\t);\n\t\t\t\t\tvalueToUse = get(\n\t\t\t\t\t\tdataBrokerValue,\n\t\t\t\t\t\t`${output}${path}`,\n\t\t\t\t\t\tvalueToUse || null\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\t...acc,\n\t\t\t\t\t[propName]: valueToUse\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n\n\t// process context session\n\tapi.context.session = unstableResolvePropertySelectorValue(`@session/output`);\n\n\t// process context app\n\tapi.context.app = appChromeSettings || {};\n\n\t// process elements\n\tapi.elements = elements.reduce((accElements, { id, properties }) => {\n\t\treturn {\n\t\t\t...accElements,\n\t\t\t[id]: properties.reduce((accProps, prop) => {\n\t\t\t\tif (prop.selectable) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...accProps,\n\t\t\t\t\t\t[prop.id || prop.name]:\n\t\t\t\t\t\t\tunstableResolvePropertySelectorValue(\n\t\t\t\t\t\t\t\t`@${id}/${prop.id || prop.name}`\n\t\t\t\t\t\t\t) || prop.value\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn accProps;\n\t\t\t}, {})\n\t\t};\n\t}, {});\n\n\t// process clientState\n\tapi.state = clientStateData;\n\n\treturn api;\n};\n\nconst createEventHandlerFromMcpEvent = (handledEvent, mcpId, mcpName) =>\n\tnew EventHandler({\n\t\tancestor: false,\n\t\tapiName: handledEvent.apiName,\n\t\tid: handledEvent.id,\n\t\tlabel: handledEvent.label,\n\t\tname: handledEvent.eventName,\n\t\ttype: EVENT,\n\t\tsourceId: mcpId,\n\t\tsourceName: mcpName,\n\t\tpayloadFields: handledEvent.payloadShape.map((prop) => ({\n\t\t\tdefaultValue: prop.defaultValue,\n\t\t\ttype: prop.fieldType,\n\t\t\tlabel: prop.label,\n\t\t\tname: prop.name,\n\t\t\ttypeMetadata: prop.typeMetadata,\n\t\t\tinterfaceApiName: prop.interfaceApiName,\n\t\t\tdescription: prop.description\n\t\t}))\n\t});\n\nconst getEventHandlersFromRootMacroponent = (\n\tmacroponentDefinitions,\n\trootMacroponentId\n) => {\n\tconst rootMacroponent = macroponentDefinitions[rootMacroponentId];\n\tconst extensionParentId = rootMacroponent.extendsSysId;\n\tconst extensionParent = macroponentDefinitions[extensionParentId];\n\tconst eventHandlers = [];\n\tif (rootMacroponent) {\n\t\trootMacroponent.handledEvents.forEach((handledEvent) => {\n\t\t\teventHandlers.push(\n\t\t\t\tcreateEventHandlerFromMcpEvent(\n\t\t\t\t\thandledEvent,\n\t\t\t\t\trootMacroponent.id,\n\t\t\t\t\trootMacroponent.name\n\t\t\t\t)\n\t\t\t);\n\t\t});\n\t}\n\tif (extensionParentId && extensionParent) {\n\t\textensionParent.handledEvents.forEach((handledEvent) => {\n\t\t\teventHandlers.push(\n\t\t\t\tcreateEventHandlerFromMcpEvent(\n\t\t\t\t\thandledEvent,\n\t\t\t\t\trootMacroponent.id,\n\t\t\t\t\trootMacroponent.name\n\t\t\t\t)\n\t\t\t);\n\t\t});\n\t}\n\treturn eventHandlers;\n};\n\nconst processClientStateData = (\n\tparams,\n\tpageState,\n\tancestorPageProperties,\n\tdataBrokerInstances,\n\tancestorDataBrokerInstances,\n\tancestorElements,\n\tappChromeSettings\n) => {\n\tconst contextBindings = reduceContextBindingsWithAncestors(\n\t\tpageState,\n\t\tancestorPageProperties\n\t);\n\tconst { rootElement } = pageState;\n\n\treturn params.reduce((acc, cur) => {\n\t\tconst { name, initialValue, type } = cur;\n\t\tif (!name) {\n\t\t\treturn acc;\n\t\t}\n\n\t\tif (type === 'json') {\n\t\t\ttry {\n\t\t\t\treturn { ...acc, [name]: JSON.parse(initialValue) };\n\t\t\t} catch (e) {\n\t\t\t\treturn { ...acc, [name]: initialValue };\n\t\t\t}\n\t\t}\n\n\t\tconst matchedValues =\n\t\t\tinitialValue &&\n\t\t\ttypeof initialValue === 'string' &&\n\t\t\tmatchBindingSyntax(initialValue);\n\t\tif (matchedValues) {\n\t\t\tconst resolved = resolvePropertyBinding({\n\t\t\t\tmatchedValues,\n\t\t\t\tbindings: contextBindings,\n\t\t\t\tancestorPageProperties: {},\n\t\t\t\tdataBrokerInstances,\n\t\t\t\tancestorDataBrokerInstances,\n\t\t\t\trootElement,\n\t\t\t\tancestorElements,\n\t\t\t\tappChromeSettings\n\t\t\t});\n\t\t\tif (resolved === undefined) {\n\t\t\t\tacc[name] = '';\n\t\t\t} else {\n\t\t\t\tacc[name] = resolved;\n\t\t\t}\n\t\t} else {\n\t\t\tacc[name] = initialValue;\n\t\t}\n\n\t\treturn acc;\n\t}, {});\n};\n\n// Autocomplete functions\n\nfunction getTypeForValue(value) {\n\tif (value === null) {\n\t\treturn 'null';\n\t}\n\n\tconst type = typeof value;\n\tif (type === 'object') {\n\t\t// Use lodash to differentiate object vs. array\n\t\tif (isArray(type)) {\n\t\t\treturn 'array';\n\t\t}\n\t}\n\n\treturn type;\n}\n\nfunction addInterfaceFromObjectKeys(obj, interfaceName, interfaces) {\n\tif (!obj) {\n\t\treturn;\n\t}\n\n\tconst props = [];\n\tfor (const name of Object.keys(obj)) {\n\t\t// Skip identifiers that start with a number, as they are invalid\n\t\t// for interface names and cause Monaco to ignore the entire interface.\n\t\tif (name[0] >= '0' && name[0] <= '9') {\n\t\t\tcontinue;\n\t\t}\n\t\tconst entry = {\n\t\t\tname,\n\t\t\ttype: getTypeForValue(obj[name])\n\t\t};\n\t\tprops.push(entry);\n\t}\n\n\tinterfaces.push({ name: interfaceName, props });\n}\n\n// Find an existing entry for the specified interface/prop and change its type\nfunction overridePropType(interfaces, interfaceName, propName, newType) {\n\tconst intf = find(interfaces, (i) => i.name === interfaceName);\n\tif (intf) {\n\t\tconst prop = find(intf.props, (p) => p.name === propName);\n\t\tif (prop) {\n\t\t\tprop.type = newType;\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction addTypesForNameValuePairs(obj, enumName, _interfaces, defs) {\n\tdefs.push(`enum ${enumName}_enum {`);\n\n\tfor (const entry of obj) {\n\t\tdefs.push(`  \"${entry.name.toUpperCase()}\" = \"${entry.name}\",`);\n\t}\n\tdefs.push('}');\n\n\t// Now add the type that references the enum\n\tdefs.push(`type ${enumName} = {`);\n\tdefs.push(`  [key in ${enumName}_enum]: any;`);\n\tdefs.push('};');\n}\n\nfunction addTypesForNameObjectKeys(obj, enumName, _interfaces, defs) {\n\tdefs.push(`enum ${enumName}_enum {`);\n\n\tfor (const name of obj) {\n\t\tdefs.push(`  \"${name.toUpperCase()}\" = \"${name}\",`);\n\t}\n\tdefs.push('}');\n\n\t// Now add the type that references the enum\n\tdefs.push(`type ${enumName} = {`);\n\tdefs.push(`  [key in ${enumName}_enum]: any;`);\n\tdefs.push('};');\n}\n\nfunction addInterfacesForContextSessionUser(\n\tuser,\n\tinterfaceName,\n\tinterfaces,\n\tdefs\n) {\n\tif (!user) {\n\t\treturn;\n\t}\n\n\t// Create an interface for the keys at this level that are not specifically overriden below\n\taddInterfaceFromObjectKeys(user, interfaceName, interfaces);\n\n\t// Add the interface for `preferences`\n\taddTypesForNameValuePairs(\n\t\tuser.preferences,\n\t\t'api_context_session_user_preferences',\n\t\tinterfaces,\n\t\tdefs\n\t);\n\n\t// Override the type for `preferences`\n\toverridePropType(\n\t\tinterfaces,\n\t\t'api_context_session_user',\n\t\t'preferences',\n\t\t'api_context_session_user_preferences'\n\t);\n\n\t// Add the enum for `roles`\n\taddTypesForNameObjectKeys(\n\t\tuser.roles,\n\t\t'api_context_session_user_roles',\n\t\tinterfaces,\n\t\tdefs\n\t);\n\n\t// Override the type for `roles`\n\toverridePropType(\n\t\tinterfaces,\n\t\t'api_context_session_user',\n\t\t'roles',\n\t\t'api_context_session_user_roles'\n\t);\n}\n\nfunction addInterfacesForContextSession(\n\tsession,\n\tinterfaceName,\n\tinterfaces,\n\tdefs\n) {\n\tif (!session) {\n\t\treturn;\n\t}\n\n\t// Create\n\t// enum Options {\n\t//   ONE = 'one.1',\n\t//   TWO = 'two',\n\t//   THREE = 'three'\n\t// }\n\n\t// type OptionRequirements = {\n\t//   [key in Options]: any; // Note that \"key in\".\n\t// };\n\n\t// Add the interface for `user`\n\taddInterfacesForContextSessionUser(\n\t\tsession.user,\n\t\t'api_context_session_user',\n\t\tinterfaces,\n\t\tdefs\n\t);\n\n\t// Add the interface for `properties`\n\taddInterfaceFromObjectKeys(\n\t\tsession.properties,\n\t\t'api_context_session_properties',\n\t\tinterfaces\n\t);\n\n\t// Create an interface for the keys at this level that are not specifically overridden below\n\taddInterfaceFromObjectKeys(session, interfaceName, interfaces);\n\n\t// Override the type for `user`\n\toverridePropType(\n\t\tinterfaces,\n\t\t'api_context_session',\n\t\t'user',\n\t\t'api_context_session_user'\n\t);\n\n\t// Override the type for `prooperties`\n\toverridePropType(\n\t\tinterfaces,\n\t\t'api_context_session',\n\t\t'properties',\n\t\t'api_context_session_properties'\n\t);\n}\n\nfunction addInterfacesForContext(context, interfaceName, interfaces, defs) {\n\tif (!context) {\n\t\treturn;\n\t}\n\n\t// Create an interface for context_app\n\taddInterfaceFromObjectKeys(context.app, 'api_context_app', interfaces);\n\n\t// Create an interface for context_props\n\taddInterfaceFromObjectKeys(context.props, 'api_context_props', interfaces);\n\n\taddInterfacesForContextSession(\n\t\tcontext.session,\n\t\t'api_context_session',\n\t\tinterfaces,\n\t\tdefs\n\t);\n\n\t// Add the hard-coded interface for 'context' itself\n\tconst contextInterface = {\n\t\tname: interfaceName,\n\t\tprops: [\n\t\t\t{ name: 'app', type: 'api_context_app' },\n\t\t\t{ name: 'props', type: 'api_context_props' },\n\t\t\t{ name: 'session', type: 'api_context_session' }\n\t\t]\n\t};\n\tinterfaces.push(contextInterface);\n}\n\n// This is where we map paths to handlers\nconst apiPaths = [\n\t{\n\t\tsrcPath: ['elements'], // Where do we read the props from\n\t\tapiPath: ['elements'], // Where in the API should the resulting interface live\n\t\tinterfaceName: 'api_elements', // Name of the interface type that will be defined\n\t\thandler: addInterfaceFromObjectKeys\n\t},\n\t{\n\t\tsrcPath: ['data'], // Where do we read the props from\n\t\tapiPath: ['data'], // Where in the API should the resulting interface live\n\t\tinterfaceName: 'api_data', // Name of the interface type that will be defined\n\t\thandler: addInterfaceFromObjectKeys\n\t},\n\t{\n\t\tsrcPath: ['state'], // Where do we read the props from\n\t\tapiPath: ['state'], // Where in the API should the resulting interface live\n\t\tinterfaceName: 'api_state', // Name of the interface type that will be defined\n\t\thandler: addInterfaceFromObjectKeys\n\t},\n\t{\n\t\tsrcPath: ['context'], // Where do we read the props from\n\t\tapiPath: ['context'], // Where in the API should the resulting interface live\n\t\tinterfaceName: 'api_context', // Name of the interface type that will be defined\n\t\thandler: addInterfacesForContext\n\t}\n];\n\nfunction getClientScriptApiCompletions(api, isClientTransformScript = false) {\n\tconst defs = ['/** UI Builder Client Script API **/'];\n\n\t// Each API entry is an object with string keys, which are the API names,\n\t// and a string value, which is the name of the data type.  This is either\n\t// a simple type like 'string', 'number' or 'boolean', or it is the name\n\t// of another interface.\n\tconst interfaces = [];\n\tconst apiInterface = {};\n\n\t// Iterate over the defined paths\n\tfor (const pathEntry of apiPaths) {\n\t\tpathEntry.handler(\n\t\t\tget(api, pathEntry.srcPath, {}),\n\t\t\tpathEntry.interfaceName,\n\t\t\tinterfaces,\n\t\t\tdefs\n\t\t);\n\n\t\t// TODO: Do we need to allow for placing parts of the API in alternate nested locations?\n\t\t// TODO: If so, we need to expand the line below to take all of apiPath into account.\n\t\tapiInterface[pathEntry.apiPath[0]] = pathEntry.interfaceName;\n\t}\n\n\t// Serialize the interfaces to a final string\n\tfor (const iface of interfaces) {\n\t\tdefs.push(`interface ${iface.name} {`);\n\t\tfor (const prop of iface.props) {\n\t\t\tdefs.push(`  ${prop.name}: ${prop.type};`);\n\t\t}\n\t\tdefs.push('}');\n\t}\n\n\t// Define interface for event\n\tdefs.push('interface event {');\n\tdefs.push('  elementId: string;');\n\tdefs.push('  name: string;');\n\tdefs.push('  payload: any;');\n\tdefs.push('}');\n\n\t// Define interface for imports\n\t// TODO: This is a temporary placeholder.  Need a separate PR that injects the names of the available imports here.\n\tdefs.push('interface imports {');\n\tdefs.push(' [key: string]: any;');\n\tdefs.push('}');\n\n\t// Serialize the main interface\n\tdefs.push('interface api {');\n\tfor (const propName of Object.keys(apiInterface)) {\n\t\tconst propType = apiInterface[propName];\n\t\tdefs.push(`  ${propName}: ${propType};`);\n\t}\n\tif (!isClientTransformScript) {\n\t\tdefs.push('  /** Set current client state values */');\n\t\tdefs.push('  setState(name: string, state: object): void;');\n\t}\n\tdefs.push('}');\n\n\tdefs.push('interface params {');\n\tdefs.push('  api: api;');\n\tdefs.push('  event: event;');\n\tdefs.push('  imports: imports;');\n\tdefs.push('}');\n\n\treturn defs.join('\\n');\n}\n\nconst isAclViolation = (runtimeErrors) => {\n\tconst ACL_ERROR_PATTERN = new RegExp('^.*(ACL).*$', 'i');\n\tif (Array.isArray(runtimeErrors)) {\n\t\treturn runtimeErrors.some(\n\t\t\t(error) => typeof error === 'string' && error.match(ACL_ERROR_PATTERN)\n\t\t);\n\t}\n};\n\nconst generateDataBrokerErrorObj = (errors) => {\n\tconst errorObj = { errors };\n\tObject.defineProperty(errorObj, 'aclViolation', {\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t\twritable: false,\n\t\tvalue: isAclViolation(errors)\n\t});\n\treturn errorObj;\n};\n\n/*\n * the following are functions for finding and remove binding references\n */\nconst pageEventMappingRef = (eventMappingId, handlerId, handlerValueId) => ({\n\tname: 'Page configuration (Events)',\n\ticon: 'component-outline',\n\taction: PAGE_INTERNAL_EVENT_MAPPING_HANDLER_CHANGED,\n\tpayload: {\n\t\teventMappingId,\n\t\thandlerId,\n\t\thandlerValueId\n\t}\n});\n\nconst elementPropertyRef = (element, propertyId) => ({\n\tname: `${element.instanceName} (${propertyId})`,\n\ticon: 'component-outline',\n\taction: ELEMENT_PROPERTY_UPDATED,\n\tpayload: {\n\t\telementId: element.id,\n\t\tpropertyId,\n\t\tvalue: null\n\t}\n});\n\nconst elementEventMappingRef = (\n\telement,\n\teventMappingId,\n\thandlerId,\n\thandlerValueId\n) => ({\n\tname: `${element.instanceName} (Events)`,\n\ticon: 'component-outline',\n\taction: ELEMENT_EVENT_MAPPING_HANDLER_CHANGED,\n\tpayload: {\n\t\telementId: element.id,\n\t\teventMappingId,\n\t\thandlerId,\n\t\thandlerValueId\n\t}\n});\n\nconst dataBrokerInstanceRef = (dataBroker, propertyId) => ({\n\tname: `${dataBroker.instanceName} (${propertyId})`,\n\ticon: 'database-outline',\n\taction: DATA_BROKER_INSTANCE_PROPERTY_UPDATED,\n\tpayload: {\n\t\tdataBrokerId: dataBroker.id,\n\t\tpropertyId,\n\t\tvalue: null\n\t}\n});\n\nconst dataBrokerEventMappingRef = (\n\tdataBroker,\n\teventMappingId,\n\thandlerId,\n\thandlerValueId\n) => ({\n\tname: `${dataBroker.instanceName} (Events)`,\n\ticon: 'database-outline',\n\taction: DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_CHANGED,\n\tpayload: {\n\t\tdataBrokerId: dataBroker.id,\n\t\teventMappingId,\n\t\thandlerId,\n\t\thandlerValueId\n\t}\n});\n\nconst clientStateParamRef = (param) => ({\n\tname: param.name,\n\ticon: 'address-card-outline',\n\taction: CLIENT_STATE_PARAMETER_CHANGED,\n\tpayload: {\n\t\tid: param.id,\n\t\tvalue: '',\n\t\tcontext: 'param-value'\n\t}\n});\n\nconst elementEventsRef = (elementName) => ({\n\tname: `${elementName} (Events)`,\n\ticon: 'component-outline'\n\t// no action or payload needed\n});\n\nconst assessTarget = (target, item) => {\n\tconst { targetKey, valueKey, idKey } = computeEventMappingTargetKeys(\n\t\ttarget.type\n\t);\n\n\treturn {\n\t\ttargetKey,\n\t\tvalueKey,\n\t\tidKey,\n\t\ttargetIsScriptOrOp:\n\t\t\t(targetKey === 'clientScript' && target[targetKey][idKey] === item) ||\n\t\t\t(targetKey === 'operation' &&\n\t\t\t\ttarget[targetKey].parentResourceId === item),\n\t\tproperties: get(target, `[${targetKey}][${valueKey}]`, [])\n\t};\n};\n\nconst isItemReferencedFn = (deleting, item) => (prop) => {\n\tlet match;\n\tswitch (deleting) {\n\t\tcase 'pageProperty':\n\t\t\tmatch = matchBindingSyntax(prop);\n\t\t\treturn match && match.propName === item;\n\t\tcase 'dataBrokerInstance':\n\t\t\tmatch = matchBindingSyntax(prop);\n\t\t\treturn match && match.id === item;\n\t\tcase 'clientStateParameter':\n\t\t\tmatch = matchStateBindingSyntax(prop);\n\t\t\treturn match && match.name === item;\n\t\tdefault:\n\t\t\treturn false;\n\t}\n};\n\n/**\n * @param {string} deleting one of 'pageProperty', 'dataBrokerInstance', 'clientStateParameter', 'clientScript'\n * @param {string} item id (or name) of item to be deleted\n * @param {object} pageState @uxf/pageState\n * @returns {boolean} defaults to false\n */\nfunction isReferenced(deleting = null, item = null, pageState = {}) {\n\tconst {\n\t\trootElement = {},\n\t\tdataBrokerInstances = [],\n\t\tclientStateParameters = []\n\t} = pageState;\n\n\tconst refs = [];\n\tconst isItemReferenced = isItemReferencedFn(deleting, item);\n\n\t// search root element internal event mappings\n\t(rootElement.internalEventMappings || []).forEach((mapping) => {\n\t\tmapping.targets.forEach((target) => {\n\t\t\tconst { targetIsScriptOrOp, properties } = assessTarget(target, item);\n\t\t\tif (targetIsScriptOrOp) {\n\t\t\t\trefs.push(elementEventsRef('Page configuration'));\n\t\t\t} else {\n\t\t\t\tproperties.forEach((property) => {\n\t\t\t\t\tif (isItemReferenced(property.value)) {\n\t\t\t\t\t\trefs.push(\n\t\t\t\t\t\t\tpageEventMappingRef(\n\t\t\t\t\t\t\t\tmapping.eventMappingId,\n\t\t\t\t\t\t\t\ttarget.targetId,\n\t\t\t\t\t\t\t\tproperty.name || property.id\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n\n\t// search element properties\n\tcreateElementArray(rootElement, (element) => {\n\t\tObject.keys(element.properties || {}).forEach((key) => {\n\t\t\tif (isItemReferenced(element.properties[key].value)) {\n\t\t\t\trefs.push(elementPropertyRef(element, key));\n\t\t\t}\n\t\t});\n\t\t(element.eventMappings || []).forEach((mapping) => {\n\t\t\tmapping.targets.forEach((target) => {\n\t\t\t\tconst { targetIsScriptOrOp, properties } = assessTarget(target, item);\n\t\t\t\tif (targetIsScriptOrOp) {\n\t\t\t\t\trefs.push(elementEventsRef(element.instanceName));\n\t\t\t\t} else {\n\t\t\t\t\tproperties.forEach((property) => {\n\t\t\t\t\t\tif (isItemReferenced(property.value)) {\n\t\t\t\t\t\t\trefs.push(\n\t\t\t\t\t\t\t\telementEventMappingRef(\n\t\t\t\t\t\t\t\t\telement,\n\t\t\t\t\t\t\t\t\tmapping.eventMappingId,\n\t\t\t\t\t\t\t\t\ttarget.targetId,\n\t\t\t\t\t\t\t\t\tproperty.name || property.id\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t});\n\n\t// search data broker instances\n\tdataBrokerInstances.forEach((instance) => {\n\t\tObject.keys(instance.properties || {}).forEach((key) => {\n\t\t\tif (isItemReferenced(instance.properties[key].value)) {\n\t\t\t\trefs.push(dataBrokerInstanceRef(instance, key));\n\t\t\t}\n\t\t});\n\t\t(instance.eventMappings || []).forEach((mapping) => {\n\t\t\tmapping.targets.forEach((target) => {\n\t\t\t\tconst { targetIsScriptOrOp, properties } = assessTarget(target, item);\n\t\t\t\tif (targetIsScriptOrOp) {\n\t\t\t\t\trefs.push({\n\t\t\t\t\t\tname: `${instance.instanceName} (Event)`,\n\t\t\t\t\t\ticon: 'database-outline'\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tproperties.forEach((property) => {\n\t\t\t\t\t\tif (isItemReferenced(property.value)) {\n\t\t\t\t\t\t\trefs.push(\n\t\t\t\t\t\t\t\tdataBrokerEventMappingRef(\n\t\t\t\t\t\t\t\t\tinstance,\n\t\t\t\t\t\t\t\t\tmapping.eventMappingId,\n\t\t\t\t\t\t\t\t\ttarget.targetId,\n\t\t\t\t\t\t\t\t\tproperty.name || property.id\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t});\n\n\t// search client state parameters\n\tclientStateParameters.forEach((parameter) => {\n\t\tif (isItemReferenced(parameter.initialValue)) {\n\t\t\trefs.push(clientStateParamRef(parameter));\n\t\t}\n\t});\n\n\treturn isEmpty(refs) ? false : refs;\n}\n\nconst updateDeclarativeClientStateUpdateEventHandlers = (\n\teventMappingHandlers,\n\tclientStateParamsToUse\n) => {\n\tObject.values(eventMappingHandlers).forEach((handlers) => {\n\t\thandlers.forEach((handler) => {\n\t\t\tif (handler.handlerTypeId === UPDATE_CLIENT_STATE_HANDLER_ID) {\n\t\t\t\thandler.values.forEach((handlerValue) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\thandlerValue.name === 'propName' ||\n\t\t\t\t\t\thandlerValue.columnName === 'propName'\n\t\t\t\t\t) {\n\t\t\t\t\t\thandlerValue.type = 'choice';\n\t\t\t\t\t\thandlerValue.typeMeta = {\n\t\t\t\t\t\t\tchoices: clientStateParamsToUse.map((param) => ({\n\t\t\t\t\t\t\t\tvalue: param.name,\n\t\t\t\t\t\t\t\tlabel: param.name\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tif (handlerValue.name === 'value') {\n\t\t\t\t\t\tconst propNameProperty =\n\t\t\t\t\t\t\thandler.values.find((prop) => prop.name === 'propName') || {};\n\t\t\t\t\t\tconst matchingClientStateParam =\n\t\t\t\t\t\t\tclientStateParamsToUse.find(\n\t\t\t\t\t\t\t\t(param) => param.name === propNameProperty.value\n\t\t\t\t\t\t\t) || {};\n\t\t\t\t\t\thandlerValue.type = matchingClientStateParam.type || 'string';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n\n\treturn eventMappingHandlers;\n};\n\nexport {\n\tcreateExposedProperty,\n\tgetElementTree,\n\tgetElementProperties,\n\tgetElementLayouts,\n\tgetElementEvents,\n\tgetElementEventMappings,\n\tgetElementStyles,\n\tgetDataBrokerInstances,\n\tgetDataBrokerInstanceProperties,\n\tsetOnChangeForDependeeProperties,\n\tgetDataBrokerEventMappings,\n\tgetEventMappingHandlers,\n\tgetDataBrokerInputPropertiesFromPageState,\n\tgetPageMetadata,\n\tgetPageProperties,\n\tisPageStateDirty,\n\taddAllEventHandlers,\n\tgetDependentProperties,\n\tgenerateDataBrokerProperties,\n\tcreateDataBrokerInstances,\n\tisContextBoundProperty,\n\tisDataBoundProperty,\n\tgetElementToEventMappingHandlerMap,\n\tgetStateParams,\n\tgetScreenEventMappings,\n\tgetInternalEventMappings,\n\tmergeArray,\n\tgetElementByProperty,\n\tgetClientScriptApi,\n\tgetClientScriptApiCompletions,\n\tgetHiddenElements,\n\tgetEventHandlersFromRootMacroponent,\n\tcreateEventHandlerFromMcpEvent,\n\tprocessClientStateData,\n\tisAclViolation,\n\tgenerateDataBrokerErrorObj,\n\tisReferenced,\n\tupdateDeclarativeClientStateUpdateEventHandlers\n};\n","/**\n *  Reserved property IDs that are used by UXF to signify special UIB component properties that\n *  do not map directly to composition element properties/attributes\n */\nexport const ELEMENT_INSTANCE_NAME = '__instance_name__';\nexport const DATA_BROKER_INSTANCE_NAME = '__data_broker_instance_name__';\nexport const VIEWPORT_ROUTES = 'viewportRoutes';\nexport const ACTIVE_ROUTE = 'activeRoute';\nexport const ACTIVE_SCREEN = 'activeScreen';\nexport const DEFAULT_ROUTE = 'defaultRoute';\nexport const REPEATED_VIEWPORT_TAB_DATA = 'repeatedTabData';\nexport const DYNAMIC_VIEWPORT_TAB_DATA = 'dynamicTabData';\nexport const PARENT_COMPOSITION_ELEMENT_ID = 'parentCompositionElementId';\nexport const VIEWPORT_CONFIGURATION = 'viewportConfiguration';\n// This is for tabset backward compatibility\nexport const VIEWPORT_NOW_ID = 'nowId';\nexport const IS_HIDDEN = '__isHidden__';\n","import isEmpty from 'lodash/isEmpty';\nimport flatten from 'lodash/flatten';\nimport get from 'lodash/get';\nimport { t } from 'sn-translate';\nimport { isUxValueModel, getShorthandFromUxValue } from '../../factories';\nimport { Property, MacroponentProperty } from '../../models';\nimport {\n\tVIEWPORT_ROUTES,\n\tACTIVE_ROUTE,\n\tDEFAULT_ROUTE,\n\tACTIVE_SCREEN,\n\tVIEWPORT_CONFIGURATION,\n\tREPEATED_VIEWPORT_TAB_DATA,\n\tDYNAMIC_VIEWPORT_TAB_DATA\n} from '../element/reservedPropertyIds';\nimport { getTemplates } from './templateLoader';\nimport { getElementByProperty } from '../utils.js';\nimport reduceContextBindingsWithAncestors from '../pageProperties/utils/reduceContextBindingsWithAncestors';\nimport { resolveBinding } from '../../utils';\nconst LOADING_ERROR = 'loading-error';\nconst LOADING = 'loading';\n\nconst renderPlaceholder = (state, message = null) => {\n\tconst node = document.createElement('now-empty-state');\n\tnode.setAttribute('slot', 'viewport');\n\tnode.setAttribute('type', state);\n\tnode.setAttribute('body-text', message);\n\treturn node;\n};\n\nconst setViewportContent = (host, content) => {\n\tif (!host) {\n\t\treturn;\n\t}\n\n\tif (!isEmpty(content.children)) {\n\t\tcontent.children[0].setAttribute('slot', 'viewport');\n\t}\n\n\tconst range = document.createRange();\n\trange.selectNodeContents(host);\n\trange.deleteContents();\n\trange.insertNode(content);\n\trange.detach();\n};\n\nconst resolveMacroponentConfig = (macroponentConfiguration, pageProperties) => {\n\tif (isEmpty(macroponentConfiguration)) {\n\t\treturn {};\n\t}\n\n\tconst mcpConfigAsProperties = Object.keys(macroponentConfiguration).map(\n\t\t(name) => {\n\t\t\tlet value;\n\t\t\tif (isUxValueModel(macroponentConfiguration[name])) {\n\t\t\t\tvalue = getShorthandFromUxValue(macroponentConfiguration[name]);\n\t\t\t} else {\n\t\t\t\tvalue = macroponentConfiguration[name];\n\t\t\t}\n\t\t\treturn new MacroponentProperty.create({\n\t\t\t\tname,\n\t\t\t\tvalue\n\t\t\t});\n\t\t},\n\t\t{}\n\t);\n\n\tconst pagePropsAsObject = pageProperties.reduce((acc, cur) => {\n\t\treturn {\n\t\t\t...acc,\n\t\t\t[cur.name]: cur.value\n\t\t};\n\t}, {});\n\n\treturn reduceContextBindingsWithAncestors(\n\t\t{\n\t\t\trootElement: {\n\t\t\t\tmacroponentProperties: mcpConfigAsProperties\n\t\t\t}\n\t\t},\n\t\tpagePropsAsObject\n\t);\n};\n\nexport const renderContents = async (host, mcp, pageProperties) => {\n\tif (!host) {\n\t\treturn;\n\t}\n\n\tsetViewportContent(host, renderPlaceholder(LOADING, t('Please wait')));\n\n\tconst {\n\t\tmacroponentSysId: mcpId,\n\t\tmacroponentConfiguration: mcpConfiguration,\n\t\tfields\n\t} = mcp;\n\n\tconst resolvedMacroponentConfig = resolveMacroponentConfig(\n\t\tmcpConfiguration,\n\t\tpageProperties\n\t);\n\n\tconst fragmentGenerator = await getTemplates([mcpId]);\n\tconst fragment =\n\t\tfragmentGenerator &&\n\t\tfragmentGenerator[mcpId] &&\n\t\tfragmentGenerator[mcpId]({\n\t\t\t...resolvedMacroponentConfig,\n\t\t\t...fields\n\t\t});\n\n\tif (fragment) {\n\t\tsetViewportContent(host, fragment);\n\t} else {\n\t\tsetViewportContent(\n\t\t\thost,\n\t\t\trenderPlaceholder(\n\t\t\t\tLOADING_ERROR,\n\t\t\t\tt('An error occurred while trying to load the viewport')\n\t\t\t)\n\t\t);\n\t}\n};\n\nexport const renderEmptyState = (\n\thost,\n\thasRoutes = true,\n\tmessage = t('Please create viewport routes.')\n) => {\n\tif (!host) {\n\t\treturn;\n\t}\n\tconst emptyState = renderPlaceholder('empty', message);\n\n\tif (hasRoutes) {\n\t\tsetViewportContent(host, emptyState);\n\t} else {\n\t\tif (!host.shadowRoot) {\n\t\t\thost.attachShadow({ mode: 'open' });\n\t\t}\n\t\thost.shadowRoot.innerHTML = '';\n\t\thost.shadowRoot.appendChild(emptyState);\n\t}\n};\n\nconst getDefaultActiveRoute = (viewportRoutes, defaultRoute) => {\n\tconst routes = flatten(Object.values(viewportRoutes));\n\tconst defaultRouteInfo = routes.find(\n\t\t(route) => route.routeType === defaultRoute\n\t);\n\n\tif (!isEmpty(defaultRouteInfo)) {\n\t\treturn get(\n\t\t\tviewportRoutes,\n\t\t\t// TODO: resolve this 0 to the right value once we have route variants\n\t\t\t// figured out\n\t\t\t`${defaultRouteInfo.routeType}[0]`,\n\t\t\t{}\n\t\t);\n\t} else {\n\t\treturn routes.sort((a, b) => a.order - b.order)[0] || {};\n\t}\n};\n\nconst getActiveRouteAndScreen = (\n\telementId,\n\tstate,\n\tviewportRoutes,\n\tdefaultRoute,\n\tvariantId\n) => {\n\tconst route = get(\n\t\tstate,\n\t\t`activeViewportRoutes.${variantId}.${elementId}`,\n\t\tgetDefaultActiveRoute(viewportRoutes, defaultRoute)\n\t);\n\n\tconst screen = get(\n\t\tstate,\n\t\t`activeViewportScreens.${variantId}.${elementId}`,\n\t\tget(route, `macroponents[0]`, {})\n\t);\n\n\treturn {\n\t\troute,\n\t\tscreen\n\t};\n};\n\nexport const initializeDataDrivenViewportProperties = (dataSource, state) => {\n\treturn {\n\t\t[REPEATED_VIEWPORT_TAB_DATA]: new Property({\n\t\t\tname: REPEATED_VIEWPORT_TAB_DATA,\n\t\t\tcolumnName: REPEATED_VIEWPORT_TAB_DATA,\n\t\t\tlabel: t('Data driven viewport'),\n\t\t\ttype: 'string',\n\t\t\tvalue: dataSource\n\t\t\t\t? transformAndResolveDataSource(dataSource, state)\n\t\t\t\t: null\n\t\t}),\n\t\t[DYNAMIC_VIEWPORT_TAB_DATA]: new Property({\n\t\t\tname: DYNAMIC_VIEWPORT_TAB_DATA,\n\t\t\tcolumnName: DYNAMIC_VIEWPORT_TAB_DATA,\n\t\t\tlabel: t('Viewport data source'),\n\t\t\ttype: 'object',\n\t\t\tvalue: dataSource\n\t\t})\n\t};\n};\n\nexport const isDataDrivenTab = (route) => !isEmpty(route.fields);\n\nconst sortViewportRoutes = (viewportRoutes) => {\n\t// when you delete a viewport route, the first route in it gets set as a default and active route. As the panel items are already sorted, this will select the first route.\n\t// Todo: Remove this once backend sorts it before passing it to the frontend.\n\tconst sortedViewportRoutes = {};\n\tconst sortedRouteKeys = Object.keys(viewportRoutes).sort(\n\t\t(a, b) => viewportRoutes[a][0].order - viewportRoutes[b][0].order\n\t);\n\tsortedRouteKeys.forEach((elem) => {\n\t\tsortedViewportRoutes[elem] = viewportRoutes[elem];\n\t});\n\treturn sortedViewportRoutes;\n};\n\nexport const initializeViewportElementProperties = (\n\telementId,\n\tviewportRoutes,\n\tdefaultRoute,\n\tstate = {},\n\tvariantId = '',\n\tdataSource\n) => {\n\tconst { route, screen } = getActiveRouteAndScreen(\n\t\telementId,\n\t\tstate,\n\t\tviewportRoutes,\n\t\tdefaultRoute,\n\t\tvariantId\n\t);\n\n\t// Data driven TabSet/Viewport component needs the routeType as the id in the viewportRoutes\n\tconst modifiedViewportRoutes = {};\n\tconst viewportRoutesKeys = Object.keys(viewportRoutes);\n\tviewportRoutesKeys.forEach((elem) => {\n\t\tif (isDataDrivenTab(viewportRoutes[elem][0])) {\n\t\t\tconst dataDrivenRouteType = get(\n\t\t\t\tviewportRoutes,\n\t\t\t\t`${elem}[0].routeType`,\n\t\t\t\t''\n\t\t\t);\n\t\t\tmodifiedViewportRoutes[dataDrivenRouteType] = viewportRoutes[elem];\n\t\t} else {\n\t\t\tmodifiedViewportRoutes[elem] = viewportRoutes[elem];\n\t\t}\n\t});\n\tconst properties = {\n\t\t[VIEWPORT_ROUTES]: new Property({\n\t\t\tname: VIEWPORT_ROUTES,\n\t\t\tcolumnName: VIEWPORT_ROUTES,\n\t\t\tlabel: t('Viewport Routes'),\n\t\t\ttype: 'array',\n\t\t\tvalue: sortViewportRoutes(modifiedViewportRoutes)\n\t\t}),\n\t\t[ACTIVE_ROUTE]: new Property({\n\t\t\tname: ACTIVE_ROUTE,\n\t\t\tcolumnName: ACTIVE_ROUTE,\n\t\t\tlabel: t('Active Route'),\n\t\t\ttype: 'object',\n\t\t\tvalue: route\n\t\t}),\n\t\t[ACTIVE_SCREEN]: new Property({\n\t\t\tname: ACTIVE_SCREEN,\n\t\t\tcolumnName: ACTIVE_SCREEN,\n\t\t\tlabel: t('Active Screen'),\n\t\t\ttype: 'object',\n\t\t\tvalue: screen\n\t\t}),\n\t\t...initializeDataDrivenViewportProperties(dataSource, state)\n\t};\n\n\tif (\n\t\t!isEmpty(defaultRoute) &&\n\t\tisDefaultRouteNotPresent(defaultRoute, viewportRoutes)\n\t) {\n\t\t// if the existing defaultRoute prop is no longer valid then update\n\t\t// it to be that of the lowest order route\n\t\tproperties[DEFAULT_ROUTE] = new Property({\n\t\t\tname: DEFAULT_ROUTE,\n\t\t\tcolumnName: DEFAULT_ROUTE,\n\t\t\tlabel: t('Default Route'),\n\t\t\ttype: 'string',\n\t\t\tvalue: route.routeType\n\t\t});\n\t}\n\n\treturn properties;\n};\n\nconst isDefaultRouteNotPresent = (defaultRoute, viewportRoutes) => {\n\tlet routeNotPresent = true;\n\tObject.values(viewportRoutes).forEach((routes) => {\n\t\t// Todo: change this when we have route variants\n\t\tif (routeNotPresent) {\n\t\t\tconst route = routes[0];\n\t\t\tif (route.routeType === defaultRoute) {\n\t\t\t\trouteNotPresent = false;\n\t\t\t}\n\t\t}\n\t});\n\treturn routeNotPresent;\n};\n\nexport const transformAndResolveDataSource = (dataSource, { properties }) => {\n\tconst {\n\t\tpageState,\n\t\tancestorPageProperties,\n\t\tdataBrokerInstances,\n\t\tancestorDataBrokerInstances,\n\t\tancestorElements,\n\t\tclientScriptApi,\n\t\tappChromeSettings\n\t} = properties;\n\n\tconst contextBindings = reduceContextBindingsWithAncestors(\n\t\tpageState,\n\t\tancestorPageProperties\n\t);\n\tconst rootElement = get(pageState, 'rootElement', {});\n\treturn resolveBinding(dataSource, {\n\t\tbindings: contextBindings,\n\t\tancestorPageProperties,\n\t\tdataBrokerInstances,\n\t\tancestorDataBrokerInstances,\n\t\trootElement,\n\t\tancestorElements,\n\t\tclientScriptApi,\n\t\tappChromeSettings\n\t});\n};\n\nexport const isViewportComponent = (component) =>\n\tget(component, 'category', '') === 'viewport';\n\nexport const isViewportIsolatedEditingDisabled = (properties) => {\n\tconst viewportConfigFromNowUi = properties[VIEWPORT_CONFIGURATION];\n\tif (viewportConfigFromNowUi) {\n\t\treturn viewportConfigFromNowUi.disableIsolationEditing;\n\t}\n\treturn false;\n};\n\nexport const getViewportElementAndProperties = (pageState, elementId) => {\n\tconst newRootElement = get(pageState, 'rootElement', {});\n\tconst viewportElement = getElementByProperty(newRootElement, elementId, 'id');\n\tconst viewportRoutes = get(\n\t\tviewportElement,\n\t\t'properties.viewportRoutes.value',\n\t\t{}\n\t);\n\tconst activeRoute = get(viewportElement, 'properties.activeRoute.value', {});\n\n\tconst defaultRoute = get(\n\t\tviewportElement,\n\t\t'properties.defaultRoute.value',\n\t\t''\n\t);\n\n\tconst activeScreen = get(\n\t\tviewportElement,\n\t\t'properties.activeScreen.value',\n\t\t{}\n\t);\n\n\t// we want this to be undefined when the element is dropped on the stage\n\tconst dynamicViewportTabData = get(\n\t\tviewportElement,\n\t\t`properties[${DYNAMIC_VIEWPORT_TAB_DATA}]`\n\t);\n\n\tconst repeatedViewportTabData = get(\n\t\tviewportElement,\n\t\t`properties[${REPEATED_VIEWPORT_TAB_DATA}]`\n\t);\n\n\treturn {\n\t\tviewportElement,\n\t\tviewportRoutes,\n\t\tactiveRoute,\n\t\tdefaultRoute,\n\t\tactiveScreen,\n\t\tdynamicViewportTabData,\n\t\trepeatedViewportTabData\n\t};\n};\n","import Element from './element';\nimport Property from './property';\nimport { seismicCuid } from '../utils';\nimport BaseModel from './baseModel';\nimport { isViewportComponent } from '../sn-uxf-builder-middleware/viewportHandlers/utils';\n\nexport const getViewportElementIds = (element) => {\n\tconst nodes = [element];\n\tconst viewportElementIds = [];\n\twhile (nodes.length) {\n\t\tconst node = nodes.shift();\n\t\tif (isViewportComponent(node.component)) {\n\t\t\tviewportElementIds.push(node.id);\n\t\t} else {\n\t\t\tnodes.push(...node.children);\n\t\t}\n\t}\n\treturn viewportElementIds;\n};\n\nfunction createElementPropertiesFromComponent(component) {\n\treturn component.properties.reduce((acc, propertyConfig) => {\n\t\tacc[propertyConfig.columnName] = new Property(propertyConfig);\n\t\treturn acc;\n\t}, {});\n}\n\nfunction createElementFromComponent(component) {\n\treturn new Element({\n\t\tid: seismicCuid(),\n\t\tcomponent,\n\t\tproperties: createElementPropertiesFromComponent(component)\n\t});\n}\n\nexport default class PageStateModel extends BaseModel {\n\tstatic attributes = {\n\t\tname: {\n\t\t\tdefault: ''\n\t\t},\n\t\trootElement: {\n\t\t\tdefault: createElementFromComponent({\n\t\t\t\tname: 'Page',\n\t\t\t\ttag: 'sn-page',\n\t\t\t\tslots: [],\n\t\t\t\ticon: 'pencil-page-outline',\n\t\t\t\tproperties: [\n\t\t\t\t\tnew Property({\n\t\t\t\t\t\tcolumnName: 'label',\n\t\t\t\t\t\tlabel: 'Optional Page Title',\n\t\t\t\t\t\ttype: 'String (Full UTF-8)'\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t})\n\t\t},\n\t\tsysId: {\n\t\t\tdefault: null\n\t\t},\n\t\tscope: {\n\t\t\tdefault: ''\n\t\t},\n\t\tscopeName: {\n\t\t\tdefault: ''\n\t\t},\n\t\tdomainId: {\n\t\t\tdefault: ''\n\t\t},\n\t\tdomainName: {\n\t\t\tdefault: ''\n\t\t},\n\t\tapplicationName: {\n\t\t\tdefault: 'Global'\n\t\t},\n\t\ttype: {\n\t\t\tdefault: 'landing'\n\t\t},\n\t\tapplications: {\n\t\t\tdefault: null\n\t\t},\n\t\tuiTypeParameters: {\n\t\t\tdefault: {}\n\t\t},\n\t\tpageStatus: {\n\t\t\tdefault: 'active'\n\t\t},\n\t\tsysPolicy: {\n\t\t\tdefault: ''\n\t\t},\n\t\treadOnly: {\n\t\t\tdefault: false\n\t\t},\n\t\tcanCopy: {\n\t\t\tdefault: true\n\t\t},\n\t\tdataBrokerInstances: {\n\t\t\tdefault: []\n\t\t},\n\t\teventHandlers: {\n\t\t\tdefault: []\n\t\t},\n\t\tclientStateParameters: {\n\t\t\tdefault: []\n\t\t},\n\t\tdispatchedEvents: {\n\t\t\tdefault: []\n\t\t},\n\t\thandledEvents: {\n\t\t\tdefault: []\n\t\t},\n\t\tscreenEventMappings: {\n\t\t\tdefault: []\n\t\t},\n\t\tviewportElementIds: {\n\t\t\tdefault: {}\n\t\t},\n\t\torder: {\n\t\t\tdefault: 0\n\t\t},\n\t\tusingSharedPageDefinition: {\n\t\t\tdefault: false\n\t\t}\n\t};\n\n\tconstructor(initialValues = {}) {\n\t\tsuper(initialValues);\n\t\tconst { type } = initialValues;\n\t\tthis.dataBrokersEnabled = type !== 'landing';\n\t\tthis.viewportElementIds = getViewportElementIds(this.rootElement);\n\t}\n\n\tget pageDefinitionInSameScope() {\n\t\treturn typeof this.rootElement.scope === 'string'\n\t\t\t? this.scope === this.rootElement.scope\n\t\t\t: true;\n\t}\n}\n","/**\n * Handy dandy proxy for helping keep effect functions mockable by sinon, example:\n *\n * export const unProxiedFetchEffect = createGraphQLEffect(someQuery, {\n *  startActionType,\n *  successActionType,\n *  errorActionType\n * })\n *\n * In actionHandlers -\n * import effectProxy from '../helpers/effectProxy'\n * ...\n * [ACTION_CONSTANT]: effectProxy(unProxiedFetchEffect)\n *\n * In tests -\n * import { unProxiedFetchEffect } from './component-file'\n * ...\n * beforeEach(() => {\n *  sandbox.stub(unProxiedFetchEffect, 'effect')\n * })\n */\n\nexport default (effect) => (coeffects) =>\n\teffect.effect(...effect.args, coeffects);\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport get from 'lodash/get';\nimport { Action, Component, ElementEvent } from '../../models';\nimport effectProxy from '../helpers/effectProxy';\nimport {\n\tCOMPONENT_LIST_ALL_REQUESTED,\n\tCOMPONENT_LIST_REQUESTED,\n\tCOMPONENT_LIST_REQUEST_FAILED,\n\tCOMPONENT_LIST_REQUEST_STARTED,\n\tCOMPONENT_LIST_REQUEST_SUCCEEDED,\n\tCOMPONENT_LIST_TYPE_REQUESTED\n} from './componentListActions';\nimport { getProperty } from './utils';\nconst COMPONENT_STYLIZED_CONTAINER = '80653115e23949b501e719ae9b0b42a6';\nconst excludedComponents = [COMPONENT_STYLIZED_CONTAINER];\n\nconst componentListRequested = ({ action, dispatch }) => {\n\tconst pageType = get(action, 'payload.pageType', null);\n\n\tif (pageType) {\n\t\tdispatch(COMPONENT_LIST_TYPE_REQUESTED, { pageType });\n\t} else {\n\t\tdispatch(COMPONENT_LIST_ALL_REQUESTED);\n\t}\n};\n\nexport const typeComponentListRequested = createHttpEffect(\n\t'/api/now/builder/toolbox_components/:pageType',\n\t{\n\t\tmethod: 'GET',\n\t\tpathParams: ['pageType'],\n\t\tstartActionType: COMPONENT_LIST_REQUEST_STARTED,\n\t\terrorActionType: COMPONENT_LIST_REQUEST_FAILED,\n\t\tsuccessActionType: COMPONENT_LIST_REQUEST_SUCCEEDED,\n\t\tbatch: false\n\t}\n);\n\nconst allComponentListRequested = createHttpEffect(\n\t'/api/now/builder/toolbox_components',\n\t{\n\t\tmethod: 'GET',\n\t\tstartActionType: COMPONENT_LIST_REQUEST_STARTED,\n\t\terrorActionType: COMPONENT_LIST_REQUEST_FAILED,\n\t\tsuccessActionType: COMPONENT_LIST_REQUEST_SUCCEEDED,\n\t\tbatch: false\n\t}\n);\n\nconst fetchComponentData = (componentsResponse) => {\n\tif (!Array.isArray(componentsResponse)) {\n\t\treturn [];\n\t}\n\tconst components = [];\n\tcomponentsResponse.forEach(\n\t\t({\n\t\t\tmacroponent: {\n\t\t\t\tid,\n\t\t\t\tname: macroponentName,\n\t\t\t\tcategory,\n\t\t\t\tproperties = [],\n\t\t\t\tdispatchedEvents = [],\n\t\t\t\trootElementDefinition: { availableSlots = [] } = {\n\t\t\t\t\tavailableSlots: []\n\t\t\t\t},\n\t\t\t\texplodable = false\n\t\t\t},\n\t\t\tlabel,\n\t\t\tdescription = '',\n\t\t\tisEditable = false,\n\t\t\texternalConfigurationSources = [],\n\t\t\ticon,\n\t\t\tactions = [],\n\t\t\trootComponentTag\n\t\t}) => {\n\t\t\tconst propertyInstances = properties.map((property) => {\n\t\t\t\treturn getProperty(property);\n\t\t\t});\n\t\t\tconst actionInstances = actions.map(\n\t\t\t\t(action) => new Action({ name: action.name })\n\t\t\t);\n\t\t\tconst eventInstances = dispatchedEvents.map((ev) => new ElementEvent(ev));\n\t\t\tconst tag = rootComponentTag || `macroponent-${id}`;\n\t\t\tconst componentInstance = new Component({\n\t\t\t\tid,\n\t\t\t\tname: label || macroponentName,\n\t\t\t\tdescription,\n\t\t\t\ticon,\n\t\t\t\tcategory,\n\t\t\t\ttag,\n\t\t\t\texternalConfigurationSources,\n\t\t\t\tactions: actionInstances,\n\t\t\t\tslots: availableSlots,\n\t\t\t\tproperties: propertyInstances,\n\t\t\t\tdispatchedEvents: eventInstances,\n\t\t\t\texplodable,\n\t\t\t\tisEditable\n\t\t\t});\n\n\t\t\tcomponents.push(componentInstance);\n\t\t}\n\t);\n\n\treturn components;\n};\n\nconst componentListRequestStarted = ({ updateProperties }) =>\n\tupdateProperties({ isLoadingComponents: true });\n\nconst componentListRequestFailed = ({ updateProperties }) =>\n\tupdateProperties({ isLoadingComponents: false });\n\nconst transformToolboxComponent = ({\n\tname,\n\ticon,\n\tid,\n\tcategory,\n\tdescription,\n\texternalConfigurationSources,\n\tisEditable,\n\ttag\n}) => ({\n\tname,\n\ticon,\n\tid,\n\tcategory,\n\tdescription,\n\texternalConfigurationSources,\n\tisEditable,\n\ttag\n});\n\nconst componentListRequestSucceeded = ({\n\taction,\n\tupdateProperties,\n\tupdateState,\n\tproperties\n}) => {\n\tconst rawComponentList = fetchComponentData(action.payload.result);\n\tconst { isLegacy } = properties;\n\tconst filteredComponentList = isLegacy\n\t\t? rawComponentList.map(transformToolboxComponent)\n\t\t: rawComponentList\n\t\t\t\t.map(transformToolboxComponent)\n\t\t\t\t.filter(({ id }) => excludedComponents.indexOf(id) === -1);\n\n\tupdateProperties({\n\t\tcomponents: filteredComponentList,\n\t\tisLoadingComponents: false\n\t});\n\tupdateState({\n\t\tpath: 'rawComponentList',\n\t\tvalue: rawComponentList,\n\t\toperation: 'set'\n\t});\n};\n\nexport default {\n\t[COMPONENT_LIST_REQUESTED]: componentListRequested,\n\t[COMPONENT_LIST_ALL_REQUESTED]: allComponentListRequested,\n\t[COMPONENT_LIST_TYPE_REQUESTED]: effectProxy(typeComponentListRequested),\n\t[COMPONENT_LIST_REQUEST_STARTED]: componentListRequestStarted,\n\t[COMPONENT_LIST_REQUEST_FAILED]: componentListRequestFailed,\n\t[COMPONENT_LIST_REQUEST_SUCCEEDED]: componentListRequestSucceeded\n};\n","export const DATA_BROKER_DEFINITIONS_REQUESTED =\n\t'SN_UXF#DATA_BROKER_DEFINITIONS_REQUESTED';\nexport const DATA_BROKER_DEFINITIONS_REQUEST_STARTED =\n\t'SN_UXF#DATA_BROKER_DEFINITIONS_REQUEST_STARTED';\nexport const DATA_BROKER_DEFINITIONS_REQUEST_FAILED =\n\t'SN_UXF#DATA_BROKER_DEFINITIONS_REQUEST_FAILED';\nexport const DATA_BROKER_DEFINITIONS_REQUEST_SUCCEEDED =\n\t'SN_UXF#DATA_BROKER_DEFINITIONS_REQUEST_SUCCEEDED';\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport {\n\tDATA_BROKER_DEFINITIONS_REQUESTED,\n\tDATA_BROKER_DEFINITIONS_REQUEST_STARTED,\n\tDATA_BROKER_DEFINITIONS_REQUEST_FAILED,\n\tDATA_BROKER_DEFINITIONS_REQUEST_SUCCEEDED\n} from './dataBrokerDefinitionsActions';\nimport { throwError } from '../../../utils';\nimport effectProxy from '../../helpers/effectProxy';\n\nexport const dataBrokerDefinitionsRequested = createHttpEffect(\n\t'/api/now/uxf/databroker/definitions',\n\t{\n\t\tmethod: 'GET',\n\t\tstartActionType: DATA_BROKER_DEFINITIONS_REQUEST_STARTED,\n\t\tsuccessActionType: DATA_BROKER_DEFINITIONS_REQUEST_SUCCEEDED,\n\t\terrorActionType: DATA_BROKER_DEFINITIONS_REQUEST_FAILED\n\t}\n);\n\nconst dataBrokerDefinitionsRequestStarted = ({ updateProperties }) =>\n\tupdateProperties({\n\t\tdataBrokerDefinitions: [],\n\t\tdataBrokerOperations: []\n\t});\n\nconst dataBrokerDefinitionsRequestSucceeded = ({\n\taction,\n\tupdateProperties\n}) => {\n\tconst dataBrokerDefinitions = action.payload.result.map((def) => ({\n\t\t...def,\n\t\tsimpleMutationBroker: !def.hydrationSysId\n\t}));\n\n\tconst dataBrokerOperations = dataBrokerDefinitions.reduce((acc, dbDef) => {\n\t\tconst dbOperations = {\n\t\t\tdefinitionId: dbDef.sysId,\n\t\t\toperations: dbDef.operations\n\t\t};\n\t\treturn acc.concat(dbOperations);\n\t}, []);\n\n\tupdateProperties({\n\t\tdataBrokerDefinitions,\n\t\tdataBrokerOperations\n\t});\n};\n\nconst dataBrokerDefinitionsRequestFailed = () => {\n\tthrowError(`Failed to load data broker definitions`);\n};\n\nexport default {\n\t[DATA_BROKER_DEFINITIONS_REQUESTED]: effectProxy(\n\t\tdataBrokerDefinitionsRequested\n\t),\n\t[DATA_BROKER_DEFINITIONS_REQUEST_STARTED]: dataBrokerDefinitionsRequestStarted,\n\t[DATA_BROKER_DEFINITIONS_REQUEST_FAILED]: dataBrokerDefinitionsRequestFailed,\n\t[DATA_BROKER_DEFINITIONS_REQUEST_SUCCEEDED]: dataBrokerDefinitionsRequestSucceeded\n};\n","import { createCustomElement } from '@servicenow/ui-core';\nimport snabbdom, { createElement } from '@servicenow/ui-renderer-snabbdom';\n\nfunction createProperties(properties) {\n\treturn {\n\t\t...Object.entries(properties).reduce((acc, [key]) => {\n\t\t\tacc[key] = {\n\t\t\t\tselectable: true\n\t\t\t};\n\t\t\treturn acc;\n\t\t}, {})\n\t};\n}\n\nexport const createDataBrokerRuntimeElement = (dataBrokerInstance) => {\n\tconst { properties: inputProperties, outputProperties } = dataBrokerInstance;\n\t// Lower case the tagname and remove characters other than alphanumeric, -, and _ to make it seismic-safe\n\tconst tagName = `data-broker-${dataBrokerInstance.id\n\t\t.replace(/[^\\w]/g, '')\n\t\t.toLowerCase()}`;\n\n\tcreateCustomElement(tagName, {\n\t\trenderer: {\n\t\t\ttype: snabbdom,\n\t\t\tview: () => createElement('slot')\n\t\t},\n\t\tproperties: {\n\t\t\t...createProperties(inputProperties),\n\t\t\t...createProperties(outputProperties),\n\t\t\tpreview: {\n\t\t\t\tselectable: true,\n\t\t\t\tdefault: {}\n\t\t\t},\n\t\t\texecutionTime: {\n\t\t\t\tselectable: true,\n\t\t\t\tdefault: -1\n\t\t\t}\n\t\t}\n\t});\n\n\treturn tagName;\n};\n","import cloneDeep from 'lodash/cloneDeep';\nimport find from 'lodash/find';\nimport get from 'lodash/get';\nimport reject from 'lodash/reject';\n\nimport { getComponentsByTagNames } from '@devsnc/library-uxf';\n\nimport { seismicCuid } from '../../../utils';\nimport { DataBrokerInstance, Element, ElementEvent } from '../../../models';\nimport createPageState from '../../../models/createPageState';\n\nimport {\n\tDATA_BROKER_INSTANCE_CREATED,\n\tDATA_BROKER_INSTANCE_DELETED,\n\tDATA_BROKER_INSTANCE_PROPERTY_UPDATED,\n\tDATA_BROKER_INSTANCE_METADATA_UPDATE_REQUESTED,\n\tDATA_BROKER_INSTANCE_ID_CHANGED,\n\tDATA_BROKER_INSTANCE_EVALUATION_MODE_UPDATED,\n\tDATA_BROKER_INSTANCE_EVENT_MAPPING_CREATED,\n\tDATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_CREATED,\n\tDATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_CHANGED,\n\tDATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_DELETED\n} from './dataBrokerInstancesActions';\n\nimport { DATA_NAMESPACE } from '../../../constants';\nimport { createDataBrokerRuntimeElement } from '../dataBrokerFactory';\n\nimport createElementArray from '../../element/utils/createElementArray';\nimport { DATABROKER_OP } from '../../elementEventMappings/constants';\nimport {\n\tcreateEventMapping,\n\tcreateEventMappingHandler,\n\tupdateEventMappingHandler,\n\tdeleteEventMappingHandler\n} from '../../elementEventMappings/utils';\nimport {\n\taddAllEventHandlers,\n\tcreateDataBrokerInstancePropertiesFromDataBrokerDefinition\n} from '../../utils';\nimport {\n\tremoveEventReferencesToPreviousId,\n\tremovePropertyReferencesToPreviousId\n} from '../../page/utils/shared';\n\nfunction createDataBrokerFromDefinition(\n\tdataBrokerDefinitions,\n\tdataBrokerDefinitionId,\n\tdataBrokerInstances,\n\tancestorDataBrokerInstances = [],\n\tdescendentDataBrokerInstances = []\n) {\n\tconst dataBrokerDefinition = find(dataBrokerDefinitions, {\n\t\tsysId: dataBrokerDefinitionId\n\t});\n\n\tconst allDataBrokerInstanceIds = [\n\t\t...dataBrokerInstances,\n\t\t...ancestorDataBrokerInstances,\n\t\t...descendentDataBrokerInstances.map((dbi) => ({ id: dbi.elementId }))\n\t].map((dbi) => dbi.id);\n\n\tconst {\n\t\tname,\n\t\ttype,\n\t\tselectableProps,\n\t\thydrationSysId,\n\t\tclientStateDataBrokerTagName,\n\t\tdispatchedEvents = [],\n\t\teventMappings\n\t} = dataBrokerDefinition;\n\n\tconst newDataBrokerInstance = new DataBrokerInstance({\n\t\tid: seismicCuid(),\n\t\tinstanceName: name,\n\t\tdefinition: {\n\t\t\tid: dataBrokerDefinitionId,\n\t\t\ttype\n\t\t},\n\t\tselectableProps: selectableProps || [],\n\t\thydrationSysId: hydrationSysId || null,\n\t\tclientStateDataBrokerTagName: clientStateDataBrokerTagName,\n\t\tproperties: hydrationSysId\n\t\t\t? createDataBrokerInstancePropertiesFromDataBrokerDefinition(\n\t\t\t\t\tdataBrokerDefinition,\n\t\t\t\t\tfalse\n\t\t\t  )\n\t\t\t: [],\n\t\toutputProperties: createDataBrokerInstancePropertiesFromDataBrokerDefinition(\n\t\t\tdataBrokerDefinition,\n\t\t\ttrue\n\t\t),\n\t\tdispatchedEvents: dispatchedEvents.map(\n\t\t\t(ev) => new ElementEvent({ ...ev, id: ev.apiName })\n\t\t),\n\t\teventMappings: eventMappings || []\n\t});\n\tnewDataBrokerInstance.initialize(name, allDataBrokerInstanceIds);\n\treturn newDataBrokerInstance;\n}\n\nfunction dataBrokerInstanceCreated({\n\taction,\n\tproperties,\n\tupdateProperties,\n\tupdateState\n}) {\n\tconst {\n\t\tdataBrokerDefinitions,\n\t\tpageState,\n\t\tancestorDataBrokerInstances = []\n\t} = properties;\n\tconst {\n\t\tdataBrokerDefinitionId,\n\t\tdataBrokerInstance,\n\t\tdescendentDataBrokers: descendentDataBrokerInstances\n\t} = action.payload;\n\n\tconst newDataBrokerInstances = cloneDeep(pageState.dataBrokerInstances);\n\tconst newEventHandlers = cloneDeep(pageState.eventHandlers);\n\n\tconst dataBrokerInstanceToAdd =\n\t\tdataBrokerInstance ||\n\t\tcreateDataBrokerFromDefinition(\n\t\t\tdataBrokerDefinitions,\n\t\t\tdataBrokerDefinitionId,\n\t\t\tpageState.dataBrokerInstances,\n\t\t\tancestorDataBrokerInstances,\n\t\t\tdescendentDataBrokerInstances\n\t\t);\n\n\tnewDataBrokerInstances.push(dataBrokerInstanceToAdd);\n\n\tif (dataBrokerInstanceToAdd.definition.type !== 'CLIENT_STATE') {\n\t\tconst dataBrokerTag = createDataBrokerRuntimeElement(\n\t\t\tdataBrokerInstanceToAdd\n\t\t);\n\n\t\tupdateState({\n\t\t\tpath: `dataBrokerElements.${dataBrokerInstanceToAdd.id}`,\n\t\t\tvalue: dataBrokerTag,\n\t\t\toperation: 'set'\n\t\t});\n\t} else {\n\t\tgetComponentsByTagNames([\n\t\t\tdataBrokerInstanceToAdd.clientStateDataBrokerTagName\n\t\t]);\n\t}\n\n\tconst updatedEventHandlers = addAllEventHandlers(\n\t\tnewEventHandlers,\n\t\tfalse, // These handlers are from local contexts\n\t\t[dataBrokerInstanceToAdd],\n\t\tdataBrokerDefinitions\n\t);\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\tdataBrokerInstances: newDataBrokerInstances,\n\t\t\t\teventHandlers: updatedEventHandlers\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n}\n\nconst dataBrokerInstanceDeleted = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState } = properties;\n\tconst { dataBrokerId } = action.payload;\n\n\tconst newDataBrokerInstances = cloneDeep(pageState.dataBrokerInstances);\n\tconst newEventHandlers = cloneDeep(pageState.eventHandlers);\n\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst elements = createElementArray(newRootElement, (element) => ({\n\t\teventMappings: element.eventMappings\n\t}));\n\t// remove any event mapping targets which reference the data broker instance we are deleting\n\telements.forEach((element) => {\n\t\telement.eventMappings.forEach((eventMapping) => {\n\t\t\teventMapping.targets = eventMapping.targets.filter((target) => {\n\t\t\t\tif (\n\t\t\t\t\ttarget.type === DATABROKER_OP &&\n\t\t\t\t\ttarget.operation.dataBrokerId === dataBrokerId\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t});\n\t});\n\t// remove any event handlers which reference the data broker instance we are deleting\n\tconst updatedEventHandlers = reject(newEventHandlers, {\n\t\tsourceId: dataBrokerId\n\t});\n\t// remove the data broker instance\n\tconst updatedDataBrokerInstances = reject(newDataBrokerInstances, {\n\t\tid: dataBrokerId\n\t});\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: newRootElement,\n\t\t\t\tdataBrokerInstances: updatedDataBrokerInstances,\n\t\t\t\teventHandlers: updatedEventHandlers\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nconst dataBrokerInstancePropertyUpdated = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState, dataBrokerProperties = {} } = properties;\n\tconst { dataBrokerId, propertyId, value } = action.payload;\n\n\tconst newDataBrokerInstances = cloneDeep(pageState.dataBrokerInstances);\n\n\tconst dataBrokerInstanceToUpdate =\n\t\tfind(newDataBrokerInstances, {\n\t\t\tid: dataBrokerId\n\t\t}) || {};\n\n\tconst dataBrokerInstancePropertyToUpdate =\n\t\tfind(dataBrokerInstanceToUpdate.properties, {\n\t\t\tcolumnName: propertyId\n\t\t}) || {};\n\n\tconst dataBrokerInstanceProperties = dataBrokerProperties[dataBrokerId] || [];\n\tconst updateProp =\n\t\tfind(dataBrokerInstanceProperties, { id: propertyId }) || {};\n\n\tif (updateProp.onChange) {\n\t\tupdateProp.onChange(dataBrokerInstanceToUpdate);\n\t}\n\n\tdataBrokerInstancePropertyToUpdate.value = value;\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\tdataBrokerInstances: newDataBrokerInstances\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nconst dataBrokerMetadataUpdatedHandler = ({\n\taction,\n\tproperties,\n\tupdateProperties,\n\tdispatch,\n\tupdateState\n}) => {\n\tconst { pageState = {} } = properties;\n\tconst {\n\t\tclientStateParameters = [],\n\t\tdataBrokerInstances = [],\n\t\teventHandlers = [],\n\t\trootElement = {}\n\t} = pageState;\n\n\tconst { previousId, changes = {} } = action.payload;\n\tconst newDataBrokerInstances = cloneDeep(dataBrokerInstances);\n\tconst dataBrokerInstanceToUpdate = find(newDataBrokerInstances, {\n\t\tid: previousId\n\t});\n\n\tconst newRootElement = cloneDeep(rootElement);\n\tconst { internalEventMappings = [] } = newRootElement || {};\n\tconst elements = createElementArray(newRootElement, (element) => element);\n\tconst newEventHandlers = cloneDeep(eventHandlers);\n\tconst newClientStateParameters = cloneDeep(clientStateParameters);\n\n\tif (changes.instanceName) {\n\t\tdataBrokerInstanceToUpdate.instanceName = changes.instanceName;\n\t\t// if a data broker instance name is changed, update event handlers that reference the old name.\n\t\tnewEventHandlers.map((eventHandler) => {\n\t\t\tconst sourceId = get(eventHandler, 'sourceId', null);\n\t\t\tif (sourceId === dataBrokerInstanceToUpdate.id) {\n\t\t\t\teventHandler.sourceName = changes.instanceName;\n\t\t\t}\n\t\t});\n\t}\n\n\tif (changes.id) {\n\t\tdataBrokerInstanceToUpdate.id = changes.id;\n\t\tremovePropertyReferencesToPreviousId(\n\t\t\tpreviousId,\n\t\t\tchanges.id,\n\t\t\telements,\n\t\t\tnewDataBrokerInstances,\n\t\t\tnewClientStateParameters,\n\t\t\tDATA_NAMESPACE\n\t\t);\n\t\tremoveEventReferencesToPreviousId(\n\t\t\tpreviousId,\n\t\t\tchanges.id,\n\t\t\telements,\n\t\t\tnewEventHandlers,\n\t\t\tnewDataBrokerInstances,\n\t\t\tinternalEventMappings,\n\t\t\tDATA_NAMESPACE\n\t\t);\n\n\t\tconst dataBrokerTag = createDataBrokerRuntimeElement(\n\t\t\tdataBrokerInstanceToUpdate\n\t\t);\n\t\tupdateState({\n\t\t\tpath: `dataBrokerElements.${dataBrokerInstanceToUpdate.id}`,\n\t\t\tvalue: dataBrokerTag,\n\t\t\toperation: 'set'\n\t\t});\n\n\t\tdispatch(DATA_BROKER_INSTANCE_ID_CHANGED, { id: changes.id });\n\t}\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\tdataBrokerInstances: newDataBrokerInstances,\n\t\t\t\tclientStateParameters: newClientStateParameters,\n\t\t\t\teventHandlers: newEventHandlers,\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nconst dataBrokerInstanceEvaluationModeChanged = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { dataBrokerId, value } = action.payload || {};\n\tconst { pageState } = properties;\n\n\tconst newDataBrokerInstances = cloneDeep(pageState.dataBrokerInstances);\n\tconst dataBrokerInstanceToUpdate = find(newDataBrokerInstances, {\n\t\tid: dataBrokerId\n\t});\n\tdataBrokerInstanceToUpdate.readEvaluationMode = value;\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{ dataBrokerInstances: newDataBrokerInstances },\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nconst dataBrokerEventMappingCreated = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { dataBrokerId, eventApiName } = action.payload || {};\n\tconst { pageState = {} } = properties;\n\tconst newDataBrokerInstances = cloneDeep(pageState.dataBrokerInstances || []);\n\tconst dataBrokerInstanceToUpdate = newDataBrokerInstances.find(\n\t\t(dbInstance) => dbInstance.id === dataBrokerId\n\t);\n\n\tif (dataBrokerInstanceToUpdate) {\n\t\tconst dataBrokerEventMapping = createEventMapping(\n\t\t\teventApiName,\n\t\t\teventApiName\n\t\t);\n\t\tdataBrokerInstanceToUpdate.eventMappings.unshift(dataBrokerEventMapping);\n\t}\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{ dataBrokerInstances: newDataBrokerInstances },\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nconst dataBrokerEventMappingHandlerCreated = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { dataBrokerId, eventMappingId } = action.payload || {};\n\tconst { pageState = {} } = properties;\n\tconst newDataBrokerInstances = cloneDeep(pageState.dataBrokerInstances || []);\n\tconst dataBrokerInstanceToUpdate =\n\t\tnewDataBrokerInstances.find(\n\t\t\t(dbInstance) => dbInstance.id === dataBrokerId\n\t\t) || {};\n\n\tconst { eventMappings = [] } = dataBrokerInstanceToUpdate;\n\tcreateEventMappingHandler(eventMappings, eventMappingId);\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{ dataBrokerInstances: newDataBrokerInstances },\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nconst dataBrokerEventMappingHandlerChanged = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst {\n\t\tdataBrokerId,\n\t\teventMappingId,\n\t\thandlerId,\n\t\thandlerTypeId = null,\n\t\thandlerValueId = null,\n\t\tvalue = null,\n\t\tscripted = null\n\t} = action.payload || {};\n\tconst {\n\t\teventHandlers = [],\n\t\tpageState = {},\n\t\tclientStateParameters = []\n\t} = properties;\n\tconst newDataBrokerInstances = cloneDeep(pageState.dataBrokerInstances || []);\n\tconst dataBrokerInstanceToUpdate =\n\t\tnewDataBrokerInstances.find(\n\t\t\t(dbInstance) => dbInstance.id === dataBrokerId\n\t\t) || {};\n\tconst { eventMappings = [] } = dataBrokerInstanceToUpdate;\n\tconst eventMappingToUpdate =\n\t\teventMappings.find(\n\t\t\t(eventMapping) => eventMapping.eventMappingId === eventMappingId\n\t\t) || {};\n\tconst { targets = [] } = eventMappingToUpdate;\n\n\tconst handlerToUpdate =\n\t\ttargets.find((target) => target.targetId === handlerId) || null;\n\tif (handlerToUpdate) {\n\t\tupdateEventMappingHandler(\n\t\t\thandlerToUpdate,\n\t\t\teventHandlers,\n\t\t\thandlerTypeId,\n\t\t\thandlerValueId,\n\t\t\tvalue,\n\t\t\tscripted,\n\t\t\tclientStateParameters\n\t\t);\n\t}\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{ dataBrokerInstances: newDataBrokerInstances },\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nconst dataBrokerEventMappingHandlerDeleted = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { dataBrokerId, eventMappingId, handlerId } = action.payload || {};\n\tconst { pageState = {} } = properties;\n\tconst newDataBrokerInstances = cloneDeep(pageState.dataBrokerInstances || []);\n\tconst dataBrokerInstanceToUpdate =\n\t\tnewDataBrokerInstances.find(\n\t\t\t(dbInstance) => dbInstance.id === dataBrokerId\n\t\t) || {};\n\tconst { eventMappings = [] } = dataBrokerInstanceToUpdate;\n\n\tdeleteEventMappingHandler(\n\t\tdataBrokerInstanceToUpdate,\n\t\teventMappings,\n\t\teventMappingId,\n\t\thandlerId\n\t);\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{ dataBrokerInstances: newDataBrokerInstances },\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nexport default {\n\t[DATA_BROKER_INSTANCE_CREATED]: dataBrokerInstanceCreated,\n\t[DATA_BROKER_INSTANCE_DELETED]: dataBrokerInstanceDeleted,\n\t[DATA_BROKER_INSTANCE_PROPERTY_UPDATED]: dataBrokerInstancePropertyUpdated,\n\t[DATA_BROKER_INSTANCE_METADATA_UPDATE_REQUESTED]: dataBrokerMetadataUpdatedHandler,\n\t[DATA_BROKER_INSTANCE_EVALUATION_MODE_UPDATED]: dataBrokerInstanceEvaluationModeChanged,\n\t[DATA_BROKER_INSTANCE_EVENT_MAPPING_CREATED]: dataBrokerEventMappingCreated,\n\t[DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_CREATED]: dataBrokerEventMappingHandlerCreated,\n\t[DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_CHANGED]: dataBrokerEventMappingHandlerChanged,\n\t[DATA_BROKER_INSTANCE_EVENT_MAPPING_HANDLER_DELETED]: dataBrokerEventMappingHandlerDeleted\n};\n","export const DATA_BROKER_RUNTIME_EXECUTE_REQUESTED =\n\t'SN_UXF#DATA_BROKER_RUNTIME_EXECUTE_REQUESTED';\nexport const DATA_BROKER_RUNTIME_EXECUTE_HTTP_REQUESTED =\n\t'SN_UXF#DATA_BROKER_RUNTIME_EXECUTE_HTTP_REQUESTED';\nexport const DATA_BROKER_RUNTIME_EXECUTE_STARTED =\n\t'SN_UXF#DATA_BROKER_RUNTIME_EXECUTE_STARTED';\nexport const DATA_BROKER_RUNTIME_EXECUTE_SUCCEEDED =\n\t'SN_UXF#DATA_BROKER_RUNTIME_EXECUTE_SUCCEEDED';\nexport const DATA_BROKER_RUNTIME_EXECUTE_FAILED =\n\t'SN_UXF#DATA_BROKER_RUNTIME_EXECUTE_FAILED';\nexport const DATA_BROKER_RUNTIME_RESET_AND_EXECUTE_REQUESTED =\n\t'SN_UXF#DATA_BROKER_RUNTIME_RESET_AND_EXECUTE_REQUESTED';\n","import {\n\tCONTEXT_NAMESPACE,\n\tDATA_NAMESPACE,\n\tSTATE_NAMESPACE\n} from '../../../constants';\nimport {\n\tmatchContextAppBindingSyntax,\n\tmatchContextSessionBindingSyntax,\n\tmatchStateBindingSyntax\n} from '../../../utils';\nimport isUndefined from 'lodash/isUndefined';\nimport get from 'lodash/get';\n\nconst DATA_CHAIN_BINDING = 'DATA_CHAIN_BINDING';\nconst JSON_LITERAL = 'JSON_LITERAL';\n\nexport const generateJSONLiteral = (value) => {\n\treturn {\n\t\ttype: JSON_LITERAL,\n\t\tvalue\n\t};\n};\n\nexport const resolveContextBinding = (\n\tvalue,\n\tcontextBindings,\n\tdataBrokerInstances,\n\tappChromeSettings = {}\n) => {\n\tconst matchedContextSessionBinding = matchContextSessionBindingSyntax(value);\n\tif (matchedContextSessionBinding) {\n\t\tconst { path } = matchedContextSessionBinding;\n\t\treturn resolveDataBinding(\n\t\t\t`${DATA_NAMESPACE}.session.output${path || ''}`,\n\t\t\tdataBrokerInstances\n\t\t);\n\t}\n\n\tconst matchedContextAppBinding = matchContextAppBindingSyntax(value);\n\tif (matchedContextAppBinding) {\n\t\tconst { path } = matchedContextAppBinding;\n\t\tconst resolvedValue = get(appChromeSettings, path, null);\n\n\t\treturn {\n\t\t\ttype: JSON_LITERAL,\n\t\t\tvalue: !isUndefined(resolvedValue) ? resolvedValue : null\n\t\t};\n\t}\n\n\tconst bindingName = value.substring(`${CONTEXT_NAMESPACE}.props`.length + 1);\n\tconst bindingNameSplitter = bindingName.split('.');\n\tconst contextValue = contextBindings[bindingNameSplitter.shift()];\n\tconst path = bindingNameSplitter.length\n\t\t? `.${bindingNameSplitter.join('.')}`\n\t\t: '';\n\n\tif (\n\t\tcontextValue &&\n\t\ttypeof contextValue === 'string' &&\n\t\tcontextValue.startsWith(DATA_NAMESPACE)\n\t) {\n\t\treturn resolveDataBinding(`${contextValue}${path}`, dataBrokerInstances);\n\t}\n\n\treturn {\n\t\ttype: JSON_LITERAL,\n\t\tvalue: contextValue\n\t};\n};\n\nexport const resolveDataBinding = (value, dataBrokerInstances) => {\n\tconst splitExpression = value.split('.');\n\tconst dataBrokerInstanceId = splitExpression[1];\n\tconst outputPath = splitExpression.length > 2 ? splitExpression.slice(2) : [];\n\tconst address = dataBrokerInstances\n\t\t.filter(\n\t\t\t(dataBrokerInstance) =>\n\t\t\t\tdataBrokerInstance.definition.type !== 'CLIENT_STATE' &&\n\t\t\t\t!dataBrokerInstance.simpleMutationBroker\n\t\t)\n\t\t.findIndex((dbInstance) => dbInstance.id === dataBrokerInstanceId);\n\n\treturn {\n\t\ttype: DATA_CHAIN_BINDING,\n\t\tbinding: {\n\t\t\taddress: [`${address}`, ...outputPath]\n\t\t}\n\t};\n};\n\nexport const resolveStateBinding = (value, clientStateData) => {\n\tconst bindingValue = matchStateBindingSyntax(value);\n\tconst resolvedValue = get(clientStateData, bindingValue.name, null);\n\treturn {\n\t\ttype: JSON_LITERAL,\n\t\tvalue: !isUndefined(resolvedValue) ? resolvedValue : null\n\t};\n};\n\nconst resolveBinding = (\n\tproperty,\n\tdataBrokerInstances,\n\tcontextBindingValues,\n\tclientStateData,\n\tappChromeSettings\n) => {\n\tconst { value } = property;\n\tif (!value) {\n\t\treturn;\n\t}\n\tif (typeof value !== 'string') {\n\t\treturn generateJSONLiteral(value);\n\t} else if (value.startsWith(CONTEXT_NAMESPACE)) {\n\t\treturn resolveContextBinding(\n\t\t\tvalue,\n\t\t\tcontextBindingValues,\n\t\t\tdataBrokerInstances,\n\t\t\tappChromeSettings\n\t\t);\n\t} else if (value.startsWith(DATA_NAMESPACE)) {\n\t\treturn resolveDataBinding(value, dataBrokerInstances);\n\t} else if (value.startsWith(STATE_NAMESPACE)) {\n\t\treturn resolveStateBinding(value, clientStateData);\n\t}\n\treturn generateJSONLiteral(value);\n};\n\n/**\n * Transforms macroponent.data values to databroker runtime to execute on server\n * @param {} param0\n */\nexport const transformDataBrokerInstancesToDataBrokerRuntime = (\n\tdataBrokerInstances,\n\tincludeDataBrokerId,\n\tcontextBindingValues = {},\n\tclientStateData,\n\tappChromeSettings\n) => {\n\tconst resolvedDataBrokers = dataBrokerInstances\n\t\t.filter((dataBrokerInstance) => {\n\t\t\treturn (\n\t\t\t\tdataBrokerInstance.definition.type !== 'CLIENT_STATE' &&\n\t\t\t\t!dataBrokerInstance.simpleMutationBroker\n\t\t\t);\n\t\t})\n\t\t.map((dataBrokerInstance) => {\n\t\t\tconst dataBrokerDefinitionId = dataBrokerInstance.definition.id;\n\n\t\t\tconst hydratedInputValues = Object.entries(\n\t\t\t\tdataBrokerInstance.properties\n\t\t\t).reduce((acc, [name, property]) => {\n\t\t\t\tacc[name] = resolveBinding(\n\t\t\t\t\tproperty,\n\t\t\t\t\tdataBrokerInstances,\n\t\t\t\t\tcontextBindingValues,\n\t\t\t\t\tclientStateData,\n\t\t\t\t\tappChromeSettings\n\t\t\t\t);\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\n\t\t\treturn {\n\t\t\t\tdataBrokerid: includeDataBrokerId ? dataBrokerInstance.id : undefined,\n\t\t\t\tdefinitionSysId: dataBrokerDefinitionId,\n\t\t\t\tinputValues: hydratedInputValues,\n\t\t\t\ttype: dataBrokerInstance.definition.type\n\t\t\t};\n\t\t});\n\tif (resolvedDataBrokers.find((d, i) => findMaxReferenceAddress(d, i) > i)) {\n\t\treturn orderDataBrokerChainBreadthFirst(resolvedDataBrokers);\n\t}\n\treturn resolvedDataBrokers;\n};\n\nconst orderDataBrokerChainBreadthFirst = (dataBrokerDependencyChain) => {\n\tconst nodes = dataBrokerDependencyChain.map((dataBroker, idx) => ({\n\t\tcurrentPosition: idx,\n\t\tcurChildIndexes: new Set(),\n\t\tnewPosition: -1,\n\t\tisChild: false\n\t}));\n\n\tfor (const index in dataBrokerDependencyChain) {\n\t\tObject.values(dataBrokerDependencyChain[index].inputValues)\n\t\t\t.filter((v) => !!v)\n\t\t\t.filter(({ type }) => type === DATA_CHAIN_BINDING)\n\t\t\t.forEach(({ binding }) => {\n\t\t\t\tconst addr = binding.address[0];\n\t\t\t\tnodes[addr].curChildIndexes.add(index);\n\t\t\t\tnodes[index].isChild = true;\n\t\t\t});\n\t}\n\n\tlet counter = 0;\n\tlet toBeVisited = nodes.filter((n) => !n.isChild);\n\ttoBeVisited.sort((n1, n2) => n1.currentPosition - n2.currentPosition);\n\n\twhile (toBeVisited.length > 0) {\n\t\tconst childIndexes = new Set();\n\t\tfor (const node of toBeVisited) {\n\t\t\tif (node.newPosition > -1) {\n\t\t\t\t// TODO: Should throw exception. We are skipping this for now.\n\t\t\t\treturn dataBrokerDependencyChain;\n\t\t\t}\n\t\t\tnode.newPosition = counter++;\n\t\t\tif (node.curChildIndexes.size) {\n\t\t\t\tnode.curChildIndexes.forEach((child) => childIndexes.add(child));\n\t\t\t}\n\t\t}\n\t\ttoBeVisited = [...childIndexes]\n\t\t\t.sort((n1, n2) => n1 - n2)\n\t\t\t.map((i) => nodes[i]);\n\t}\n\n\tnodes.sort((n1, n2) => n1.newPosition - n2.newPosition);\n\tconst ret = new Array(dataBrokerDependencyChain.length);\n\tif (nodes.find((node) => node.newPosition < 0)) {\n\t\treturn dataBrokerDependencyChain;\n\t}\n\tfor (const node of nodes) {\n\t\tret[node.newPosition] = dataBrokerDependencyChain[node.currentPosition];\n\t\tnode.curChildIndexes.forEach((childIdx) => {\n\t\t\tconst dataBroker = dataBrokerDependencyChain[childIdx];\n\t\t\tfor (const k in dataBroker.inputValues) {\n\t\t\t\tif (\n\t\t\t\t\tdataBroker.inputValues[k].type === DATA_CHAIN_BINDING &&\n\t\t\t\t\tdataBroker.inputValues[k].binding.address[0] ===\n\t\t\t\t\t\t`${node.currentPosition}`\n\t\t\t\t) {\n\t\t\t\t\tdataBroker.inputValues[k].binding.address[0] = `${node.newPosition}`;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\treturn ret;\n};\n\nconst findMaxReferenceAddress = (d, address) => {\n\treturn Object.values(d.inputValues)\n\t\t.filter((v) => !!v)\n\t\t.filter((v) => v.type === DATA_CHAIN_BINDING)\n\t\t.reduce((acc, c) => Math.max(acc, c.binding.address[0]), address);\n};\n","export const UPDATED_TABLES_RESET_REQUESTED =\n\t'SN_UXF#UPDATED_TABLES_RESET_REQUESTED';\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport { transformDataBrokerInstancesToDataBrokerRuntime } from './utils/transformDataBrokerInstancesToDataBrokerRuntime';\nimport {\n\tDATA_BROKER_RUNTIME_EXECUTE_REQUESTED,\n\tDATA_BROKER_RUNTIME_EXECUTE_HTTP_REQUESTED,\n\tDATA_BROKER_RUNTIME_EXECUTE_STARTED,\n\tDATA_BROKER_RUNTIME_EXECUTE_SUCCEEDED,\n\tDATA_BROKER_RUNTIME_EXECUTE_FAILED,\n\tDATA_BROKER_RUNTIME_RESET_AND_EXECUTE_REQUESTED\n} from './dataBrokerRuntimeActions';\nimport { DATA_BROKER_DEFINITIONS_REQUESTED } from './dataBrokerDefinitions/dataBrokerDefinitionsActions';\nimport { UPDATED_TABLES_RESET_REQUESTED } from '../updatedTables/updatedTablesActions';\nimport reduceContextBindingsWithAncestors from '../pageProperties/utils/reduceContextBindingsWithAncestors';\nimport { throwError, matchBindingSyntax } from '../../utils';\nimport effectProxy from '../helpers/effectProxy';\nimport get from 'lodash/get';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { DATA_NAMESPACE } from '../../constants';\nimport createPageState from '../../models/createPageState';\nimport { createDataBrokerInstancePropertiesFromDataBrokerDefinition } from '../utils';\n\nexport const dataBrokerRuntimeExecuteHttpEffect = createHttpEffect(\n\t'/api/now/uxf/databroker/exec',\n\t{\n\t\tmethod: 'POST',\n\t\tbatch: false,\n\t\tpathParams: ['pageEndpoint'],\n\t\tdataParam: 'data',\n\t\tstartActionType: DATA_BROKER_RUNTIME_EXECUTE_STARTED,\n\t\tsuccessActionType: DATA_BROKER_RUNTIME_EXECUTE_SUCCEEDED,\n\t\terrorActionType: DATA_BROKER_RUNTIME_EXECUTE_FAILED\n\t}\n);\n\nconst dataBrokerRuntimeExecuteRequested = ({ properties, dispatch }) => {\n\tconst {\n\t\tpageState,\n\t\tancestorDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tclientStateData,\n\t\tparentDataBrokerInstances,\n\t\tisIsolatedEditAndEmptyState,\n\t\tappChromeSettings\n\t} = properties;\n\tconst dataBrokerInstances = isIsolatedEditAndEmptyState\n\t\t? parentDataBrokerInstances\n\t\t: get(pageState, 'dataBrokerInstances', []);\n\tconst ancestorDBkrIDs = new Set(\n\t\tancestorDataBrokerInstances.map((dbr) => dbr.id)\n\t);\n\tdataBrokerInstances.forEach((dbkr) => {\n\t\tfor (const p in dbkr.properties) {\n\t\t\tconst val = dbkr.properties[p].value;\n\t\t\tconst bindExpr = val && matchBindingSyntax(val);\n\t\t\tif (\n\t\t\t\tbindExpr &&\n\t\t\t\tbindExpr.namespace === DATA_NAMESPACE &&\n\t\t\t\tancestorDBkrIDs.has(bindExpr.id)\n\t\t\t) {\n\t\t\t\tdbkr.properties[p].value = null;\n\t\t\t}\n\t\t}\n\t});\n\n\tconst dataBrokerRuntime = transformDataBrokerInstancesToDataBrokerRuntime(\n\t\t[...ancestorDataBrokerInstances, ...dataBrokerInstances],\n\t\tfalse,\n\t\treduceContextBindingsWithAncestors(pageState, ancestorPageProperties),\n\t\tclientStateData,\n\t\tappChromeSettings\n\t);\n\tif (dataBrokerRuntime.length) {\n\t\tdispatch(DATA_BROKER_RUNTIME_EXECUTE_HTTP_REQUESTED, {\n\t\t\tdata: dataBrokerRuntime\n\t\t});\n\t}\n};\n\nconst dataBrokerRuntimeExecuteSucceeeded = ({\n\taction,\n\tproperties,\n\tupdateState\n}) => {\n\tconst {\n\t\tpageState = {},\n\t\tancestorDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tclientStateData,\n\t\tparentDataBrokerInstances,\n\t\tisIsolatedEditAndEmptyState,\n\t\tappChromeSettings\n\t} = properties;\n\tconst dataBrokerInstances = isIsolatedEditAndEmptyState\n\t\t? parentDataBrokerInstances\n\t\t: get(pageState, 'dataBrokerInstances', []);\n\n\tconst dataBrokerChain = transformDataBrokerInstancesToDataBrokerRuntime(\n\t\t[...ancestorDataBrokerInstances, ...dataBrokerInstances],\n\t\ttrue,\n\t\treduceContextBindingsWithAncestors(pageState, ancestorPageProperties),\n\t\tclientStateData,\n\t\tappChromeSettings\n\t);\n\n\tconst dataBrokerData = dataBrokerChain\n\t\t.map((dataBrokerLink, index) => {\n\t\t\treturn {\n\t\t\t\tdataBrokerid: dataBrokerLink.dataBrokerid,\n\t\t\t\tresult: get(action.payload, `result[${index}].executionResult`, {}),\n\t\t\t\terrors: get(action.payload, `result[${index}].errors`),\n\t\t\t\texecutionTime: get(action.payload, `result[${index}].executionTime`, -1)\n\t\t\t};\n\t\t})\n\t\t.reduce((acc, dataBrokerLink) => {\n\t\t\tacc[dataBrokerLink.dataBrokerid] = {\n\t\t\t\tresult: dataBrokerLink.result,\n\t\t\t\texecutionTime: dataBrokerLink.executionTime,\n\t\t\t\terrors: dataBrokerLink.errors\n\t\t\t};\n\n\t\t\treturn acc;\n\t\t}, {});\n\n\tupdateState({\n\t\tpath: 'dataBrokerData',\n\t\tvalue: dataBrokerData,\n\t\toperation: 'set'\n\t});\n};\n\nconst dataBrokerRuntimeExecuteStarted = () => {\n\t// eslint-disable-next-line no-console\n\tconsole.log(`UXF Message: Started to execute data broker instances`); // TODO: Remove\n};\n\nconst dataBrokerRuntimeExecuteFailed = () => {\n\tthrowError(`Failed to execute data broker instances`);\n};\n\nconst dataBrokerRuntimeResetAndExecuteRequested = ({\n\tdispatch,\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { __data } = action.payload;\n\tconst inputProps = get(__data, 'record.props', null);\n\tconst outputProps = get(__data, 'record.output_schema', null);\n\tconst sysId = get(__data, 'sys_id', null);\n\tconst actionType = get(__data, 'action', null);\n\tconst changedDataBrokerDefinition = properties.dataBrokerDefinitions.find(\n\t\t(def) => def.sysId === sysId\n\t);\n\tif (!changedDataBrokerDefinition && actionType !== 'entry') {\n\t\treturn;\n\t}\n\n\tlet newInputProps,\n\t\tnewOutputProps,\n\t\tnewDataBrokerInstances = properties.pageState.dataBrokerInstances;\n\tif (inputProps) {\n\t\ttry {\n\t\t\tnewInputProps = JSON.parse(inputProps.value);\n\t\t\tchangedDataBrokerDefinition.inputParams = newInputProps;\n\t\t} catch (e) {\n\t\t\tthrowError('Failed to parse new incoming data broker prop changes');\n\t\t}\n\t\tconst newInstanceProps = createDataBrokerInstancePropertiesFromDataBrokerDefinition(\n\t\t\tchangedDataBrokerDefinition,\n\t\t\tfalse\n\t\t);\n\t\tnewDataBrokerInstances = newDataBrokerInstances.map((dbinst) => {\n\t\t\tif (dbinst.definition.id === sysId) {\n\t\t\t\treturn { ...dbinst, properties: newInstanceProps };\n\t\t\t}\n\t\t\treturn dbinst;\n\t\t});\n\t}\n\n\tif (outputProps) {\n\t\tif (!outputProps.value) {\n\t\t\tchangedDataBrokerDefinition.outputSchema = [\n\t\t\t\t{\n\t\t\t\t\tfieldType: 'object',\n\t\t\t\t\tlabel: 'Output',\n\t\t\t\t\tmandatory: false,\n\t\t\t\t\tname: 'output',\n\t\t\t\t\treadOnly: true,\n\t\t\t\t\tselectable: false,\n\t\t\t\t\tvalueType: 'object'\n\t\t\t\t}\n\t\t\t];\n\t\t} else {\n\t\t\ttry {\n\t\t\t\tnewOutputProps = JSON.parse(outputProps.value);\n\t\t\t\tchangedDataBrokerDefinition.outputSchema = newOutputProps;\n\t\t\t} catch (e) {\n\t\t\t\tthrowError('Failed to parse new incoming data broker prop changes');\n\t\t\t}\n\t\t}\n\t\tconst newInstanceOutputProps = createDataBrokerInstancePropertiesFromDataBrokerDefinition(\n\t\t\tchangedDataBrokerDefinition,\n\t\t\ttrue\n\t\t);\n\t\tnewDataBrokerInstances = newDataBrokerInstances.map((dbinst) => {\n\t\t\tif (dbinst.definition.id === sysId) {\n\t\t\t\treturn { ...dbinst, outputProperties: newInstanceOutputProps };\n\t\t\t}\n\t\t\treturn dbinst;\n\t\t});\n\t}\n\n\t(inputProps || outputProps) &&\n\t\tupdateProperties({\n\t\t\tpageState: createPageState(\n\t\t\t\t{\n\t\t\t\t\tdataBrokerInstances: newDataBrokerInstances\n\t\t\t\t},\n\t\t\t\tcloneDeep(properties.pageState)\n\t\t\t)\n\t\t});\n\n\tdispatch(UPDATED_TABLES_RESET_REQUESTED, { table: 'sys_ux_data_broker' });\n\tdispatch(DATA_BROKER_DEFINITIONS_REQUESTED);\n\tdispatch(DATA_BROKER_RUNTIME_EXECUTE_REQUESTED);\n};\n\nexport default {\n\t[DATA_BROKER_RUNTIME_EXECUTE_REQUESTED]: dataBrokerRuntimeExecuteRequested,\n\t[DATA_BROKER_RUNTIME_EXECUTE_HTTP_REQUESTED]: effectProxy(\n\t\tdataBrokerRuntimeExecuteHttpEffect\n\t),\n\t[DATA_BROKER_RUNTIME_EXECUTE_SUCCEEDED]: dataBrokerRuntimeExecuteSucceeeded,\n\t[DATA_BROKER_RUNTIME_EXECUTE_STARTED]: dataBrokerRuntimeExecuteStarted,\n\t[DATA_BROKER_RUNTIME_EXECUTE_FAILED]: dataBrokerRuntimeExecuteFailed,\n\t[DATA_BROKER_RUNTIME_RESET_AND_EXECUTE_REQUESTED]: dataBrokerRuntimeResetAndExecuteRequested\n};\n","import { findElementById } from './element';\nimport get from 'lodash/get';\n\n/**\n * Finds the of quadrant of where an existing x,y coordinate.\n * @param {Object} rootElement - the element to recursively search throught.\n * @param {string} ownerId - cuid of the owning element.\n * @param {string} layoutRole - The layout role to use, this is currently just `default`.\n * @returns {string} - the layout type of the owner element or an empty string.\n */\nexport default function getLayoutType(\n\trootElement,\n\townerId,\n\tlayoutRole = 'default'\n) {\n\tconst owner = findElementById(rootElement, ownerId);\n\treturn get(owner, `layout.${layoutRole}.type`, '');\n}\n","import Model from '../model';\n\nexport default class ColumnElement extends Model {\n\tconstructor({ slotName, size, rows = [], id }) {\n\t\tsuper();\n\t\tthis.type = 'column';\n\t\tthis.slotName = slotName;\n\t\tthis.size = size;\n\t\tthis.rows = rows;\n\t\tthis.id = id;\n\t}\n}\n","import Model from '../model';\n\nexport default class RowElement extends Model {\n\tconstructor({ slotName, columns = [], id }) {\n\t\tsuper();\n\t\tthis.type = 'row';\n\t\tthis.slotName = slotName;\n\t\tthis.columns = columns;\n\t\tthis.id = id;\n\t}\n}\n","import Model from '../model';\n\nexport default class RowColumn extends Model {\n\tconstructor(root) {\n\t\tsuper();\n\t\tthis.type = 'rowColumn';\n\t\tthis.root = root;\n\t}\n}\n","import cuid from 'cuid';\nimport Layout from '../../../../models/layout/layout';\nimport ColumnElement from '../../../../models/layout/columnElement';\nimport RowElement from '../../../../models/layout/rowElement';\nimport RowColumn from '../../../../models/layout/rowColumn';\n\nimport {\n\tinsertAndGetUpdatedLayout,\n\tdeleteAndGetUpdatedLayout,\n\ttreeifyLayout,\n\tflattenLayout\n} from '../layout';\n\nfunction rowWithColumnsLayout(slotToPlaceNewElementIn) {\n\treturn new Layout({\n\t\tdefault: new RowColumn(\n\t\t\tnew RowElement({\n\t\t\t\tid: cuid(),\n\t\t\t\tcolumns: [\n\t\t\t\t\tnew ColumnElement({\n\t\t\t\t\t\tsize: '12',\n\t\t\t\t\t\tslotName: slotToPlaceNewElementIn,\n\t\t\t\t\t\tid: cuid()\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t})\n\t\t)\n\t});\n}\n\nfunction rootIsALeaf(layout) {\n\tconst {\n\t\tdefault: { root }\n\t} = layout;\n\tif (!root.columns && !root.rows) {\n\t\treturn true;\n\t} else if (\n\t\t(root.columns && !root.columns.length) ||\n\t\t(root.rows && !root.rows.length)\n\t) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport const placeElementOnLayout = ({\n\thasChildren,\n\tadjacentId,\n\tslotName,\n\tdirection,\n\tlayout\n}) => {\n\tif (!layout || !layout.default || !hasChildren) {\n\t\treturn rowWithColumnsLayout(slotName);\n\t}\n\tconst flattenedInputLayout = flattenLayout(layout.default.root);\n\tconst flattenedOutputLayout = insertAndGetUpdatedLayout(\n\t\tflattenedInputLayout,\n\t\tdirection,\n\t\tadjacentId,\n\t\tslotName\n\t);\n\treturn treeifyLayout(flattenedOutputLayout);\n};\n\nexport const deleteElementFromLayout = ({ id, layout }) => {\n\tconst flattenedInputLayout = flattenLayout(layout.default.root);\n\n\tconst flattenedOutputLayout = deleteAndGetUpdatedLayout(\n\t\tflattenedInputLayout,\n\t\tid\n\t);\n\tconst treeLayout = treeifyLayout(flattenedOutputLayout);\n\tif (rootIsALeaf(treeLayout)) {\n\t\treturn null;\n\t}\n\treturn treeLayout;\n};\n\nexport const findLayoutElementIdFromSlotName = ({ slotName, layout }) => {\n\tconst flattenedInputLayout = flattenLayout(layout.default.root);\n\n\tfor (const key in flattenedInputLayout) {\n\t\tif (flattenedInputLayout[key].slotName === slotName) {\n\t\t\treturn key;\n\t\t}\n\t}\n};\n","import cuid from 'cuid';\nimport get from 'lodash/get';\n\nconst pageTypeLookup = {\n\tlanding(slot) {\n\t\treturn {\n\t\t\tdefault: {\n\t\t\t\ttype: 'rowColumn',\n\t\t\t\troot: {\n\t\t\t\t\ttype: 'row',\n\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'column',\n\t\t\t\t\t\t\tslotName: slot,\n\t\t\t\t\t\t\tsize: '12',\n\t\t\t\t\t\t\trows: [],\n\t\t\t\t\t\t\tid: cuid()\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tid: cuid()\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n\tslottedComponent(slot) {\n\t\treturn {\n\t\t\tdefault: {\n\t\t\t\ttype: 'flex',\n\t\t\t\troot: null,\n\t\t\t\tchildren: null,\n\t\t\t\tstyles: null,\n\t\t\t\trules: {\n\t\t\t\t\t'flex-direction': 'column'\n\t\t\t\t},\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tslotName: slot,\n\t\t\t\t\t\tstyles: {\n\t\t\t\t\t\t\t'flex-direction': 'row'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t},\n\tfallback(slot) {\n\t\treturn {\n\t\t\tdefault: {\n\t\t\t\ttype: 'flex',\n\t\t\t\troot: null,\n\t\t\t\tchildren: null,\n\t\t\t\tstyles: null,\n\t\t\t\trules: {\n\t\t\t\t\t'flex-direction': 'column'\n\t\t\t\t},\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tslotName: slot,\n\t\t\t\t\t\tstyles: {\n\t\t\t\t\t\t\t'flex-direction': 'column'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n};\n\nconst createDefaultLayout = (slot, pageType) => {\n\tconst fn = get(pageTypeLookup, pageType, pageTypeLookup.fallback);\n\treturn fn(slot);\n};\nconst DEFAULT_SLOT_NAME = 'default-slot';\nexport { DEFAULT_SLOT_NAME };\nexport default createDefaultLayout;\n","import getLayoutType from './utils/getLayoutType';\nimport {\n\tCOMPONENT_PLACED,\n\tCOMPONENT_PLACED_SUCCEEDED,\n\tELEMENT_DELETED,\n\tELEMENT_DETACHED,\n\tDETACHED_ELEMENT_RELOCATED,\n\tDETACHED_ELEMENT_RESTORED,\n\tELEMENT_IS_HIDDEN_TEST_VALUE_CHANGED,\n\tCOMPONENT_EDIT_REQUESTED\n} from './elementActions';\nimport { ELEMENT_COMPLETE_EVENT_MAPPING_CREATED } from '../elementEventMappings/elementEventMappingsActions';\nimport { throwError } from '../../utils';\nimport { getElementTree, getHiddenElements } from '../utils';\nimport { ELEMENT_INSTANCE_NAME, IS_HIDDEN } from './reservedPropertyIds';\nimport get from 'lodash/get';\n\nimport { findParentElement } from './utils/element';\nimport createElementArray from './utils/createElementArray';\n\nimport {\n\tcomponentPlaced,\n\telementDetached,\n\tdetachedElementRelocated,\n\tdetachedElementRestored,\n\telementDeleted\n} from './rowColumnHandlers';\nimport {\n\tcomponentPlaced as defaultComponentPlaced,\n\telementDetached as defaultElementDetached,\n\tdetachedElementRelocated as defaultDetachedElementRelocated,\n\tdetachedElementRestored as defaultDetachedElementRestored,\n\telementDeleted as defaultElementDeleted,\n\tcomponentCreatedInSlot,\n\tcomponentMovedToSlot\n} from './defaultLayoutElementHandlers';\n\nconst elementCreatedLookup = {\n\trowColumn: componentPlaced,\n\tfallback: defaultComponentPlaced\n};\n\nconst elementDetachedLookup = {\n\trowColumn: elementDetached,\n\tfallback: defaultElementDetached\n};\n\nconst elementRelocatedLookup = {\n\trowColumn: detachedElementRelocated,\n\tfallback: defaultDetachedElementRelocated\n};\n\nconst elementDeletedLookup = {\n\trowColumn: elementDeleted,\n\tfallback: defaultElementDeleted\n};\n\nconst elementRestoredLookup = {\n\trowColumn: detachedElementRestored,\n\tfallback: defaultDetachedElementRestored\n};\nconst createdInSlot = (coeffects) => {\n\treturn !!get(coeffects, 'action.payload.elementId', false);\n};\nconst elementCreatedHandler = (coeffects) => {\n\tconst {\n\t\tpageState: { rootElement }\n\t} = coeffects.properties;\n\n\tconst { parentId, isLegacy = false } = coeffects.action.payload;\n\tconst type = isLegacy\n\t\t? 'rowColumn'\n\t\t: getLayoutType(rootElement, parentId, 'default');\n\tconst actionFn = get(\n\t\telementCreatedLookup,\n\t\ttype,\n\t\telementCreatedLookup.fallback\n\t);\n\tif (createdInSlot(coeffects)) {\n\t\treturn componentCreatedInSlot(coeffects);\n\t}\n\n\tactionFn(coeffects);\n};\n\nconst elementDetachedHandler = (coeffects) => {\n\tconst {\n\t\tpageState: { rootElement }\n\t} = coeffects.properties;\n\tconst { elementId } = coeffects.action.payload;\n\tconst parentElement = findParentElement(rootElement, elementId);\n\n\tif (!parentElement) {\n\t\tthrowError('Cannot detach root element');\n\t}\n\n\tconst type = getLayoutType(rootElement, parentElement.id, 'default');\n\tconst actionFn = get(\n\t\telementDetachedLookup,\n\t\ttype,\n\t\telementDetachedLookup.fallback\n\t);\n\tactionFn(coeffects);\n};\n\nconst elementRelocatedHandler = (coeffects) => {\n\tconst {\n\t\tpageState: { rootElement }\n\t} = coeffects.properties;\n\tconst { parentId } = coeffects.action.payload;\n\tconst type = getLayoutType(rootElement, parentId, 'default');\n\n\tif (createdInSlot(coeffects)) {\n\t\treturn componentMovedToSlot(coeffects);\n\t}\n\tconst actionFn = get(\n\t\telementRelocatedLookup,\n\t\ttype,\n\t\telementRelocatedLookup.fallback\n\t);\n\tactionFn(coeffects);\n};\n\nconst elementRestoredHandler = (coeffects) => {\n\tconst { state, properties, updateState } = coeffects;\n\tconst {\n\t\tpageState: { rootElement }\n\t} = properties;\n\tconst {\n\t\tdetachedElementData: { detachedElements, previousLayout }\n\t} = state;\n\n\tif (!previousLayout || !detachedElements || detachedElements.length < 1) {\n\t\tupdateState({\n\t\t\tpath: 'detachedElementData',\n\t\t\toperation: 'set',\n\t\t\tvalue: null\n\t\t});\n\n\t\treturn;\n\t}\n\n\tconst parentElement = findParentElement(rootElement, detachedElements[0].id);\n\n\tconst type = getLayoutType(rootElement, parentElement.id, 'default');\n\tconst actionFn = get(\n\t\telementRestoredLookup,\n\t\ttype,\n\t\telementRestoredLookup.fallback\n\t);\n\tactionFn(coeffects);\n};\n\nconst elementDeleteConfirmedHandler = (coeffects) => {\n\tconst {\n\t\tpageState: { rootElement }\n\t} = coeffects.properties;\n\tconst { elementId, deletedElementId } = coeffects.action.payload;\n\tconst parentElement = findParentElement(\n\t\trootElement,\n\t\telementId || deletedElementId\n\t);\n\tconst type = getLayoutType(rootElement, parentElement.id, 'default');\n\tconst actionFn = get(\n\t\telementDeletedLookup,\n\t\ttype,\n\t\telementDeletedLookup.fallback\n\t);\n\tconst { action } = coeffects;\n\tactionFn({\n\t\t...coeffects,\n\t\taction: {\n\t\t\t...action,\n\t\t\tpayload: {\n\t\t\t\telementId: elementId || deletedElementId\n\t\t\t}\n\t\t}\n\t});\n};\n\nconst elementCreatedSucceededHandler = ({ state, action, dispatch }) => {\n\tconst { elementId, componentId } = action.payload;\n\tconst {\n\t\trawComponentList,\n\t\tproperties: { newElementDefaultEventHandlers }\n\t} = state;\n\tconst component = rawComponentList.find(\n\t\t(component) => component.id === componentId\n\t);\n\tconst defaultEventHandler =\n\t\tcomponent && newElementDefaultEventHandlers[component.tag];\n\n\tif (defaultEventHandler) {\n\t\tconst eventHandler = component.dispatchedEvents.find(({ eventName }) => {\n\t\t\treturn eventName === defaultEventHandler.eventName;\n\t\t});\n\n\t\tif (eventHandler) {\n\t\t\tdispatch(ELEMENT_COMPLETE_EVENT_MAPPING_CREATED, {\n\t\t\t\telementId,\n\t\t\t\teventId: eventHandler.id,\n\t\t\t\teventApiName: eventHandler.apiName,\n\t\t\t\teventMappingTarget: defaultEventHandler.eventMappingTarget\n\t\t\t});\n\t\t}\n\t}\n\tdispatch('UIB_APP#EMPTY_SLOT_OR_ELEMENT_SELECTED', {\n\t\ttype: 'element',\n\t\telementId,\n\t\tcomponent\n\t});\n};\n\nconst elementIsHiddenTestValueChanged = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tlet newHiddenElements;\n\tif (action.payload.value === 'true' || action.payload.value === 'false') {\n\t\tnewHiddenElements = {\n\t\t\t...properties.hiddenElements,\n\t\t\t[action.payload.elementId]: action.payload.value === 'true'\n\t\t};\n\t} else {\n\t\tconst elementArr = createElementArray(\n\t\t\tproperties.pageState.rootElement,\n\t\t\t(el) => ({\n\t\t\t\tid: el.id,\n\t\t\t\tisHidden: el.isHidden\n\t\t\t})\n\t\t);\n\t\tnewHiddenElements = getHiddenElements(\n\t\t\telementArr,\n\t\t\tproperties.clientScriptApi\n\t\t);\n\t}\n\n\tconst newElementTree = getElementTree(\n\t\tproperties.pageState.rootElement,\n\t\tnewHiddenElements\n\t);\n\n\tupdateProperties({\n\t\thiddenElements: newHiddenElements,\n\t\telementTree: newElementTree\n\t});\n};\n\nconst componentEditRequested = ({ action, properties }) => {\n\tconst { clientScriptApi, elementProperties } = properties;\n\tconst targetProperties = get(elementProperties, action.payload.elementId, []);\n\tconst propertiesToCache = targetProperties.reduce((acc, { id, value }) => {\n\t\tlet parsedValue = value;\n\t\ttry {\n\t\t\tif (typeof value === 'string') {\n\t\t\t\tconst checkValue = JSON.parse(value);\n\t\t\t\ttypeof checkValue === 'object' && (parsedValue = checkValue);\n\t\t\t}\n\t\t} catch (_) {\n\t\t\t// do nothing\n\t\t}\n\t\tif (id === ELEMENT_INSTANCE_NAME || id === IS_HIDDEN) {\n\t\t\treturn acc;\n\t\t}\n\n\t\tconst valueToUse =\n\t\t\ttypeof parsedValue === 'string' && value.startsWith('@')\n\t\t\t\t? get(clientScriptApi, value.slice(1), null)\n\t\t\t\t: parsedValue;\n\n\t\treturn {\n\t\t\t...acc,\n\t\t\t[id]: valueToUse\n\t\t};\n\t}, {});\n\n\ttry {\n\t\tsessionStorage.setItem('cbProps', JSON.stringify(propertiesToCache));\n\t} catch (_) {\n\t\t// do nothing\n\t}\n};\n\nexport default {\n\t[COMPONENT_PLACED]: elementCreatedHandler,\n\t[COMPONENT_PLACED_SUCCEEDED]: elementCreatedSucceededHandler,\n\t[ELEMENT_DELETED]: elementDeleteConfirmedHandler,\n\t[ELEMENT_DETACHED]: elementDetachedHandler,\n\t[DETACHED_ELEMENT_RELOCATED]: elementRelocatedHandler,\n\t[DETACHED_ELEMENT_RESTORED]: elementRestoredHandler,\n\t[ELEMENT_IS_HIDDEN_TEST_VALUE_CHANGED]: elementIsHiddenTestValueChanged,\n\t[COMPONENT_EDIT_REQUESTED]: componentEditRequested\n};\n","import { COMPONENT_PLACED_SUCCEEDED } from '../elementActions';\nimport cuid from 'cuid';\nimport cloneDeep from 'lodash/cloneDeep';\nimport get from 'lodash/get';\nimport createPageState from '../../../models/createPageState';\n\nimport {\n\tcreateElementFromComponent,\n\tfindElementById,\n\tgetRootElementFromState,\n\telementUsesSNLayout,\n\tgetAllElementIds\n} from '../utils/element';\n\nimport { placeElementOnLayout } from '../utils/api/layout';\n\nimport Slot from '../../../models/slot';\nimport { Element } from '../../../models';\nimport { getTemplates } from '@devsnc/library-uxf';\n\nconst componentPlaced = ({\n\taction,\n\tstate,\n\tproperties,\n\tupdateProperties,\n\tdispatch\n}) => {\n\tconst {\n\t\tcomponentId,\n\t\tparentId,\n\t\tslotName,\n\t\tadjacentLayoutElementId,\n\t\tdirection\n\t} = action.payload;\n\n\tconst {\n\t\trawComponentList,\n\t\tproperties: { pageState }\n\t} = state;\n\n\tconst newRootElement = cloneDeep(getRootElementFromState(state));\n\tconst parentElement = findElementById(newRootElement, parentId);\n\n\tconst droppedComponent = rawComponentList.find(\n\t\t(component) => component.id === componentId\n\t);\n\n\t// Load component scripts dynamically\n\t// This is async, but shouldn't matter if the scripts are loaded after\n\t// the component tags have been rendered in the html\n\tgetTemplates([droppedComponent.id]);\n\tconst pageType = get(properties, 'pageMetadata.type', 'screen');\n\n\tconst newElement = createElementFromComponent(\n\t\tdroppedComponent,\n\t\tparentElement,\n\t\tfalse,\n\t\tpageType\n\t);\n\n\tconst allElementIds = getAllElementIds(newRootElement);\n\tnewElement.initialize(allElementIds);\n\n\tif (slotName) {\n\t\tnewElement.slot = new Slot({\n\t\t\tname: slotName,\n\t\t\tparentElement: parentElement\n\t\t});\n\t} else if (elementUsesSNLayout(parentElement)) {\n\t\tconst slotToPlaceNewElementIn = cuid();\n\t\tparentElement.layout = placeElementOnLayout({\n\t\t\thasChildren: parentElement.children && parentElement.children.length > 0,\n\t\t\tslotName: slotToPlaceNewElementIn,\n\t\t\tlayout: parentElement.layout,\n\t\t\tadjacentId: adjacentLayoutElementId,\n\t\t\tdirection\n\t\t});\n\n\t\tnewElement.slot = new Slot({\n\t\t\tname: slotToPlaceNewElementIn,\n\t\t\tparentElement: parentElement\n\t\t});\n\t}\n\n\tparentElement.children.push(newElement);\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n\n\tdispatch(COMPONENT_PLACED_SUCCEEDED, {\n\t\telementId: newElement.id,\n\t\tcomponentId: droppedComponent.id\n\t});\n};\n\nexport { componentPlaced };\n","import cloneDeep from 'lodash/cloneDeep';\nimport cuid from 'cuid';\n\nimport createPageState from '../../../models/createPageState';\n\nimport {\n\tfindElementById,\n\tfindElements,\n\tfindParentElement,\n\tgetRootElementFromState,\n\tdeleteChildElement\n} from '../utils/element';\n\nimport { Element } from '../../../models';\n\nimport {\n\tRESTORE_ELEMENT_SUCCEEDED,\n\tRELOCATE_ELEMENT_SUCCEEDED,\n\tDETACH_ELEMENT_SUCCEEDED,\n\tDETACHED_ELEMENT_RESTORED\n} from '../elementActions';\n\nimport { flattenLayout, findLayoutElementById } from '../utils/layout';\n\nimport {\n\tdeleteElementFromLayout,\n\tplaceElementOnLayout\n} from '../utils/api/layout';\n\nconst elementDetached = ({\n\tstate,\n\taction,\n\tupdateProperties,\n\tupdateState,\n\tdispatch\n}) => {\n\tconst { elementId: detachedElementId } = action.payload;\n\tconst {\n\t\tproperties: { pageState }\n\t} = state;\n\n\tconst newRootElement = cloneDeep(getRootElementFromState(state));\n\n\tconst parentElement = findParentElement(newRootElement, detachedElementId);\n\n\tconst flattenedLayout = flattenLayout(parentElement.layout.default.root);\n\n\tconst detachedElement = findElementById(newRootElement, detachedElementId);\n\tconst detachedElements = findElements(\n\t\tparentElement,\n\t\t(elm) => elm.slot && elm.slot.name === detachedElement.slot.name\n\t);\n\n\tconst detachedLayoutNode = Object.values(flattenedLayout).find(\n\t\t(node) => node.slotName === detachedElement.slot.name\n\t);\n\n\tconst previousLayout = parentElement.layout;\n\tparentElement.layout = deleteElementFromLayout({\n\t\tlayout: previousLayout,\n\t\tid: detachedLayoutNode.id\n\t});\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n\n\tdispatch(DETACH_ELEMENT_SUCCEEDED, { elementId: detachedElementId });\n\tupdateState({\n\t\tpath: 'detachedElementData',\n\t\toperation: 'set',\n\t\tvalue: { previousLayout, detachedElements, detachedElementId }\n\t});\n};\n\nconst detachedElementRelocated = ({\n\tstate,\n\taction,\n\tupdateState,\n\tupdateProperties,\n\tdispatch\n}) => {\n\tconst {\n\t\tparentId,\n\t\tdirection,\n\t\tadjacentLayoutElementId,\n\t\tslotName\n\t} = action.payload;\n\n\tconst {\n\t\tdetachedElementData: { detachedElements, detachedElementId },\n\t\tproperties: { pageState }\n\t} = state;\n\n\tconst newRootElement = cloneDeep(getRootElementFromState(state));\n\tconst parentElement = findElementById(newRootElement, parentId);\n\n\tconst layoutElementExists = !!findLayoutElementById(\n\t\tdetachedElementId,\n\t\tparentElement.layout\n\t);\n\n\tif (layoutElementExists) {\n\t\treturn dispatch(DETACHED_ELEMENT_RESTORED);\n\t}\n\n\tlet detachedElementParent;\n\tdetachedElements.length &&\n\t\t(detachedElementParent = findParentElement(\n\t\t\tnewRootElement,\n\t\t\tdetachedElements[0].id\n\t\t));\n\n\tif (detachedElementParent && detachedElementParent.id !== parentElement.id) {\n\t\tdetachedElements.forEach((detachedElement) =>\n\t\t\tdeleteChildElement(detachedElementParent, detachedElement.id)\n\t\t);\n\t\tdetachedElements.forEach((detachedElement) =>\n\t\t\tparentElement.children.push(detachedElement)\n\t\t);\n\t}\n\n\tconst movedElement = detachedElements.find(\n\t\t(el) => el.id === detachedElementId\n\t);\n\tconst slotToPlaceElementIn = slotName || cuid();\n\n\tmovedElement.slot.name = slotToPlaceElementIn;\n\tconst newLayout = placeElementOnLayout({\n\t\thasChildren: parentElement.children && parentElement.children.length > 0,\n\t\tadjacentId: adjacentLayoutElementId,\n\t\tslotName: slotToPlaceElementIn,\n\t\tlayout: parentElement.layout,\n\t\tdirection\n\t});\n\tconst newElement = findElementById(newRootElement, detachedElementId);\n\n\tnewElement.slot.name = slotToPlaceElementIn;\n\tparentElement.layout = newLayout;\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n\tdispatch(RELOCATE_ELEMENT_SUCCEEDED, { elementId: detachedElementId });\n\n\tupdateState({\n\t\tpath: 'detachedElementData',\n\t\toperation: 'set',\n\t\tvalue: null\n\t});\n};\n\nconst detachedElementRestored = ({\n\tstate,\n\tupdateProperties,\n\tupdateState,\n\tdispatch\n}) => {\n\tconst {\n\t\tdetachedElementData: { detachedElements, previousLayout },\n\t\tproperties: { pageState }\n\t} = state;\n\n\tconst newRootElement = cloneDeep(getRootElementFromState(state));\n\n\tconst parentElement = findParentElement(\n\t\tnewRootElement,\n\t\tdetachedElements[0].id\n\t);\n\tparentElement.layout = previousLayout;\n\tdispatch(RESTORE_ELEMENT_SUCCEEDED, {\n\t\telementIds: detachedElements.map((el) => el.id)\n\t});\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n\n\tupdateState({\n\t\tpath: 'detachedElementData',\n\t\toperation: 'set',\n\t\tvalue: null\n\t});\n};\n\nexport { elementDetached, detachedElementRelocated, detachedElementRestored };\n","import cloneDeep from 'lodash/cloneDeep';\nimport createPageState from '../../../models/createPageState';\nimport createDefaultLayout, {\n\tDEFAULT_SLOT_NAME\n} from '../utils/createDefaultLayout';\n\nimport {\n\tfindElementById,\n\tgetRootElementFromState,\n\tfindParentElement,\n\tisOnlySlottedChild,\n\tdeleteChildElement,\n\telementUsesSNLayout\n} from '../utils/element';\n\nimport {\n\tfindLayoutElementIdFromSlotName,\n\tdeleteElementFromLayout\n} from '../utils/api/layout';\n\nimport { Element } from '../../../models';\n\nconst elementDeleted = ({ state, action, updateProperties }) => {\n\tconst {\n\t\tproperties: { pageState }\n\t} = state;\n\n\tconst newPageState = cloneDeep(pageState);\n\n\tconst { elementId: deletedElementId } = action.payload;\n\n\tconst newRootElement = cloneDeep(getRootElementFromState(state));\n\n\tconst onlySlottedChild = isOnlySlottedChild(deletedElementId, newRootElement);\n\n\tif (newRootElement.id === deletedElementId) {\n\t\t// Don't allow deleting the root element\n\t\treturn;\n\t}\n\n\tconst parentElement = findParentElement(newRootElement, deletedElementId);\n\n\tif (elementUsesSNLayout(parentElement)) {\n\t\tconst detachedElementSlotName = findElementById(\n\t\t\tnewRootElement,\n\t\t\tdeletedElementId\n\t\t).slot.name;\n\n\t\tconst layoutElementId = findLayoutElementIdFromSlotName({\n\t\t\tlayout: parentElement.layout,\n\t\t\tslotName: detachedElementSlotName\n\t\t});\n\n\t\tif (onlySlottedChild) {\n\t\t\tparentElement.layout = deleteElementFromLayout({\n\t\t\t\tlayout: parentElement.layout,\n\t\t\t\tid: layoutElementId\n\t\t\t});\n\t\t}\n\t}\n\n\tdeleteChildElement(parentElement, deletedElementId);\n\n\t// Prevent the root element layout from being null\n\tif (newRootElement.layout === null) {\n\t\tnewRootElement.layout = createDefaultLayout(DEFAULT_SLOT_NAME, 'landing');\n\t}\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tnewPageState\n\t\t)\n\t});\n};\n\nexport { elementDeleted };\n","import get from 'lodash/get';\n\nconst isLayoutEmpty = (layout) => {\n\tconst items = get(layout, 'default.items', []);\n\treturn items.length === 0;\n};\n\nexport default isLayoutEmpty;\n","import get from 'lodash/get';\nimport flow from 'lodash/flow';\nimport zip from 'lodash/zip';\nimport groupBy from 'lodash/groupBy';\nimport last from 'lodash/last';\n\nconst getAssignedComponents = (element) => {\n\tconst { children = [] } = element;\n\treturn children.reduce(\n\t\t(acc, current) => {\n\t\t\tconst hasSlotName = !!get(current, 'slot.name', null);\n\t\t\tif (hasSlotName) {\n\t\t\t\tacc.orphanedComponents.push(current);\n\t\t\t} else {\n\t\t\t\tacc.nullSlottedChildren.push(current);\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t},\n\t\t{ orphanedComponents: [], nullSlottedChildren: [] }\n\t);\n};\nconst PROCESSING = 'PROCESSING';\nconst DONE = 'DONE';\nconst ERROR = 'ERROR';\n\nconst gatherOrphanedComponents = ({ status, data }) => {\n\tif (status !== PROCESSING) {\n\t\treturn { status, data };\n\t}\n\tconst { ownerElement, newLayout, currentLayout } = data;\n\tconst { orphanedComponents, nullSlottedChildren } = getAssignedComponents(\n\t\townerElement\n\t);\n\tif (orphanedComponents.length === 0) {\n\t\treturn {\n\t\t\tstatus: DONE,\n\t\t\tdata: { newLayout, ownerElement, children: nullSlottedChildren }\n\t\t};\n\t}\n\treturn {\n\t\tstatus,\n\t\tdata: {\n\t\t\tcurrentLayout,\n\t\t\tnewLayout,\n\t\t\torphanedComponents,\n\t\t\townerElement,\n\t\t\tchildren: nullSlottedChildren\n\t\t}\n\t};\n};\n\nconst matchSlotNames = ({ status, data }) => {\n\tif (status !== PROCESSING) {\n\t\treturn { status, data };\n\t}\n\tconst { newLayout, orphanedComponents, children } = data;\n\n\tconst { items = [] } = newLayout.default;\n\tconst results = orphanedComponents.reduce(\n\t\t({ matched, remaining }, element) => {\n\t\t\tconst { name } = element.slot;\n\t\t\tif (\n\t\t\t\titems.find((item) => {\n\t\t\t\t\tconst { slotName } = item;\n\t\t\t\t\treturn name === slotName;\n\t\t\t\t})\n\t\t\t) {\n\t\t\t\tmatched.push(element);\n\n\t\t\t\treturn {\n\t\t\t\t\tmatched,\n\t\t\t\t\tremaining\n\t\t\t\t};\n\t\t\t}\n\t\t\tremaining.push(element);\n\n\t\t\treturn {\n\t\t\t\tmatched,\n\t\t\t\tremaining\n\t\t\t};\n\t\t},\n\t\t{ matched: [], remaining: [] }\n\t);\n\n\tif (results.remaining.length === 0) {\n\t\treturn {\n\t\t\tstatus: DONE,\n\t\t\tdata: {\n\t\t\t\t...data,\n\t\t\t\tchildren: [...children, ...results.matched],\n\t\t\t\torphanedComponents: []\n\t\t\t}\n\t\t};\n\t}\n\treturn {\n\t\tstatus,\n\t\tdata: {\n\t\t\t...data,\n\t\t\tchildren: [...children, ...results.matched],\n\t\t\torphanedComponents: results.remaining\n\t\t}\n\t};\n};\nconst matchComponentsToSlots = (elements, slots) => {\n\tconst matchedResults = zip(\n\t\tObject.values(groupBy(elements, 'slot.name')),\n\t\tslots\n\t).reduce(\n\t\t(acc, curr) => {\n\t\t\tconst { matched, unmatched } = acc;\n\t\t\tconst [elements, slot] = curr;\n\t\t\tif (!elements || elements.length === 0) {\n\t\t\t\treturn acc;\n\t\t\t}\n\t\t\tif (!slot) {\n\t\t\t\treturn {\n\t\t\t\t\tmatched,\n\t\t\t\t\tunmatched: [...unmatched, ...elements]\n\t\t\t\t};\n\t\t\t}\n\t\t\tconst newElements = elements.map((element) => {\n\t\t\t\treturn {\n\t\t\t\t\t...element,\n\t\t\t\t\tslot: {\n\t\t\t\t\t\tname: slot.slotName\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t});\n\t\t\treturn {\n\t\t\t\tmatched: [...matched, ...newElements],\n\t\t\t\tunmatched\n\t\t\t};\n\t\t},\n\t\t{\n\t\t\tmatched: [],\n\t\t\tunmatched: []\n\t\t}\n\t);\n\n\tconst matchedComponents = [\n\t\t...matchedResults.matched,\n\t\t...matchedResults.unmatched.map((comp) => {\n\t\t\tconst lastItem = last(slots);\n\t\t\tconst name = lastItem ? lastItem.slotName : comp.slot.name;\n\t\t\treturn {\n\t\t\t\t...comp,\n\t\t\t\tslot: {\n\t\t\t\t\tname\n\t\t\t\t}\n\t\t\t};\n\t\t})\n\t];\n\treturn matchedComponents;\n};\n\nconst placeRemainingElements = ({ status, data }) => {\n\tif (status !== PROCESSING) {\n\t\treturn { status, data };\n\t}\n\tconst { newLayout, orphanedComponents, children, currentLayout } = data;\n\n\tconst newItems = newLayout.default.items || [];\n\n\tconst oldItems = get(currentLayout, 'default.items', []) || [];\n\n\tconst matchedComponents = matchComponentsToSlots(orphanedComponents, [\n\t\t...newItems.filter(({ slotName }) => {\n\t\t\treturn !oldItems.find(({ slotName: name }) => name === slotName);\n\t\t}),\n\t\t...newItems.filter(({ slotName }) => {\n\t\t\treturn oldItems.find(({ slotName: name }) => name === slotName);\n\t\t})\n\t]);\n\n\tconst remaningOrphans = orphanedComponents.filter(({ slot: orphanSlot }) => {\n\t\treturn matchedComponents.find(({ slot }) => {\n\t\t\tslot.name === orphanSlot.name;\n\t\t});\n\t});\n\tconst combinedChildren = [...children, ...matchedComponents];\n\n\tconst newStatus = remaningOrphans.length > 0 ? ERROR : DONE;\n\n\treturn {\n\t\tstatus: newStatus,\n\t\tdata: {\n\t\t\t...data,\n\t\t\torphanedComponents: remaningOrphans,\n\t\t\tchildren: combinedChildren\n\t\t}\n\t};\n};\n\nconst unwrapData = (path) => ({ data }) => {\n\treturn data[path];\n};\n\nconst reparentElements = flow(\n\tgatherOrphanedComponents,\n\tmatchSlotNames,\n\tplaceRemainingElements,\n\tunwrapData('children')\n);\n\nconst reparentElementsToNewLayout = (ownerElement, newLayout) => {\n\tconst children = reparentElements({\n\t\tstatus: PROCESSING,\n\t\tdata: { currentLayout: ownerElement.layout, newLayout, ownerElement }\n\t});\n\treturn children;\n};\nexport { matchComponentsToSlots };\nexport default reparentElementsToNewLayout;\n","import {\n\tELEMENT_LAYOUT_CHANGED,\n\tSLOT_STYLES_CHANGED,\n\tSLOT_STYLES_PATCHED,\n\tUPDATE_LAYOUT_SUCCEEDED\n} from './elementActions';\nimport { Element } from '../../models';\nimport createElementArray from './utils/createElementArray';\nimport isLayoutEmpty from './utils/isLayoutEmpty';\nimport reparentElementsToNewLayout from './utils/reparentElementsToNewLayout';\nimport createPageState from '../../models/createPageState';\nimport cloneDeep from 'lodash/cloneDeep';\nimport get from 'lodash/get';\nimport { throwError, normalizeRowColumnSlots } from '../../utils';\n\nconst addTemplateIdToLayout = (layout, templateId) => {\n\tif (layout.default) {\n\t\tlayout.default.templateId = templateId;\n\t}\n\treturn layout;\n};\n\nconst elementLayoutChanged = ({\n\taction,\n\tproperties,\n\tupdateProperties,\n\tdispatch,\n\tgetDefaultLayout\n}) => {\n\tconst { pageState, templatesDefinitions } = properties;\n\tconst { elementId, layoutTemplateId, layout } = action.payload;\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst elements = createElementArray(newRootElement, (element) => element);\n\tconst updateElement = elements.find(({ id }) => id === elementId);\n\n\tlet newLayout;\n\tif (layoutTemplateId) {\n\t\tconst layoutTemplate = templatesDefinitions.find(\n\t\t\t(template) => layoutTemplateId === template.id\n\t\t);\n\t\tconst rootMacroponentId = get(\n\t\t\tlayoutTemplate,\n\t\t\t'macroponentInstance.rootMacroponentId'\n\t\t);\n\t\tnewLayout = get(\n\t\t\tlayoutTemplate,\n\t\t\t`macroponentInstance.macroponentDefinitions.${rootMacroponentId}.layout`,\n\t\t\t{}\n\t\t);\n\t\taddTemplateIdToLayout(newLayout, layoutTemplateId);\n\t} else {\n\t\ttry {\n\t\t\tnewLayout = JSON.parse(layout);\n\t\t} catch (er) {\n\t\t\tthrowError('invalid layout JSON');\n\t\t}\n\t}\n\n\tconst normalizedLayout = normalizeRowColumnSlots(newLayout);\n\tnewLayout = isLayoutEmpty(normalizedLayout)\n\t\t? getDefaultLayout('slotted-component')\n\t\t: normalizedLayout;\n\n\tconst reparentedComponents = reparentElementsToNewLayout(\n\t\tupdateElement,\n\t\tnewLayout\n\t);\n\n\tupdateElement.children = reparentedComponents;\n\tupdateElement.layout = newLayout;\n\n\tif (reparentedComponents.length > 0) {\n\t\tdispatch(UPDATE_LAYOUT_SUCCEEDED, {\n\t\t\tcomponents: reparentedComponents\n\t\t});\n\t}\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nconst slotStylesPatched = ({ action, properties, updateProperties }) => {\n\tconst { elementId, selectedSlotName, styles } = action.payload;\n\tconst { pageState } = properties;\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst elements = createElementArray(newRootElement, (element) => element);\n\tconst updateElement = elements.find(({ id }) => id === elementId);\n\tconst updateSlot = get(updateElement, 'layout.default.items', []).find(\n\t\t(item) => item.slotName === selectedSlotName\n\t);\n\tupdateSlot.styles = {\n\t\t...updateSlot.styles,\n\t\t...styles\n\t};\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nconst slotStylesChanged = ({ action, properties, updateProperties }) => {\n\tconst { elementId, selectedSlotName, styles } = action.payload;\n\tconst { pageState } = properties;\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst elements = createElementArray(newRootElement, (element) => element);\n\tconst updateElement = elements.find(({ id }) => id === elementId);\n\tconst updateSlot = get(updateElement, 'layout.default.items', []).find(\n\t\t(item) => item.slotName === selectedSlotName\n\t);\n\n\tupdateSlot.styles = styles;\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\nexport default {\n\t[ELEMENT_LAYOUT_CHANGED]: elementLayoutChanged,\n\t[SLOT_STYLES_CHANGED]: slotStylesChanged,\n\t[SLOT_STYLES_PATCHED]: slotStylesPatched\n};\n","import { ELEMENT_STYLES_UPDATED } from './elementActions';\nimport { Element } from '../../models';\nimport { findElementById } from './utils/element';\nimport createPageState from '../../models/createPageState';\nimport cloneDeep from 'lodash/cloneDeep';\n\nconst elementStylesUpdated = ({ action, properties, updateProperties }) => {\n\tconst { pageState } = properties;\n\tconst { elementId, styles } = action.payload;\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst element = findElementById(newRootElement, elementId);\n\telement.styles = styles;\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nexport default {\n\t[ELEMENT_STYLES_UPDATED]: elementStylesUpdated\n};\n","import cloneDeep from 'lodash/cloneDeep';\nimport { ELEMENT_RESIZED } from './elementActions';\nimport createPageState from '../../models/createPageState';\nimport { Element } from '../../models';\n\nimport { findElementById } from './utils/element';\nimport { getResizedRow, getClosestNeighbor } from './utils/layout';\n\nconst resizeLookup = (type = '') => {\n\tswitch (type) {\n\t\tcase 'SHRINK':\n\t\t\treturn -1;\n\t\tcase 'EXPAND':\n\t\t\treturn 1;\n\t\tdefault:\n\t\t\treturn 0;\n\t}\n};\n\nconst elementResized = ({ action, state, updateProperties }) => {\n\tconst {\n\t\tproperties: { pageState }\n\t} = state;\n\n\tconst { id, side, direction: directionString, elementId } = action.payload;\n\tconst direction = directionString.toUpperCase();\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst ownerElement = findElementById(newRootElement, elementId);\n\tconst layout = ownerElement.layout;\n\tconst row = getResizedRow(layout, { label: 'id', value: id });\n\n\tif (!row || row.length <= 1) {\n\t\treturn;\n\t}\n\n\tconst targetIdx = row.findIndex((part) => part.id === id);\n\tconst target = row[targetIdx];\n\tconst neighbor = getClosestNeighbor(row, targetIdx, side, direction);\n\tconst neighborIndex = row.indexOf(neighbor);\n\n\tif (target.size <= 1 && direction === 'SHRINK') {\n\t\treturn;\n\t}\n\n\tif (!neighbor) {\n\t\treturn;\n\t}\n\n\trow[targetIdx] = {\n\t\t...target,\n\t\tsize: parseInt(target.size, 10) + resizeLookup(direction)\n\t};\n\n\trow[neighborIndex] = {\n\t\t...neighbor,\n\t\tsize: parseInt(neighbor.size, 10) - resizeLookup(direction)\n\t};\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nexport { elementResized };\nexport default {\n\t[ELEMENT_RESIZED]: elementResized\n};\n","import { ELEMENT_PROPERTY_UPDATED } from './elementActions';\nimport { Element } from '../../models';\nimport { ELEMENT_INSTANCE_NAME, IS_HIDDEN } from './reservedPropertyIds';\nimport createElementArray from './utils/createElementArray';\nimport createPageState from '../../models/createPageState';\n\nimport cloneDeep from 'lodash/cloneDeep';\n\nimport isCircular from './utils/isCircular';\n\nexport const elementPropertyUpdatedHandler = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState, elementProperties } = properties;\n\n\tconst {\n\t\telementId,\n\t\tpropertyId: payloadPropertyId,\n\t\tvalue: payloadValue,\n\t\tproperties: payloadProperties\n\t} = action.payload;\n\n\tconst propertiesToUpdate =\n\t\tpayloadProperties && payloadProperties.length\n\t\t\t? payloadProperties\n\t\t\t: [\n\t\t\t\t\t{\n\t\t\t\t\t\tpropertyId: payloadPropertyId,\n\t\t\t\t\t\tvalue: payloadValue\n\t\t\t\t\t}\n\t\t\t  ];\n\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst elements = createElementArray(newRootElement, (element) => element);\n\tconst updateElement = elements.find((el) => el.id === elementId);\n\n\tpropertiesToUpdate.forEach(({ propertyId, value }) => {\n\t\tconst updateProp =\n\t\t\telementProperties[elementId].find((prop) => prop.id === propertyId) || {};\n\n\t\tif (updateProp.onChange) {\n\t\t\tupdateProp.onChange(updateElement);\n\t\t}\n\n\t\tif (propertyId === ELEMENT_INSTANCE_NAME) {\n\t\t\tupdateElement.instanceName = value;\n\t\t} else if (propertyId === IS_HIDDEN) {\n\t\t\tupdateElement.isHidden = value;\n\t\t} else if (!updateElement.properties[propertyId].readOnly) {\n\t\t\tconst checkElement = cloneDeep(updateElement);\n\t\t\tcheckElement.properties[propertyId].value = value;\n\t\t\tconst circularRefElements = isCircular(checkElement, elements);\n\t\t\tif (circularRefElements) {\n\t\t\t\tupdateElement.properties[propertyId].error = {\n\t\t\t\t\ttype: 'circular',\n\t\t\t\t\telements: circularRefElements\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tupdateElement.properties[propertyId].value = value;\n\t\t\t\tupdateElement.properties[propertyId].error = null;\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(\n\t\t\t\t`UXF Builder Middleware Error: Cannot update read-only property ${updateElement.properties[propertyId].columnName} of element ${elementId}`\n\t\t\t);\n\t\t}\n\t});\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nexport default {\n\t[ELEMENT_PROPERTY_UPDATED]: elementPropertyUpdatedHandler\n};\n","import { matchBindingSyntax } from '../../../utils';\n\nexport default function isCircular(\n\tsourceElement,\n\tallElements,\n\tcurrentElement,\n\titerCount = 0\n) {\n\tlet currentDepth = iterCount;\n\tconst currEl = currentElement || sourceElement;\n\tconst boundElementIds = Object.values(currEl.properties).reduce(\n\t\t(acc, { value }) => {\n\t\t\tconst matcher = matchBindingSyntax(value);\n\t\t\tif (matcher && matcher.namespace === '@elements') {\n\t\t\t\treturn [...acc, matcher.id];\n\t\t\t}\n\t\t\treturn acc;\n\t\t},\n\t\t[]\n\t);\n\t// Safety for call stack overflow\n\tif (iterCount > 100) {\n\t\treturn false;\n\t}\n\tif (boundElementIds.length === 0) {\n\t\treturn false;\n\t}\n\tif (boundElementIds.some((boundElId) => boundElId === sourceElement.id)) {\n\t\treturn [\n\t\t\tsourceElement.instanceName || sourceElement.id,\n\t\t\tcurrEl.instanceName || currEl.id\n\t\t];\n\t}\n\treturn boundElementIds.reduce((isCir, boundElId) => {\n\t\tconst nextEl = allElements.find((el) => el.id === boundElId);\n\t\tif (isCir) {\n\t\t\treturn [\n\t\t\t\tsourceElement.instanceName || sourceElement.id,\n\t\t\t\tcurrEl.instanceName || currEl.id\n\t\t\t];\n\t\t}\n\t\tif (!nextEl) {\n\t\t\treturn false;\n\t\t}\n\t\treturn isCircular(sourceElement, allElements, nextEl, ++currentDepth);\n\t}, false);\n}\n","import {\n\tELEMENT_METADATA_UPDATE_REQUESTED,\n\tELEMENT_ID_CHANGED,\n\tVIEWPORT_NAME_CHANGED\n} from './elementActions';\nimport { Element } from '../../models';\nimport createElementArray from './utils/createElementArray';\nimport createPageState from '../../models/createPageState';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { ELEMENT_NAMESPACE } from '../../constants';\nimport {\n\tremoveEventReferencesToPreviousId,\n\tremovePropertyReferencesToPreviousId\n} from '../page/utils/shared';\n\nconst elementMetadataUpdatedHandler = ({\n\taction,\n\tproperties,\n\tupdateProperties,\n\tdispatch\n}) => {\n\tconst { pageState = {} } = properties;\n\tconst { previousId, changes = {} } = action.payload;\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst elements = createElementArray(newRootElement, (element) => element);\n\tconst updateElement = elements.find((el) => el.id === previousId) || {};\n\n\tif (changes.instanceName) {\n\t\tupdateElement.instanceName = changes.instanceName;\n\n\t\tif (\n\t\t\tupdateElement.component &&\n\t\t\tupdateElement.component.category === 'viewport'\n\t\t) {\n\t\t\tdispatch(VIEWPORT_NAME_CHANGED, {\n\t\t\t\tid: previousId,\n\t\t\t\tvalue: changes.instanceName\n\t\t\t});\n\t\t}\n\t}\n\n\tif (changes.id) {\n\t\tupdateElement.id = changes.id;\n\t\tremovePropertyReferencesToPreviousId(\n\t\t\tpreviousId,\n\t\t\tchanges.id,\n\t\t\telements,\n\t\t\t[], // elements can't be referenced in data broker properties\n\t\t\t[], // elements can't be referenced in client state parameters\n\t\t\tELEMENT_NAMESPACE\n\t\t);\n\t\tremoveEventReferencesToPreviousId(\n\t\t\tpreviousId,\n\t\t\tchanges.id,\n\t\t\telements,\n\t\t\t[], // event handlers can't reference element IDs\n\t\t\t[], // data broker event mappings can't reference element IDs\n\t\t\t[], // internal event mappings can't reference element IDs\n\t\t\tELEMENT_NAMESPACE\n\t\t);\n\t\tdispatch(ELEMENT_ID_CHANGED, { id: changes.id });\n\t}\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\trootElement: new Element(newRootElement)\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nexport default {\n\t[ELEMENT_METADATA_UPDATE_REQUESTED]: elementMetadataUpdatedHandler\n};\n","export const PAGE_LIST_REQUESTED = 'SN_UXF#PAGE_LIST_REQUESTED';\nexport const PAGE_LIST_HTTP_REQUESTED = 'SN_UXF#PAGE_LIST_HTTP_REQUESTED';\nexport const PAGE_LIST_REQUEST_STARTED = 'SN_UXF#PAGE_LIST_REQUEST_STARTED';\nexport const PAGE_LIST_REQUEST_FAILED = 'SN_UXF#PAGE_LIST_REQUEST_FAILED';\nexport const PAGE_LIST_REQUEST_SUCCEEDED = 'SN_UXF#PAGE_LIST_REQUEST_SUCCEEDED';\n","import { PAGE_STATUS_ACTIVE, PAGE_STATUS_INACTIVE } from '../constants';\n\nexport function getPageStatus(isActive) {\n\treturn isActive ? PAGE_STATUS_ACTIVE : PAGE_STATUS_INACTIVE;\n}\n\nexport function getIsActive(pageStatus) {\n\treturn pageStatus === PAGE_STATUS_ACTIVE;\n}\n","import get from 'lodash/get';\nimport isNil from 'lodash/isNil';\nimport unionBy from 'lodash/unionBy';\nimport groupBy from 'lodash/groupBy';\nimport isEmpty from 'lodash/isEmpty';\nimport { t } from 'sn-translate';\nimport {\n\tComponent,\n\tElement,\n\tElementEvent,\n\tMacroponentProperty,\n\tPageStateModel,\n\tProperty,\n\tSlot,\n\tClientStateParameter\n} from '../../../models';\nimport { getProperty } from '../../componentList/utils';\nimport { addAllEventHandlers, createDataBrokerInstances } from '../../utils';\nimport { getPageStatus } from './pageStatus';\nimport {\n\tcoercePropertyValueToShorthand,\n\tgenerateEventMappings\n} from './shared';\nimport { seismicCuid } from '../../../utils';\nimport {\n\tPARENT_COMPOSITION_ELEMENT_ID,\n\tDEFAULT_ROUTE\n} from '../../element/reservedPropertyIds';\nimport {\n\tinitializeViewportElementProperties,\n\tisViewportComponent,\n\tinitializeDataDrivenViewportProperties\n} from '../../viewportHandlers/utils';\nimport { isUxValueModel, getShorthandFromUxValue } from '../../../factories';\nimport { ELEMENT_TYPES } from '../../../constants';\nimport { ROOT_MACROPONENT_SOURCE_EVENTS } from '../constants';\n\nconst SHARED_PAGE_DEFINITION_SYS_ID = 'a094b3d2773210106e224a2a69106123';\nimport { TRANSLATION_LITERAL } from '../../../factories/constants';\n\nconst getComponent = (id, macroponentDefinitions, componentDefinitions) => {\n\tconst {\n\t\tname: macroponentName,\n\t\ttoolboxIcon: icon,\n\t\ttoolboxLabel,\n\t\tproperties,\n\t\tdispatchedEvents = [],\n\t\trootElement = {},\n\t\tcomposition = [],\n\t\trootElementDefinition,\n\t\tcategory,\n\t\texplodable = false,\n\t\tisEditable = false\n\t} = macroponentDefinitions[id];\n\n\tconst availableSlots = rootElementDefinition\n\t\t? rootElementDefinition.availableSlots\n\t\t: [];\n\n\t// If a composition element is a \"Facade macroponent\", meaning that it has a Seismic component\n\t// as a root element and no composition, then we can use the tag of its root element.\n\t// Otherwise, we should use the web component generated by the macroponent factory.\n\t// This way, we can easily render a complex macroponent as a composition element.\n\tconst tag =\n\t\trootElement.definition.id && composition.length === 0\n\t\t\t? componentDefinitions[rootElement.definition.id]\n\t\t\t: `macroponent-${id}`;\n\n\tif (tag === 'now-uxf-page') {\n\t\tavailableSlots.push('@default');\n\t}\n\n\tconst actionInstances = []; // TODO: Get real actions at some point.\n\tconst propertyInstances = properties.map((property) => {\n\t\treturn getProperty(property);\n\t});\n\tconst eventInstances = dispatchedEvents.map((ev) => new ElementEvent(ev));\n\n\treturn new Component({\n\t\tid,\n\t\tname: toolboxLabel || macroponentName,\n\t\ticon,\n\t\ttag,\n\t\tcategory,\n\t\tactions: actionInstances,\n\t\tslots: availableSlots,\n\t\tproperties: propertyInstances,\n\t\tdispatchedEvents: eventInstances,\n\t\texplodable,\n\t\tisEditable\n\t});\n};\n\nconst getIsHiddenValue = (isHiddenValue) => {\n\tif (!isUxValueModel(isHiddenValue)) {\n\t\treturn isHiddenValue;\n\t}\n\treturn getShorthandFromUxValue(isHiddenValue);\n};\n\nfunction createElementPropertiesFromComponent(\n\telementId,\n\tcomponent,\n\tpropertyValues,\n\tviewportConfigurations,\n\tstate,\n\tvariantId\n) {\n\tconst componentDerivedProperties = component.properties.reduce(\n\t\t(acc, propertyConfig) => {\n\t\t\tacc[propertyConfig.columnName] = new Property(propertyConfig);\n\t\t\tif (propertyValues.hasOwnProperty(propertyConfig.columnName)) {\n\t\t\t\tacc[propertyConfig.columnName].value = coercePropertyValueToShorthand(\n\t\t\t\t\tpropertyValues[propertyConfig.columnName],\n\t\t\t\t\tpropertyConfig.type\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n\n\tconst elementProperties = Object.keys(propertyValues).reduce(\n\t\t(acc, propertyName) => {\n\t\t\tconst incomingValue = propertyValues[propertyName];\n\t\t\tlet type = 'string';\n\t\t\tlet finalValue = incomingValue;\n\t\t\tlet translatable = false;\n\t\t\tif (isUxValueModel(incomingValue)) {\n\t\t\t\tconst tempValue = getShorthandFromUxValue(incomingValue);\n\t\t\t\ttype = typeof tempValue === 'object' ? 'json' : type;\n\t\t\t\tfinalValue = coercePropertyValueToShorthand(incomingValue, type);\n\t\t\t\ttranslatable = incomingValue.type === TRANSLATION_LITERAL;\n\t\t\t}\n\t\t\tacc[propertyName] = new Property({\n\t\t\t\tvalue: finalValue,\n\t\t\t\ttype,\n\t\t\t\tlabel: propertyName,\n\t\t\t\ttranslatable\n\t\t\t});\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n\n\tlet viewportComponentProperties = {};\n\tif (isViewportComponent(component)) {\n\t\tconst viewportRoutes = viewportConfigurations[elementId];\n\t\tconst currentDefaultRoute = get(\n\t\t\tcomponentDerivedProperties,\n\t\t\t'defaultRoute.value',\n\t\t\t''\n\t\t);\n\t\tif (viewportRoutes) {\n\t\t\tviewportComponentProperties = initializeViewportElementProperties(\n\t\t\t\telementId,\n\t\t\t\tviewportRoutes,\n\t\t\t\tcurrentDefaultRoute,\n\t\t\t\tstate,\n\t\t\t\tvariantId,\n\t\t\t\tget(elementProperties, 'dynamicTabData.value', '')\n\t\t\t);\n\t\t} else {\n\t\t\t// If you have already saved data source in the composition and if there are no viewport routes,\n\t\t\t// we have to initialize/add the properties dynamicTabData and repeatedTabData\n\t\t\t// so the viewport component can be initialized and rendered properly\n\t\t\t// based on the data source which is in the composition.\n\t\t\t// Todo: remove this whenever the viewport behavior has the dynamicTabData property\n\t\t\tviewportComponentProperties = initializeDataDrivenViewportProperties(\n\t\t\t\tget(elementProperties, 'dynamicTabData.value', ''),\n\t\t\t\tstate\n\t\t\t);\n\n\t\t\t// if there are no viewport routes, we need to reset the default route.\n\t\t\t// a user could go into the platform or the isolation mode and delete all routes\n\t\t\t// associated with a viewport component. We dont need to retain the\n\t\t\t// old defaultRoute in that case.\n\t\t\tif (currentDefaultRoute) {\n\t\t\t\tviewportComponentProperties[DEFAULT_ROUTE] = new Property({\n\t\t\t\t\tname: DEFAULT_ROUTE,\n\t\t\t\t\tcolumnName: DEFAULT_ROUTE,\n\t\t\t\t\tlabel: t('Default Route'),\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tvalue: ''\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\t...elementProperties,\n\t\t...componentDerivedProperties,\n\t\t...viewportComponentProperties\n\t};\n}\n\nconst createElementFromCompositionNode = (\n\tcompositionNode,\n\tcomponentDefinitions,\n\tmacroponentDefinitions,\n\teventHandlers,\n\tisParentModal = false,\n\tviewportConfigurations,\n\tstate,\n\tvariantId,\n\tscreenEventMappings,\n\tparentElement\n) => {\n\tconst {\n\t\telementId,\n\t\telementLabel = '',\n\t\tdefinition: { id, type },\n\t\tslot,\n\t\tpropertyValues = {},\n\t\tisHidden,\n\t\teventMappings = [],\n\t\tstyles = {},\n\t\toverrides\n\t} = compositionNode;\n\n\tif (!macroponentDefinitions[id]) {\n\t\t// The element is missing so return the bare minimum of an Element with an error\n\t\treturn new Element({\n\t\t\tid: elementId,\n\t\t\tinstanceName: elementLabel,\n\t\t\tslot: new Slot({\n\t\t\t\tname: slot,\n\t\t\t\tparentElement\n\t\t\t}),\n\t\t\tcomponent: new Component({\n\t\t\t\ttag: 'now-uxf-error-element'\n\t\t\t}),\n\t\t\terror: new Error(`UXF Error: Component ${id} not found.`)\n\t\t});\n\t}\n\n\tconst component =\n\t\ttype === 'MACROPONENT' || type === 'MACROPONENT_VIEWPORT'\n\t\t\t? getComponent(id, macroponentDefinitions, componentDefinitions)\n\t\t\t: {\n\t\t\t\t\tid,\n\t\t\t\t\tname: componentDefinitions[id],\n\t\t\t\t\ttag: componentDefinitions[id],\n\t\t\t\t\ttype: 'SEISMIC_COMPONENT',\n\t\t\t\t\tproperties: []\n\t\t\t  };\n\n\tconst properties = createElementPropertiesFromComponent(\n\t\telementId,\n\t\tcomponent,\n\t\tpropertyValues,\n\t\tviewportConfigurations,\n\t\tstate,\n\t\tvariantId\n\t);\n\n\tconst EventMappings = generateEventMappings(\n\t\teventMappings,\n\t\teventHandlers,\n\t\tcomponent.dispatchedEvents || [],\n\t\tscreenEventMappings\n\t);\n\n\tconst internalEventMappings =\n\t\tmacroponentDefinitions[id].internalEventMappings;\n\n\tconst isModal =\n\t\tget(macroponentDefinitions, `${component.id}.category`, null) ===\n\t\tELEMENT_TYPES.MODAL;\n\n\tconst isHiddenValue = getIsHiddenValue(isHidden);\n\n\tconst element = new Element({\n\t\tid: elementId,\n\t\tinstanceName: elementLabel,\n\t\tslot: new Slot({\n\t\t\tname: slot,\n\t\t\tparentElement\n\t\t}),\n\t\tchildren: [],\n\t\tcomponent,\n\t\tproperties,\n\t\teventMappings: EventMappings,\n\t\tlayout: {},\n\t\tstyles,\n\t\tisModal,\n\t\tisModalDescendant: isParentModal,\n\t\tinternalEventMappings,\n\t\tisHidden: isHiddenValue || ''\n\t});\n\n\tif (overrides) {\n\t\tconst { layout = {}, composition = [] } = overrides;\n\n\t\telement.layout = layout;\n\t\telement.children = composition.map((node) =>\n\t\t\tcreateElementFromCompositionNode(\n\t\t\t\tnode,\n\t\t\t\tcomponentDefinitions,\n\t\t\t\tmacroponentDefinitions,\n\t\t\t\teventHandlers,\n\t\t\t\tisModal,\n\t\t\t\tviewportConfigurations,\n\t\t\t\tstate,\n\t\t\t\tnull,\n\t\t\t\tscreenEventMappings,\n\t\t\t\telement\n\t\t\t)\n\t\t);\n\t}\n\n\treturn element;\n};\n\nconst getMergedPropertiesFromHierarchy = (\n\tmacroponent,\n\tmacroponentDefinitions = {}\n) => {\n\tlet next = macroponent;\n\tconst hierarchyItems = [];\n\twhile (!isNil(next)) {\n\t\thierarchyItems.push(\n\t\t\tget(next, 'properties', []).map((prop) => ({\n\t\t\t\t...prop,\n\t\t\t\tinherited: next !== macroponent\n\t\t\t}))\n\t\t);\n\t\tnext = next.extendsSysId && macroponentDefinitions[next.extendsSysId];\n\t}\n\n\treturn unionBy(...hierarchyItems, 'name');\n};\nconst formatLayout = (layout, defaultLayout) => {\n\tif (!get(layout, 'default')) {\n\t\treturn defaultLayout;\n\t} else {\n\t\treturn layout;\n\t}\n};\n\nexport const createElementFromMacroponent = (\n\tmacroponent,\n\tpropertyValues = {},\n\tpropertyTestValues = {},\n\tcomponentDefinitions,\n\tmacroponentDefinitions,\n\teventHandlers,\n\tpageType,\n\tviewportConfigurations,\n\tstate,\n\tvariantId,\n\tscreenEventMappings,\n\tinternalEventMappings\n) => {\n\tconst {\n\t\tname,\n\t\textendsSysId,\n\t\tcomposition = [],\n\t\tlayout = {},\n\t\tid,\n\t\tsysPolicy\n\t} = macroponent;\n\n\tconst { getDefaultLayout, properties } = state;\n\tconst { isLegacy = false } = properties || {};\n\tconst formattedLayout = formatLayout(layout, getDefaultLayout(pageType));\n\n\tconst rootElement = extendsSysId\n\t\t? macroponentDefinitions[extendsSysId].rootElement\n\t\t: macroponent.rootElement;\n\n\tconst macroThatHasProperties = extendsSysId // TODO: Rename this awful name.\n\t\t? macroponentDefinitions[extendsSysId]\n\t\t: macroponent;\n\n\tconst hierarchyProperties = getMergedPropertiesFromHierarchy(\n\t\tmacroponent,\n\t\tmacroponentDefinitions\n\t);\n\n\tconst componentProperties = macroThatHasProperties.properties.map((prop) => {\n\t\tconst { fieldType, label, name, readOnly, selectable } = prop;\n\t\treturn {\n\t\t\tcolumnName: name,\n\t\t\tlabel,\n\t\t\ttype: fieldType,\n\t\t\tvalue: get(prop, 'defaultValue', ''), // TODO: This comes from the rootelement props, which may point back to the shell props\n\t\t\treadOnly,\n\t\t\tselectable\n\t\t};\n\t});\n\n\tconst component = {\n\t\tname: macroThatHasProperties.name,\n\t\ttag: componentDefinitions[rootElement.definition.id],\n\t\tproperties: componentProperties,\n\t\tslots: ['@default']\n\t};\n\n\tconst elementProperties = componentProperties.reduce(\n\t\t(acc, propertyConfig) => {\n\t\t\tconst isPropertyDefined = !isNil(\n\t\t\t\tpropertyValues[propertyConfig.columnName]\n\t\t\t);\n\t\t\tpropertyConfig.value = isPropertyDefined\n\t\t\t\t? propertyValues[propertyConfig.columnName]\n\t\t\t\t: propertyConfig.value;\n\t\t\tif (isLegacy && propertyConfig.columnName === 'bare') {\n\t\t\t\tpropertyConfig.value = false;\n\t\t\t}\n\t\t\tacc[propertyConfig.columnName] = new Property(propertyConfig);\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n\n\tconst children = composition.map((node) =>\n\t\tcreateElementFromCompositionNode(\n\t\t\tnode,\n\t\t\tcomponentDefinitions,\n\t\t\tmacroponentDefinitions,\n\t\t\teventHandlers,\n\t\t\tfalse,\n\t\t\tviewportConfigurations,\n\t\t\tstate,\n\t\t\tvariantId,\n\t\t\tscreenEventMappings,\n\t\t\trootElement\n\t\t)\n\t);\n\n\t// let's store things in pageState that closely resemble macroponents\n\tconst rawProperties = hierarchyProperties.map((prop) => {\n\t\tconst propertyValue = propertyValues[prop.name];\n\n\t\tconst createdMacroponentProperty = MacroponentProperty.create({\n\t\t\t...prop,\n\t\t\tvalue: isUxValueModel(propertyValue)\n\t\t\t\t? getShorthandFromUxValue(propertyValue)\n\t\t\t\t: propertyValue,\n\t\t\ttestValue: propertyTestValues[prop.name]\n\t\t});\n\t\treturn createdMacroponentProperty;\n\t});\n\n\tconst element = new Element({\n\t\tid,\n\t\tinstanceName: name,\n\t\tchildren,\n\t\tcomponent,\n\t\tproperties: elementProperties,\n\t\tmacroponentProperties: rawProperties,\n\t\tlayout: formattedLayout,\n\t\textendsSysId,\n\t\tpropertyValues,\n\t\tpropertyTestValues,\n\t\tinternalEventMappings,\n\t\tscope: macroponent.scope,\n\t\tscopeName: macroponent.scopeName,\n\t\tdomainId: macroponent.domainId,\n\t\tdomainName: macroponent.domainName,\n\t\tsysPolicy\n\t});\n\n\treturn element;\n};\n\nexport const transformSubroutesToViewportConfig = (\n\tsubroutes,\n\tentityMap = {}\n) => {\n\tconst subrouteConfigurations = groupBy(\n\t\tsubroutes,\n\t\tPARENT_COMPOSITION_ELEMENT_ID\n\t);\n\tconst viewportConfigurations = {};\n\tfor (const viewportElementId in subrouteConfigurations) {\n\t\tconst viewportConfig = subrouteConfigurations[viewportElementId];\n\t\tviewportConfigurations[viewportElementId] =\n\t\t\tviewportConfigurations[viewportElementId] || {};\n\t\tviewportConfig.forEach((route) => {\n\t\t\tviewportConfigurations[viewportElementId][route.routeType] =\n\t\t\t\tviewportConfigurations[viewportElementId][route.routeType] || [];\n\t\t\tviewportConfigurations[viewportElementId][route.routeType].push(route);\n\t\t});\n\t}\n\tif (isEmpty(entityMap)) {\n\t\treturn viewportConfigurations;\n\t} else {\n\t\tconst reMappedViewportConfig = {};\n\t\tObject.keys(viewportConfigurations).forEach((elem) => {\n\t\t\tconst newKey = Object.keys(entityMap).find(\n\t\t\t\t(key) => entityMap[key] === elem\n\t\t\t);\n\t\t\treMappedViewportConfig[newKey] = viewportConfigurations[elem];\n\t\t});\n\t\treturn reMappedViewportConfig;\n\t}\n};\n\nexport default function transformMacroponentToPageState(\n\tmacroponent,\n\tdataBrokerDefinitions,\n\teventHandlers = [],\n\tclientStateParameters = [],\n\tstate,\n\tvariantId\n) {\n\tconst {\n\t\tname,\n\t\tid: sysId,\n\t\tscope,\n\t\tscopeName,\n\t\tdomainId,\n\t\tdomainName,\n\t\tapplicationName,\n\t\tisReadOnly: readOnly,\n\t\tcanCopy,\n\t\tisActive,\n\t\tmacroponentInstance: {\n\t\t\tcomponentDefinitions,\n\t\t\tmacroponentDefinitions,\n\t\t\trootMacroponentId,\n\t\t\teventMappings = [],\n\t\t\tmacroponentPublicHandledEvents = [],\n\t\t\tsubroutes,\n\t\t\tclientScripts = []\n\t\t},\n\t\tpageType,\n\t\torder,\n\t\tsysPolicy,\n\t\t...uiTypeParameters\n\t} = macroponent;\n\n\tconst rootMacroponent = macroponentDefinitions[rootMacroponentId];\n\n\tconst dispatchedEvents = (rootMacroponent.dispatchedEvents || []).map(\n\t\t(event) => new ElementEvent(event)\n\t);\n\tconst handledEvents = (rootMacroponent.handledEvents || []).map(\n\t\t(event) => new ElementEvent(event)\n\t);\n\tconst internalEventMappingsSourceEvents = [\n\t\t...(handledEvents || []),\n\t\t...ROOT_MACROPONENT_SOURCE_EVENTS\n\t];\n\n\tconst { data, stateProperties = [] } = rootMacroponent;\n\n\tconst viewportConfigurations = transformSubroutesToViewportConfig(subroutes);\n\n\tconst newClientStateParameters = stateProperties.map((stateParam) => {\n\t\tconst matchingParam = clientStateParameters.find(\n\t\t\t(param) => param.name === stateParam.name\n\t\t);\n\t\treturn new ClientStateParameter({\n\t\t\tid: matchingParam ? matchingParam.id : seismicCuid(),\n\t\t\tname: stateParam.name,\n\t\t\ttype: stateParam.fieldType,\n\t\t\tinitialValue: coercePropertyValueToShorthand(\n\t\t\t\tstateParam.initialValue,\n\t\t\t\tstateParam.fieldType\n\t\t\t)\n\t\t});\n\t});\n\n\tconst initialDataBrokerInstances = createDataBrokerInstances(\n\t\tdata,\n\t\tdataBrokerDefinitions\n\t);\n\tconst updatedEventHandlers = addAllEventHandlers(\n\t\teventHandlers,\n\t\tfalse, // These event handlers are from local context\n\t\tinitialDataBrokerInstances,\n\t\tdataBrokerDefinitions,\n\t\tclientScripts,\n\t\tdispatchedEvents,\n\t\trootMacroponent,\n\t\tmacroponentPublicHandledEvents\n\t);\n\n\tconst propertyValues = macroponent.macroponentInstance.propertyValues || {};\n\tconst propertyTestValues =\n\t\tmacroponent.macroponentInstance.propertyTestValues || {};\n\n\tconst screenEventMappings = generateEventMappings(\n\t\teventMappings || [],\n\t\tupdatedEventHandlers,\n\t\tdispatchedEvents\n\t);\n\tconst dataBrokerInstances = initialDataBrokerInstances.map((dbInstance) => {\n\t\treturn {\n\t\t\t...dbInstance,\n\t\t\teventMappings: generateEventMappings(\n\t\t\t\tdbInstance.eventMappings || [],\n\t\t\t\tupdatedEventHandlers,\n\t\t\t\tdbInstance.dispatchedEvents || [],\n\t\t\t\tscreenEventMappings\n\t\t\t)\n\t\t};\n\t});\n\n\tconst rootMacroponentEventMappings =\n\t\trootMacroponent.internalEventMappings || {};\n\tconst transformedInternalEventMappings = Object.entries(\n\t\trootMacroponentEventMappings\n\t).map(([eventApiName, targets]) => ({\n\t\teventMappingId: eventApiName,\n\t\tsourceEventApiName: eventApiName,\n\t\ttargets\n\t}));\n\tconst internalEventMappings = generateEventMappings(\n\t\ttransformedInternalEventMappings || [],\n\t\tupdatedEventHandlers,\n\t\tinternalEventMappingsSourceEvents,\n\t\tscreenEventMappings\n\t);\n\n\tconst rootElement = createElementFromMacroponent(\n\t\trootMacroponent,\n\t\tpropertyValues,\n\t\tpropertyTestValues,\n\t\tcomponentDefinitions,\n\t\tmacroponentDefinitions,\n\t\tupdatedEventHandlers,\n\t\tpageType,\n\t\tviewportConfigurations,\n\t\tstate,\n\t\tvariantId,\n\t\tscreenEventMappings,\n\t\tinternalEventMappings\n\t);\n\n\tconst associatedTypes = get(\n\t\tmacroponentDefinitions[rootMacroponentId],\n\t\t'associatedTypes'\n\t);\n\tconst usingSharedPageDefinition =\n\t\tassociatedTypes &&\n\t\t!!associatedTypes.find((id) => id === SHARED_PAGE_DEFINITION_SYS_ID);\n\n\treturn new PageStateModel({\n\t\trootElement,\n\t\tname,\n\t\tsysId,\n\t\tscope,\n\t\tscopeName,\n\t\tdomainId,\n\t\tdomainName,\n\t\tapplicationName,\n\t\tcanCopy,\n\t\tpageStatus: getPageStatus(isActive),\n\t\tsysPolicy,\n\t\treadOnly,\n\t\ttype: pageType,\n\t\tuiTypeParameters,\n\t\tdataBrokerInstances,\n\t\teventHandlers: updatedEventHandlers,\n\t\tdispatchedEvents,\n\t\thandledEvents,\n\t\tclientStateParameters: newClientStateParameters,\n\t\tscreenEventMappings,\n\t\torder,\n\t\tusingSharedPageDefinition\n\t});\n}\n","import cloneDeep from 'lodash/cloneDeep';\nimport get from 'lodash/get';\nimport {\n\tELEMENT_EXPLODED,\n\tELEMENT_EXPLODED_MACROPONENT_SUCCEEDED,\n\tELEMENT_EXPLODED_MACROPONENT_REQUESTED,\n\tELEMENT_EXPLODED_SUBROUTE_COPY_REQUESTED,\n\tELEMENT_EXPLODED_SUBROUTE_COPY_SUCCEEDED,\n\tELEMENT_EXPLODED_UPDATE_PAGE_WITH_MACROPONENT_CONTENTS\n} from './elementActions';\n\nimport { PAGE_LIST_REQUESTED } from '../pageList/pageListActions';\n\nimport { DATA_BROKER_INSTANCE_CREATED } from '../dataBrokers/dataBrokerInstances/dataBrokerInstancesActions';\nimport { createHttpEffect } from '@servicenow/ui-effect-http';\nimport {\n\tfindElementById,\n\tfindElements,\n\tgetAllElementIds,\n\tfindParentElement\n} from './utils/element';\nimport { createDataBrokerInstances } from '../utils';\nimport {\n\tcreateElementFromMacroponent,\n\ttransformSubroutesToViewportConfig\n} from '../page/utils/transformMacroponentToPageState';\nimport { Element } from '../../models';\nimport createPageState from '../../models/createPageState';\nimport { SN_UIB_APP_UPDATE_APP_ROUTE_STATE } from '../../constants';\n\nconst explodedMacroponentRequested = createHttpEffect(\n\t'/api/now/uxframework/macroponents/:macroponentId',\n\t{\n\t\tmethod: 'GET',\n\t\tpathParams: ['macroponentId'],\n\t\tsuccessActionType: ELEMENT_EXPLODED_MACROPONENT_SUCCEEDED,\n\t\tbatch: false\n\t}\n);\n\nconst subroutesCopyRequested = createHttpEffect(\n\t'/api/now/builder/subroutes/copy/to/variants/:variantSysId',\n\t{\n\t\tmethod: 'POST',\n\t\tdataParam: 'subroutes',\n\t\tpathParams: ['variantSysId'],\n\t\tsuccessActionType: ELEMENT_EXPLODED_SUBROUTE_COPY_SUCCEEDED,\n\t\tbatch: false\n\t}\n);\n\nconst elementExplodedHandler = (coeffects) => {\n\tconst {\n\t\tdispatch,\n\t\taction: {\n\t\t\tpayload: { elementId }\n\t\t},\n\t\tproperties: { pageState }\n\t} = coeffects;\n\n\tconst explodedElement = findElementById(pageState.rootElement, elementId);\n\n\t// TODO: Right now, we invoke the explosion as soon as we have the macroponent definition.\n\t// Instead, we want to show a confirmation modal that shows the user what they will\n\t// be adding to the page if they proceed.\n\tdispatch(\n\t\tELEMENT_EXPLODED_MACROPONENT_REQUESTED,\n\t\t{\n\t\t\tmacroponentId: explodedElement.component.id\n\t\t},\n\t\t{\n\t\t\texplodedElementId: elementId\n\t\t}\n\t);\n};\n\nconst updateBinding = (\n\tpropertyValue,\n\toriginalContextProperties,\n\tentityIdMap\n) => {\n\t// TODO: This would be improved by treating these as UxValues instead of doing string\n\t// wizardry\n\n\tif (typeof propertyValue !== 'string') {\n\t\treturn propertyValue;\n\t}\n\n\tif (propertyValue.startsWith('@context.props')) {\n\t\tconst propBindingName = propertyValue.substring('@context.props.'.length);\n\t\treturn originalContextProperties[propBindingName || null];\n\t} else if (propertyValue.startsWith('@data')) {\n\t\tconst truncated = propertyValue.substring('@data.'.length);\n\n\t\tconst dbInstanceId = truncated.substr(0, truncated.indexOf('.'));\n\t\tconst remainder = truncated.substr(truncated.indexOf('.'));\n\t\treturn `@data.${entityIdMap.data[dbInstanceId]}${remainder}`;\n\t}\n\n\treturn propertyValue;\n};\n\nconst createDataBokerInstances = (arg) => {\n\tconst {\n\t\tdata,\n\t\tdataBrokerDefinitions,\n\t\toriginalContextProperties,\n\t\tentityIdMap,\n\t\tdispatch\n\t} = arg;\n\n\tconst dataBrokerIdMap = {};\n\tconst newDataBrokers = createDataBrokerInstances(data, dataBrokerDefinitions);\n\n\tnewDataBrokers.forEach((dbInstance) => {\n\t\tconst newDbInstanceId = entityIdMap.data[dbInstance.id];\n\t\tdataBrokerIdMap[dbInstance.id] = dbInstance.id = newDbInstanceId;\n\n\t\tObject.keys(dbInstance.properties).forEach((propertyName) => {\n\t\t\tconst property = dbInstance.properties[propertyName];\n\t\t\tif (property.value) {\n\t\t\t\tproperty.value = updateBinding(\n\t\t\t\t\tproperty.value,\n\t\t\t\t\toriginalContextProperties,\n\t\t\t\t\tentityIdMap\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\tdispatch(DATA_BROKER_INSTANCE_CREATED, {\n\t\t\tdataBrokerInstance: dbInstance\n\t\t});\n\t});\n};\n\nconst generateIdMap = (pageState, newExplodedElement, data) => {\n\tconst idMap = {\n\t\tdata: {},\n\t\telements: {},\n\t\tstate: {}\n\t};\n\n\tconst uniqueIdMapGenerator = (originalIds, currentIds, prefix) => {\n\t\treturn originalIds.reduce((acc, cur) => {\n\t\t\tlet newId = `${prefix}_${cur}`;\n\n\t\t\tif (currentIds.includes(newId)) {\n\t\t\t\tlet counter = 1;\n\t\t\t\twhile (currentIds.includes(`${newId}_${counter}`)) {\n\t\t\t\t\tcounter += 1;\n\t\t\t\t}\n\t\t\t\tnewId += `_${counter}`;\n\t\t\t}\n\n\t\t\tcurrentIds.push(newId);\n\t\t\tacc[cur] = newId;\n\t\t\treturn acc;\n\t\t}, {});\n\t};\n\n\t// Elements\n\tconst currentElementIds = getAllElementIds(pageState.rootElement);\n\tconst explodedElementIds = findElements(newExplodedElement, () => true)\n\t\t.map((element) => element.id)\n\t\t.filter((id) => id !== newExplodedElement.id);\n\n\tidMap.elements = uniqueIdMapGenerator(\n\t\texplodedElementIds,\n\t\tcurrentElementIds,\n\t\tnewExplodedElement.id\n\t);\n\tidMap.elements[newExplodedElement.id] = newExplodedElement.id;\n\n\t// Data broker instances\n\tconst currentDataBrokerInstanceIds = pageState.dataBrokerInstances.map(\n\t\t(instance) => instance.id\n\t);\n\tconst explodedDataBrokerIds = data.map((instance) => instance.elementId);\n\tidMap.data = uniqueIdMapGenerator(\n\t\texplodedDataBrokerIds,\n\t\tcurrentDataBrokerInstanceIds,\n\t\tnewExplodedElement.id\n\t);\n\n\t// TODO: State\n\n\treturn idMap;\n};\n\nconst subroutesCopySucceeded = ({ state, action, dispatch }) => {\n\tconst {\n\t\tentityIdMap,\n\t\toriginalContextProperties,\n\t\tmacroponent,\n\t\texplodedElementId,\n\t\tcomponentDependencies,\n\t\tmacroponentDependencies\n\t} = action.meta;\n\n\tconst { result } = action.payload;\n\n\tconst newExplodedElement = createElementFromMacroponent(\n\t\tmacroponent,\n\t\t{},\n\t\t{},\n\t\tcomponentDependencies,\n\t\tmacroponentDependencies,\n\t\t[],\n\t\tnull,\n\t\ttransformSubroutesToViewportConfig(result, entityIdMap.elements),\n\t\tstate\n\t);\n\n\t// Look for empty slot references on children of container.\n\t// If empty, default it\n\tnewExplodedElement.children.forEach((child) => {\n\t\tif (!child.slot.name) {\n\t\t\tchild.slot.name = 'Main';\n\t\t}\n\t});\n\n\tnewExplodedElement.id = explodedElementId;\n\tnewExplodedElement.component.id = macroponent.extendsSysId;\n\n\tdispatch(ELEMENT_EXPLODED_UPDATE_PAGE_WITH_MACROPONENT_CONTENTS, {\n\t\tnewExplodedElement,\n\t\tentityIdMap,\n\t\toriginalContextProperties,\n\t\tmacroponent,\n\t\texplodedElementId\n\t});\n};\n\nconst explodedMacroponentRequestSucceeded = (coeffects) => {\n\tconst {\n\t\taction: {\n\t\t\tmeta: { explodedElementId },\n\t\t\tpayload: {\n\t\t\t\tresult: {\n\t\t\t\t\tmacroponent,\n\t\t\t\t\tmacroponentDependencies,\n\t\t\t\t\tcomponentDependencies,\n\t\t\t\t\tsubroutes\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tproperties: { pageState },\n\t\tstate,\n\t\tdispatch\n\t} = coeffects;\n\n\tconst originalExplodedElement = findElementById(\n\t\tpageState.rootElement,\n\t\texplodedElementId\n\t);\n\n\tconst originalContextProperties = Object.keys(\n\t\toriginalExplodedElement.properties\n\t).reduce((acc, cur) => {\n\t\tacc[cur] = originalExplodedElement.properties[cur].value;\n\t\treturn acc;\n\t}, {});\n\n\tconst newExplodedElement = createElementFromMacroponent(\n\t\tmacroponent,\n\t\t{},\n\t\t{},\n\t\tcomponentDependencies,\n\t\tmacroponentDependencies,\n\t\t[],\n\t\tnull,\n\t\t{},\n\t\tstate\n\t);\n\tnewExplodedElement.id = explodedElementId;\n\tnewExplodedElement.component.id = macroponent.extendsSysId;\n\n\t// Look for empty slot references on children of container.\n\t// If empty, default it\n\tnewExplodedElement.children.forEach((child) => {\n\t\tif (!child.slot.name) {\n\t\t\tchild.slot.name = 'Main';\n\t\t}\n\t});\n\n\t// First thing we do is figure out what all the new ID names are going to be for our\n\t// migrated content, in order to prevent collisions with things that already exist.\n\t// We need this first, so we can update references to these things as we migrate all our\n\t// different types of content.\n\tconst entityIdMap = generateIdMap(\n\t\tpageState,\n\t\tnewExplodedElement,\n\t\tmacroponent.data\n\t);\n\n\tif (subroutes && subroutes.length > 0) {\n\t\treturn dispatch(\n\t\t\tELEMENT_EXPLODED_SUBROUTE_COPY_REQUESTED,\n\t\t\t{\n\t\t\t\tsubroutes: subroutes.map((subroute) => {\n\t\t\t\t\tconst currentParentCompositionElementId =\n\t\t\t\t\t\tsubroute.parentCompositionElementId;\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...subroute,\n\t\t\t\t\t\tparentCompositionElementId:\n\t\t\t\t\t\t\tentityIdMap.elements[currentParentCompositionElementId]\n\t\t\t\t\t};\n\t\t\t\t}),\n\t\t\t\tvariantSysId: pageState.sysId\n\t\t\t},\n\t\t\t{\n\t\t\t\tmacroponent,\n\t\t\t\tmacroponentDependencies,\n\t\t\t\tcomponentDependencies,\n\t\t\t\texplodedElementId,\n\t\t\t\tnewExplodedElement,\n\t\t\t\tentityIdMap,\n\t\t\t\toriginalContextProperties\n\t\t\t}\n\t\t);\n\t}\n\n\tdispatch(ELEMENT_EXPLODED_UPDATE_PAGE_WITH_MACROPONENT_CONTENTS, {\n\t\tnewExplodedElement,\n\t\tentityIdMap,\n\t\toriginalContextProperties,\n\t\tmacroponent,\n\t\texplodedElementId\n\t});\n};\n\nconst updatePageStateWithMacroponentContents = ({\n\taction,\n\tupdateProperties,\n\tproperties,\n\tdispatch\n}) => {\n\tconst {\n\t\tnewExplodedElement,\n\t\tentityIdMap,\n\t\toriginalContextProperties,\n\t\tmacroponent,\n\t\texplodedElementId\n\t} = action.payload;\n\tconst { pageState, dataBrokerDefinitions } = properties;\n\n\t// Create all our fresh new data brokers with the help of our DB creation event handling.\n\tcreateDataBokerInstances({\n\t\tdata: macroponent.data || [],\n\t\tdataBrokerDefinitions,\n\t\tentityIdMap,\n\t\toriginalContextProperties,\n\t\tdispatch\n\t});\n\n\t// Update the IDs of our new elements, and update their properties if they need to be updated\n\t// to reference new values.\n\tfindElements(newExplodedElement, () => true).forEach((element) => {\n\t\telement.id = entityIdMap.elements[element.id];\n\n\t\t// Apply the old property values to any elements that bind to @context.props\n\t\tObject.keys(element.properties).forEach((propertyName) => {\n\t\t\tconst property = element.properties[propertyName];\n\t\t\tif (property.value) {\n\t\t\t\tproperty.value = updateBinding(\n\t\t\t\t\tproperty.value,\n\t\t\t\t\toriginalContextProperties,\n\t\t\t\t\tentityIdMap\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t});\n\n\t// Finally, update page state with our newly generated element, and replace the old element\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst parentElement = findParentElement(newRootElement, explodedElementId);\n\tconst elementIndex = parentElement.children.findIndex(\n\t\t(elem) => elem.id === explodedElementId\n\t);\n\tnewExplodedElement.slot = parentElement.children[elementIndex].slot;\n\tnewExplodedElement.instanceName =\n\t\tparentElement.children[elementIndex].instanceName;\n\tparentElement.children[elementIndex] = newExplodedElement;\n\n\tconst newPageState = createPageState(\n\t\t{\n\t\t\trootElement: new Element(newRootElement)\n\t\t},\n\t\tpageState\n\t);\n\n\tupdateProperties({\n\t\tpageState: newPageState\n\t});\n\n\tconst appConfig = get(pageState, 'uiTypeParameters.appConfig', '');\n\tconst keyToUse = appConfig ? 'appConfigId' : 'macroponentSysId';\n\tconst sysIdToUse =\n\t\tappConfig || get(pageState, 'uiTypeParameters.parentMacroponent', null);\n\tdispatch(\n\t\tPAGE_LIST_REQUESTED,\n\t\t{ [keyToUse]: sysIdToUse },\n\t\t{ isExplosion: true }\n\t);\n\tdispatch(SN_UIB_APP_UPDATE_APP_ROUTE_STATE, { sysId: sysIdToUse });\n};\n\nexport default {\n\t[ELEMENT_EXPLODED]: elementExplodedHandler,\n\t[ELEMENT_EXPLODED_MACROPONENT_REQUESTED]: explodedMacroponentRequested,\n\t[ELEMENT_EXPLODED_MACROPONENT_SUCCEEDED]: explodedMacroponentRequestSucceeded,\n\t[ELEMENT_EXPLODED_SUBROUTE_COPY_REQUESTED]: subroutesCopyRequested,\n\t[ELEMENT_EXPLODED_SUBROUTE_COPY_SUCCEEDED]: subroutesCopySucceeded,\n\t[ELEMENT_EXPLODED_UPDATE_PAGE_WITH_MACROPONENT_CONTENTS]: updatePageStateWithMacroponentContents\n};\n","import * as elementActions from './elementActions';\nimport elementTypeHandlers from './elementHandlers';\nimport elementLayoutHandlers from './elementLayoutHandlers';\nimport elementStyleHandlers from './elementStyleHandlers';\nimport elementResizeHandler from './elementResizeHandler';\nimport elementPropertyUpdatedHandler from './elementPropertyUpdatedHandler';\nimport elementMetadataUpdatedHandler from './elementMetadataUpdatedHandler';\nimport elementExplodedHandler from './elementExplodedHandler';\n\nconst elementHandlers = {\n\t...elementTypeHandlers,\n\t...elementPropertyUpdatedHandler,\n\t...elementLayoutHandlers,\n\t...elementStyleHandlers,\n\t...elementResizeHandler,\n\t...elementMetadataUpdatedHandler,\n\t...elementExplodedHandler\n};\n\nexport { elementActions, elementHandlers };\n","import { seismicCuid } from '../../utils';\n\nimport { Element, EventMapping, EventMappingTarget } from '../../models';\n\nimport createPageState from '../../models/createPageState';\n\nimport {\n\tELEMENT_EVENT_MAPPING_CREATED,\n\tELEMENT_EVENT_MAPPING_HANDLER_CHANGED,\n\tELEMENT_EVENT_MAPPING_HANDLER_CREATED,\n\tELEMENT_EVENT_MAPPING_HANDLER_DELETED,\n\tELEMENT_COMPLETE_EVENT_MAPPING_CREATED,\n\tSCREEN_EVENT_MAPPING_CREATED,\n\tSCREEN_EVENT_MAPPING_HANDLER_ADDED,\n\tSCREEN_EVENT_MAPPING_HANDLER_DELETED,\n\tSCREEN_EVENT_MAPPING_HANDLER_CHANGED,\n\tPAGE_INTERNAL_EVENT_MAPPING_CREATED,\n\tPAGE_INTERNAL_EVENT_MAPPING_HANDLER_CREATED,\n\tPAGE_INTERNAL_EVENT_MAPPING_HANDLER_DELETED,\n\tPAGE_INTERNAL_EVENT_MAPPING_HANDLER_CHANGED\n} from './elementEventMappingsActions';\nimport cloneDeep from 'lodash/cloneDeep';\nimport reject from 'lodash/reject';\nimport {\n\tgetNewRootElementAndElementToUpdate,\n\tcreateEventMapping,\n\tcreateEventMappingHandler,\n\tdeleteEventMappingHandler,\n\tupdateEventMappingHandler\n} from './utils';\n\nfunction getPageState(newRootElement, pageState) {\n\treturn createPageState(\n\t\t{\n\t\t\trootElement: new Element(newRootElement)\n\t\t},\n\t\tpageState\n\t);\n}\n\nconst elementEventMappingCreated = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState } = properties;\n\tconst { elementId, eventId, eventApiName } = action.payload;\n\tconst {\n\t\tnewRootElement,\n\t\telementToUpdate\n\t} = getNewRootElementAndElementToUpdate(pageState, elementId);\n\n\tconst elementEventMapping = createEventMapping(eventId, eventApiName);\n\telementToUpdate.eventMappings.unshift(elementEventMapping);\n\n\tupdateProperties({\n\t\tpageState: getPageState(newRootElement, pageState)\n\t});\n};\n\nconst elementEventMappingHandlerCreated = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState } = properties;\n\tconst { elementId, eventMappingId } = action.payload;\n\tconst {\n\t\tnewRootElement,\n\t\telementToUpdate = {}\n\t} = getNewRootElementAndElementToUpdate(pageState, elementId);\n\tconst { eventMappings = [] } = elementToUpdate;\n\tcreateEventMappingHandler(eventMappings, eventMappingId);\n\n\tupdateProperties({\n\t\tpageState: getPageState(newRootElement, pageState)\n\t});\n};\n\nconst elementEventMappingHandlerDeleted = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState } = properties;\n\tconst { elementId, eventMappingId, handlerId } = action.payload;\n\tconst {\n\t\tnewRootElement,\n\t\telementToUpdate = {}\n\t} = getNewRootElementAndElementToUpdate(pageState, elementId);\n\n\tconst { eventMappings = [] } = elementToUpdate;\n\tdeleteEventMappingHandler(\n\t\telementToUpdate,\n\t\teventMappings,\n\t\teventMappingId,\n\t\thandlerId\n\t);\n\n\tupdateProperties({\n\t\tpageState: getPageState(newRootElement, pageState)\n\t});\n};\n\nconst eventMappingHandlerChanged = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState, eventHandlers, clientStateParameters = [] } = properties;\n\tconst {\n\t\telementId,\n\t\teventMappingId,\n\t\thandlerId,\n\t\thandlerTypeId,\n\t\thandlerValueId = null,\n\t\tvalue = null,\n\t\tscripted\n\t} = action.payload;\n\n\tconst {\n\t\tnewRootElement,\n\t\telementToUpdate\n\t} = getNewRootElementAndElementToUpdate(pageState, elementId);\n\tconst eventMappingToUpdate =\n\t\telementToUpdate.eventMappings.find(\n\t\t\t(eventMapping) => eventMapping.eventMappingId === eventMappingId\n\t\t) || {};\n\n\tconst { targets = [] } = eventMappingToUpdate;\n\tconst handlerToUpdate =\n\t\ttargets.find((target) => target.targetId === handlerId) || null;\n\tif (handlerToUpdate) {\n\t\tupdateEventMappingHandler(\n\t\t\thandlerToUpdate,\n\t\t\teventHandlers,\n\t\t\thandlerTypeId,\n\t\t\thandlerValueId,\n\t\t\tvalue,\n\t\t\tscripted,\n\t\t\tclientStateParameters\n\t\t);\n\t}\n\n\tconst newPageState = getPageState(newRootElement, pageState);\n\tupdateProperties({\n\t\tpageState: newPageState\n\t});\n};\n\nconst elementCompleteEventMappingCreated = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState } = properties;\n\tconst {\n\t\telementId,\n\t\teventId,\n\t\teventApiName,\n\t\teventMappingTarget\n\t} = action.payload;\n\n\tconst {\n\t\tnewRootElement,\n\t\telementToUpdate\n\t} = getNewRootElementAndElementToUpdate(pageState, elementId);\n\n\tconst elementEventMapping = new EventMapping({\n\t\teventMappingId: seismicCuid(),\n\t\teventId,\n\t\teventApiName,\n\t\ttargets: [new EventMappingTarget(eventMappingTarget)]\n\t});\n\n\telementToUpdate.eventMappings.unshift(elementEventMapping);\n\n\tupdateProperties({\n\t\tpageState: getPageState(newRootElement, pageState)\n\t});\n};\n\nconst screenEventMappingCreated = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState } = properties;\n\tconst { eventId, eventApiName } = action.payload;\n\n\tconst newScreenEventMapping = createEventMapping(eventId, eventApiName);\n\tconst existingScreenEventMappings = cloneDeep(pageState.screenEventMappings);\n\texistingScreenEventMappings.unshift(newScreenEventMapping);\n\n\tconst newPageState = createPageState(\n\t\t{\n\t\t\tscreenEventMappings: existingScreenEventMappings\n\t\t},\n\t\tpageState\n\t);\n\n\tupdateProperties({\n\t\tpageState: newPageState\n\t});\n};\n\nconst screenEventMappingHandlerAdded = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState } = properties;\n\tconst { eventMappingId } = action.payload;\n\n\tconst clonedScreenEventMappings = cloneDeep(\n\t\tpageState.screenEventMappings || []\n\t);\n\tcreateEventMappingHandler(clonedScreenEventMappings, eventMappingId);\n\n\tconst newPageState = createPageState(\n\t\t{\n\t\t\tscreenEventMappings: clonedScreenEventMappings\n\t\t},\n\t\tcloneDeep(pageState)\n\t);\n\n\tupdateProperties({\n\t\tpageState: newPageState\n\t});\n};\n\nconst screenEventMappingHandlerDeleted = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { eventMappingId, handlerId } = action.payload;\n\tconst clonedScreenEventMappings = cloneDeep(\n\t\tproperties.pageState.screenEventMappings\n\t);\n\tconst eventMappingToUpdate = clonedScreenEventMappings.find(\n\t\t(eventMapping) => eventMapping.eventMappingId === eventMappingId\n\t);\n\n\teventMappingToUpdate.targets = reject(eventMappingToUpdate.targets, {\n\t\ttargetId: handlerId\n\t});\n\n\tlet newScreenEventMappings = clonedScreenEventMappings;\n\t// if there was only one target for this event mapping, delete the whole mapping\n\tif (eventMappingToUpdate.targets.length === 0) {\n\t\tnewScreenEventMappings = reject(clonedScreenEventMappings, {\n\t\t\teventMappingId: eventMappingId\n\t\t});\n\t}\n\n\tconst newPageState = createPageState(\n\t\t{\n\t\t\tscreenEventMappings: newScreenEventMappings\n\t\t},\n\t\tcloneDeep(properties.pageState)\n\t);\n\n\tupdateProperties({\n\t\tpageState: newPageState\n\t});\n};\n\nconst screenEventMappingHandlerChanged = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState, eventHandlers, clientStateParameters = [] } = properties;\n\tconst {\n\t\teventMappingId,\n\t\thandlerId,\n\t\thandlerTypeId,\n\t\thandlerValueId = null,\n\t\tvalue = null,\n\t\tscripted\n\t} = action.payload;\n\tconst clonedScreenEventMappings = cloneDeep(pageState.screenEventMappings);\n\tconst eventMappingToUpdate =\n\t\tclonedScreenEventMappings.find(\n\t\t\t(eventMapping) => eventMapping.eventMappingId === eventMappingId\n\t\t) || {};\n\n\tconst { targets = [] } = eventMappingToUpdate;\n\tconst handlerToUpdate =\n\t\ttargets.find((target) => target.targetId === handlerId) || null;\n\tif (handlerToUpdate) {\n\t\tupdateEventMappingHandler(\n\t\t\thandlerToUpdate,\n\t\t\teventHandlers,\n\t\t\thandlerTypeId,\n\t\t\thandlerValueId,\n\t\t\tvalue,\n\t\t\tscripted,\n\t\t\tclientStateParameters\n\t\t);\n\t}\n\n\tconst newPageState = createPageState(\n\t\t{ screenEventMappings: clonedScreenEventMappings },\n\t\tcloneDeep(pageState)\n\t);\n\n\tupdateProperties({\n\t\tpageState: newPageState\n\t});\n};\n\nconst internalEventMappingCreated = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState } = properties;\n\tconst { eventId, eventApiName } = action.payload || {};\n\n\tconst newInternalEventMapping = createEventMapping(eventId, eventApiName);\n\tconst newRootElement = cloneDeep(pageState.rootElement) || {};\n\tconst existingInternalEventMappings =\n\t\tnewRootElement.internalEventMappings || [];\n\texistingInternalEventMappings.unshift(newInternalEventMapping);\n\n\tupdateProperties({\n\t\tpageState: createPageState({ rootElement: newRootElement }, pageState)\n\t});\n};\n\nconst internalEventMappingHandlerCreated = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState } = properties;\n\tconst { eventMappingId } = action.payload || {};\n\n\tconst newRootElement = cloneDeep(pageState.rootElement) || {};\n\tconst existingInternalEventMappings =\n\t\tnewRootElement.internalEventMappings || [];\n\tcreateEventMappingHandler(existingInternalEventMappings, eventMappingId);\n\n\tupdateProperties({\n\t\tpageState: createPageState({ rootElement: newRootElement }, pageState)\n\t});\n};\n\nconst internalEventMappingHandlerDeleted = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { pageState } = properties;\n\tconst { eventMappingId, handlerId } = action.payload || {};\n\n\tconst newRootElement = cloneDeep(pageState.rootElement) || {};\n\tconst existingInternalEventMappings =\n\t\tnewRootElement.internalEventMappings || [];\n\tconst eventMappingToUpdate =\n\t\texistingInternalEventMappings.find(\n\t\t\t(eventMapping) => eventMapping.eventMappingId === eventMappingId\n\t\t) || {};\n\teventMappingToUpdate.targets = reject(eventMappingToUpdate.targets, {\n\t\ttargetId: handlerId\n\t});\n\n\t// if there was only one target for this event mapping, delete the whole mapping\n\tif (eventMappingToUpdate.targets.length === 0) {\n\t\tnewRootElement.internalEventMappings = reject(\n\t\t\texistingInternalEventMappings,\n\t\t\t{\n\t\t\t\teventMappingId: eventMappingId\n\t\t\t}\n\t\t);\n\t}\n\n\tupdateProperties({\n\t\tpageState: createPageState({ rootElement: newRootElement }, pageState)\n\t});\n};\n\nconst internalEventMappingHandlerChanged = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst {\n\t\teventHandlers = [],\n\t\tpageState = {},\n\t\tclientStateParameters = []\n\t} = properties;\n\tconst {\n\t\teventMappingId,\n\t\thandlerId,\n\t\thandlerTypeId,\n\t\thandlerValueId = null,\n\t\tvalue = null,\n\t\tscripted\n\t} = action.payload || {};\n\n\tconst newRootElement = cloneDeep(pageState.rootElement) || {};\n\tconst existingInternalEventMappings =\n\t\tnewRootElement.internalEventMappings || [];\n\tconst eventMappingToUpdate =\n\t\texistingInternalEventMappings.find(\n\t\t\t(eventMapping) => eventMapping.eventMappingId === eventMappingId\n\t\t) || {};\n\n\tconst { targets = [] } = eventMappingToUpdate;\n\tconst handlerToUpdate =\n\t\ttargets.find((target) => target.targetId === handlerId) || null;\n\tif (handlerToUpdate) {\n\t\tupdateEventMappingHandler(\n\t\t\thandlerToUpdate,\n\t\t\teventHandlers,\n\t\t\thandlerTypeId,\n\t\t\thandlerValueId,\n\t\t\tvalue,\n\t\t\tscripted,\n\t\t\tclientStateParameters\n\t\t);\n\t}\n\n\tupdateProperties({\n\t\tpageState: createPageState({ rootElement: newRootElement }, pageState)\n\t});\n};\n\nexport default {\n\t[ELEMENT_EVENT_MAPPING_CREATED]: elementEventMappingCreated,\n\t[ELEMENT_EVENT_MAPPING_HANDLER_CHANGED]: eventMappingHandlerChanged,\n\t[ELEMENT_EVENT_MAPPING_HANDLER_CREATED]: elementEventMappingHandlerCreated,\n\t[ELEMENT_EVENT_MAPPING_HANDLER_DELETED]: elementEventMappingHandlerDeleted,\n\t[ELEMENT_COMPLETE_EVENT_MAPPING_CREATED]: elementCompleteEventMappingCreated,\n\t[SCREEN_EVENT_MAPPING_CREATED]: screenEventMappingCreated,\n\t[SCREEN_EVENT_MAPPING_HANDLER_ADDED]: screenEventMappingHandlerAdded,\n\t[SCREEN_EVENT_MAPPING_HANDLER_DELETED]: screenEventMappingHandlerDeleted,\n\t[SCREEN_EVENT_MAPPING_HANDLER_CHANGED]: screenEventMappingHandlerChanged,\n\t[PAGE_INTERNAL_EVENT_MAPPING_CREATED]: internalEventMappingCreated,\n\t[PAGE_INTERNAL_EVENT_MAPPING_HANDLER_CREATED]: internalEventMappingHandlerCreated,\n\t[PAGE_INTERNAL_EVENT_MAPPING_HANDLER_DELETED]: internalEventMappingHandlerDeleted,\n\t[PAGE_INTERNAL_EVENT_MAPPING_HANDLER_CHANGED]: internalEventMappingHandlerChanged\n};\n","export const PAGE_CREATE_REQUESTED = 'SN_UXF#PAGE_CREATE_REQUESTED';\nexport const PAGE_CREATE_HTTP_REQUESTED = 'SN_UXF#PAGE_CREATE_HTTP_REQUESTED';\nexport const PAGE_CREATE_STARTED = 'SN_UXF#PAGE_CREATE_STARTED';\nexport const PAGE_CREATE_FAILED = 'SN_UXF#PAGE_CREATE_FAILED';\nexport const PAGE_CREATE_SUCCEEDED = 'SN_UXF#PAGE_CREATE_SUCCEEDED';\n\nexport const PAGE_REQUESTED = 'SN_UXF#PAGE_REQUESTED';\nexport const PAGE_REQUESTED_STARTED = 'SN_UXF#PAGE_REQUESTED_STARTED';\nexport const PAGE_REQUESTED_HTTP = 'SN_UXF#PAGE_REQUESTED_HTTP';\nexport const PAGE_REQUEST_HTTP_STARTED = 'SN_UXF#PAGE_REQUEST_STARTED';\nexport const PAGE_REQUEST_HTTP_FAILED = 'SN_UXF#PAGE_REQUEST_FAILED';\nexport const PAGE_REQUEST_HTTP_SUCCEEDED = 'SN_UXF#PAGE_REQUEST_SUCCEEDED';\n\nexport const PAGE_UPDATE_REQUESTED = 'SN_UXF#PAGE_UPDATE_REQUESTED';\nexport const PAGE_UPDATE_STARTED = 'SN_UXF#PAGE_UPDATE_STARTED';\nexport const PAGE_UPDATE_FAILED = 'SN_UXF#PAGE_UPDATE_FAILED';\nexport const PAGE_UPDATE_SUCCEEDED = 'SN_UXF#PAGE_UPDATE_SUCCEEDED';\n\nexport const PAGE_DELETE_REQUESTED = 'SN_UXF#PAGE_DELETE_REQUESTED';\nexport const PAGE_DELETE_REQUESTED_HTTP = 'SN_UXF#PAGE_DELETE_REQUESTED_HTTP';\nexport const PAGE_DELETE_STARTED = 'SN_UXF#PAGE_DELETE_STARTED';\nexport const PAGE_DELETE_FAILED = 'SN_UXF#PAGE_DELETE_FAILED';\nexport const PAGE_DELETE_SUCCEEDED = 'SN_UXF#PAGE_DELETE_SUCCEEDED';\n\nexport const PAGE_SAVE_REQUESTED = 'SN_UXF#PAGE_SAVE_REQUESTED';\nexport const PAGE_SAVE_HTTP_REQUESTED = 'SN_UXF#PAGE_SAVE_HTTP_REQUESTED';\n\nexport const PAGE_COMPONENTS_REQUESTED = 'SN_UXF#PAGE_COMPONENTS_REQUESTED';\n\nexport const PAGE_COPY_REQUESTED = 'SN_UXF#PAGE_COPY_REQUESTED';\nexport const PAGE_COPY_HTTP_REQUESTED = 'SN_UXF#PAGE_COPY_HTTP_REQUESTED';\nexport const PAGE_COPY_STARTED = 'SN_UXF#PAGE_COPY_STARTED';\nexport const PAGE_COPY_FAILED = 'SN_UXF#PAGE_COPY_FAILED';\nexport const PAGE_COPY_SUCCEEDED = 'SN_UXF#PAGE_COPY_SUCCEEDED';\nexport const PAGE_DATA_RECEIVED = 'SN_UXF#PAGE_DATA_RECEIVED';\n\nexport const METADATA_UPDATE_REQUESTED = 'SN_UXF#METADATA_UPDATE_REQUESTED';\nexport const METADATA_UPDATE_HTTP_REQUESTED =\n\t'SN_UXF#METADATA_UPDATE_HTTP_REQUESTED';\nexport const METADATA_UPDATE_STARTED = 'SN_UXF#METADATA_UPDATE_STARTED';\nexport const METADATA_UPDATE_FAILED = 'SN_UXF#METADATA_UPDATE_FAILED';\nexport const METADATA_UPDATE_SUCCEEDED = 'SN_UXF#METADATA_UPDATE_SUCCEEDED';\n\nexport const ISOLATED_EDIT_MODE_REQUESTED =\n\t'SN_UXF#ISOLATED_EDIT_MODE_REQUESTED';\nexport const ISOLATED_EDIT_MODE_REQUEST_SUCCEEDED =\n\t'SN_UXF#ISOLATED_EDIT_MODE_REQUEST_SUCCEEDED';\nexport const ISOLATED_EDIT_MODE_REQUEST_FAILED =\n\t'SN_UXF#ISOLATED_EDIT_MODE_REQUEST_FAILED';\n","import { MACROPONENT_CATEGORY, SCREEN_TEMPLATE_SYS_ID } from '../../constants';\nimport cloneDeep from 'lodash/cloneDeep';\nimport uniqBy from 'lodash/uniqBy';\nimport { getTemplates } from '@devsnc/library-uxf';\nimport transformMacroponentToPageState from '../page/utils/transformMacroponentToPageState';\nimport get from 'lodash/get';\n\nconst getValuesForDefaultProperties = (screenTypes, screenTypeId) => (\n\tcolumnName\n) => {\n\ttry {\n\t\treturn screenTypes\n\t\t\t.find(({ id }) => id === screenTypeId)\n\t\t\t[columnName].split(',')\n\t\t\t.filter((prop) => prop)\n\t\t\t.map((prop) => String(prop).trim());\n\t} catch (e) {\n\t\tconsole.warn(\n\t\t\t`UXF Builder Middleware Warning: no default page properties were configured from ${columnName}`\n\t\t);\n\t\treturn [];\n\t}\n};\n\nconst setupDefaultProperties = (screenTypes, screenTypeId) => {\n\tconst getValuesFrom = getValuesForDefaultProperties(\n\t\tscreenTypes,\n\t\tscreenTypeId\n\t);\n\tconst screenTypeFieldsAndParams = [\n\t\t...getValuesFrom('fields'),\n\t\t...getValuesFrom('optionalParameters')\n\t];\n\n\tconst defaultProperties = uniqBy(\n\t\tscreenTypeFieldsAndParams.map((name) => ({ name })),\n\t\t'name'\n\t);\n\tconst defaultPropertyValues = screenTypeFieldsAndParams.reduce(\n\t\t(acc, prop) => {\n\t\t\tacc[prop] = '';\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n\n\treturn { defaultProperties, defaultPropertyValues };\n};\n\nconst createLandingPage = (\n\tpageInformation,\n\tcomposition,\n\tlayout,\n\tproperties,\n\tpropertyValues,\n\tdispatch,\n\thttpAction\n) => {\n\tconst {\n\t\tname,\n\t\tscope,\n\t\tsysPolicy,\n\t\tapplicability: { applications },\n\t\tcopyFrom //TODO: add support to copy from a given page sysId in the backend\n\t} = pageInformation;\n\tconst applicablePage = (applications.length >= 1 && applications[0]) || '';\n\tconst applicabilityType = applicablePage ? 'single' : 'any';\n\n\tdispatch(httpAction, {\n\t\tpageEndpoint: 'ws_landing_pages',\n\t\tsysparm_transaction_scope: scope,\n\t\tdata: {\n\t\t\tisActive: false,\n\t\t\tapplicability: { type: applicabilityType, applicablePage },\n\t\t\tmacroponentInstance: {\n\t\t\t\tmacroponent: {\n\t\t\t\t\tname,\n\t\t\t\t\tsysPolicy,\n\t\t\t\t\tcomposition,\n\t\t\t\t\tlayout,\n\t\t\t\t\tproperties,\n\t\t\t\t\textendsSysId: SCREEN_TEMPLATE_SYS_ID,\n\t\t\t\t\tcategory: MACROPONENT_CATEGORY\n\t\t\t\t},\n\t\t\t\tpropertyValues\n\t\t\t},\n\t\t\tcopyFrom\n\t\t}\n\t});\n};\n\nconst createScreen = (\n\tpageInformation,\n\tcomposition,\n\tlayout,\n\tproperties,\n\tpropertyValues,\n\tdispatch,\n\thttpAction\n) => {\n\tconst {\n\t\tapplicability: { appConfigId, screenTypeId },\n\t\tname,\n\t\tscope,\n\t\tsysPolicy,\n\t\torder,\n\t\tscreenCondition,\n\t\tcopyFrom //TODO: add support to copy from a given page sysId in the backend\n\t} = pageInformation;\n\n\tdispatch(httpAction, {\n\t\tpageEndpoint: 'screens',\n\t\tsysparm_transaction_scope: scope,\n\t\tdata: {\n\t\t\tappConfig: appConfigId,\n\t\t\tscreenType: screenTypeId,\n\t\t\tname,\n\t\t\torder,\n\t\t\tscreenCondition,\n\t\t\tisActive: false,\n\t\t\tmacroponentInstance: {\n\t\t\t\tmacroponent: {\n\t\t\t\t\tname,\n\t\t\t\t\tsysPolicy,\n\t\t\t\t\tcomposition,\n\t\t\t\t\tlayout,\n\t\t\t\t\tproperties,\n\t\t\t\t\textendsSysId: SCREEN_TEMPLATE_SYS_ID,\n\t\t\t\t\tcategory: MACROPONENT_CATEGORY\n\t\t\t\t},\n\t\t\t\tpropertyValues\n\t\t\t},\n\t\t\tcopyFrom\n\t\t}\n\t});\n};\n\nconst pageCreateStarted = ({ updateProperties }) =>\n\tupdateProperties({ isSavingPage: true });\n\nconst pageCreateSucceeded = ({\n\taction,\n\tstate,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { dataBrokerDefinitions, eventHandlers, pages } = properties;\n\tconst variantId = get(properties, 'pageState.sysId', '');\n\n\tconst {\n\t\tresult: {\n\t\t\tmacroponentInstance: { rootMacroponentId }\n\t\t}\n\t} = action.payload;\n\n\t// Load component scripts dynamically\n\t// This is async, but shouldn't matter if the scripts are loaded after\n\t// the component tags have been rendered in the html\n\tgetTemplates([rootMacroponentId]);\n\n\tconst pageState = transformMacroponentToPageState(\n\t\taction.payload.result,\n\t\tdataBrokerDefinitions,\n\t\teventHandlers,\n\t\t[], // empty client state params array on new page creation\n\t\tstate,\n\t\tvariantId\n\t);\n\tconst pageStatePristine = cloneDeep(pageState);\n\n\tupdateProperties({\n\t\tisLoadingPage: false,\n\t\tisSavingPage: false,\n\t\tisPageReadOnly: pageState.readOnly && !!pageState.sysPolicy,\n\t\tisPageCopiable: pageState.canCopy,\n\t\tpageState,\n\t\tpageStatePristine,\n\t\tclientScriptsPristine: [],\n\t\tpages: pages.concat({\n\t\t\tname: pageState.name,\n\t\t\tsysId: pageState.sysId,\n\t\t\ttype: pageState.type,\n\t\t\tpageStatus: pageState.pageStatus,\n\t\t\tscope: pageState.scope,\n\t\t\tuiTypeParameters: pageState.uiTypeParameters\n\t\t})\n\t});\n};\n\nconst pageCreateFailed = ({ updateProperties }) => {\n\tupdateProperties({\n\t\tisLoadingPage: false,\n\t\tisSavingPage: false\n\t});\n};\n\nexport {\n\tsetupDefaultProperties,\n\tcreateLandingPage,\n\tcreateScreen,\n\tpageCreateStarted,\n\tpageCreateSucceeded,\n\tpageCreateFailed\n};\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport {\n\tPAGE_CREATE_REQUESTED,\n\tPAGE_CREATE_HTTP_REQUESTED,\n\tPAGE_CREATE_STARTED,\n\tPAGE_CREATE_FAILED,\n\tPAGE_CREATE_SUCCEEDED,\n\tPAGE_DATA_RECEIVED\n} from './pageActions';\n\nimport {\n\tsetupDefaultProperties,\n\tcreateLandingPage,\n\tcreateScreen,\n\tpageCreateStarted,\n\tpageCreateSucceeded,\n\tpageCreateFailed\n} from './pageCreatedUtils';\n\nimport { COMPONENT_LIST_REQUESTED } from '../componentList/componentListActions';\nimport effectProxy from '../helpers/effectProxy';\n\nconst pageCreateRequested = ({ action, dispatch, properties }) => {\n\tconst {\n\t\tapplicability: { screenTypeId }\n\t} = action.payload;\n\n\tconst { pageType } = properties;\n\n\tconst { screenTypes } = properties;\n\tconst { defaultProperties, defaultPropertyValues } = setupDefaultProperties(\n\t\tscreenTypes,\n\t\tscreenTypeId\n\t);\n\n\tswitch (pageType) {\n\t\tcase 'landing-page':\n\t\t\tcreateLandingPage(\n\t\t\t\taction.payload,\n\t\t\t\t[],\n\t\t\t\t{},\n\t\t\t\tdefaultProperties,\n\t\t\t\tdefaultPropertyValues,\n\t\t\t\tdispatch,\n\t\t\t\tPAGE_CREATE_HTTP_REQUESTED\n\t\t\t);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tcreateScreen(\n\t\t\t\taction.payload,\n\t\t\t\t[],\n\t\t\t\t{},\n\t\t\t\tdefaultProperties,\n\t\t\t\tdefaultPropertyValues,\n\t\t\t\tdispatch,\n\t\t\t\tPAGE_CREATE_HTTP_REQUESTED\n\t\t\t);\n\t}\n\n\tdispatch(COMPONENT_LIST_REQUESTED, { pageType });\n\tdispatch(PAGE_DATA_RECEIVED);\n};\n\nexport const pageCreateHttpEffect = createHttpEffect(\n\t'/api/now/uxframework/:pageEndpoint',\n\t{\n\t\tmethod: 'POST',\n\t\tpathParams: ['pageEndpoint'],\n\t\tqueryParams: ['sysparm_transaction_scope'],\n\t\tdataParam: 'data',\n\t\tstartActionType: PAGE_CREATE_STARTED,\n\t\tsuccessActionType: PAGE_CREATE_SUCCEEDED,\n\t\terrorActionType: PAGE_CREATE_FAILED,\n\t\tbatch: false\n\t}\n);\n\nexport default {\n\t[PAGE_CREATE_REQUESTED]: pageCreateRequested,\n\t[PAGE_CREATE_HTTP_REQUESTED]: effectProxy(pageCreateHttpEffect),\n\t[PAGE_CREATE_STARTED]: pageCreateStarted,\n\t[PAGE_CREATE_FAILED]: pageCreateFailed,\n\t[PAGE_CREATE_SUCCEEDED]: pageCreateSucceeded\n};\n","const ENDPOINT_TYPE_MAP = {\n\tlanding: 'ws_landing_pages',\n\t'landing-page': 'ws_landing_pages',\n\tdashboard: 'screens'\n};\n\nconst METADATA_ENDPOINT_TYPE_MAP = {\n\tlanding: 'ws_landing_pages_metadata',\n\t'landing-page': 'ws_landing_pages'\n};\n\nexport default function pageEndpointFromType(type, metadata = false) {\n\treturn metadata\n\t\t? METADATA_ENDPOINT_TYPE_MAP[type] || 'screens'\n\t\t: ENDPOINT_TYPE_MAP[type] || 'screens';\n}\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\n\nimport {\n\tPAGE_DELETE_REQUESTED,\n\tPAGE_DELETE_REQUESTED_HTTP,\n\tPAGE_DELETE_STARTED,\n\tPAGE_DELETE_FAILED,\n\tPAGE_DELETE_SUCCEEDED\n} from './pageActions';\nimport pageEndpointFromType from './utils/pageEndpointFromType';\nimport { throwError } from '../../utils';\n\nconst pageDeletedHandler = ({ state, action, dispatch }) => {\n\tconst {\n\t\tproperties: { pages }\n\t} = state;\n\n\tconst {\n\t\tpayload: { sysId, scope }\n\t} = action;\n\n\tconst pageToDelete = pages.find((page) => page.sysId === sysId);\n\tif (!pageToDelete) {\n\t\tthrowError(`Cannot find requested page ${sysId}`);\n\t}\n\n\tdispatch(PAGE_DELETE_REQUESTED_HTTP, {\n\t\tsysId,\n\t\tsysparm_transaction_scope: scope,\n\t\tpagesEndpoint: pageEndpointFromType(pageToDelete.type)\n\t});\n};\n\nconst pageDeletedHttpHandler = createHttpEffect(\n\t'/api/now/uxframework/:pagesEndpoint/:sysId',\n\t{\n\t\tmethod: 'DELETE',\n\t\tpathParams: ['pagesEndpoint', 'sysId'],\n\t\tqueryParams: ['sysparm_transaction_scope'],\n\t\tstartActionType: PAGE_DELETE_STARTED,\n\t\tsuccessActionType: PAGE_DELETE_SUCCEEDED,\n\t\terrorActionType: PAGE_DELETE_FAILED,\n\t\tbatch: false\n\t}\n);\n\nconst addSysIdToActionMeta = (context) => {\n\tconst { coeffects } = context;\n\tconst { action } = coeffects;\n\tconst { meta } = action;\n\treturn {\n\t\t...context,\n\t\tcoeffects: {\n\t\t\t...coeffects,\n\t\t\taction: {\n\t\t\t\t...action,\n\t\t\t\tmeta: {\n\t\t\t\t\t...meta,\n\t\t\t\t\tdeleteSysId: action.payload.sysId\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n};\n\nconst deletePageRequestStarted = ({ updateProperties }) =>\n\tupdateProperties({ isDeletingPage: true });\n\nconst deletePageRequestSucceeded = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst {\n\t\tmeta: { deleteSysId = '' }\n\t} = action;\n\tconst pages = properties.pages.filter((p) => p.sysId !== deleteSysId);\n\n\tconst updatedProperties = {\n\t\tpages,\n\t\tisDeletingPage: false\n\t};\n\n\tif (\n\t\tproperties.pageMetadata &&\n\t\tdeleteSysId === properties.pageMetadata.sysId\n\t) {\n\t\tupdatedProperties.pageState = null;\n\t\tupdatedProperties.pageStatePristine = null;\n\t\tupdatedProperties.isPageStateDirty = false;\n\t\tupdatedProperties.clientScripts = [];\n\t\tupdatedProperties.clientScriptsPristine = [];\n\t}\n\n\tupdateProperties(updatedProperties);\n};\n\nconst deletePageRequestFailed = ({ updateProperties }) =>\n\tupdateProperties({ isDeletingPage: false }); // TODO: Surface error?\n\nexport default {\n\t[PAGE_DELETE_REQUESTED]: pageDeletedHandler,\n\t[PAGE_DELETE_REQUESTED_HTTP]: {\n\t\t...pageDeletedHttpHandler,\n\t\tinterceptors: [addSysIdToActionMeta]\n\t},\n\t[PAGE_DELETE_STARTED]: deletePageRequestStarted,\n\t[PAGE_DELETE_FAILED]: deletePageRequestFailed,\n\t[PAGE_DELETE_SUCCEEDED]: deletePageRequestSucceeded\n};\n","import { createDataBrokerInstances } from '../../utils';\n\n/**\n * @typedef ClientState\n * @property {Object[]} parentData\n * @property {Object[]} ancestorData\n * @property {Object[]} parentElements\n * @property {Object[]} ancestorElements\n * @property {Object[]} parentProperties\n * @property {Object[]} ancestorProperties\n */\n\n/**\n * @typedef DataBrokerDefinition\n * @property {Object} definition\n * @property {Object} inputParams\n * @property {String} name\n * @property {String} type\n * @property {String} sysId\n * @property {String} description\n * @property {String} hydrationSysId\n * @property {Object} outputSchema\n * @property {Object[]} operations\n * @property {Boolean} simpleMutationBroker\n */\n\n/**\n * @param {ClientState} result\n * @param {DataBrokerDefinition}\n */\n\nconst createDataBrokerInstancesFromContextState = (\n\tresult,\n\tdataBrokerDefinitions\n) => {\n\tconst { ancestorData = [], parentData = [] } = result || {};\n\tconst parentDataBrokerInstances = createDataBrokerInstances(\n\t\tparentData,\n\t\tdataBrokerDefinitions\n\t);\n\tconst grandParentDataBrokerInstances = createDataBrokerInstances(\n\t\tancestorData,\n\t\tdataBrokerDefinitions\n\t);\n\n\treturn {\n\t\tancestorDataBrokerInstances: [\n\t\t\t...parentDataBrokerInstances,\n\t\t\t...grandParentDataBrokerInstances\n\t\t],\n\t\tparentDataBrokerInstances\n\t};\n};\n\nexport default createDataBrokerInstancesFromContextState;\n","function reduceProperties(properties) {\n\tconst { testValues = {}, values = {} } = properties;\n\tconst reducedProperties = Object.entries(testValues).reduce(\n\t\t(acc, [propName, propTestValue]) => ({\n\t\t\t...acc,\n\t\t\t[propName]: propTestValue\n\t\t}),\n\t\t{}\n\t);\n\treturn Object.entries(values).reduce((acc, [propName, propValue]) => {\n\t\treturn {\n\t\t\t...acc,\n\t\t\t[propName]: testValues[propName] || propValue\n\t\t};\n\t}, reducedProperties);\n}\n\nexport default (result) => {\n\tconst { parentProperties = {}, ancestorProperties = {} } = result || {};\n\n\tlet componentBuilderProps = {};\n\ttry {\n\t\tcomponentBuilderProps =\n\t\t\tJSON.parse(window.sessionStorage.getItem('cbProps')) || {};\n\t} catch (_) {\n\t\t// Do nothing\n\t}\n\n\tparentProperties.testValues = {\n\t\t...parentProperties.testValues,\n\t\t...componentBuilderProps\n\t};\n\tancestorProperties.testValues = {\n\t\t...ancestorProperties.testValues,\n\t\t...componentBuilderProps\n\t};\n\tparentProperties.values = {\n\t\t...parentProperties.values,\n\t\t...componentBuilderProps\n\t};\n\tancestorProperties.values = {\n\t\t...ancestorProperties.values,\n\t\t...componentBuilderProps\n\t};\n\n\tconst aggregateProperties = {\n\t\t...ancestorProperties,\n\t\t...parentProperties\n\t};\n\n\treturn {\n\t\tancestorPageProperties: reduceProperties(aggregateProperties),\n\t\tparentPageProperties: reduceProperties(parentProperties)\n\t};\n};\n","function reduceElements(elements) {\n\treturn elements.reduce(\n\t\t(acc, { elementId, elementLabel, propertyValues, macroponentType }) => {\n\t\t\treturn {\n\t\t\t\t...acc,\n\t\t\t\t[elementId]: {\n\t\t\t\t\tlabel: elementLabel,\n\t\t\t\t\tpropertyValues,\n\t\t\t\t\tcategory: macroponentType\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\t{}\n\t);\n}\n\nexport default (result) => {\n\tconst { ancestorElements = [], parentElements = [] } = result || {};\n\n\tconst aggregatedElements = [...ancestorElements, ...parentElements];\n\n\treturn {\n\t\tancestorElements: reduceElements(aggregatedElements),\n\t\tparentElements: reduceElements(parentElements)\n\t};\n};\n","import { createCustomElement } from '@servicenow/ui-core';\n\n/**\n * Function that creates Seismic elements for each ancestor element\n * @param {object} ancestorElements\n * @return {void}\n */\nconst createRuntimeElement = (propertyValues, tagName) => {\n\tcreateCustomElement(tagName, {\n\t\tproperties: Object.keys(propertyValues).reduce((acc, propName) => {\n\t\t\treturn {\n\t\t\t\t...acc,\n\t\t\t\t[propName]: {\n\t\t\t\t\tdefault: null,\n\t\t\t\t\tselectable: true\n\t\t\t\t}\n\t\t\t};\n\t\t}, {})\n\t});\n};\n\n/**\n * Function that generates Seismic elements for an ancestor element for selectable state\n * @param {object} ancestorElements\n * @return {object} Tagnames of all the runtime elementa that were created by elementId\n */\nexport const createAncestorElementsRuntimeElements = (ancestorElements) => {\n\treturn Object.entries(ancestorElements)\n\t\t.map(([elementId, { propertyValues }]) => {\n\t\t\t// Lower case the tagname and remove characters other than alphanumeric, -, and _ to make it seismic-safe\n\t\t\tconst tagName = `ancestor-element-${elementId\n\t\t\t\t.replace(/[^\\w]/g, '')\n\t\t\t\t.toLowerCase()}`;\n\t\t\tcreateRuntimeElement(propertyValues, tagName);\n\t\t\treturn { elementId, tagName };\n\t\t})\n\t\t.reduce((acc, { elementId, tagName }) => {\n\t\t\treturn {\n\t\t\t\t...acc,\n\t\t\t\t[elementId]: tagName\n\t\t\t};\n\t\t}, {});\n};\n","import computeContextDataBrokerInstances from './utils/dataBrokerUtils';\nimport computeContextPageProperties from './utils/pagePropertyUtils';\nimport computeContextElements from './utils/elementUtils';\nimport reduceAppChromeSettings from './utils/appChromeSettingsUtils';\nimport { createDataBrokerRuntimeElement } from '../dataBrokers/dataBrokerFactory';\nimport { createAncestorElementsRuntimeElements } from './ancestorElementFactory';\nimport { getDataBrokerInstances, addAllEventHandlers } from '../utils';\nimport { EventHandler } from '../../models';\nimport { isUxValueModel, getShorthandFromUxValue } from '../../factories';\nimport get from 'lodash/get';\n\nexport default function processContextState({\n\tcontextState = {},\n\tupdateState,\n\tproperties\n}) {\n\tconst { dataBrokerDefinitions } = properties;\n\n\tconst {\n\t\tancestorDataBrokerInstances,\n\t\tparentDataBrokerInstances\n\t} = computeContextDataBrokerInstances(contextState, dataBrokerDefinitions);\n\tconst transformedAncestorDataBrokerInstances = getDataBrokerInstances(\n\t\tancestorDataBrokerInstances\n\t);\n\tconst transformedParentDataBrokerInstances = getDataBrokerInstances(\n\t\tparentDataBrokerInstances\n\t);\n\n\tconst {\n\t\tancestorPageProperties,\n\t\tparentPageProperties\n\t} = computeContextPageProperties(contextState);\n\n\tconst { pageProperties: appChromeSettings } = contextState;\n\tconst transformedAppChromeSettings = reduceAppChromeSettings(\n\t\tappChromeSettings\n\t);\n\n\tconst { ancestorElements, parentElements } = computeContextElements(\n\t\tcontextState\n\t);\n\n\tconst dataBrokerTags = {};\n\tancestorDataBrokerInstances.forEach((dataBrokerInstance) => {\n\t\tif (dataBrokerInstance.definition.type !== 'CLIENT_STATE') {\n\t\t\tdataBrokerTags[dataBrokerInstance.id] = createDataBrokerRuntimeElement(\n\t\t\t\tdataBrokerInstance\n\t\t\t);\n\t\t}\n\t});\n\n\tconst ancestorElementElements = createAncestorElementsRuntimeElements(\n\t\tancestorElements\n\t);\n\n\tupdateState({\n\t\tancestorElementElements\n\t});\n\n\tconst { parentHandledEvents = [], ancestorHandledEvents = [] } = contextState;\n\tconst parentEventHandlers = [\n\t\t...parentHandledEvents,\n\t\t...ancestorHandledEvents\n\t].map((eventHandler) => {\n\t\treturn new EventHandler({\n\t\t\t...eventHandler,\n\t\t\tancestor: true\n\t\t});\n\t});\n\n\tconst allParentEventHandlers = addAllEventHandlers(\n\t\tparentEventHandlers,\n\t\ttrue, // These event handlers are from ancestor contexts\n\t\tancestorDataBrokerInstances,\n\t\tdataBrokerDefinitions\n\t);\n\n\treturn {\n\t\tancestorDataBrokerInstances: transformedAncestorDataBrokerInstances,\n\t\tparentDataBrokerInstances: transformedParentDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tparentPageProperties,\n\t\tancestorElements,\n\t\tparentElements,\n\t\tappChromeSettings: transformedAppChromeSettings,\n\t\tparentEventHandlers: allParentEventHandlers,\n\t\tancestorDataBrokerTags: dataBrokerTags,\n\t\ttheme: contextState.theme,\n\t\tparentInfo: {\n\t\t\t...contextState.parentInfo,\n\t\t\telementProperties: convertToShorthand(\n\t\t\t\tget(contextState, 'parentInfo.elementProperties', {})\n\t\t\t)\n\t\t}\n\t};\n}\n\nexport function convertToShorthand(properties) {\n\tconst shorthand = {};\n\tfor (const prop in properties) {\n\t\tconst propVal = properties[prop];\n\t\tif (isUxValueModel(propVal)) {\n\t\t\tshorthand[prop] = getShorthandFromUxValue(propVal);\n\t\t}\n\t}\n\treturn shorthand;\n}\n","export default function reduceAppChromeSettings(props = []) {\n\treturn props.reduce((acc, prop) => {\n\t\tlet parsedValue;\n\t\ttry {\n\t\t\tparsedValue = JSON.parse(prop.value);\n\t\t} catch (e) {\n\t\t\tparsedValue = prop.value;\n\t\t}\n\t\treturn { ...acc, [prop.name]: parsedValue };\n\t}, {});\n}\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport isEmpty from 'lodash/isEmpty';\nimport {\n\tPAGE_REQUESTED,\n\tPAGE_REQUESTED_STARTED,\n\tPAGE_REQUESTED_HTTP,\n\tPAGE_REQUEST_HTTP_STARTED,\n\tPAGE_REQUEST_HTTP_FAILED,\n\tPAGE_REQUEST_HTTP_SUCCEEDED,\n\tISOLATED_EDIT_MODE_REQUESTED,\n\tISOLATED_EDIT_MODE_REQUEST_SUCCEEDED,\n\tISOLATED_EDIT_MODE_REQUEST_FAILED\n} from './pageActions';\nimport { COMPONENT_LIST_REQUESTED } from '../componentList/componentListActions';\nimport processContextState, {\n\tconvertToShorthand\n} from '../contextState/contextStateProcessor';\nimport pageEndpointFromType from './utils/pageEndpointFromType';\nimport effectProxy from '../helpers/effectProxy';\nimport get from 'lodash/get';\nconst pageRequested = ({ state, dispatch, action }) => {\n\tconst {\n\t\tproperties: { pages }\n\t} = state;\n\tconst {\n\t\tpayload: { sysId, noDomain, isCreatingPage }\n\t} = action;\n\t!isCreatingPage &&\n\t\tdispatch(PAGE_REQUESTED_STARTED, {\n\t\t\tsysId,\n\t\t\tpages,\n\t\t\tnoDomain\n\t\t});\n};\nconst pageRequestedStarted = ({ dispatch, action, properties }) => {\n\tconst {\n\t\tpayload: { sysId, noDomain }\n\t} = action;\n\tdispatch(PAGE_REQUESTED_HTTP, {\n\t\tsysId,\n\t\tpagesEndpoint: pageEndpointFromType(properties.pageType),\n\t\t['sysparm_nodomain']: noDomain\n\t});\n\tdispatch(COMPONENT_LIST_REQUESTED, {\n\t\tpageType: properties.pageType\n\t});\n};\nexport const pageRequestedHttp = createHttpEffect(\n\t'/api/now/uxframework/:pagesEndpoint/:sysId',\n\t{\n\t\tmethod: 'GET',\n\t\tpathParams: ['pagesEndpoint', 'sysId'],\n\t\tqueryParams: ['sysparm_transaction_scope', 'sysparm_nodomain'],\n\t\tstartActionType: PAGE_REQUEST_HTTP_STARTED,\n\t\tsuccessActionType: PAGE_REQUEST_HTTP_SUCCEEDED,\n\t\terrorActionType: PAGE_REQUEST_HTTP_FAILED,\n\t\tbatch: false\n\t}\n);\nconst pageRequestStarted = ({ updateProperties }) =>\n\tupdateProperties({ isLoadingPage: true });\nconst isolatedEditModeRequested = createHttpEffect(\n\t`/api/now/builder/viewports/parent/:parentScreenId/info/:parentElementId`,\n\t{\n\t\tmethod: 'GET',\n\t\tpathParams: ['parentScreenId', 'parentElementId'],\n\t\tsuccessActionType: ISOLATED_EDIT_MODE_REQUEST_SUCCEEDED,\n\t\terrorActionType: ISOLATED_EDIT_MODE_REQUEST_FAILED,\n\t\tbatch: false\n\t}\n);\nconst isolatedEditModeRequestSucceeded = ({\n\taction: {\n\t\tpayload: {\n\t\t\tresult: { parentData, parentInfo }\n\t\t}\n\t},\n\tproperties,\n\tupdateState,\n\tupdateProperties,\n\tdispatch,\n\tstate\n}) => {\n\tconst { dataBrokerDefinitions } = properties;\n\tconst elementProperties = get(parentInfo, 'elementProperties', {});\n\tif (dataBrokerDefinitions && !isEmpty(parentData)) {\n\t\tconst propsToUpdate = processContextState({\n\t\t\tcontextState: { parentData, parentInfo },\n\t\t\tupdateState,\n\t\t\tproperties\n\t\t});\n\t\tupdateProperties(propsToUpdate);\n\t\tupdateState({\n\t\t\tdataBrokerElements: {\n\t\t\t\t...state.dataBrokerElements,\n\t\t\t\t...propsToUpdate.ancestorDataBrokerTags,\n\t\t\t\t...propsToUpdate.dataBrokerTags\n\t\t\t}\n\t\t});\n\t} else {\n\t\tupdateProperties({\n\t\t\tparentInfo: {\n\t\t\t\t...parentInfo,\n\t\t\t\telementProperties: convertToShorthand(elementProperties)\n\t\t\t}\n\t\t});\n\t}\n\tdispatch('UIB_APP#RESET_ROUTE_STATUS', {}, { parentData });\n};\nexport default {\n\t[PAGE_REQUESTED]: pageRequested,\n\t[PAGE_REQUESTED_STARTED]: pageRequestedStarted,\n\t[PAGE_REQUESTED_HTTP]: effectProxy(pageRequestedHttp),\n\t[PAGE_REQUEST_HTTP_STARTED]: pageRequestStarted,\n\t[ISOLATED_EDIT_MODE_REQUESTED]: isolatedEditModeRequested,\n\t[ISOLATED_EDIT_MODE_REQUEST_SUCCEEDED]: isolatedEditModeRequestSucceeded\n};\n","import { Slot } from '../../../models';\nimport cuid from 'cuid';\nimport isEmpty from 'lodash/isEmpty';\nimport flatMap from 'lodash/flatMap';\n\nconst childrenKey = (type) => (type === 'row' ? 'columns' : 'rows');\n\nexport function createSimpleLayout(element) {\n\tconst generatedSlotNames = element.children.reduce((acc, cur) => {\n\t\tacc[cur.id] = cuid();\n\t\treturn acc;\n\t}, {});\n\n\telement.children.forEach((child) => {\n\t\tchild.slot = new Slot({\n\t\t\tname: generatedSlotNames[child.id],\n\t\t\tparentElement: element\n\t\t});\n\t});\n\n\tconst newLayout = {\n\t\tdefault: {\n\t\t\ttype: 'rowColumn',\n\t\t\troot: {\n\t\t\t\tid: cuid(),\n\t\t\t\ttype: 'column',\n\t\t\t\tsize: 12,\n\t\t\t\trows: element.children.map((child) => ({\n\t\t\t\t\ttype: 'row',\n\t\t\t\t\tid: cuid(),\n\t\t\t\t\tslotName: generatedSlotNames[child.id]\n\t\t\t\t}))\n\t\t\t}\n\t\t}\n\t};\n\n\telement.layout = newLayout;\n}\n\nexport function createSlotsForEveryElement(\n\tlayout,\n\tslottedElements,\n\tinjectedCuid = cuid\n) {\n\tconst claimedSlotNames = {};\n\n\tconst checkNode = (layoutElement) => {\n\t\tif (!layoutElement.slotName) {\n\t\t\tconst childrenType = childrenKey(layoutElement.type);\n\t\t\tif (!layoutElement[childrenType]) {\n\t\t\t\treturn [layoutElement];\n\t\t\t}\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\t...layoutElement,\n\t\t\t\t\t[childrenType]: flatMap(layoutElement[childrenType], checkNode)\n\t\t\t\t}\n\t\t\t];\n\t\t}\n\n\t\tconst slotName = layoutElement.slotName;\n\t\tconst elementsInSlot = slottedElements.filter(\n\t\t\t(slottedElement) => slottedElement.slotName === slotName\n\t\t);\n\t\tif (elementsInSlot.length <= 1) {\n\t\t\treturn [layoutElement];\n\t\t}\n\n\t\tif (layoutElement.type === 'row') {\n\t\t\treturn elementsInSlot.map((elementInSlot) => {\n\t\t\t\tconst newSlotName = injectedCuid();\n\t\t\t\tclaimedSlotNames[elementInSlot.elementId] = newSlotName;\n\t\t\t\treturn {\n\t\t\t\t\ttype: 'row',\n\t\t\t\t\tid: injectedCuid(),\n\t\t\t\t\tslotName: newSlotName\n\t\t\t\t};\n\t\t\t});\n\t\t} else {\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttype: 'column',\n\t\t\t\t\tsize: layoutElement.size,\n\t\t\t\t\tdivider: layoutElement.divider,\n\t\t\t\t\tid: layoutElement.id,\n\t\t\t\t\trows: elementsInSlot.map((elementInSlot) => {\n\t\t\t\t\t\tconst newSlotName = injectedCuid();\n\t\t\t\t\t\tclaimedSlotNames[elementInSlot.elementId] = newSlotName;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttype: 'row',\n\t\t\t\t\t\t\tid: injectedCuid(),\n\t\t\t\t\t\t\tslotName: newSlotName\n\t\t\t\t\t\t};\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t];\n\t\t}\n\t};\n\n\tlet newLayoutRoot;\n\ttry {\n\t\tnewLayoutRoot = checkNode(layout.default.root)[0];\n\t} catch (e) {\n\t\treturn {\n\t\t\tfixedLayout: null,\n\t\t\tconvertedSlotNames: {}\n\t\t};\n\t}\n\n\tif (isEmpty(claimedSlotNames)) {\n\t\treturn {\n\t\t\tfixedLayout: null,\n\t\t\tconvertedSlotNames: {}\n\t\t};\n\t} else {\n\t\tconst rootChildren = newLayoutRoot[childrenKey(newLayoutRoot.type)] || [];\n\t\treturn {\n\t\t\tnewLayoutRoot:\n\t\t\t\trootChildren.length !== 1 ? newLayoutRoot : rootChildren[0],\n\t\t\tconvertedSlotNames: claimedSlotNames\n\t\t};\n\t}\n}\n","import ClientScript from '../../models/clientScript';\nimport cloneDeep from 'lodash/cloneDeep';\nimport flatMap from 'lodash/flatMap';\nimport get from 'lodash/get';\nimport { getTemplates } from '@devsnc/library-uxf';\nimport { Element, Slot } from '../../models';\nimport createPageState from '../../models/createPageState';\nimport processContextState from '../contextState/contextStateProcessor';\nimport { createDataBrokerRuntimeElement } from '../dataBrokers/dataBrokerFactory';\n\nimport {\n\tcreateSimpleLayout,\n\tcreateSlotsForEveryElement\n} from '../element/utils/layoutMigration';\nimport transformMacroponentToPageState from './utils/transformMacroponentToPageState';\nimport {\n\tPAGE_COMPONENTS_REQUESTED,\n\tPAGE_REQUEST_HTTP_SUCCEEDED,\n\tPAGE_DATA_RECEIVED\n} from './pageActions';\nimport { throwError, seismicCuid } from '../../utils';\nimport { getEventHandlersFromRootMacroponent } from '../utils';\n\nimport { COMPONENT_SOURCES_REQUESTED } from '../componentSources/componentSourcesActions';\n\nfunction addIdsToLayoutElement(layoutElement) {\n\tlayoutElement.id = layoutElement.id || seismicCuid();\n\n\tif (layoutElement.slotName) {\n\t\treturn;\n\t}\n\n\tconst childAccessor = layoutElement.type === 'row' ? 'columns' : 'rows';\n\n\tfor (const childLayoutElement of layoutElement[childAccessor]) {\n\t\taddIdsToLayoutElement(childLayoutElement);\n\t}\n}\n\nexport const addIdsToLayout = (layout) => {\n\tif (layout && layout.default) {\n\t\tconst { root } = layout.default;\n\n\t\taddIdsToLayoutElement(root);\n\t}\n};\n\nfunction findElements(element, callback) {\n\tif (typeof callback !== 'function') {\n\t\tthrowError('Callback must be a function', TypeError);\n\t}\n\n\tconst matchingElements = [];\n\tif (callback.call(null, element)) {\n\t\tmatchingElements.push(element);\n\t}\n\n\treturn matchingElements.concat(\n\t\tflatMap(element.children, (child) => findElements(child, callback))\n\t);\n}\n\nconst elementsWithOrphanedElements = (element) => {\n\tconst hasNoLayout = element.layout && !element.layout.default;\n\tconst hasChildren = element.children && element.children.length > 0;\n\tconst hasNoNamedSlots =\n\t\t(get(element, 'component.slots') || []).filter(\n\t\t\t(name) => name !== '@default'\n\t\t).length === 0;\n\treturn hasNoLayout && hasChildren && hasNoNamedSlots;\n};\n\nconst pageRequestSucceeded = async ({\n\taction,\n\tdispatch,\n\tstate,\n\tproperties,\n\tupdateProperties,\n\tupdateState\n}) => {\n\tconst { dataBrokerDefinitions } = properties;\n\n\tconst {\n\t\tresult: {\n\t\t\tmacroponentInstance: {\n\t\t\t\trootMacroponentId,\n\t\t\t\tcomponentDefinitions,\n\t\t\t\tmacroponentDefinitions,\n\t\t\t\tclientScripts = []\n\t\t\t},\n\t\t\tcontextState\n\t\t}\n\t} = action.payload;\n\tdispatch(COMPONENT_SOURCES_REQUESTED, {\n\t\tpageComponents: Object.values(componentDefinitions)\n\t});\n\n\tconst clientScriptsToUpdate = clientScripts.map(\n\t\t(script) => new ClientScript(script)\n\t);\n\n\tconst mcpEventHandlers = getEventHandlersFromRootMacroponent(\n\t\tmacroponentDefinitions,\n\t\trootMacroponentId\n\t);\n\n\tconst {\n\t\tancestorDataBrokerInstances,\n\t\tparentDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tparentPageProperties,\n\t\tancestorElements,\n\t\tparentElements,\n\t\tparentEventHandlers,\n\t\tappChromeSettings,\n\t\tancestorDataBrokerTags,\n\t\ttheme,\n\t\tparentInfo\n\t} = processContextState({\n\t\tcontextState,\n\t\tupdateState,\n\t\tproperties\n\t});\n\n\tconst allEventHandlers = [...parentEventHandlers, ...mcpEventHandlers];\n\n\tconst variantId = get(properties, 'pageState.sysId', null);\n\n\tconst pageState = transformMacroponentToPageState(\n\t\taction.payload.result,\n\t\tdataBrokerDefinitions,\n\t\tallEventHandlers,\n\t\t[], // empty array for clientStateParameters on a fresh page request\n\t\tstate,\n\t\tvariantId\n\t);\n\n\tconst { dataBrokerInstances } = pageState;\n\n\tif (pageState.dataBrokersEnabled) {\n\t\t// create data broker runtime elements.\n\t\tconst dataBrokerTags = {};\n\t\tdataBrokerInstances.forEach((dataBrokerInstance) => {\n\t\t\tif (dataBrokerInstance.definition.type !== 'CLIENT_STATE') {\n\t\t\t\tdataBrokerTags[dataBrokerInstance.id] = createDataBrokerRuntimeElement(\n\t\t\t\t\tdataBrokerInstance\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\tupdateState({\n\t\t\tdataBrokerElements: {\n\t\t\t\t...state.dataBrokerElements,\n\t\t\t\t...ancestorDataBrokerTags,\n\t\t\t\t...dataBrokerTags\n\t\t\t}\n\t\t});\n\t}\n\n\tawait getTemplates([rootMacroponentId]);\n\n\tdispatch(PAGE_COMPONENTS_REQUESTED);\n\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst elementsWithLayout = findElements(\n\t\tnewRootElement,\n\t\t(elem) => elem.layout\n\t);\n\n\telementsWithLayout.forEach((element) => {\n\t\tif (get(element.layout, 'default.root', null)) {\n\t\t\taddIdsToLayout(element.layout);\n\t\t\tconst elementsInLayout = element.children.map((child) => ({\n\t\t\t\telementId: child.id,\n\t\t\t\tslotName: child.slot && child.slot.name\n\t\t\t}));\n\t\t\tconst { newLayoutRoot, convertedSlotNames } = createSlotsForEveryElement(\n\t\t\t\telement.layout,\n\t\t\t\telementsInLayout\n\t\t\t);\n\t\t\tif (newLayoutRoot) {\n\t\t\t\telement.layout.default.root = newLayoutRoot;\n\t\t\t\telement.children.forEach((child) => {\n\t\t\t\t\tif (convertedSlotNames[child.id]) {\n\t\t\t\t\t\tchild.slot = new Slot({\n\t\t\t\t\t\t\tname: convertedSlotNames[child.id],\n\t\t\t\t\t\t\tparentElement: element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telement.layout;\n\t});\n\n\tconst elementsWithoutLayouts = findElements(\n\t\tnewRootElement,\n\t\telementsWithOrphanedElements\n\t);\n\telementsWithoutLayouts.forEach(createSimpleLayout);\n\n\tconst newPageState = createPageState(\n\t\t{\n\t\t\trootElement: new Element(newRootElement)\n\t\t},\n\t\tpageState\n\t);\n\n\tupdateProperties({\n\t\tdataBrokerInstances: newPageState.dataBrokerInstances,\n\t\tscreenEventMappings: [],\n\t\tancestorDataBrokerInstances,\n\t\tparentDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tparentPageProperties,\n\t\tancestorElements,\n\t\tappChromeSettings,\n\t\tparentElements,\n\t\tisLoadingPage: false,\n\t\tisPageReadOnly: pageState.readOnly && !!pageState.sysPolicy,\n\t\tisPageCopiable: pageState.canCopy,\n\t\tpageState: newPageState,\n\t\tpageStatePristine: cloneDeep(newPageState),\n\t\tclientScripts: clientScriptsToUpdate,\n\t\tclientScriptsPristine: cloneDeep(clientScriptsToUpdate),\n\t\ttheme,\n\t\tparentInfo\n\t});\n\tdispatch(PAGE_DATA_RECEIVED);\n};\n\nexport default {\n\t[PAGE_REQUEST_HTTP_SUCCEEDED]: pageRequestSucceeded\n};\n","export const COMPONENT_SOURCES_REQUESTED = 'SN_UXF#COMPONENT_SOURCES_REQUESTED';\n","import cloneDeep from 'lodash/cloneDeep';\nimport {\n\tgetNewRootElementAndElementToUpdate,\n\tgetInvalidEventMappingTargets,\n\tformatEventNameAndLabel\n} from '../../elementEventMappings/utils';\nimport createPageState from '../../../models/createPageState';\nimport { EVENT, DATABROKER_OP } from '../../elementEventMappings/constants';\n\nexport default function convertAncestorEventMappingsToRelays(pageState) {\n\tlet updatedPageState = cloneDeep(pageState);\n\tconst {\n\t\trootElement,\n\t\teventHandlers = [],\n\t\tscreenEventMappings = [],\n\t\tdataBrokerInstances = []\n\t} = updatedPageState;\n\tconst parentEventHandlers = eventHandlers.filter(\n\t\t(handler) => handler.ancestor === true\n\t);\n\tconst invalidEventMappingTargets = getInvalidEventMappingTargets(\n\t\trootElement,\n\t\tparentEventHandlers,\n\t\tdataBrokerInstances\n\t);\n\n\tfor (const invalidTarget of invalidEventMappingTargets) {\n\t\tlet eventMappingToUpdate = null;\n\t\tconst {\n\t\t\tnewRootElement,\n\t\t\telementToUpdate\n\t\t} = getNewRootElementAndElementToUpdate(\n\t\t\tupdatedPageState,\n\t\t\tinvalidTarget.elementId || null\n\t\t);\n\n\t\tif (invalidTarget.elementId) {\n\t\t\teventMappingToUpdate = elementToUpdate.eventMappings.find(\n\t\t\t\t(eventMapping) =>\n\t\t\t\t\teventMapping.eventMappingId === invalidTarget.eventMappingId\n\t\t\t);\n\t\t} else if (invalidTarget.dataBrokerId) {\n\t\t\tconst dataBrokerInstanceToUpdate =\n\t\t\t\tdataBrokerInstances.find(\n\t\t\t\t\t(dataBrokerInstance) =>\n\t\t\t\t\t\tdataBrokerInstance.id === invalidTarget.dataBrokerId\n\t\t\t\t) || {};\n\t\t\tconst { eventMappings = [] } = dataBrokerInstanceToUpdate;\n\t\t\teventMappingToUpdate = eventMappings.find(\n\t\t\t\t(eventMapping) =>\n\t\t\t\t\teventMapping.eventMappingId === invalidTarget.eventMappingId\n\t\t\t);\n\t\t} else if (invalidTarget.rootElementId) {\n\t\t\teventMappingToUpdate = newRootElement.internalEventMappings.find(\n\t\t\t\t(internalEventMapping) =>\n\t\t\t\t\tinternalEventMapping.eventMappingId === invalidTarget.eventMappingId\n\t\t\t);\n\t\t}\n\n\t\tif (eventMappingToUpdate) {\n\t\t\tconst eventMappingTargetToUpdate = eventMappingToUpdate.targets.find(\n\t\t\t\t(target) => target.targetId === invalidTarget.target.targetId\n\t\t\t);\n\n\t\t\tconst { name } = formatEventNameAndLabel(\n\t\t\t\tinvalidTarget.parentEventHandler,\n\t\t\t\tnewRootElement.id\n\t\t\t);\n\t\t\tconst relayMapping = screenEventMappings.find((mapping) => {\n\t\t\t\tconst [, eventName] = mapping.eventApiName.split('.');\n\t\t\t\treturn eventName === name;\n\t\t\t});\n\n\t\t\tif (eventMappingTargetToUpdate && relayMapping) {\n\t\t\t\tconst relayTarget = relayMapping.targets[0] || {};\n\t\t\t\teventMappingTargetToUpdate.type = EVENT;\n\t\t\t\tif (relayTarget.type === DATABROKER_OP) {\n\t\t\t\t\teventMappingTargetToUpdate.event = {};\n\t\t\t\t\teventMappingTargetToUpdate.event.payload =\n\t\t\t\t\t\tinvalidTarget.target.operation.payload;\n\t\t\t\t\teventMappingTargetToUpdate.operation = null;\n\t\t\t\t}\n\t\t\t\teventMappingTargetToUpdate.event.sysId = relayMapping.eventId;\n\t\t\t\teventMappingTargetToUpdate.event.apiName = relayMapping.eventApiName;\n\t\t\t}\n\t\t}\n\t\tupdatedPageState = createPageState(\n\t\t\t{\n\t\t\t\trootElement: newRootElement\n\t\t\t},\n\t\t\tupdatedPageState\n\t\t);\n\t}\n\treturn updatedPageState;\n}\n","import isNil from 'lodash/isNil';\nimport get from 'lodash/get';\nimport cloneDeep from 'lodash/cloneDeep';\nimport set from 'lodash/set';\nimport omit from 'lodash/omit';\nimport { getIsActive } from './pageStatus';\nimport { computeEventMappingTargetKeys } from './shared';\nimport {\n\tgetUxValueFromShorthand,\n\tisUxValueModel,\n\tgetShorthandFromUxValue,\n\tgetVersionedUxValueFromShorthand\n} from '../../../factories';\nimport { DATABROKER_OP, EVENT } from '../../elementEventMappings/constants';\nimport isEmpty from 'lodash/isEmpty';\nimport {\n\tACTIVE_ROUTE,\n\tVIEWPORT_ROUTES,\n\tACTIVE_SCREEN,\n\tREPEATED_VIEWPORT_TAB_DATA,\n\tVIEWPORT_NOW_ID\n} from '../../element/reservedPropertyIds';\nimport convertAncestorEventMappingsToRelays from './convertAncestorEventMappingsToRelays';\nimport {\n\tBINDING_SHORTHAND_PATTERN,\n\tSCRIPT_SHORTHAND_PATTERN\n} from '../../../factories/constants';\n\nconst isLegacy = (pageStateType) => pageStateType === 'landing';\n\nconst getIsHiddenValue = async (isHiddenValue) => {\n\tif (isUxValueModel(isHiddenValue)) {\n\t\treturn isHiddenValue;\n\t}\n\treturn await getVersionedUxValueFromShorthand(isHiddenValue);\n};\n\nconst isValidBindingShorthand = (str) => {\n\treturn typeof str === 'string' && !!str.match(BINDING_SHORTHAND_PATTERN);\n};\n\nconst isScriptedTransform = (str) => {\n\treturn typeof str === 'string' && !!str.match(SCRIPT_SHORTHAND_PATTERN);\n};\n\nconst transformToNodeProperties = (properties, isLegacyPageState) => {\n\treturn Object.keys(properties).reduce((acc, cur) => {\n\t\tif (properties[cur].type === 'json') {\n\t\t\tlet value;\n\t\t\ttry {\n\t\t\t\tvalue = JSON.parse(properties[cur].value);\n\t\t\t} catch (e) {\n\t\t\t\tvalue = properties[cur].value;\n\t\t\t}\n\n\t\t\tacc[cur] = value;\n\t\t} else {\n\t\t\tlet value = get(properties[cur], 'value', '');\n\t\t\tif (\n\t\t\t\tvalue &&\n\t\t\t\t!isLegacyPageState &&\n\t\t\t\t!isValidBindingShorthand(value) &&\n\t\t\t\t!isScriptedTransform(value) &&\n\t\t\t\tget(properties[cur], 'translatable')\n\t\t\t) {\n\t\t\t\tvalue = `translate(${value})`;\n\t\t\t}\n\t\t\tacc[cur] = value;\n\t\t}\n\t\treturn acc;\n\t}, {});\n};\n\nexport const transformEventMappings = async (\n\teventMappings,\n\tisLegacyPageState\n) => {\n\tconst newEventMappings = [];\n\tfor (const { eventMappingId, eventApiName, targets } of eventMappings) {\n\t\tconst transformedTargets = [];\n\t\tfor (const target of targets) {\n\t\t\tconst {\n\t\t\t\ttargetKey,\n\t\t\t\tvalueKey,\n\t\t\t\tidKey,\n\t\t\t\tnonTargetKeys\n\t\t\t} = computeEventMappingTargetKeys(target.type);\n\n\t\t\tif (!targetKey) {\n\t\t\t\ttransformedTargets.push({ ...target, type: 'EVENT' });\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst eventMappingTargetValues = get(\n\t\t\t\ttarget,\n\t\t\t\t`${targetKey}.${valueKey}`,\n\t\t\t\t[]\n\t\t\t);\n\n\t\t\tconst targetValuesMap = eventMappingTargetValues.reduce((acc, cur) => {\n\t\t\t\tacc[cur.columnName] = cur;\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\n\t\t\tconst targetValues = transformToNodeProperties(\n\t\t\t\ttargetValuesMap,\n\t\t\t\tisLegacyPageState\n\t\t\t);\n\t\t\tconst targetIsScripted = !!target.clientTransformScript;\n\t\t\tconst noTargetValuesExist = Object.values(targetValues).every(\n\t\t\t\t(val) => !val\n\t\t\t);\n\n\t\t\tconst targetUxValues = await getVersionedUxValueFromShorthand(\n\t\t\t\tnoTargetValuesExist && targetIsScripted\n\t\t\t\t\t? target.clientTransformScript\n\t\t\t\t\t: targetValues\n\t\t\t);\n\n\t\t\tconst transformedEventMappingTarget = {\n\t\t\t\t...target,\n\t\t\t\t[targetKey]: {\n\t\t\t\t\t[idKey]: target[targetKey][idKey],\n\t\t\t\t\t[valueKey]: targetUxValues\n\t\t\t\t},\n\t\t\t\t...nonTargetKeys.reduce((acc, key) => {\n\t\t\t\t\treturn { ...acc, [key]: null };\n\t\t\t\t}, {})\n\t\t\t};\n\n\t\t\tif (target.type === EVENT) {\n\t\t\t\ttransformedEventMappingTarget[targetKey].apiName = target.event.apiName;\n\t\t\t}\n\n\t\t\tif (target.type === DATABROKER_OP) {\n\t\t\t\ttransformedEventMappingTarget[targetKey].operationName =\n\t\t\t\t\ttarget.operation.operationName;\n\t\t\t\ttransformedEventMappingTarget[targetKey].parentResourceId =\n\t\t\t\t\ttarget.operation.parentResourceId;\n\t\t\t}\n\n\t\t\ttransformedTargets.push(transformedEventMappingTarget);\n\t\t}\n\n\t\tnewEventMappings.push({\n\t\t\teventMappingId,\n\t\t\tsourceEventApiName: eventApiName,\n\t\t\ttargets: transformedTargets\n\t\t});\n\t}\n\treturn newEventMappings;\n};\n\nexport const getOverrides = (pageStateType) => async (layout, children) => {\n\tconst hasLayout = layout && layout.default;\n\tconst hasChildren = children && children.length > 0;\n\tif (!hasLayout && !hasChildren) {\n\t\treturn;\n\t}\n\n\tconst composition = [];\n\tif (Array.isArray(children)) {\n\t\tfor (const child of children) {\n\t\t\tcomposition.push(\n\t\t\t\tawait createCompositionNodeFromElement(pageStateType)(child)\n\t\t\t);\n\t\t}\n\t}\n\n\treturn {\n\t\tlayout,\n\t\tcomposition\n\t};\n};\n\nconst createCompositionNodeFromElement = (pageStateType) => async (element) => {\n\tconst {\n\t\tid,\n\t\tinstanceName,\n\t\tslot,\n\t\tcomponent,\n\t\tproperties,\n\t\teventMappings,\n\t\tstyles,\n\t\tchildren,\n\t\tlayout,\n\t\tisHidden\n\t} = element;\n\n\tconst definition = {\n\t\ttype: component.type,\n\t\tid: component.id\n\t};\n\n\tconst isLegacyPageState = isLegacy(pageStateType);\n\n\tconst nodeProperties = Object.entries(\n\t\ttransformToNodeProperties(properties, isLegacyPageState)\n\t);\n\n\tconst propertyValues = {};\n\tfor (const [propertyName, propertyValue] of nodeProperties) {\n\t\tpropertyValues[propertyName] = isLegacyPageState\n\t\t\t? propertyValue\n\t\t\t: await getVersionedUxValueFromShorthand(\n\t\t\t\t\tpropertyValue,\n\t\t\t\t\tproperties[propertyName].schema\n\t\t\t  );\n\t}\n\n\tconst transformedEventMappings =\n\t\teventMappings &&\n\t\t(await transformEventMappings(eventMappings, isLegacyPageState));\n\n\tconst isHiddenValue = await getIsHiddenValue(isHidden);\n\n\tconst compositionNode = {\n\t\telementId: id,\n\t\telementLabel: instanceName,\n\t\tslot: slot && slot.name,\n\t\tdefinition,\n\t\tstyles,\n\t\tpropertyValues,\n\t\teventMappings: transformedEventMappings\n\t};\n\n\tif (!isLegacy(pageStateType)) {\n\t\tcompositionNode.isHidden = isHiddenValue;\n\t}\n\n\tconst overrides = await getOverrides(pageStateType)(layout, children);\n\tif (overrides) {\n\t\tcompositionNode.overrides = overrides;\n\t}\n\n\treturn compositionNode;\n};\n\nconst createMacroponentFromElement = (pageStateType) => async (\n\telement,\n\tdataBrokerInstances,\n\tclientStateParameters,\n\tdispatchedEvents,\n\thandledEvents\n) => {\n\tconst {\n\t\tinstanceName: name,\n\t\tid,\n\t\tlayout,\n\t\tchildren,\n\t\textendsSysId,\n\t\tmacroponentProperties\n\t} = element;\n\n\tconst composition = [];\n\n\tfor (const child of children) {\n\t\tcomposition.push(\n\t\t\tawait createCompositionNodeFromElement(pageStateType)(child)\n\t\t);\n\t}\n\n\tconst isLegacyPageState = isLegacy(pageStateType);\n\n\tconst data = [];\n\tfor (const dataBrokerInstance of dataBrokerInstances) {\n\t\tconst newInstance = {\n\t\t\telementId: dataBrokerInstance.id,\n\t\t\telementLabel: dataBrokerInstance.instanceName,\n\t\t\treadEvaluationMode: dataBrokerInstance.readEvaluationMode || 'EAGER',\n\t\t\tdefinition: omit(dataBrokerInstance.definition, 'invalid'),\n\t\t\tinputValues: Object.entries(\n\t\t\t\ttransformToNodeProperties(\n\t\t\t\t\tdataBrokerInstance.properties,\n\t\t\t\t\tisLegacyPageState\n\t\t\t\t)\n\t\t\t).reduce((acc, [propertyName, propertyValue]) => {\n\t\t\t\treturn {\n\t\t\t\t\t...acc,\n\t\t\t\t\t[propertyName]: isLegacy(pageStateType)\n\t\t\t\t\t\t? propertyValue\n\t\t\t\t\t\t: getUxValueFromShorthand(propertyValue)\n\t\t\t\t};\n\t\t\t}, {}),\n\t\t\teventMappings: await transformEventMappings(\n\t\t\t\tdataBrokerInstance.eventMappings\n\t\t\t)\n\t\t};\n\t\tdata.push(newInstance);\n\t}\n\n\tconst stateProperties = clientStateParameters.map((param) => {\n\t\tlet value = param.initialValue;\n\t\tif (param.type === 'json') {\n\t\t\ttry {\n\t\t\t\tvalue = JSON.parse(param.initialValue);\n\t\t\t} catch (e) {\n\t\t\t\tvalue = param.initialValue;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tname: param.name,\n\t\t\tlabel: param.name,\n\t\t\tfieldType: param.type,\n\t\t\tvalueType: param.type,\n\t\t\tinitialValue: getUxValueFromShorthand(value),\n\t\t\tdescription: '',\n\t\t\tshape: ''\n\t\t};\n\t});\n\n\treturn {\n\t\tcomposition,\n\t\tdata,\n\t\textendsSysId,\n\t\tid,\n\t\tlayout,\n\t\tname,\n\t\trootElement: {}, // TODO\n\t\tproperties: macroponentProperties.filter(\n\t\t\t(prop) => prop.inherited === false\n\t\t),\n\t\tstateProperties,\n\t\tdispatchedEvents,\n\t\thandledEvents\n\t};\n};\n\nconst getTabsFromComposition = (elComposition) => {\n\tconst propsUxValueModel = get(elComposition, 'propertyValues.tabs', null);\n\tlet tabs = null;\n\n\tif (isUxValueModel(propsUxValueModel)) {\n\t\tconst shortHandVal = getShorthandFromUxValue(propsUxValueModel);\n\t\ttabs = isEmpty(shortHandVal) ? null : shortHandVal;\n\t}\n\n\treturn tabs;\n};\n\nconst removeViewportsTransientPropertiesFromComposition = (\n\tcomposition,\n\tmcp,\n\tviewportElementIds\n) => {\n\treturn composition.map((elComposition) => {\n\t\tconst { overrides } = elComposition;\n\n\t\tif (\n\t\t\tviewportElementIds.includes(elComposition.elementId) &&\n\t\t\tgetTabsFromComposition(elComposition) === null\n\t\t) {\n\t\t\t// these are all transient properties that\n\t\t\t// should not be saved back into the composition\n\t\t\t// of any viewport element\n\n\t\t\tdelete elComposition.propertyValues[VIEWPORT_ROUTES];\n\t\t\tdelete elComposition.propertyValues[ACTIVE_ROUTE];\n\t\t\tdelete elComposition.propertyValues[ACTIVE_SCREEN];\n\t\t\tdelete elComposition.propertyValues[REPEATED_VIEWPORT_TAB_DATA];\n\t\t\t// supporting tabset backward compatibility\n\t\t\tdelete elComposition.propertyValues[VIEWPORT_NOW_ID];\n\t\t} else if (!isEmpty(overrides) && !isEmpty(overrides.composition)) {\n\t\t\t/*\n\t\t\t\tElements such have containers can be made parents of any element\n\t\t\t\tand that would require us to recursively check the overrides\n\t\t\t\tand invoke this method\n\t\t\t */\n\t\t\tconst { composition } = overrides;\n\t\t\telComposition.overrides.composition = removeViewportsTransientPropertiesFromComposition(\n\t\t\t\tcomposition,\n\t\t\t\tmcp,\n\t\t\t\tviewportElementIds\n\t\t\t);\n\t\t}\n\t\treturn elComposition;\n\t});\n};\n\nexport const removeViewportsTransientProperties = (\n\tmacroponentInstance,\n\tviewportElementIds = {}\n) => {\n\tconst mcp = cloneDeep(macroponentInstance);\n\n\tconst topLevelComposition = removeViewportsTransientPropertiesFromComposition(\n\t\tget(mcp, 'macroponentInstance.macroponent.composition', []),\n\t\tmcp,\n\t\tviewportElementIds\n\t);\n\n\tset(mcp, 'macroponentInstance.macroponent.composition', topLevelComposition);\n\n\treturn mcp;\n};\n\nexport const createMacroponentInstanceFromElement = (pageStateType) => async (\n\telement,\n\tdataBrokerInstances,\n\tclientStateParameters,\n\tdispatchedEvents,\n\thandledEvents,\n\tscreenEventMappings = [],\n\tinternalEventMappings = []\n) => {\n\tconst { macroponentProperties } = element;\n\n\tconst macroponent = await createMacroponentFromElement(pageStateType)(\n\t\telement,\n\t\tdataBrokerInstances,\n\t\tclientStateParameters,\n\t\tdispatchedEvents,\n\t\thandledEvents\n\t);\n\n\tconst transformedScreenEventMappings = await transformEventMappings(\n\t\tscreenEventMappings\n\t);\n\n\tconst transformInternalEventMappings = async (mappings) => {\n\t\tconst transformedMappings = await transformEventMappings(mappings);\n\t\treturn transformedMappings.reduce((acc, mapping) => {\n\t\t\tif (!acc[mapping.sourceEventApiName]) {\n\t\t\t\tacc[mapping.sourceEventApiName] = mapping.targets || [];\n\t\t\t} else {\n\t\t\t\tacc[mapping.sourceEventApiName] = [\n\t\t\t\t\t...acc[mapping.sourceEventApiName],\n\t\t\t\t\t...(mapping.targets || [])\n\t\t\t\t];\n\t\t\t}\n\t\t\treturn acc;\n\t\t}, {});\n\t};\n\tconst transformedInternalEventMappings = await transformInternalEventMappings(\n\t\tinternalEventMappings\n\t);\n\tmacroponent.internalEventMappings = transformedInternalEventMappings;\n\n\treturn {\n\t\tmacroponent,\n\t\teventMappings: transformedScreenEventMappings,\n\t\tpropertyValues: macroponentProperties.reduce((acc, prop) => {\n\t\t\tif (!isNil(prop.value)) {\n\t\t\t\tif (\n\t\t\t\t\t!isValidBindingShorthand(prop.value) &&\n\t\t\t\t\tget(prop, 'typeMetadata.translatable')\n\t\t\t\t) {\n\t\t\t\t\tacc[prop.name] = getUxValueFromShorthand(\n\t\t\t\t\t\t`translate(${prop.value})`,\n\t\t\t\t\t\tprop.typeMetadata\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tacc[prop.name] = prop.value;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn acc;\n\t\t}, {}),\n\t\tpropertyTestValues: macroponentProperties.reduce((acc, prop) => {\n\t\t\tif (!isNil(prop.testValue)) {\n\t\t\t\tacc[prop.name] = prop.testValue;\n\t\t\t}\n\t\t\treturn acc;\n\t\t}, {})\n\t};\n};\n\nexport default async function transformPageStateToMacroponent(pageState) {\n\tlet updatedPageState = cloneDeep(pageState);\n\n\tupdatedPageState = convertAncestorEventMappingsToRelays(pageState);\n\tconst {\n\t\tsysId: id,\n\t\tscope,\n\t\ttype: pageStateType,\n\t\trootElement,\n\t\tpageStatus,\n\t\tuiTypeParameters,\n\t\tdataBrokerInstances,\n\t\tclientStateParameters = [],\n\t\tdispatchedEvents,\n\t\thandledEvents,\n\t\tscreenEventMappings\n\t} = updatedPageState;\n\n\tconst macroponent = {\n\t\tid,\n\t\tscope,\n\t\tisActive: getIsActive(pageStatus),\n\t\tmacroponentInstance: await createMacroponentInstanceFromElement(\n\t\t\tpageStateType\n\t\t)(\n\t\t\trootElement,\n\t\t\tdataBrokerInstances,\n\t\t\tclientStateParameters,\n\t\t\tdispatchedEvents,\n\t\t\thandledEvents,\n\t\t\tscreenEventMappings,\n\t\t\trootElement.internalEventMappings\n\t\t)\n\t};\n\n\tif (isLegacy(pageStateType)) {\n\t\tconst applicability =\n\t\t\tuiTypeParameters && uiTypeParameters.applicability\n\t\t\t\t? uiTypeParameters.applicability\n\t\t\t\t: {\n\t\t\t\t\t\ttype: 'ANY',\n\t\t\t\t\t\tapplicablePage: ''\n\t\t\t\t  };\n\n\t\tmacroponent.applicability = applicability;\n\t}\n\n\treturn macroponent;\n}\n","export const MCP_CONTRACT_EVENT_CREATED =\n\t'SN_UXF#MACROPONENT_CONTRACT_EVENT_CREATED';\nexport const MCP_CONTRACT_EVENT_CREATE_SUCCEEDED =\n\t'SN_UXF#MACROPONENT_CONTRACT_EVENT_CREATE_SUCCEEDED';\nexport const MCP_CONTRACT_EVENT_CREATE_FAILED =\n\t'SN_UXF#MACROPONENT_CONTRACT_EVENT_CREATE_FAILED';\nexport const MCP_CONTRACT_EVENT_FETCH_REQUESTED =\n\t'SN_UXF#MACROPONENT_CONTRACT_EVENT_FETCH_REQUESTED';\nexport const MCP_CONTRACT_EVENT_UPDATED =\n\t'SN_UXF#MACROPONENT_CONTRACT_EVENT_UPDATED';\nexport const MCP_CONTRACT_EVENT_UPDATE_SUCCEEDED =\n\t'SN_UXF#MACROPONENT_CONTRACT_EVENT_UPDATE_SUCCEEDED';\nexport const MCP_CONTRACT_EVENT_UPDATE_FAILED =\n\t'SN_UXF#MACROPONENT_CONTRACT_EVENT_UPDATE_FAILED';\nexport const MCP_CONTRACT_EVENT_DELETED =\n\t'SN_UXF#MACROPONENT_CONTRACT_EVENT_DELETED';\nexport const MCP_CONTRACT_EVENT_DELETE_REQUESTED =\n\t'SN_UXF#MACROPONENT_CONTRACT_EVENT_DELETE_REQUESTED';\n","import {\n\tformatEventNameAndLabel,\n\tgetInvalidEventMappingTargets,\n\tgetReducedInvalidHandlerList,\n\tgetReducedIncongruentHandlerList\n} from '../../elementEventMappings/utils';\nimport {\n\tMCP_CONTRACT_EVENT_CREATED,\n\tMCP_CONTRACT_EVENT_UPDATED\n} from '../../dispatchedEvents/dispatchedEventsActions';\nimport { PAGE_SAVE_HTTP_REQUESTED } from '../pageActions';\n\nconst dispatchMcpContractAction = (\n\teventHandlers,\n\tactionType,\n\trootMacroponentId,\n\tscreenName,\n\tsavePayload,\n\tsaveMeta,\n\tdispatch,\n\tvariantScope\n) => {\n\tfor (const eventHandler of eventHandlers) {\n\t\tconst { name, label } = formatEventNameAndLabel(\n\t\t\teventHandler,\n\t\t\trootMacroponentId,\n\t\t\tscreenName\n\t\t);\n\n\t\tconst payloadToSend = {\n\t\t\tevent: {\n\t\t\t\tevent_name: name,\n\t\t\t\tlabel,\n\t\t\t\tprops: JSON.stringify(\n\t\t\t\t\teventHandler.payloadFields.map((field) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tname: field.name,\n\t\t\t\t\t\t\tfieldType: field.type,\n\t\t\t\t\t\t\tinterfaceApiName: field.interfaceApiName,\n\t\t\t\t\t\t\tlabel: field.label\n\t\t\t\t\t\t};\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t},\n\t\t\tsysparm_transaction_scope: variantScope\n\t\t};\n\n\t\tif (actionType === MCP_CONTRACT_EVENT_UPDATED) {\n\t\t\tpayloadToSend.eventId = eventHandler.existingDispatchedEvent.id;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tdispatch(actionType, payloadToSend, {\n\t\t\t\tscreenEventMappingHandler: eventHandler,\n\t\t\t\tsavePayload,\n\t\t\t\tsaveMeta,\n\t\t\t\tcontext: 'dispatchedEvents'\n\t\t\t});\n\t\t}, 100);\n\t}\n};\n\nexport default function createDispatchedEvents({\n\trootElement,\n\trootMacroponentId,\n\tscreenName,\n\tdataBrokerInstances,\n\tparentEventHandlers,\n\tdispatch,\n\texistingDispatchedEvents = [],\n\tsavePayload,\n\tsaveMeta,\n\tvariantScope\n}) {\n\tconst invalidEventMappingTargets = getInvalidEventMappingTargets(\n\t\trootElement,\n\t\tparentEventHandlers,\n\t\tdataBrokerInstances\n\t);\n\tconst dispatchedEventsToCreate = getReducedInvalidHandlerList(\n\t\tinvalidEventMappingTargets,\n\t\texistingDispatchedEvents,\n\t\trootMacroponentId\n\t);\n\n\tconst dispatchedEventsToUpdate = getReducedIncongruentHandlerList(\n\t\tinvalidEventMappingTargets,\n\t\texistingDispatchedEvents,\n\t\trootMacroponentId\n\t);\n\n\tif (dispatchedEventsToCreate && dispatchedEventsToCreate.length > 0) {\n\t\tdispatchMcpContractAction(\n\t\t\tdispatchedEventsToCreate,\n\t\t\tMCP_CONTRACT_EVENT_CREATED,\n\t\t\trootMacroponentId,\n\t\t\tscreenName,\n\t\t\tsavePayload,\n\t\t\tsaveMeta,\n\t\t\tdispatch,\n\t\t\tvariantScope\n\t\t);\n\t} else if (dispatchedEventsToUpdate && dispatchedEventsToUpdate.length) {\n\t\tdispatchMcpContractAction(\n\t\t\tdispatchedEventsToUpdate,\n\t\t\tMCP_CONTRACT_EVENT_UPDATED,\n\t\t\trootMacroponentId,\n\t\t\tscreenName,\n\t\t\tsavePayload,\n\t\t\tsaveMeta,\n\t\t\tdispatch,\n\t\t\tvariantScope\n\t\t);\n\t} else {\n\t\t// if there are no dispatched events to create, continue saving the page\n\t\tdispatch(PAGE_SAVE_HTTP_REQUESTED, { ...savePayload }, { ...saveMeta });\n\t}\n}\n","import {\n\tPAGE_SAVE_REQUESTED,\n\tPAGE_UPDATE_REQUESTED,\n\tPAGE_SAVE_HTTP_REQUESTED\n} from './pageActions';\nimport transformPageStateToMacroponent, {\n\tremoveViewportsTransientProperties\n} from '../page/utils/transformPageStateToMacroponent';\nimport pageEndpointFromType from './utils/pageEndpointFromType';\nimport createDispatchedEvents from './utils/resolveInvalidEventMappingTargets';\n\nconst pageSaveRequestedHandler = ({ action, properties, dispatch }) => {\n\tconst { pageStateModel } = action.payload || {};\n\tconst pageState = pageStateModel || properties.pageState || {};\n\tconst parentEventHandlers = pageState.eventHandlers.filter(\n\t\t(handler) => handler.ancestor === true\n\t);\n\n\tcreateDispatchedEvents({\n\t\trootElement: pageState.rootElement,\n\t\trootMacroponentId: pageState.rootElement.id,\n\t\tscreenName: pageState.name,\n\t\tdataBrokerInstances: pageState.dataBrokerInstances,\n\t\tparentEventHandlers,\n\t\tdispatch,\n\t\texistingDispatchedEvents: pageState.dispatchedEvents,\n\t\tsavePayload: action.payload,\n\t\tsaveMeta: action.meta,\n\t\tvariantScope: pageState.scope\n\t});\n};\n\nconst pageSaveHandler = async ({ action, properties, dispatch }) => {\n\tconst { pageStateModel } = action.payload || {};\n\tconst pageState = pageStateModel || properties.pageState;\n\tlet macroponentInstance = await transformPageStateToMacroponent(pageState);\n\n\tmacroponentInstance = removeViewportsTransientProperties(\n\t\tmacroponentInstance,\n\t\tpageState.viewportElementIds\n\t);\n\n\tconst { forceActivate, forceDeactivate } = action.payload || {};\n\tif (forceActivate === true) {\n\t\tmacroponentInstance.isActive = true;\n\t} else if (forceDeactivate === true) {\n\t\tmacroponentInstance.isActive = false;\n\t}\n\tdispatch(\n\t\tPAGE_UPDATE_REQUESTED,\n\t\t{\n\t\t\tpageEndpoint: pageEndpointFromType(pageState.type),\n\t\t\tsysId: macroponentInstance.id,\n\t\t\tsysparm_transaction_scope: macroponentInstance.scope,\n\t\t\tdata: macroponentInstance\n\t\t},\n\t\t{ forceActivate, forceDeactivate, ...action.meta }\n\t);\n};\n\nexport default {\n\t[PAGE_SAVE_REQUESTED]: pageSaveRequestedHandler,\n\t[PAGE_SAVE_HTTP_REQUESTED]: pageSaveHandler\n};\n","export const CLIENT_SCRIPTS_SCRIPT_CREATED =\n\t'SN_UXF#CLIENT_SCRIPTS_SCRIPT_CREATED';\nexport const CLIENT_SCRIPTS_SCRIPT_DELETED =\n\t'SN_UXF#CLIENT_SCRIPTS_SCRIPT_DELETED';\nexport const CLIENT_SCRIPTS_SCRIPT_CHANGED =\n\t'SN_UXF#CLIENT_SCRIPTS_SCRIPT_CHANGED';\nexport const CLIENT_SCRIPTS_CREATE_REQUESTED =\n\t'SN_UXF#CLIENT_SCRIPTS_CREATE_REQUESTED';\nexport const CLIENT_SCRIPTS_CREATE_SUCCEEDED =\n\t'SN_UXF#CLIENT_SCRIPTS_CREATE_SUCCEEDED';\nexport const CLIENT_SCRIPTS_DELETE_REQUESTED =\n\t'SN_UXF#CLIENT_SCRIPTS_DELETE_REQUESTED';\nexport const CLIENT_SCRIPTS_DELETE_SUCCEEDED =\n\t'SN_UXF#CLIENT_SCRIPTS_DELETE_SUCCEEDED';\nexport const CLIENT_SCRIPTS_UPDATE_REQUESTED =\n\t'SN_UXF#CLIENT_SCRIPTS_UPDATE_REQUESTED';\nexport const CLIENT_SCRIPTS_UPDATE_HTTP_REQUESTED =\n\t'SN_UXF#CLIENT_SCRIPTS_UPDATE_HTTP_REQUESTED';\nexport const CLIENT_SCRIPTS_UPDATE_SUCCEEDED =\n\t'SN_UXF#CLIENT_SCRIPTS_UPDATE_SUCCEEDED';\nexport const CLIENT_SCRIPTS_CREATE_STARTED =\n\t'SN_UXF#CLIENT_SCRIPTS_CREATE_STARTED';\nexport const CLIENT_SCRIPTS_DELETE_STARTED =\n\t'SN_UXF#CLIENT_SCRIPTS_DELETE_STARTED';\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport cloneDeep from 'lodash/cloneDeep';\nimport {\n\tPAGE_UPDATE_REQUESTED,\n\tPAGE_UPDATE_STARTED,\n\tPAGE_UPDATE_FAILED,\n\tPAGE_UPDATE_SUCCEEDED\n} from './pageActions';\nimport { CLIENT_SCRIPTS_UPDATE_REQUESTED } from '../clientScripts/clientScriptsActions';\nimport transformMacroponentToPageState from './utils/transformMacroponentToPageState';\nimport effectProxy from '../helpers/effectProxy';\nimport { deleteTemplateCache } from '../viewportHandlers/templateLoader';\n\nexport const pageUpdateRequested = createHttpEffect(\n\t'/api/now/uxframework/:pageEndpoint/:sysId',\n\t{\n\t\tmethod: 'PATCH',\n\t\tpathParams: ['pageEndpoint', 'sysId'],\n\t\tqueryParams: ['sysparm_transaction_scope'],\n\t\tdataParam: 'data',\n\t\tstartActionType: PAGE_UPDATE_STARTED,\n\t\tsuccessActionType: PAGE_UPDATE_SUCCEEDED,\n\t\terrorActionType: PAGE_UPDATE_FAILED,\n\t\tbatch: false\n\t}\n);\n\nconst pageUpdateStarted = ({ properties, updateProperties, dispatch }) => {\n\tupdateProperties({ isSavingPage: true });\n\tdispatch(CLIENT_SCRIPTS_UPDATE_REQUESTED, { data: properties.clientScripts });\n};\n\nconst pageUpdateSucceeded = ({\n\taction,\n\tstate,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { isChangingPage } = action.meta || {};\n\n\tif (isChangingPage) {\n\t\tupdateProperties({\n\t\t\tisLoadingPage: false,\n\t\t\tisSavingPage: false\n\t\t});\n\t\treturn;\n\t}\n\n\tconst {\n\t\tdataBrokerDefinitions,\n\t\teventHandlers,\n\t\tpages: currentPages = [],\n\t\tclientStateParameters,\n\t\tpageState: { sysId: variantId, rootElement },\n\t\tclientScripts\n\t} = properties;\n\n\tif (rootElement && rootElement.id) {\n\t\tdeleteTemplateCache([rootElement.id]);\n\t}\n\n\tconst pageState = transformMacroponentToPageState(\n\t\taction.payload.result,\n\t\tdataBrokerDefinitions,\n\t\teventHandlers,\n\t\tclientStateParameters,\n\t\tstate,\n\t\tvariantId\n\t);\n\tconst pageStatePristine = cloneDeep(pageState);\n\n\tconst pages = currentPages.map((page) => {\n\t\tif (page.sysId === pageState.sysId) {\n\t\t\treturn {\n\t\t\t\t...page,\n\t\t\t\tname: pageState.name,\n\t\t\t\tpageStatus: pageState.pageStatus\n\t\t\t};\n\t\t}\n\t\treturn page;\n\t});\n\n\tupdateProperties({\n\t\tisLoadingPage: false,\n\t\tisPageStateDirty: false,\n\t\tisSavingPage: false,\n\t\tpageState,\n\t\tpageStatePristine,\n\t\tclientScriptsPristine: cloneDeep(clientScripts),\n\t\tpages\n\t});\n};\n\nconst pageUpdateFailed = ({ updateProperties }) => {\n\tupdateProperties({\n\t\tisLoadingPage: false,\n\t\tisSavingPage: false\n\t});\n};\n\nexport default {\n\t[PAGE_UPDATE_REQUESTED]: effectProxy(pageUpdateRequested),\n\t[PAGE_UPDATE_STARTED]: pageUpdateStarted,\n\t[PAGE_UPDATE_FAILED]: pageUpdateFailed,\n\t[PAGE_UPDATE_SUCCEEDED]: pageUpdateSucceeded\n};\n","import { PageStateModel } from '../../../models';\nimport isNil from 'lodash/isNil';\nimport cloneDeep from 'lodash/cloneDeep';\nimport merge from 'lodash/merge';\nimport { getIsActive, getPageStatus } from './pageStatus';\n\nexport const getMetadataUpdatePayload = (changes = {}) => {\n\tconst updatePayload = {};\n\n\t['name', 'sysPolicy', 'order', 'screenCondition'].forEach((field) => {\n\t\tif (!isNil(changes[field])) {\n\t\t\tupdatePayload[field] = changes[field];\n\t\t}\n\t});\n\n\tif (changes.pageStatus) {\n\t\tupdatePayload.isActive = getIsActive(changes.pageStatus);\n\t}\n\n\treturn updatePayload;\n};\n\nexport const transformMetadataToPageState = (pageMetadata, pageState) => {\n\tconst { name, sysPolicy, isActive, order, screenCondition } = pageMetadata;\n\n\tconst clonePageState = cloneDeep(pageState);\n\tconst updatedPageState = merge(clonePageState, {\n\t\tname,\n\t\tsysPolicy,\n\t\tpageStatus: getPageStatus(isActive),\n\t\tuiTypeParameters: {\n\t\t\t...clonePageState.uiTypeParameters,\n\t\t\torder,\n\t\t\tscreenCondition\n\t\t},\n\t\trootElement: {\n\t\t\t...clonePageState.rootElement,\n\t\t\tinstanceName: name\n\t\t}\n\t});\n\n\treturn new PageStateModel(updatedPageState);\n};\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport {\n\tMETADATA_UPDATE_REQUESTED,\n\tMETADATA_UPDATE_HTTP_REQUESTED,\n\tMETADATA_UPDATE_STARTED,\n\tMETADATA_UPDATE_FAILED,\n\tMETADATA_UPDATE_SUCCEEDED\n} from './pageActions';\nimport {\n\ttransformMetadataToPageState,\n\tgetMetadataUpdatePayload\n} from './utils/transformMetadata';\nimport pageEndpointFromType from './utils/pageEndpointFromType';\nimport { getPageStatus } from './utils/pageStatus';\n\nexport const metadataUpdateHttpEffect = createHttpEffect(\n\t'/api/now/uxframework/:pageEndpoint/:pageSysId',\n\t{\n\t\tmethod: 'PATCH',\n\t\tpathParams: ['pageEndpoint', 'pageSysId'],\n\t\tqueryParams: ['sysparm_transaction_scope'],\n\t\tdataParam: 'data',\n\t\tstartActionType: METADATA_UPDATE_STARTED,\n\t\tsuccessActionType: METADATA_UPDATE_SUCCEEDED,\n\t\terrorActionType: METADATA_UPDATE_FAILED,\n\t\tbatch: false\n\t}\n);\n\nconst metadataUpdateRequested = ({ action, dispatch, properties }) => {\n\tconst { pageToUpdate } = action.payload;\n\tconst {\n\t\tpageState: {\n\t\t\trootElement: { id: macroponentId }\n\t\t}\n\t} = properties;\n\n\tconst { type, sysId, scope } = pageToUpdate\n\t\t? pageToUpdate\n\t\t: properties.pageState;\n\n\tconst options = {\n\t\tpageEndpoint: pageEndpointFromType(`${type}`, true),\n\t\tpageSysId: sysId,\n\t\tsysparm_transaction_scope: scope,\n\t\tdata: {\n\t\t\t...getMetadataUpdatePayload(action.payload)\n\t\t}\n\t};\n\n\tif (type === 'landing') {\n\t\toptions.data.macroponentId = macroponentId;\n\t}\n\n\tdispatch(METADATA_UPDATE_HTTP_REQUESTED, options, {\n\t\tupdatedPageSysId: sysId\n\t});\n};\n\nconst metadataUpdateStarted = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: true });\n};\n\nconst metadataUpdateSucceeded = ({ action, updateProperties, properties }) => {\n\t// In the case where the updated page is not the current page,\n\t// The page object should be correctly updated and pageState should not be updated\n\tconst {\n\t\tmeta: { updatedPageSysId }\n\t} = action;\n\n\tif (updatedPageSysId === properties.pageState.sysId) {\n\t\tconst pageState = transformMetadataToPageState(\n\t\t\taction.payload.result,\n\t\t\tproperties.pageState\n\t\t);\n\n\t\t// update any changed meta in pristine; preserve differences elsewhere\n\t\tconst pageStatePristine = transformMetadataToPageState(\n\t\t\taction.payload.result,\n\t\t\tproperties.pageStatePristine\n\t\t);\n\n\t\tconst pages = properties.pages.map((page) => {\n\t\t\tif (page.sysId !== pageState.sysId) {\n\t\t\t\treturn page;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...page,\n\t\t\t\tname: pageState.name,\n\t\t\t\tpageStatus: pageState.pageStatus\n\t\t\t};\n\t\t});\n\n\t\tupdateProperties({\n\t\t\tpageState,\n\t\t\tpageStatePristine,\n\t\t\tpages,\n\t\t\tisSavingPage: false\n\t\t});\n\t} else {\n\t\tconst {\n\t\t\tname,\n\t\t\tsysPolicy,\n\t\t\tisActive,\n\t\t\torder,\n\t\t\tscreenCondition\n\t\t} = action.payload.result;\n\t\tconst pages = properties.pages.map((page) => {\n\t\t\tif (page.sysId !== updatedPageSysId) {\n\t\t\t\treturn page;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...page,\n\t\t\t\tname,\n\t\t\t\tsysPolicy,\n\t\t\t\tpageStatus: getPageStatus(isActive),\n\t\t\t\torder,\n\t\t\t\tscreenCondition\n\t\t\t};\n\t\t});\n\n\t\tupdateProperties({\n\t\t\tpages,\n\t\t\tisSavingPage: false\n\t\t});\n\t}\n};\n\nconst metadataUpdateFailed = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false });\n};\n\nexport default {\n\t[METADATA_UPDATE_REQUESTED]: metadataUpdateRequested,\n\t[METADATA_UPDATE_HTTP_REQUESTED]: metadataUpdateHttpEffect,\n\t[METADATA_UPDATE_STARTED]: metadataUpdateStarted,\n\t[METADATA_UPDATE_FAILED]: metadataUpdateFailed,\n\t[METADATA_UPDATE_SUCCEEDED]: metadataUpdateSucceeded\n};\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport get from 'lodash/get';\nimport {\n\tPAGE_COPY_REQUESTED,\n\tPAGE_COPY_HTTP_REQUESTED,\n\tPAGE_COPY_STARTED,\n\tPAGE_COPY_SUCCEEDED,\n\tPAGE_COPY_FAILED\n} from './pageActions';\n\nimport {\n\tcreateLandingPage,\n\tcreateScreen,\n\tpageCreateStarted,\n\tpageCreateSucceeded,\n\tpageCreateFailed\n} from './pageCreatedUtils';\nimport transformPageStateToMacroponent from './utils/transformPageStateToMacroponent';\n\nconst pageCopyRequested = async ({ state, action, dispatch }) => {\n\tconst {\n\t\tproperties: { pageState }\n\t} = state;\n\n\tif (!pageState) {\n\t\tconsole.warn(\n\t\t\t`UXF Builder Middleware Error: Must load a page before coping a page.`\n\t\t);\n\t\treturn;\n\t}\n\n\tif (pageState.type === 'record') {\n\t\t// TODO: Record page logic should be removed\n\t\treturn;\n\t}\n\n\tconst copiedMacroponent = await transformPageStateToMacroponent(pageState);\n\n\tconst layout = get(\n\t\tcopiedMacroponent,\n\t\t'macroponentInstance.macroponent.layout',\n\t\t{}\n\t);\n\tconst composition = get(\n\t\tcopiedMacroponent,\n\t\t'macroponentInstance.macroponent.composition',\n\t\t[]\n\t);\n\n\tconst propertyValues = get(\n\t\tcopiedMacroponent,\n\t\t'macroponentInstance.propertyValues',\n\t\t{}\n\t);\n\n\tconst properties = get(\n\t\tcopiedMacroponent,\n\t\t'macroponentInstance.properties',\n\t\t[]\n\t);\n\n\tif (pageState.type === 'landing') {\n\t\t// TODO: Landing pages are deprecated.  Remove.\n\t\tcreateLandingPage(\n\t\t\taction.payload,\n\t\t\tcomposition,\n\t\t\tlayout,\n\t\t\tproperties,\n\t\t\tpropertyValues,\n\t\t\tdispatch,\n\t\t\tPAGE_COPY_HTTP_REQUESTED\n\t\t);\n\t} else {\n\t\tcreateScreen(\n\t\t\taction.payload,\n\t\t\tcomposition,\n\t\t\tlayout,\n\t\t\tproperties,\n\t\t\tpropertyValues,\n\t\t\tdispatch,\n\t\t\tPAGE_COPY_HTTP_REQUESTED\n\t\t);\n\t}\n};\n\nconst pageCopyHttpEffect = createHttpEffect(\n\t'/api/now/uxframework/:pageEndpoint',\n\t{\n\t\tmethod: 'POST',\n\t\tpathParams: ['pageEndpoint'],\n\t\tqueryParams: ['sysparm_transaction_scope'],\n\t\tdataParam: 'data',\n\t\tstartActionType: PAGE_COPY_STARTED,\n\t\tsuccessActionType: PAGE_COPY_SUCCEEDED,\n\t\terrorActionType: PAGE_COPY_FAILED,\n\t\tbatch: false\n\t}\n);\n\nexport default {\n\t[PAGE_COPY_REQUESTED]: pageCopyRequested,\n\t[PAGE_COPY_HTTP_REQUESTED]: pageCopyHttpEffect,\n\t[PAGE_COPY_STARTED]: pageCreateStarted,\n\t[PAGE_COPY_FAILED]: pageCreateFailed,\n\t[PAGE_COPY_SUCCEEDED]: pageCreateSucceeded\n};\n","import * as pageActions from './pageActions';\nimport pageCreatedHandlers from './pageCreatedHandlers';\nimport pageDeletedHandlers from './pageDeletedHandlers';\nimport pageRequestedHandlers from './pageRequestedHandlers';\nimport pageRequestSucceededHandlers from './pageRequestSucceededHandlers';\nimport pageSavedHandlers from './pageSavedHandlers';\nimport pageUpdatedHandler from './pageUpdatedHandlers';\nimport pageMetadataHandlers from './pageMetadataHandlers';\nimport pageCopiedHandlers from './pageCopiedHandlers';\n\nconst pageHandlers = {\n\t...pageCreatedHandlers,\n\t...pageDeletedHandlers,\n\t...pageRequestedHandlers,\n\t...pageRequestSucceededHandlers,\n\t...pageSavedHandlers,\n\t...pageUpdatedHandler,\n\t...pageMetadataHandlers,\n\t...pageCopiedHandlers\n};\n\nexport { pageActions, pageHandlers };\n","export const CONFIGURATION_COMPONENT_BY_INTERFACE_REQUESTED =\n\t'SN_UXF#CONFIGURATION_COMPONENT_BY_INTERFACE_REQUESTED';\nexport const CONFIGURATION_COMPONENT_BY_INTERFACE_SUCCEEDED =\n\t'SN_UXF#CONFIGURATION_COMPONENT_BY_INTERFACE_SUCCEEDED';\nexport const CONFIGURATION_COMPONENT_BY_INTERFACE_FAILED =\n\t'SN_UXF#CONFIGURATION_COMPONENT_BY_INTERFACE_FAILED';\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\n\nimport {\n\tPAGE_LIST_REQUESTED,\n\tPAGE_LIST_HTTP_REQUESTED,\n\tPAGE_LIST_REQUEST_STARTED,\n\tPAGE_LIST_REQUEST_FAILED,\n\tPAGE_LIST_REQUEST_SUCCEEDED\n} from './pageListActions';\n\nimport { CONFIGURATION_COMPONENT_BY_INTERFACE_REQUESTED } from '../configurationComponentByInterface/configurationComponentByInterfaceActions';\n\nimport {\n\tPAGE_REQUESTED_STARTED,\n\tPAGE_SAVE_REQUESTED\n} from '../page/pageActions';\nimport { getPageStatus } from '../page/utils/pageStatus';\nimport effectProxy from '../helpers/effectProxy';\n\nconst appendToRequestPayload = (payload) => {\n\tif (!payload) {\n\t\treturn {};\n\t}\n\n\t// For component builder\n\tif (payload.macroponentSysId) {\n\t\treturn {\n\t\t\tsysparm_macroponent_id: payload.macroponentSysId\n\t\t};\n\t}\n\n\treturn {\n\t\tsysparm_page_registry_id: payload.pageRegistrySysId,\n\t\tsysparm_app_config_id: payload.appConfigId\n\t};\n};\n\nconst pageListRequested = ({ action, dispatch, updateState, properties }) => {\n\tconst { payload } = action;\n\n\tupdateState({\n\t\toperation: 'set',\n\t\tpath: 'pagesLoaded',\n\t\tvalue: false\n\t});\n\n\tconst sysparm_query_no_domain =\n\t\tpayload && payload.sysparm_query_no_domain !== undefined\n\t\t\t? payload.sysparm_query_no_domain\n\t\t\t: properties.isDomainExpanded;\n\n\tdispatch(\n\t\tPAGE_LIST_HTTP_REQUESTED,\n\t\t{\n\t\t\tpageResource: 'screens',\n\t\t\tsysparm_query_no_domain,\n\t\t\t...appendToRequestPayload(payload)\n\t\t},\n\t\taction.meta\n\t);\n\n\tdispatch(CONFIGURATION_COMPONENT_BY_INTERFACE_REQUESTED);\n};\n\nexport const pageListHttpRequested = createHttpEffect(\n\t'/api/now/uxframework/:pageResource',\n\t{\n\t\tmethod: 'GET',\n\t\tbatch: false,\n\t\tpathParams: ['pageResource'],\n\t\tqueryParams: [\n\t\t\t'sysparm_page_registry_id',\n\t\t\t'sysparm_app_config_id',\n\t\t\t'sysparm_macroponent_id',\n\t\t\t'sysparm_query_no_domain'\n\t\t],\n\t\tstartActionType: PAGE_LIST_REQUEST_STARTED,\n\t\tsuccessActionType: PAGE_LIST_REQUEST_SUCCEEDED,\n\t\terrorActionType: PAGE_LIST_REQUEST_FAILED\n\t}\n);\n\nconst pageListRequestStarted = ({ updateProperties }) =>\n\tupdateProperties({ isLoadingPages: true });\n\nconst pageListRequestSucceeded = ({\n\taction,\n\tstate,\n\tupdateProperties,\n\tupdateState,\n\tdispatch\n}) => {\n\tconst { queuedPageRequestId } = state;\n\n\tconst newPages = action.payload.result.map((pagePayload) => {\n\t\tconst {\n\t\t\tname,\n\t\t\tid: sysId,\n\t\t\tscope,\n\t\t\tisActive,\n\t\t\ttable,\n\t\t\tworkspaceMasterConfigSysId,\n\t\t\tmacroponentInstance: { rootMacroponentId, macroponentDefinitions },\n\t\t\tpageType,\n\t\t\tscreenType,\n\t\t\torder,\n\t\t\tscreenConditions\n\t\t} = pagePayload;\n\n\t\tconst {\n\t\t\treadOnly,\n\t\t\tsysPolicy,\n\t\t\tscope: pageDefinitionScopeId\n\t\t} = macroponentDefinitions[rootMacroponentId];\n\n\t\tconst page = {\n\t\t\tsysId,\n\t\t\tscope,\n\t\t\treadOnly,\n\t\t\tsysPolicy,\n\t\t\tname,\n\t\t\tpageStatus: getPageStatus(isActive),\n\t\t\ttype: pageType,\n\t\t\tscreenType,\n\t\t\torder,\n\t\t\tscreenConditions,\n\t\t\tpageDefinitionScopeId\n\t\t};\n\n\t\tif (table) {\n\t\t\tpage.uiTypeParameters = {\n\t\t\t\ttable,\n\t\t\t\tworkspaceMasterConfigSysId\n\t\t\t};\n\t\t}\n\n\t\treturn page;\n\t});\n\n\tupdateProperties({ isLoadingPages: false, pages: newPages });\n\n\tif (queuedPageRequestId) {\n\t\tdispatch(PAGE_REQUESTED_STARTED, {\n\t\t\tsysId: queuedPageRequestId,\n\t\t\tpages: newPages\n\t\t});\n\t}\n\n\tupdateState({\n\t\toperation: 'set',\n\t\tpath: 'queuedPageRequestId',\n\t\tvalue: null\n\t});\n\tupdateState({\n\t\toperation: 'set',\n\t\tpath: 'pagesLoaded',\n\t\tvalue: true\n\t});\n\n\tif (action.meta.isExplosion) {\n\t\tdispatch(PAGE_SAVE_REQUESTED);\n\t}\n};\n\nconst pageListRequestFailed = ({ updateProperties }) =>\n\tupdateProperties({ isLoadingPages: false });\n\nexport default {\n\t[PAGE_LIST_REQUESTED]: pageListRequested,\n\t[PAGE_LIST_HTTP_REQUESTED]: effectProxy(pageListHttpRequested),\n\t[PAGE_LIST_REQUEST_STARTED]: pageListRequestStarted,\n\t[PAGE_LIST_REQUEST_FAILED]: pageListRequestFailed,\n\t[PAGE_LIST_REQUEST_SUCCEEDED]: pageListRequestSucceeded\n};\n","export const SCREEN_PROPERTIES_UPDATE_REQUESTED =\n\t'SN_UXF#SCREEN_PROPERTIES_UPDATE_REQUESTED';\nexport const SCREEN_PROPERTIES_UPDATE_STARTED =\n\t'SN_UXF#SCREEN_PROPERTIES_UPDATE_STARTED';\nexport const SCREEN_PROPERTIES_UPDATE_FAILED =\n\t'SN_UXF#SCREEN_PROPERTIES_UPDATE_FAILED';\nexport const SCREEN_PROPERTIES_UPDATE_SUCCEEDED =\n\t'SN_UXF#SCREEN_PROPERTIES_UPDATE_SUCCEEDED';\n","import PageStateModel from '../../models/pageState';\n\nexport const updatePageState = (pageState, updatedProperties) => {\n\tconst { name, pageStatus, ...uiTypeParameters } = updatedProperties;\n\treturn new PageStateModel({\n\t\t...pageState,\n\t\tname,\n\t\tpageStatus,\n\t\tuiTypeParameters: {\n\t\t\t...pageState.uiTypeParameters,\n\t\t\t...uiTypeParameters\n\t\t}\n\t});\n};\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport get from 'lodash/get';\nimport cloneDeep from 'lodash/cloneDeep';\nimport {\n\tSCREEN_PROPERTIES_UPDATE_REQUESTED,\n\tSCREEN_PROPERTIES_UPDATE_STARTED,\n\tSCREEN_PROPERTIES_UPDATE_FAILED,\n\tSCREEN_PROPERTIES_UPDATE_SUCCEEDED\n} from './screenPropertiesActions';\nimport { PAGE_REQUESTED } from '../page/pageActions';\nimport { updatePageState } from './utils';\nimport { CLIENT_SCRIPTS_UPDATE_REQUESTED } from '../clientScripts/clientScriptsActions';\nimport { getPageStatus } from '../page/utils/pageStatus';\nimport effectProxy from '../helpers/effectProxy';\n\nexport const screenPropertiesUpdateRequested = createHttpEffect(\n\t'/api/now/uxframework/screens/:sysId',\n\t{\n\t\tmethod: 'PATCH',\n\t\tpathParams: ['sysId'],\n\t\tqueryParams: ['sysparm_transaction_scope'],\n\t\tdataParam: 'data',\n\t\tstartActionType: SCREEN_PROPERTIES_UPDATE_STARTED,\n\t\tsuccessActionType: SCREEN_PROPERTIES_UPDATE_SUCCEEDED,\n\t\terrorActionType: SCREEN_PROPERTIES_UPDATE_FAILED,\n\t\tbatch: false\n\t}\n);\n\nconst screenPropertiesUpdateStarted = ({\n\tproperties,\n\tupdateProperties,\n\tdispatch\n}) => {\n\tupdateProperties({ isSavingPage: true });\n\tdispatch(CLIENT_SCRIPTS_UPDATE_REQUESTED, { data: properties.clientScripts });\n};\n\nconst screenPropertiesUpdateSucceeded = ({\n\taction,\n\tproperties,\n\tupdateProperties,\n\tdispatch\n}) => {\n\tconst { pages: currentPages = [], pageState, pageStatePristine } = properties;\n\tconst updatedScreen = get(action.payload, 'result', {});\n\tconst { name, isActive, order, screenCondition } = updatedScreen;\n\tconst pageStatus = getPageStatus(isActive);\n\tconst newPageState = cloneDeep(pageState);\n\tconst pages = currentPages.map((page) => {\n\t\tif (page.sysId === updatedScreen.id) {\n\t\t\treturn {\n\t\t\t\t...page,\n\t\t\t\tname,\n\t\t\t\tpageStatus\n\t\t\t};\n\t\t}\n\t\treturn page;\n\t});\n\n\t//If updated screen is not current screen return\n\n\tconst currentlyLoadedScreen = updatedScreen.id === pageState.sysId;\n\tif (!currentlyLoadedScreen) {\n\t\treturn updateProperties({\n\t\t\tisSavingPage: false,\n\t\t\tisLoadingPage: false,\n\t\t\tpageState: newPageState,\n\t\t\tpages\n\t\t});\n\t} else {\n\t\tif (!action.meta.changePageDefinition) {\n\t\t\tupdateProperties({\n\t\t\t\tisLoadingPage: false,\n\t\t\t\tisSavingPage: false,\n\t\t\t\tpageState: updatePageState(newPageState, {\n\t\t\t\t\tname,\n\t\t\t\t\tpageStatus,\n\t\t\t\t\torder,\n\t\t\t\t\tscreenCondition\n\t\t\t\t}),\n\t\t\t\tpageStatePristine: updatePageState(pageStatePristine, {\n\t\t\t\t\tname,\n\t\t\t\t\tpageStatus,\n\t\t\t\t\torder,\n\t\t\t\t\tscreenCondition\n\t\t\t\t}),\n\t\t\t\tpages\n\t\t\t});\n\t\t} else {\n\t\t\tdispatch(PAGE_REQUESTED, { sysId: updatedScreen.id });\n\t\t\tupdateProperties({\n\t\t\t\tisLoadingPage: false,\n\t\t\t\tisSavingPage: false,\n\t\t\t\tpages\n\t\t\t});\n\t\t}\n\t}\n};\n\nconst screenPropertiesUpdateFailed = ({ updateProperties }) => {\n\tupdateProperties({\n\t\tisLoadingPage: false,\n\t\tisSavingPage: false\n\t});\n};\n\nexport default {\n\t[SCREEN_PROPERTIES_UPDATE_REQUESTED]: effectProxy(\n\t\tscreenPropertiesUpdateRequested\n\t),\n\t[SCREEN_PROPERTIES_UPDATE_STARTED]: screenPropertiesUpdateStarted,\n\t[SCREEN_PROPERTIES_UPDATE_FAILED]: screenPropertiesUpdateFailed,\n\t[SCREEN_PROPERTIES_UPDATE_SUCCEEDED]: screenPropertiesUpdateSucceeded\n};\n","import * as screenPropertiesActions from './screenPropertiesActions';\nimport screenPropertiesUpdatedHandler from './screenPropertiesUpdatedHandlers';\n\nconst screenPropertiesHandlers = {\n\t...screenPropertiesUpdatedHandler\n};\n\nexport { screenPropertiesActions, screenPropertiesHandlers };\n","export const PAGE_PROPERTIES_CHANGED = 'SN_UXF#PAGE_PROPERTIES_CHANGED';\nexport const PAGE_PROPERTIES_CREATED = 'SN_UXF#PAGE_PROPERTIES_CREATED';\nexport const PAGE_PROPERTIES_DELETED = 'SN_UXF#PAGE_PROPERTIES_DELETED';\n","import cloneDeep from 'lodash/cloneDeep';\nimport reject from 'lodash/reject';\nimport isEmpty from 'lodash/isEmpty';\nimport omit from 'lodash/omit';\nimport { Element, Property } from '../../models';\nimport createPageState from '../../models/createPageState';\nimport * as MacroponentProperty from '../../models/macroponentProperty';\nimport {\n\tPAGE_PROPERTIES_CHANGED,\n\tPAGE_PROPERTIES_CREATED,\n\tPAGE_PROPERTIES_DELETED\n} from './pagePropertiesActions';\n\nfunction getPageState(newRootElement, pageState) {\n\treturn createPageState(\n\t\t{\n\t\t\trootElement: new Element(newRootElement)\n\t\t},\n\t\tpageState\n\t);\n}\n\nfunction resolveValue(value, testValue, fieldType) {\n\tconst valueToUse = testValue || value;\n\tswitch (fieldType) {\n\t\tcase 'boolean':\n\t\t\treturn valueToUse || false;\n\t\tcase 'number':\n\t\t\treturn Number(valueToUse) || 0;\n\t\tcase 'json':\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(valueToUse);\n\t\t\t} catch (_) {\n\t\t\t\treturn valueToUse;\n\t\t\t}\n\t\tdefault:\n\t\t\treturn valueToUse;\n\t}\n}\n\nconst pagePropertiesChanged = ({ action, properties, updateProperties }) => {\n\tconst { pageState } = properties;\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst {\n\t\tmacroponentProperties,\n\t\tproperties: elementProperties\n\t} = newRootElement;\n\tconst {\n\t\tpagePropertyId: id,\n\t\tvalue,\n\t\ttestValue,\n\t\tname,\n\t\tfieldType,\n\t\tdescription,\n\t\ttranslatable\n\t} = action.payload;\n\tconst propertyToUpdate = macroponentProperties.find(\n\t\t(pageProp) => pageProp.id === id\n\t);\n\n\tif (propertyToUpdate === undefined) {\n\t\treturn;\n\t}\n\n\tconst propertyToUpdateTypeMetadata = propertyToUpdate.typeMetadata || {};\n\tpropertyToUpdate.name = name;\n\t// TODO: keep \"label\" in sync with name, for now; could become human-readable string\n\tpropertyToUpdate.label = name;\n\tpropertyToUpdate.value = resolveValue(value, null, fieldType);\n\tpropertyToUpdate.testValue = resolveValue(null, testValue, fieldType);\n\tpropertyToUpdate.fieldType = fieldType;\n\tpropertyToUpdate.description = description || '';\n\tif (translatable) {\n\t\tpropertyToUpdate.typeMetadata = {\n\t\t\t...propertyToUpdateTypeMetadata,\n\t\t\ttranslatable\n\t\t};\n\t} else if (translatable === false && !isEmpty(propertyToUpdateTypeMetadata)) {\n\t\tpropertyToUpdate.typeMetadata = omit(\n\t\t\tpropertyToUpdateTypeMetadata,\n\t\t\t'translatable'\n\t\t);\n\t}\n\n\tif (elementProperties[name] === undefined) {\n\t\telementProperties[name] = new Property({ name });\n\t}\n\telementProperties[name].value = resolveValue(value, testValue, fieldType);\n\telementProperties[name].type = fieldType;\n\n\tupdateProperties({\n\t\tpageState: getPageState(newRootElement, pageState)\n\t});\n};\n\nconst pagePropertiesCreated = ({ action, properties, updateProperties }) => {\n\tconst { payload = {} } = action;\n\tconst { name, fieldType, description, translatable } = payload;\n\tconst { pageState } = properties;\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\n\tconst typeMetadata = translatable ? { translatable } : undefined;\n\n\tconst newMacroProp = MacroponentProperty.create({\n\t\tname,\n\t\tfieldType,\n\t\tdescription: description || '',\n\t\ttypeMetadata\n\t});\n\tnewRootElement.macroponentProperties.unshift(newMacroProp);\n\tnewRootElement.properties[newMacroProp.name] = new Property({\n\t\tname: newMacroProp.name\n\t});\n\n\tupdateProperties({\n\t\tpageState: getPageState(newRootElement, pageState)\n\t});\n};\n\nconst pagePropertiesDeleted = ({ action, properties, updateProperties }) => {\n\tconst { pageState } = properties;\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst { pagePropertyId: id } = action.payload;\n\n\tnewRootElement.macroponentProperties = reject(\n\t\tnewRootElement.macroponentProperties,\n\t\t{ id }\n\t);\n\n\tupdateProperties({\n\t\tpageState: getPageState(newRootElement, pageState)\n\t});\n};\n\nexport default {\n\t[PAGE_PROPERTIES_CHANGED]: pagePropertiesChanged,\n\t[PAGE_PROPERTIES_CREATED]: pagePropertiesCreated,\n\t[PAGE_PROPERTIES_DELETED]: pagePropertiesDeleted\n};\n","export const PAGE_LAYOUT_CHANGED = 'SN_UXF#PAGE_LAYOUT_CHANGED';\n","import cloneDeep from 'lodash/cloneDeep';\nimport { PAGE_LAYOUT_CHANGED } from './pageLayoutActions';\nimport { Element } from '../../models';\nimport createPageState from '../../models/createPageState';\nimport isLayoutEmpty from '../element/utils/isLayoutEmpty';\nimport { throwError, normalizeRowColumnSlots } from '../../utils';\nimport reparentElementsToNewLayout from '../element/utils/reparentElementsToNewLayout';\n\nfunction getPageState(newRootElement, pageState) {\n\treturn createPageState(\n\t\t{\n\t\t\trootElement: new Element(newRootElement)\n\t\t},\n\t\tpageState\n\t);\n}\n\nconst pageLayoutChanged = ({\n\taction,\n\tproperties,\n\tupdateProperties,\n\tgetDefaultLayout\n}) => {\n\tconst { pageState } = properties;\n\tconst newRootElement = cloneDeep(pageState.rootElement);\n\tconst { layout } = action.payload;\n\tlet newLayout;\n\ttry {\n\t\tconst normalizedParsedLayout = normalizeRowColumnSlots(JSON.parse(layout));\n\t\tnewLayout = isLayoutEmpty(normalizedParsedLayout)\n\t\t\t? getDefaultLayout('page')\n\t\t\t: normalizedParsedLayout;\n\t} catch (er) {\n\t\tnewLayout = newRootElement.layout;\n\t\tthrowError('invalid page layout JSON');\n\t}\n\tnewRootElement.children = reparentElementsToNewLayout(\n\t\tnewRootElement,\n\t\tnewLayout\n\t);\n\tnewRootElement.layout = newLayout;\n\tupdateProperties({\n\t\tpageState: getPageState(newRootElement, pageState)\n\t});\n};\n\nexport default {\n\t[PAGE_LAYOUT_CHANGED]: pageLayoutChanged\n};\n","export const TEMPLATES_REQUESTED = 'SN_UXF#TEMPLATES_REQUESTED';\nexport const TEMPLATES_REQUEST_STARTED = 'SN_UXF#TEMPLATES_REQUEST_STARTED';\nexport const TEMPLATES_REQUEST_FAILED = 'SN_UXF#TEMPLATES_REQUEST_FAILED';\nexport const TEMPLATES_REQUEST_SUCCEEDED = 'SN_UXF#TEMPLATES_REQUEST_SUCCEEDED';\n","export const DEFAULT_PAGE_TEMPLATE_ID = '28bde4cd53431010e6bcddeeff7b12cc';\nexport const DEFAULT_CONTAINER_TEMPLATE_ID = '5832fd4d53c31010e6bcddeeff7b12db';\nexport const pageTypeLookup = {\n\t'slotted-component': DEFAULT_CONTAINER_TEMPLATE_ID,\n\tpage: DEFAULT_PAGE_TEMPLATE_ID,\n\tfallback: DEFAULT_PAGE_TEMPLATE_ID\n};\n","import get from 'lodash/get';\nimport {\n\tpageTypeLookup,\n\tDEFAULT_PAGE_TEMPLATE_ID,\n\tDEFAULT_CONTAINER_TEMPLATE_ID\n} from './pageTypeLookup';\nimport { getLayoutFromMacroponent } from './getLayoutFromMacroponent';\nimport cuid from 'cuid';\n\nconst DEFAULT_LANDING_PAGE_LAYOUT = {\n\tdefault: {\n\t\ttype: 'rowColumn',\n\t\troot: {\n\t\t\ttype: 'row',\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'column',\n\t\t\t\t\tslotName: 'default-slot',\n\t\t\t\t\tsize: '12',\n\t\t\t\t\trows: [],\n\t\t\t\t\tid: cuid()\n\t\t\t\t}\n\t\t\t],\n\t\t\tid: cuid()\n\t\t}\n\t}\n};\nconst FALLBACK_DEFAULT_PAGE_LAYOUT = {\n\tdefault: {\n\t\ttype: 'flex',\n\t\troot: null,\n\t\tchildren: null,\n\t\tstyles: null,\n\t\trules: {\n\t\t\t'flex-direction': 'column'\n\t\t},\n\t\titems: [\n\t\t\t{\n\t\t\t\tslotName: 'default-slot',\n\t\t\t\tstyles: {\n\t\t\t\t\t'flex-direction': 'column'\n\t\t\t\t}\n\t\t\t}\n\t\t],\n\t\ttemplateId: DEFAULT_PAGE_TEMPLATE_ID\n\t}\n};\n\nconst FALLBACK_DEFAULT_CONTAINER_LAYOUT = {\n\tdefault: {\n\t\ttype: 'flex',\n\t\troot: null,\n\t\tchildren: null,\n\t\tstyles: null,\n\t\trules: {\n\t\t\t'flex-direction': 'column'\n\t\t},\n\t\titems: [\n\t\t\t{\n\t\t\t\tslotName: 'default-slot',\n\t\t\t\tstyles: {\n\t\t\t\t\t'flex-direction': 'column'\n\t\t\t\t}\n\t\t\t}\n\t\t],\n\t\ttemplateId: DEFAULT_CONTAINER_TEMPLATE_ID\n\t}\n};\n\nconst fallbackTemplateLookup = {\n\tDEFAULT_PAGE_TEMPLATE_ID: FALLBACK_DEFAULT_PAGE_LAYOUT,\n\tDEFAULT_CONTAINER_TEMPLATE_ID: FALLBACK_DEFAULT_CONTAINER_LAYOUT,\n\tfallback: FALLBACK_DEFAULT_CONTAINER_LAYOUT\n};\n\nconst addTemplateIdToLayout = (layout, templateId) => {\n\tif (layout && layout.default) {\n\t\tlayout.default.templateId = templateId;\n\t}\n\treturn layout;\n};\nconst getDefaultLayout = (pageType, templatesDefinitions) => {\n\tconst defaultTemplateId = get(\n\t\tpageTypeLookup,\n\t\tpageType,\n\t\tpageTypeLookup.fallback\n\t);\n\tif (!templatesDefinitions) {\n\t\tconsole.warn(\n\t\t\t'Failed to load template definitions falling back to hard coded layout'\n\t\t);\n\t\treturn get(\n\t\t\tfallbackTemplateLookup,\n\t\t\tdefaultTemplateId,\n\t\t\tfallbackTemplateLookup.fallback\n\t\t);\n\t}\n\tconst defaultTemplate = templatesDefinitions.find((templateDefinition) => {\n\t\treturn templateDefinition.id === defaultTemplateId;\n\t});\n\tconst layout =\n\t\tdefaultTemplate &&\n\t\tgetLayoutFromMacroponent(defaultTemplate.macroponentInstance);\n\taddTemplateIdToLayout(layout, defaultTemplateId);\n\treturn layout;\n};\nexport const memoizeGetDefaultLayout = (templatesDefinitions) => {\n\tconst layoutsCache = {\n\t\tlanding: DEFAULT_LANDING_PAGE_LAYOUT\n\t};\n\treturn (pageType) => {\n\t\tif (layoutsCache[pageType]) {\n\t\t\treturn layoutsCache[pageType];\n\t\t} else {\n\t\t\tconst defaultLayout = getDefaultLayout(pageType, templatesDefinitions);\n\t\t\tlayoutsCache[pageType] = defaultLayout;\n\t\t\treturn defaultLayout;\n\t\t}\n\t};\n};\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport {\n\tTEMPLATES_REQUESTED,\n\tTEMPLATES_REQUEST_STARTED,\n\tTEMPLATES_REQUEST_FAILED,\n\tTEMPLATES_REQUEST_SUCCEEDED\n} from './templatesActions';\nimport { UIB_TEMPLATES_SCOPE_ID } from '../../constants';\nimport { throwError } from '../../utils';\nimport get from 'lodash/get';\nimport effectProxy from '../helpers/effectProxy';\nimport { memoizeGetDefaultLayout } from './utils/getDefaultLayout';\n/*\n * handlers for fetching the templates & template types\n */\n\nexport const templatesRequested = createHttpEffect(\n\t`/api/now/builder/templates`,\n\t{\n\t\tmethod: 'GET',\n\t\tstartActionType: TEMPLATES_REQUEST_STARTED,\n\t\tsuccessActionType: TEMPLATES_REQUEST_SUCCEEDED,\n\t\terrorActionType: TEMPLATES_REQUEST_FAILED\n\t}\n);\n\nconst requestStarted = ({ updateProperties }) => {\n\tupdateProperties({\n\t\ttemplates: [],\n\t\ttemplatesDefinitions: []\n\t});\n};\n\nconst requestSucceeded = ({ action, updateProperties, updateState }) => {\n\tconst {\n\t\tresult: { templates: templatesDefinitions, templateTypes }\n\t} = action.payload;\n\n\tconst templates = templatesDefinitions\n\t\t.map(\n\t\t\t({\n\t\t\t\tid,\n\t\t\t\tscope,\n\t\t\t\tscopeName,\n\t\t\t\torder,\n\t\t\t\tlabel: name,\n\t\t\t\timage,\n\t\t\t\tmacroponentInstance,\n\t\t\t\tassociatedTypes\n\t\t\t}) => ({\n\t\t\t\tid,\n\t\t\t\tcustomized: scope !== UIB_TEMPLATES_SCOPE_ID,\n\t\t\t\tname,\n\t\t\t\torder,\n\t\t\t\trootMacroponentId: get(macroponentInstance, 'rootMacroponentId'),\n\t\t\t\timage,\n\t\t\t\tscopeName,\n\t\t\t\ttypes: associatedTypes.map((typeId) => {\n\t\t\t\t\tconst at = templateTypes.find((type) => type.id === typeId) || {};\n\t\t\t\t\treturn at.name;\n\t\t\t\t})\n\t\t\t})\n\t\t)\n\t\t.sort((a, b) => a.order - b.order);\n\tconst memoizedGetDefaultLayout = memoizeGetDefaultLayout(\n\t\ttemplatesDefinitions\n\t);\n\tupdateProperties({\n\t\ttemplates,\n\t\ttemplateTypes,\n\t\ttemplatesDefinitions\n\t});\n\tupdateState({\n\t\tgetDefaultLayout: memoizedGetDefaultLayout\n\t});\n};\n\nconst requestFailed = () => {\n\tthrowError(`Failed to load templates`);\n};\n\nexport default {\n\t[TEMPLATES_REQUESTED]: effectProxy(templatesRequested),\n\t[TEMPLATES_REQUEST_STARTED]: requestStarted,\n\t[TEMPLATES_REQUEST_FAILED]: requestFailed,\n\t[TEMPLATES_REQUEST_SUCCEEDED]: requestSucceeded\n};\n","// select\nexport const PAGE_TEMPLATE_SELECTED = 'SN_UXF#PAGE_TEMPLATE_SELECTED';\n\n// create\nexport const PAGE_TEMPLATE_CREATE_REQUESTED =\n\t'SN_UXF#PAGE_TEMPLATE_CREATE_REQUESTED';\nexport const PAGE_TEMPLATE_CREATE_HTTP_REQUESTED =\n\t'SN_UXF#PAGE_TEMPLATE_CREATE_HTTP_REQUESTED';\nexport const PAGE_TEMPLATE_CREATE_STARTED =\n\t'SN_UXF#PAGE_TEMPLATE_CREATE_STARTED';\nexport const PAGE_TEMPLATE_CREATE_FAILED = 'SN_UXF#PAGE_TEMPLATE_CREATE_FAILED';\nexport const PAGE_TEMPLATE_CREATE_SUCCEEDED =\n\t'SN_UXF#PAGE_TEMPLATE_CREATE_SUCCEEDED';\n","import cloneDeep from 'lodash/cloneDeep';\nimport get from 'lodash/get';\nimport { PAGE_TEMPLATE_SELECTED } from './pageTemplatesActions';\n\nimport { UPDATE_LAYOUT_SUCCEEDED } from '../element/elementActions';\n\nimport createPageState from '../../models/createPageState';\nimport transformMacroponentToPageState from '../page/utils/transformMacroponentToPageState';\nimport reparentElementsToNewLayout from '../element/utils/reparentElementsToNewLayout';\nimport { Element } from '../../models';\nimport { normalizeRowColumnSlots } from '../../utils';\n\n/**\n * handlers for uib-dispatched actions\n *\n * @param {Element} newRootElement\n * @param {PageStateModel} pageState\n * @returns {PageStateModel}\n */\nfunction getPageState(newRootElement, pageState) {\n\treturn createPageState(\n\t\t{\n\t\t\trootElement: new Element({\n\t\t\t\t...pageState.rootElement,\n\t\t\t\tlayout: newRootElement.layout,\n\t\t\t\tchildren: newRootElement.children,\n\t\t\t\textendsSysId: newRootElement.extendsSysId\n\t\t\t})\n\t\t},\n\t\tpageState\n\t);\n}\n\nconst addTemplateId = (templatePageState, templateId) => {\n\tconst layout = get(templatePageState, 'rootElement.layout.default');\n\tlayout.templateId = templateId;\n\treturn layout;\n};\n\nconst pageTemplateSelected = ({\n\taction,\n\tproperties,\n\tdispatch,\n\tupdateProperties,\n\tstate\n}) => {\n\tconst {\n\t\tpageState,\n\t\ttemplatesDefinitions,\n\t\tdataBrokerDefinitions,\n\t\teventHandlers\n\t} = properties;\n\n\tconst { pageTemplateId } = action.payload;\n\n\tconst selectedPageTemplate = templatesDefinitions.find(\n\t\t({ id }) => id === pageTemplateId\n\t);\n\n\tconst selectedPageTemplateAsPageState = transformMacroponentToPageState(\n\t\tselectedPageTemplate,\n\t\tdataBrokerDefinitions,\n\t\teventHandlers,\n\t\t[], // empty client state params array\n\t\tstate\n\t);\n\n\taddTemplateId(selectedPageTemplateAsPageState, pageTemplateId);\n\n\tconst reparentedComponents = reparentElementsToNewLayout(\n\t\tpageState.rootElement,\n\t\tnormalizeRowColumnSlots(selectedPageTemplateAsPageState.rootElement.layout)\n\t);\n\n\tconst children = [\n\t\t...selectedPageTemplateAsPageState.rootElement.children.filter(\n\t\t\tfunction removeExistingElements(element) {\n\t\t\t\treturn !reparentedComponents.find((reparentedElement) => {\n\t\t\t\t\treturn reparentedElement.id === element.id;\n\t\t\t\t});\n\t\t\t}\n\t\t),\n\t\t...reparentedComponents\n\t];\n\tconst newRootElement = cloneDeep({\n\t\t...selectedPageTemplateAsPageState.rootElement,\n\t\tid: pageState.rootElement.id,\n\t\tinstanceName: pageState.rootElement.instanceName,\n\t\tmacroponentProperties: pageState.rootElement.macroponentProperties,\n\t\tchildren\n\t});\n\n\tif (reparentedComponents.length > 0) {\n\t\tdispatch(UPDATE_LAYOUT_SUCCEEDED, {\n\t\t\tcomponents: reparentedComponents\n\t\t});\n\t}\n\n\tupdateProperties({\n\t\tpageState: getPageState(newRootElement, pageState)\n\t});\n};\n\nexport default {\n\t[PAGE_TEMPLATE_SELECTED]: pageTemplateSelected\n};\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport {\n\tPAGE_TEMPLATE_CREATE_REQUESTED,\n\tPAGE_TEMPLATE_CREATE_HTTP_REQUESTED,\n\tPAGE_TEMPLATE_CREATE_STARTED,\n\tPAGE_TEMPLATE_CREATE_FAILED,\n\tPAGE_TEMPLATE_CREATE_SUCCEEDED\n} from './pageTemplatesActions';\nimport { TEMPLATES_REQUESTED } from '../templates/templatesActions';\nimport { MACROPONENT_CATEGORY, SCREEN_TEMPLATE_SYS_ID } from '../../constants';\nimport effectProxy from '../helpers/effectProxy';\nimport { throwError } from '../../utils';\n\nconst pageCreateRequested = ({ action, properties, dispatch }) => {\n\tconst { name: label, layout } = action.payload;\n\tconst { templateTypes } = properties;\n\n\tconst pageType = (templateTypes.find((type) => type.name === 'page') || {})\n\t\t.id;\n\n\tdispatch(PAGE_TEMPLATE_CREATE_HTTP_REQUESTED, {\n\t\tdata: {\n\t\t\tlabel,\n\t\t\tassociatedTypes: [pageType],\n\t\t\tmacroponentInstance: {\n\t\t\t\tmacroponent: {\n\t\t\t\t\tname: label,\n\t\t\t\t\tcategory: MACROPONENT_CATEGORY,\n\t\t\t\t\textendsSysId: SCREEN_TEMPLATE_SYS_ID,\n\t\t\t\t\tlayout: JSON.parse(layout)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n};\n\n// TODO: figure out async and ui response\nconst pageTemplateCreateStarted = ({ updateProperties }) =>\n\tupdateProperties({ isSavingTemplate: true });\n\nconst pageTemplateCreateSucceeded = ({ dispatch }) => {\n\tdispatch(TEMPLATES_REQUESTED);\n};\n\nconst pageTemplateCreateFailed = () =>\n\tthrowError('Failed to save page template');\n\nexport const pageTemplateCreateHttpEffect = createHttpEffect(\n\t'/api/now/builder/templates',\n\t{\n\t\tmethod: 'POST',\n\t\tdataParam: 'data',\n\t\tstartActionType: PAGE_TEMPLATE_CREATE_STARTED,\n\t\tsuccessActionType: PAGE_TEMPLATE_CREATE_SUCCEEDED,\n\t\terrorActionType: PAGE_TEMPLATE_CREATE_FAILED,\n\t\tbatch: false\n\t}\n);\n\nexport default {\n\t[PAGE_TEMPLATE_CREATE_REQUESTED]: pageCreateRequested,\n\t[PAGE_TEMPLATE_CREATE_HTTP_REQUESTED]: effectProxy(\n\t\tpageTemplateCreateHttpEffect\n\t),\n\t[PAGE_TEMPLATE_CREATE_STARTED]: pageTemplateCreateStarted,\n\t[PAGE_TEMPLATE_CREATE_FAILED]: pageTemplateCreateFailed,\n\t[PAGE_TEMPLATE_CREATE_SUCCEEDED]: pageTemplateCreateSucceeded\n};\n","import * as pageTemplatesActions from './pageTemplatesActions';\nimport select from './pageTemplatesHandlers';\nimport create from './pageTemplateCreateHandlers';\n\nconst pageTemplatesHandlers = {\n\t...select,\n\t...create\n};\n\nexport { pageTemplatesActions, pageTemplatesHandlers };\n","export const LAYOUT_TEMPLATE_CREATE_REQUESTED =\n\t'SN_UXF#LAYOUT_TEMPLATE_CREATE_REQUESTED';\nexport const LAYOUT_TEMPLATE_CREATE_HTTP_REQUESTED =\n\t'SN_UXF#LAYOUT_TEMPLATE_CREATE_HTTP_REQUESTED';\nexport const LAYOUT_TEMPLATE_CREATE_STARTED =\n\t'SN_UXF#LAYOUT_TEMPLATE_CREATE_STARTED';\nexport const LAYOUT_TEMPLATE_CREATE_FAILED =\n\t'SN_UXF#LAYOUT_TEMPLATE_CREATE_FAILED';\nexport const LAYOUT_TEMPLATE_CREATE_SUCCEEDED =\n\t'SN_UXF#LAYOUT_TEMPLATE_CREATE_SUCCEEDED';\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport {\n\tLAYOUT_TEMPLATE_CREATE_REQUESTED,\n\tLAYOUT_TEMPLATE_CREATE_HTTP_REQUESTED,\n\tLAYOUT_TEMPLATE_CREATE_STARTED,\n\tLAYOUT_TEMPLATE_CREATE_FAILED,\n\tLAYOUT_TEMPLATE_CREATE_SUCCEEDED\n} from './layoutTemplatesActions';\nimport { TEMPLATES_REQUESTED } from '../templates/templatesActions';\nimport { MACROPONENT_CATEGORY, SCREEN_TEMPLATE_SYS_ID } from '../../constants';\nimport effectProxy from '../helpers/effectProxy';\nimport { throwError } from '../../utils';\n\nconst layoutTemplateCreateRequested = ({ action, properties, dispatch }) => {\n\tconst { name: label, layout } = action.payload;\n\tconst { templateTypes } = properties;\n\n\tconst layoutType = (\n\t\ttemplateTypes.find((type) => type.name === 'layout') || {}\n\t).id;\n\n\tdispatch(LAYOUT_TEMPLATE_CREATE_HTTP_REQUESTED, {\n\t\tdata: {\n\t\t\tlabel,\n\t\t\tassociatedTypes: [layoutType],\n\t\t\tmacroponentInstance: {\n\t\t\t\tmacroponent: {\n\t\t\t\t\tname: label,\n\t\t\t\t\tcategory: MACROPONENT_CATEGORY,\n\t\t\t\t\textendsSysId: SCREEN_TEMPLATE_SYS_ID,\n\t\t\t\t\tlayout: JSON.parse(layout)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n};\n\n// TODO: figure out async and ui response\nconst layoutTemplateCreateStarted = ({ updateProperties }) =>\n\tupdateProperties({ isSavingTemplate: true });\n\nconst layoutTemplateCreateSucceeded = ({ dispatch }) => {\n\tdispatch(TEMPLATES_REQUESTED);\n};\n\nconst layoutTemplateCreateFailed = () =>\n\tthrowError('Failed to save layout template');\n\nexport const layoutTemplateCreateHttpEffect = createHttpEffect(\n\t'/api/now/builder/templates',\n\t{\n\t\tmethod: 'POST',\n\t\tdataParam: 'data',\n\t\tstartActionType: LAYOUT_TEMPLATE_CREATE_STARTED,\n\t\tsuccessActionType: LAYOUT_TEMPLATE_CREATE_SUCCEEDED,\n\t\terrorActionType: LAYOUT_TEMPLATE_CREATE_FAILED,\n\t\tbatch: false\n\t}\n);\n\nexport default {\n\t[LAYOUT_TEMPLATE_CREATE_REQUESTED]: layoutTemplateCreateRequested,\n\t[LAYOUT_TEMPLATE_CREATE_HTTP_REQUESTED]: effectProxy(\n\t\tlayoutTemplateCreateHttpEffect\n\t),\n\t[LAYOUT_TEMPLATE_CREATE_STARTED]: layoutTemplateCreateStarted,\n\t[LAYOUT_TEMPLATE_CREATE_FAILED]: layoutTemplateCreateFailed,\n\t[LAYOUT_TEMPLATE_CREATE_SUCCEEDED]: layoutTemplateCreateSucceeded\n};\n","import { tokenize } from 'esprima';\n\nfunction stripEndQuotes(str) {\n\tif (\n\t\t(str.charAt(0) === '\"' && str.charAt(str.length - 1) === '\"') ||\n\t\t(str.charAt(0) === \"'\" && str.charAt(str.length - 1) === \"'\")\n\t) {\n\t\treturn str.substr(1, str.length - 2);\n\t}\n}\n\nexport default function createRequiredTranslations(scripts) {\n\tconst tokens = tokenize(scripts);\n\n\tif (!tokens.some((token) => token.value === 'translate')) {\n\t\treturn;\n\t}\n\n\treturn tokens.reduce((acc, currValue, currIndex, sourceArray) => {\n\t\tif (\n\t\t\tcurrValue.value === 'translate' &&\n\t\t\tsourceArray[currIndex - 1].value === '.' &&\n\t\t\tsourceArray[currIndex - 2].value === 'helpers'\n\t\t) {\n\t\t\tacc.push({\n\t\t\t\tmessage: stripEndQuotes(sourceArray[currIndex + 2].value)\n\t\t\t});\n\t\t}\n\t\treturn acc;\n\t}, []);\n}\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport _get from 'lodash/get';\nimport cloneDeep from 'lodash/cloneDeep';\nimport ClientScript from '../../models/clientScript';\nimport EventHandler from '../../models/eventHandler';\nimport createElementArray from '../element/utils/createElementArray';\nimport createPageState from '../../models/createPageState';\nimport createRequiredTranslations from './utils';\n\nimport {\n\tCLIENT_SCRIPTS_SCRIPT_CHANGED,\n\tCLIENT_SCRIPTS_SCRIPT_CREATED,\n\tCLIENT_SCRIPTS_SCRIPT_DELETED,\n\tCLIENT_SCRIPTS_CREATE_REQUESTED,\n\tCLIENT_SCRIPTS_CREATE_SUCCEEDED,\n\tCLIENT_SCRIPTS_DELETE_REQUESTED,\n\tCLIENT_SCRIPTS_DELETE_SUCCEEDED,\n\tCLIENT_SCRIPTS_UPDATE_REQUESTED,\n\tCLIENT_SCRIPTS_UPDATE_HTTP_REQUESTED,\n\tCLIENT_SCRIPTS_UPDATE_SUCCEEDED,\n\tCLIENT_SCRIPTS_CREATE_STARTED,\n\tCLIENT_SCRIPTS_DELETE_STARTED\n} from './clientScriptsActions';\n\nimport { processLinting } from '../../utils';\n\nimport { ELEMENT_EVENT_MAPPING_HANDLER_DELETED } from '../elementEventMappings/elementEventMappingsActions';\n\nimport { CLIENT_SCRIPT } from '../elementEventMappings/constants';\nconst DEFAULT_SCRIPT_NAME = 'New client script';\nconst matchExpr = new RegExp(`^${DEFAULT_SCRIPT_NAME} (\\\\d+)$`);\n\nconst clientScriptsScriptCreated = ({ properties, dispatch }) => {\n\tconst scope = _get(properties, 'pageState.scope', null);\n\n\tconst newClientScripts = properties.clientScripts.map(\n\t\t(script) => new ClientScript(script)\n\t);\n\tconst defaultScriptNameCount =\n\t\t1 +\n\t\tnewClientScripts.reduce((count, clientScript) => {\n\t\t\tconst matches = clientScript.name.match(matchExpr);\n\t\t\tif (matches) {\n\t\t\t\treturn Math.max(parseInt(matches[1], 10), count);\n\t\t\t}\n\t\t\treturn count;\n\t\t}, 0);\n\tconst name = `${DEFAULT_SCRIPT_NAME} ${defaultScriptNameCount}`;\n\tconst newClientScript = {\n\t\tname,\n\t\tscript: `/**\n * @param {params} params\n * @param {api} params.api\n * @param {any} params.event\n * @param {any} params.imports\n */\nfunction handler({api, event, helpers, imports}) {\\n}`,\n\t\tscope,\n\t\tincludes: []\n\t};\n\n\tdispatch(CLIENT_SCRIPTS_CREATE_REQUESTED, {\n\t\tscreenId: properties.pageState.sysId,\n\t\tdata: [newClientScript]\n\t});\n};\n\nconst clientScriptsScriptDeleted = ({\n\taction,\n\tupdateProperties,\n\tproperties,\n\tdispatch\n}) => {\n\tconst filteredScripts = [\n\t\t...properties.clientScripts.filter((clientScript) => {\n\t\t\treturn clientScript.id !== action.payload.id;\n\t\t})\n\t];\n\n\tconst filteredEventHandlers = [\n\t\t...properties.eventHandlers.filter((eventHandler) => {\n\t\t\treturn eventHandler.id !== action.payload.id;\n\t\t})\n\t];\n\n\tconst elementArr = createElementArray(\n\t\tproperties.pageState.rootElement,\n\t\t(element) => ({\n\t\t\tid: element.id,\n\t\t\teventMappings: element.eventMappings\n\t\t})\n\t);\n\n\telementArr.forEach((element) => {\n\t\telement.eventMappings.forEach((eventMapping) => {\n\t\t\teventMapping.targets.forEach((target) => {\n\t\t\t\tif (\n\t\t\t\t\ttarget.clientScript &&\n\t\t\t\t\ttarget.clientScript.sysId === action.payload.id\n\t\t\t\t) {\n\t\t\t\t\tdispatch(ELEMENT_EVENT_MAPPING_HANDLER_DELETED, {\n\t\t\t\t\t\telementId: element.id,\n\t\t\t\t\t\teventMappingId: eventMapping.eventMappingId,\n\t\t\t\t\t\thandlerId: target.targetId\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t});\n\n\tconst newPageState = createPageState(\n\t\t{ eventHandlers: filteredEventHandlers },\n\t\tcloneDeep(properties.pageState)\n\t);\n\n\tupdateProperties({\n\t\tclientScripts: filteredScripts,\n\t\tpageState: newPageState\n\t});\n\n\tdispatch(CLIENT_SCRIPTS_DELETE_REQUESTED, { scriptId: action.payload.id });\n};\n\nconst clientScriptsScriptChanged = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { code, name, id, includes } = action.payload;\n\n\tconst newPageState = createPageState(\n\t\t{\n\t\t\teventHandlers: properties.eventHandlers.map((eventHandler) => {\n\t\t\t\tconst returnValue = eventHandler;\n\n\t\t\t\tif (eventHandler.id === id) {\n\t\t\t\t\tif (typeof name === 'string') {\n\t\t\t\t\t\treturnValue.name = name;\n\t\t\t\t\t\treturnValue.label = name;\n\t\t\t\t\t}\n\t\t\t\t\tif (Array.isArray(includes)) {\n\t\t\t\t\t\treturnValue.includes = includes;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn returnValue;\n\t\t\t})\n\t\t},\n\t\tcloneDeep(properties.pageState)\n\t);\n\n\tupdateProperties({\n\t\tclientScripts: properties.clientScripts.map((clientScript) => {\n\t\t\tconst returnValue = clientScript;\n\n\t\t\tif (clientScript.id === id) {\n\t\t\t\tif (typeof name === 'string') {\n\t\t\t\t\treturnValue.name = name;\n\t\t\t\t}\n\t\t\t\tif (typeof code === 'string') {\n\t\t\t\t\treturnValue.script = code;\n\t\t\t\t}\n\t\t\t\tif (Array.isArray(includes)) {\n\t\t\t\t\treturnValue.includes = includes;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn returnValue;\n\t\t}),\n\t\tpageState: newPageState\n\t});\n};\n\nconst clientScriptsCreateRequested = createHttpEffect(\n\t'/api/now/uxframework/client_scripts/:screenId',\n\t{\n\t\tmethod: 'POST',\n\t\tbatch: false,\n\t\tpathParams: ['screenId'],\n\t\tqueryParams: ['sysparm_transaction_scope'],\n\t\tdataParam: 'data',\n\t\tsuccessActionType: CLIENT_SCRIPTS_CREATE_SUCCEEDED,\n\t\tstartActionType: CLIENT_SCRIPTS_CREATE_STARTED\n\t}\n);\nconst clientScriptsCreateStarted = ({ updateProperties }) => {\n\tupdateProperties({ isClientScriptsBusy: true });\n};\n\nconst clientScriptsCreateSucceeded = ({\n\tproperties,\n\taction: {\n\t\tpayload: { result }\n\t},\n\tupdateProperties\n}) => {\n\tconst newClientScript = new ClientScript(result[0]);\n\tconst newClientScripts = [newClientScript, ...properties.clientScripts];\n\n\tconst newEventHandler = new EventHandler({\n\t\tid: newClientScript.id,\n\t\tlabel: newClientScript.name,\n\t\ttype: CLIENT_SCRIPT,\n\t\tsourceName: 'Client script',\n\t\tsourceId: newClientScript.id,\n\t\tname: newClientScript.name,\n\t\tpayloadFields: []\n\t});\n\n\tupdateProperties({\n\t\tisClientScriptsBusy: false,\n\t\tclientScripts: newClientScripts,\n\t\teventHandlers: [...properties.eventHandlers, newEventHandler]\n\t});\n};\n\nconst clientScriptsDeleteRequested = createHttpEffect(\n\t'/api/now/uxframework/client_scripts/:scriptId',\n\t{\n\t\tmethod: 'DELETE',\n\t\tbatch: false,\n\t\tpathParams: ['scriptId'],\n\t\tsuccessActionType: CLIENT_SCRIPTS_DELETE_SUCCEEDED,\n\t\tstartActionType: CLIENT_SCRIPTS_DELETE_STARTED\n\t}\n);\n\nconst clientScriptsDeleteStarted = ({ updateProperties }) =>\n\tupdateProperties({ isClientScriptsBusy: true });\n\nconst clientScriptsDeleteSucceeded = ({ updateProperties }) =>\n\tupdateProperties({ isClientScriptsBusy: false });\n\nconst clientScriptsUpdateHttpEffect = createHttpEffect(\n\t'/api/now/uxframework/client_scripts',\n\t{\n\t\tmethod: 'PATCH',\n\t\tbatch: false,\n\t\tsuccessActionType: CLIENT_SCRIPTS_UPDATE_SUCCEEDED,\n\t\tdataParam: 'data'\n\t}\n);\n\nconst clientScriptsUpdateRequested = async ({ properties, dispatch }) => {\n\tconst { clientScripts } = properties;\n\n\tconst clientScriptsToUpdate = [];\n\tfor (const clientScript of clientScripts) {\n\t\tconst { script } = clientScript;\n\t\tconst errors = (await processLinting([script]))[0];\n\t\tclientScriptsToUpdate.push({\n\t\t\t...clientScript,\n\t\t\thasError: errors.length > 0,\n\t\t\trequiredTranslations: createRequiredTranslations(script)\n\t\t});\n\t}\n\n\tdispatch(CLIENT_SCRIPTS_UPDATE_HTTP_REQUESTED, {\n\t\tdata: clientScriptsToUpdate\n\t});\n};\n\nconst clientScriptsUpdateSucceeded = () => null;\n\nexport default {\n\t[CLIENT_SCRIPTS_SCRIPT_CHANGED]: clientScriptsScriptChanged,\n\t[CLIENT_SCRIPTS_SCRIPT_CREATED]: clientScriptsScriptCreated,\n\t[CLIENT_SCRIPTS_SCRIPT_DELETED]: clientScriptsScriptDeleted,\n\t[CLIENT_SCRIPTS_CREATE_REQUESTED]: clientScriptsCreateRequested,\n\t[CLIENT_SCRIPTS_CREATE_STARTED]: clientScriptsCreateStarted,\n\t[CLIENT_SCRIPTS_CREATE_SUCCEEDED]: clientScriptsCreateSucceeded,\n\t[CLIENT_SCRIPTS_DELETE_REQUESTED]: clientScriptsDeleteRequested,\n\t[CLIENT_SCRIPTS_DELETE_STARTED]: clientScriptsDeleteStarted,\n\t[CLIENT_SCRIPTS_DELETE_SUCCEEDED]: clientScriptsDeleteSucceeded,\n\t[CLIENT_SCRIPTS_UPDATE_REQUESTED]: clientScriptsUpdateRequested,\n\t[CLIENT_SCRIPTS_UPDATE_HTTP_REQUESTED]: clientScriptsUpdateHttpEffect,\n\t[CLIENT_SCRIPTS_UPDATE_SUCCEEDED]: clientScriptsUpdateSucceeded\n};\n","import {\n\tCLIENT_STATE_PARAMETER_CREATED,\n\tCLIENT_STATE_PARAMETER_DELETED,\n\tCLIENT_STATE_PARAMETER_CHANGED\n} from './clientStateActions';\nimport { ClientStateParameter } from '../../models';\nimport createPageState from '../../models/createPageState';\nimport { seismicCuid } from '../../utils';\nimport reject from 'lodash/reject';\nimport cloneDeep from 'lodash/cloneDeep';\n\nconst clientStateParameterCreated = ({ properties, updateProperties }) => {\n\tconst { pageState } = properties;\n\tconst newClientStateParameter = new ClientStateParameter({\n\t\tid: seismicCuid()\n\t});\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\tclientStateParameters: [\n\t\t\t\t\t...pageState.clientStateParameters,\n\t\t\t\t\tnewClientStateParameter\n\t\t\t\t]\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nconst clientStateParameterDeleted = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { id } = action.payload;\n\tconst { pageState } = properties;\n\tconst newClientStateParameters = reject(pageState.clientStateParameters, {\n\t\tid: id\n\t});\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\tclientStateParameters: [...newClientStateParameters]\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nconst clientStateParameterChanged = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { id, value, context } = action.payload;\n\tconst { pageState } = properties;\n\tconst newClientStateParams = cloneDeep(pageState.clientStateParameters);\n\n\tconst paramToUpdate = newClientStateParams.find((param) => param.id === id);\n\tlet fieldToUpdate;\n\tswitch (context) {\n\t\tcase 'param-name':\n\t\t\tfieldToUpdate = 'name';\n\t\t\tbreak;\n\t\tcase 'param-type':\n\t\t\tfieldToUpdate = 'type';\n\t\t\tbreak;\n\t\tcase 'param-value':\n\t\t\tfieldToUpdate = 'initialValue';\n\t\t\tbreak;\n\t}\n\tif (fieldToUpdate) {\n\t\tif (\n\t\t\tfieldToUpdate === 'initialValue' &&\n\t\t\tparamToUpdate.type === 'number' &&\n\t\t\ttypeof value === 'string' &&\n\t\t\t!value.startsWith('@')\n\t\t) {\n\t\t\tparamToUpdate[fieldToUpdate] = Number(value);\n\t\t} else {\n\t\t\tparamToUpdate[fieldToUpdate] = value;\n\t\t}\n\n\t\tif (fieldToUpdate === 'type') {\n\t\t\tparamToUpdate.initialValue = value === 'boolean' ? false : null;\n\t\t}\n\t}\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\tclientStateParameters: newClientStateParams\n\t\t\t},\n\t\t\tpageState\n\t\t)\n\t});\n};\n\nexport default {\n\t[CLIENT_STATE_PARAMETER_CREATED]: clientStateParameterCreated,\n\t[CLIENT_STATE_PARAMETER_DELETED]: clientStateParameterDeleted,\n\t[CLIENT_STATE_PARAMETER_CHANGED]: clientStateParameterChanged\n};\n","import { CLIENT_STATE_DATA_REQUESTED } from './clientStateActions';\nimport { processClientStateData } from '../utils';\n\nconst clientStateDataRequested = ({ action, properties, updateProperties }) => {\n\tconst { params } = action.payload;\n\tconst {\n\t\tpageState,\n\t\tancestorPageProperties,\n\t\tdataBrokerInstances,\n\t\tancestorDataBrokerInstances,\n\t\tancestorElements,\n\t\tappChromeSettings\n\t} = properties;\n\n\tupdateProperties({\n\t\tclientStateData: processClientStateData(\n\t\t\tparams,\n\t\t\tpageState,\n\t\t\tancestorPageProperties,\n\t\t\tdataBrokerInstances,\n\t\t\tancestorDataBrokerInstances,\n\t\t\tancestorElements,\n\t\t\tappChromeSettings\n\t\t)\n\t});\n};\n\nexport default {\n\t[CLIENT_STATE_DATA_REQUESTED]: clientStateDataRequested\n};\n","import { seismicCuid } from '../../../utils';\nimport EventMapping from '../../../models/eventMapping';\nimport Property from '../../../models/property';\nimport EventMappingTarget from '../../../models/eventMappingTarget';\nimport { EVENT, DATABROKER_OP } from '../../elementEventMappings/constants';\n\nconst generatePayloadProperty = (payloadField) => {\n\treturn new Property({\n\t\tname: payloadField.name,\n\t\tcolumnName: payloadField.name,\n\t\tlabel: payloadField.label,\n\t\ttype: payloadField.type,\n\t\tvalue: `@payload.${payloadField.name}`\n\t});\n};\n\nexport default function createScreenEventMapping(\n\tsourceEventId,\n\tsourceEventApiName,\n\ttargetHandler\n) {\n\tconst { type, apiName, id, payloadFields, sourceId, name } = targetHandler;\n\tconst eventMappingTarget = new EventMappingTarget({\n\t\ttargetId: seismicCuid(),\n\t\ttype\n\t});\n\n\tswitch (type) {\n\t\tcase EVENT:\n\t\t\teventMappingTarget.event = {};\n\t\t\teventMappingTarget.event.apiName = apiName;\n\t\t\teventMappingTarget.event.sysId = id;\n\t\t\teventMappingTarget.event.payload = payloadFields.map((payloadField) => {\n\t\t\t\treturn generatePayloadProperty(payloadField);\n\t\t\t});\n\t\t\tbreak;\n\t\tcase DATABROKER_OP:\n\t\t\teventMappingTarget.operation = {};\n\t\t\teventMappingTarget.operation.parentResourceId = sourceId;\n\t\t\teventMappingTarget.operation.dataBrokerId = id;\n\t\t\teventMappingTarget.operation.operationName = name;\n\t\t\teventMappingTarget.operation.payload = payloadFields.map(\n\t\t\t\t(payloadField) => {\n\t\t\t\t\treturn generatePayloadProperty(payloadField);\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\treturn new EventMapping({\n\t\teventId: sourceEventId,\n\t\teventApiName: sourceEventApiName,\n\t\teventMappingId: seismicCuid(),\n\t\ttargets: [eventMappingTarget]\n\t});\n}\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport get from 'lodash/get';\nimport set from 'lodash/set';\nimport createPageState from '../../models/createPageState';\nimport cloneDeep from 'lodash/cloneDeep';\nimport ElementEvent from '../../models/elementEvent';\nimport EventHandler from '../../models/eventHandler';\nimport createScreenEventMapping from './utils/createScreenEventMapping';\nimport { computeEventMappingTargetKeys } from '../page/utils/shared';\nimport {\n\tMCP_CONTRACT_EVENT_CREATED,\n\tMCP_CONTRACT_EVENT_CREATE_SUCCEEDED,\n\tMCP_CONTRACT_EVENT_CREATE_FAILED,\n\tMCP_CONTRACT_EVENT_FETCH_REQUESTED,\n\tMCP_CONTRACT_EVENT_UPDATED,\n\tMCP_CONTRACT_EVENT_UPDATE_SUCCEEDED,\n\tMCP_CONTRACT_EVENT_UPDATE_FAILED,\n\tMCP_CONTRACT_EVENT_DELETED,\n\tMCP_CONTRACT_EVENT_DELETE_REQUESTED\n} from './dispatchedEventsActions';\nimport { PAGE_SAVE_HTTP_REQUESTED } from '../page/pageActions';\nimport { formatEventNameAndLabel } from '../elementEventMappings/utils';\nimport { throwError } from '../../utils';\nimport { removePrefixes } from '../../factories/util';\n\nconst macroponentContractEventCreated = createHttpEffect(\n\t'/api/now/table/sys_ux_event?sysparm_fields=sys_scope.scope,event_name,label,sys_id,props',\n\t{\n\t\tmethod: 'POST',\n\t\tbatch: false,\n\t\tdataParam: 'event',\n\t\tqueryParams: ['sysparm_transaction_scope'],\n\t\tsuccessActionType: MCP_CONTRACT_EVENT_CREATE_SUCCEEDED,\n\t\terrorActionType: MCP_CONTRACT_EVENT_CREATE_FAILED\n\t}\n);\n\nconst macroponentContractEventCreateSucceeded = ({\n\taction,\n\tproperties,\n\tupdateProperties,\n\tdispatch\n}) => {\n\tconst { pageState } = properties;\n\tconst { result: rawResult } = action.payload;\n\tconst {\n\t\tscreenEventMappingHandler,\n\t\tsavePayload,\n\t\tsaveMeta,\n\t\tcontext: propName\n\t} = action.meta;\n\n\tlet result = rawResult;\n\tif (Array.isArray(rawResult)) {\n\t\tif (rawResult.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tresult = rawResult[0];\n\t}\n\n\tconst {\n\t\tevent_name: eventName,\n\t\tprops,\n\t\tlabel,\n\t\tsys_id: id,\n\t\t'sys_scope.scope': scopeName\n\t} = result;\n\tconst apiName = `${scopeName}.${eventName}`;\n\tlet payloadShape;\n\ttry {\n\t\tpayloadShape = JSON.parse(props);\n\t} catch (_) {\n\t\tpayloadShape = [];\n\t}\n\tconst newEvent = new ElementEvent({\n\t\tid,\n\t\teventName,\n\t\tpayloadShape,\n\t\tlabel,\n\t\tapiName\n\t});\n\n\tconst { eventHandlers = [] } = pageState;\n\tconst isRelay = eventHandlers.find((handler) => {\n\t\tconst { name } = formatEventNameAndLabel(handler, pageState.rootElement.id);\n\t\treturn name === eventName;\n\t});\n\n\tconst newEventHandler = new EventHandler({\n\t\tid,\n\t\tapiName,\n\t\tlabel,\n\t\ttype: 'EVENT',\n\t\tsourceName: pageState.rootElement.instanceName,\n\t\tsourceId: pageState.rootElement.id,\n\t\tname: eventName,\n\t\tpayloadFields: payloadShape.map((prop) => {\n\t\t\treturn {\n\t\t\t\t...prop,\n\t\t\t\ttype: prop.fieldType\n\t\t\t};\n\t\t}),\n\t\trelay: !!isRelay\n\t});\n\n\tconst clonedPageState = cloneDeep(pageState);\n\tlet updatedPageState = clonedPageState;\n\n\tif (screenEventMappingHandler) {\n\t\tconst newScreenEventMapping = createScreenEventMapping(\n\t\t\tid,\n\t\t\tapiName,\n\t\t\tscreenEventMappingHandler\n\t\t);\n\t\tupdatedPageState.screenEventMappings.unshift(newScreenEventMapping);\n\t\tupdatedPageState = createPageState(\n\t\t\t{\n\t\t\t\tscreenEventMappings: updatedPageState.screenEventMappings\n\t\t\t},\n\t\t\tupdatedPageState\n\t\t);\n\t}\n\n\tupdatedPageState[propName].unshift(newEvent);\n\tconst newPageState = createPageState(\n\t\t{\n\t\t\t[propName]: updatedPageState[propName],\n\t\t\teventHandlers: [...updatedPageState.eventHandlers, newEventHandler]\n\t\t},\n\t\tupdatedPageState\n\t);\n\n\tupdateProperties({\n\t\tpageState: newPageState\n\t});\n\n\tsavePayload &&\n\t\tdispatch(\n\t\t\tPAGE_SAVE_HTTP_REQUESTED,\n\t\t\t{\n\t\t\t\t...savePayload,\n\t\t\t\tpageStateModel: newPageState\n\t\t\t},\n\t\t\t{ ...saveMeta }\n\t\t);\n};\n\nconst macroponentContractEventUpdated = {\n\teffect: () => null,\n\tinterceptors: [\n\t\t(context) => {\n\t\t\tconst inputAction = context.coeffects.action;\n\t\t\t// Remove any i18n debugger prefixes on save\n\t\t\t// and dont patch event_name\n\t\t\tdelete inputAction.payload.event.event_name;\n\t\t\tconst existingLabel = get(inputAction, 'payload.event.label', '');\n\t\t\tset(inputAction, 'payload.event.label', removePrefixes(existingLabel));\n\n\t\t\tconst url = '/api/now/table/sys_ux_event/:eventId';\n\t\t\tconst options = {\n\t\t\t\tmethod: 'PATCH',\n\t\t\t\tbatch: false,\n\t\t\t\tdataParam: 'event',\n\t\t\t\tpathParams: ['eventId'],\n\t\t\t\tsuccessActionType: MCP_CONTRACT_EVENT_UPDATE_SUCCEEDED,\n\t\t\t\terrorActionType: MCP_CONTRACT_EVENT_UPDATE_FAILED\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\t...context,\n\t\t\t\teffects: [\n\t\t\t\t\t{\n\t\t\t\t\t\t...createHttpEffect(url, options, context.coeffects),\n\t\t\t\t\t\targs: [url, options, context.coeffects]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\t\t}\n\t]\n};\n\nconst macroponentContractEventUpdateSucceeded = ({\n\taction,\n\tupdateProperties,\n\tproperties,\n\tdispatch\n}) => {\n\tconst {\n\t\tresult: { label, props, event_name: eventName, sys_id: id }\n\t} = action.payload;\n\tlet payloadShape;\n\ttry {\n\t\tpayloadShape = JSON.parse(props);\n\t} catch (_) {\n\t\tpayloadShape = [];\n\t}\n\n\tconst {\n\t\tscreenEventMappingHandler,\n\t\tsavePayload,\n\t\tsaveMeta,\n\t\tcontext: propName\n\t} = action.meta || {};\n\n\tconst { pageState = {} } = properties;\n\tconst clonedEvents = cloneDeep(pageState[propName] || []);\n\tconst clonedEventHandlers = cloneDeep(pageState.eventHandlers || []);\n\tconst clonedPageState = cloneDeep(pageState);\n\tconst updatedPageState = clonedPageState;\n\n\tclonedEvents.forEach((event) => {\n\t\tif (event.id === id) {\n\t\t\tevent.label = label;\n\t\t\tevent.payloadShape = payloadShape;\n\t\t\tevent.eventName = eventName;\n\t\t}\n\t});\n\n\tclonedEventHandlers.forEach((handler) => {\n\t\tif (handler.id === id) {\n\t\t\thandler.label = label;\n\t\t\thandler.name = label;\n\t\t\thandler.payloadFields = payloadShape.map((prop) => ({\n\t\t\t\t...prop,\n\t\t\t\ttype: prop.fieldType\n\t\t\t}));\n\t\t}\n\t});\n\n\tconst screenEventMappingToUpdate = updatedPageState.screenEventMappings.find(\n\t\t(eventMapping) => eventMapping.eventId === id\n\t);\n\tscreenEventMappingToUpdate &&\n\t\tscreenEventMappingHandler &&\n\t\tscreenEventMappingToUpdate.targets.forEach((target) => {\n\t\t\tconst { targetKey, valueKey, idKey } = computeEventMappingTargetKeys(\n\t\t\t\ttarget.type\n\t\t\t);\n\t\t\tif (target[targetKey][idKey] === screenEventMappingHandler.id) {\n\t\t\t\ttarget[targetKey][valueKey].forEach((prop) => {\n\t\t\t\t\tif (!prop.value) {\n\t\t\t\t\t\tprop.value = `@payload.${prop.name}`;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\tconst newPageState = createPageState(\n\t\t{\n\t\t\t[propName]: clonedEvents,\n\t\t\teventHandlers: clonedEventHandlers\n\t\t},\n\t\tupdatedPageState\n\t);\n\n\tupdateProperties({\n\t\tpageState: newPageState\n\t});\n\n\tsavePayload &&\n\t\tdispatch(\n\t\t\tPAGE_SAVE_HTTP_REQUESTED,\n\t\t\t{\n\t\t\t\t...savePayload,\n\t\t\t\tpageStateModel: newPageState\n\t\t\t},\n\t\t\t{ ...saveMeta }\n\t\t);\n};\n\nconst macroponentContractEventUpdateFailed = ({ action }) => {\n\tconst failureMessage = get(action.payload, 'options.data.error.detail', '');\n\tthrowError(`Failed to update event: ${failureMessage}`);\n};\n\nconst macroponentContractEventDeleteRequested = createHttpEffect(\n\t'/api/now/table/sys_ux_event/:eventId',\n\t{\n\t\tmethod: 'DELETE',\n\t\tbatch: false,\n\t\tpathParams: ['eventId']\n\t}\n);\n\nconst macroponentContractEventDeleted = ({\n\taction,\n\tdispatch,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst { context: propName, eventId } = action.payload || {};\n\tconst { pageState = {} } = properties;\n\n\tconst clonedEventHandlers = cloneDeep(pageState.eventHandlers);\n\tconst clonedEvents = cloneDeep(pageState[propName]);\n\tconst filteredHandlers = clonedEventHandlers.filter(\n\t\t(handler) => handler.id !== eventId\n\t);\n\tconst filteredEvents = clonedEvents.filter((event) => event.id !== eventId);\n\n\tupdateProperties({\n\t\tpageState: createPageState(\n\t\t\t{\n\t\t\t\teventHandlers: filteredHandlers,\n\t\t\t\t[propName]: filteredEvents\n\t\t\t},\n\t\t\tcloneDeep(pageState)\n\t\t)\n\t});\n\n\tdispatch(MCP_CONTRACT_EVENT_DELETE_REQUESTED, { eventId });\n};\n\nconst macroponentContractEventCreateFailed = ({ action, dispatch }) => {\n\tconst failureMessage = get(action.payload, 'options.data.error.detail', '');\n\tconst messageMatcher = failureMessage.match(/.+?\\((.+)\\)/);\n\tconst targetEventLabel = messageMatcher ? messageMatcher[1] : undefined;\n\tif (targetEventLabel) {\n\t\tdispatch(\n\t\t\tMCP_CONTRACT_EVENT_FETCH_REQUESTED,\n\t\t\t{\n\t\t\t\tsysparm_query: `label=${targetEventLabel}`\n\t\t\t},\n\t\t\taction.meta\n\t\t);\n\t}\n};\n\nconst macroponentContractEventFetchRequested = createHttpEffect(\n\t'/api/now/table/sys_ux_event',\n\t{\n\t\tmethod: 'GET',\n\t\tqueryParams: ['sysparm_query'],\n\t\tbatch: false,\n\t\tsuccessActionType: MCP_CONTRACT_EVENT_CREATE_SUCCEEDED\n\t}\n);\n\nexport default {\n\t[MCP_CONTRACT_EVENT_CREATED]: macroponentContractEventCreated,\n\t[MCP_CONTRACT_EVENT_CREATE_SUCCEEDED]: macroponentContractEventCreateSucceeded,\n\t[MCP_CONTRACT_EVENT_CREATE_FAILED]: macroponentContractEventCreateFailed,\n\t[MCP_CONTRACT_EVENT_FETCH_REQUESTED]: macroponentContractEventFetchRequested,\n\t[MCP_CONTRACT_EVENT_UPDATED]: macroponentContractEventUpdated,\n\t[MCP_CONTRACT_EVENT_UPDATE_SUCCEEDED]: macroponentContractEventUpdateSucceeded,\n\t[MCP_CONTRACT_EVENT_UPDATE_FAILED]: macroponentContractEventUpdateFailed,\n\t[MCP_CONTRACT_EVENT_DELETED]: macroponentContractEventDeleted,\n\t[MCP_CONTRACT_EVENT_DELETE_REQUESTED]: macroponentContractEventDeleteRequested\n};\n","import { actionTypes } from '@servicenow/ui-core';\nimport { snUXFActions } from '../../sn-uxf-builder-middleware';\n\nconst componentDomReadyHandler = ({ dispatch }) => {\n\tdispatch(snUXFActions.AMB_SUBSCRIPTION_REQUESTED, {\n\t\ttable: 'sys_ux_data_broker',\n\t\tfilter: 'sys_idISNOTEMPTY',\n\t\tsubscribe: true\n\t});\n};\n\nexport default {\n\t[actionTypes.COMPONENT_DOM_READY]: componentDomReadyHandler\n};\n","export const AMB_SUBSCRIPTION_REQUESTED = 'SN_UXF#CREATE_AMB_SUBSCRIPTION';\nexport const AMB_UNSUBSCRIBE_REQUESTED = 'SN_UXF#AMB_UNSUBSCRIBE_REQUESTED';\n","import { createAmbSubscriptionEffect } from '@servicenow/ui-effect-amb';\nimport set from 'lodash/set';\nimport { encodeFilterForAmb } from './utils';\nimport { AMB_SUBSCRIPTION_REQUESTED } from './ambSubscribersActions';\n\nconst MESSAGE_UPDATE_ACTION_ROOT = 'SN_UXF#AMB_MESSAGE_RECEIVED';\nconst SUBSCRIPTION_SUCCEEDED_ACTION_ROOT = 'SN_UXF#AMB_SUBSCRIPTION_SUCCEEDED';\nconst SUBSCRIPTION_FAILED_ACTION_ROOT = 'SN_UXF#AMB_SUBSCRIPTION_FAILED';\nconst UNSUBSCRIBE_SUCCEEDED_ACTION_ROOT = 'SN_UXF#AMB_UNSUBSCRIBE_SUCCEEDED';\n\nconst ambSubscriptionRequestedHandler = {\n\teffect: () => null,\n\tinterceptors: [\n\t\t(context) => {\n\t\t\tconst {\n\t\t\t\tpayload: { table, filter }\n\t\t\t} = context.coeffects.action;\n\t\t\tconst targetTable = table || null;\n\t\t\tconst targetFilter = encodeFilterForAmb(filter) || null;\n\t\t\tif (!targetTable || !targetFilter) {\n\t\t\t\treturn context;\n\t\t\t}\n\t\t\tset(context.coeffects.action, 'payload.filter', targetFilter);\n\n\t\t\tconst messageReceivedActionType = `${MESSAGE_UPDATE_ACTION_ROOT}:${targetTable}`;\n\t\t\tconst subscriptionSucceededActionType = `${SUBSCRIPTION_SUCCEEDED_ACTION_ROOT}:${targetTable}`;\n\t\t\tconst subscriptionFailedActionType = `${SUBSCRIPTION_FAILED_ACTION_ROOT}:${targetTable}`;\n\t\t\tconst unsubscribeSucceededActionType = `${UNSUBSCRIBE_SUCCEEDED_ACTION_ROOT}:${targetTable}`;\n\n\t\t\tconst channel = '/rw/default/:table/:filter';\n\t\t\tconst options = {\n\t\t\t\tsubscribeSucceededActionType: subscriptionSucceededActionType,\n\t\t\t\tsubscribeFailedActionType: subscriptionFailedActionType,\n\t\t\t\tunsubscribeSucceededActionType: unsubscribeSucceededActionType,\n\t\t\t\tmessageReceivedActionType: messageReceivedActionType\n\t\t\t};\n\t\t\tconst ambEffect = createAmbSubscriptionEffect(channel, options);\n\n\t\t\treturn {\n\t\t\t\t...context,\n\t\t\t\teffects: [\n\t\t\t\t\t{\n\t\t\t\t\t\t...ambEffect,\n\t\t\t\t\t\targs: [...ambEffect.args, context.coeffects]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\t\t}\n\t]\n};\n\nexport default {\n\t[AMB_SUBSCRIPTION_REQUESTED]: ambSubscriptionRequestedHandler\n};\n","export const encodeFilterForAmb = (filter) => {\n\treturn btoa(filter).replace(/=/g, '-');\n};\n","import get from 'lodash/get';\nimport { UPDATED_TABLES_RESET_REQUESTED } from './updatedTablesActions';\nimport { messageInfo } from '../../utils';\n\nexport default {\n\t['SN_UXF#AMB_SUBSCRIPTION_SUCCEEDED:sys_ux_data_broker']: ({\n\t\tupdateProperties,\n\t\tproperties\n\t}) => {\n\t\t// eslint-disable-next-line no-console\n\t\tmessageInfo('(AMB) listening for changes/updates on sys_ux_data_broker');\n\t\tupdateProperties({\n\t\t\tupdatedTables: {\n\t\t\t\t...properties.updatedTables,\n\t\t\t\t['sys_ux_data_broker']: null\n\t\t\t}\n\t\t});\n\t},\n\t['SN_UXF#AMB_MESSAGE_RECEIVED:sys_ux_data_broker']: ({\n\t\taction,\n\t\tupdateProperties,\n\t\tproperties\n\t}) => {\n\t\tconst data = get(action.payload, 'data', {});\n\t\t// eslint-disable-next-line no-console\n\t\tmessageInfo('(AMB) change detected on sys_ux_data_broker', data);\n\t\tupdateProperties({\n\t\t\tupdatedTables: {\n\t\t\t\t...properties.updatedTables,\n\t\t\t\t['sys_ux_data_broker']: data\n\t\t\t}\n\t\t});\n\t},\n\t[UPDATED_TABLES_RESET_REQUESTED]: ({\n\t\taction,\n\t\tproperties,\n\t\tupdateProperties\n\t}) => {\n\t\tconst { table } = action.payload;\n\t\tupdateProperties({\n\t\t\tupdatedTables: {\n\t\t\t\t...properties.updatedTables,\n\t\t\t\t[table]: null\n\t\t\t}\n\t\t});\n\t}\n};\n","export const NEW_CREATE_PAGE = 'SN_UXF#NEW_PAGE_CREATE';\nexport const NEW_PAGE_SAVED = 'SN_UXF#NEW_PAGE_SAVED';\nexport const NEW_PAGE_SAVE_REQUEST = 'SN_UXF#NEW_PAGE_SAVE_REQUEST';\nexport const NEW_PAGE_SAVE_STARTED = 'SN_UXF#NEW_PAGE_SAVE_STARTED';\nexport const NEW_PAGE_SAVE_SUCCEEDED = 'SN_UXF#NEW_PAGE_SAVE_SUCCEEDED';\nexport const NEW_PAGE_SAVE_FAILED = 'SN_UXF#NEW_PAGE_SAVE_FAILED';\n\nexport const NEW_PAGE_CREATE_REQUEST = 'SN_UXF#NEW_PAGE_CREATE_REQUEST';\nexport const NEW_PAGE_CREATE_STARTED = 'SN_UXF#NEW_PAGE_CREATE_STARTED';\nexport const NEW_PAGE_CREATE_SUCCEEDED = 'SN_UXF#NEW_PAGE_CREATE_SUCCEEDED';\nexport const NEW_PAGE_CREATE_FAILED = 'SN_UXF#NEW_PAGE_CREATE_FAILED';\n\nexport const NEW_PAGE_DELETE_REQUEST = 'SN_UXF#NEW_PAGE_DELETE_REQUEST';\nexport const NEW_PAGE_DELETE_REQUEST_HTTP =\n\t'SN_UXF#NEW_PAGE_DELETE_REQUEST_HTTP';\nexport const NEW_PAGE_DELETE_STARTED = 'SN_UXF#NEW_PAGE_DELETE_STARTED';\nexport const NEW_PAGE_DELETE_SUCCEEDED = 'SN_UXF#NEW_PAGE_DELETE_SUCCEEDED';\nexport const NEW_PAGE_DELETE_FAILED = 'SN_UXF#NEW_PAGE_DELETE_FAILED';\n\nexport const NEW_PAGE_VARIANT_CREATE_REQUEST =\n\t'SN_UXF#NEW_PAGE_VARIANT_CREATE_REQUEST';\nexport const NEW_PAGE_VARIANT_CREATE_REQUEST_HTTP =\n\t'SN_UXF#NEW_PAGE_VARIANT_CREATE_REQUEST_HTTP';\nexport const NEW_PAGE_VARIANT_CREATE_STARTED =\n\t'SN_UXF#NEW_PAGE_VARIANT_CREATE_STARTED';\nexport const NEW_PAGE_VARIANT_CREATE_SUCCEEDED =\n\t'SN_UXF#NEW_PAGE_VARIANT_CREATE_SUCCEEDED';\nexport const NEW_PAGE_VARIANT_CREATE_FAILED =\n\t'SN_UXF#NEW_PAGE_VARIANT_CREATE_FAILED';\n\nexport const NEW_PAGE_VARIANT_CREATE_OVERRIDE_REQUEST =\n\t'SN_UXF#NEW_PAGE_VARIANT_CREATE_OVERRIDE_REQUEST';\nexport const NEW_PAGE_VARIANT_CREATE_OVERRIDE_STARTED =\n\t'NEW_PAGE_VARIANT_CREATE_OVERRIDE_STARTED';\nexport const NEW_PAGE_VARIANT_CREATE_OVERRIDE_SUCCEEDED =\n\t'SN_UXF#NEW_PAGE_VARIANT_CREATE_OVERRIDE_SUCCEEDED';\nexport const NEW_PAGE_VARIANT_CREATE_OVERRIDE_FAILED =\n\t'SN_UXF#NEW_PAGE_VARIANT_CREATE_OVERRIDE_FAILED';\n\nexport const NEW_PAGE_VARIANT_DELETE_REQUEST =\n\t'SN_UXF#NEW_PAGE_VARIANT_DELETE_REQUEST';\nexport const NEW_PAGE_VARIANT_DELETE_REQUEST_HTTP =\n\t'SN_UXF#NEW_PAGE_VARIANT_DELETE_REQUEST_HTTP';\nexport const NEW_PAGE_VARIANT_DELETE_STARTED =\n\t'SN_UXF#NEW_PAGE_VARIANT_DELETE_STARTED';\nexport const NEW_PAGE_VARIANT_DELETE_SUCCEEDED =\n\t'SN_UXF#NEW_PAGE_VARIANT_DELETE_SUCCEEDED';\nexport const NEW_PAGE_VARIANT_DELETE_FAILED =\n\t'SN_UXF#NEW_PAGE_VARIANT_DELETE_FAILED';\n","import transformMacroponentToPageState from '../page/utils/transformMacroponentToPageState';\n\nexport const addNewPageReceived = (\n\treceived,\n\tpages,\n\tdataBrokerDefinitions,\n\teventHandlers,\n\tstate,\n\tvariantId\n) => {\n\tconst pageState = transformMacroponentToPageState(\n\t\treceived,\n\t\tdataBrokerDefinitions,\n\t\teventHandlers,\n\t\t[], // empty client state params array on new page creation\n\t\tstate,\n\t\tvariantId\n\t);\n\n\treturn [\n\t\tpageState,\n\t\t[\n\t\t\t...pages,\n\t\t\t{\n\t\t\t\tname: pageState.name,\n\t\t\t\tsysId: pageState.sysId,\n\t\t\t\ttype: pageState.type,\n\t\t\t\tpageStatus: pageState.pageStatus,\n\t\t\t\tscope: pageState.scope,\n\t\t\t\tuiTypeParameters: pageState.uiTypeParameters,\n\t\t\t\treadOnly: pageState.readOnly,\n\t\t\t\tsysPolicy: pageState.sysPolicy,\n\t\t\t\tscreenType: received.screenType\n\t\t\t}\n\t\t]\n\t];\n};\n\nexport const replacePageWithOverrideReceived = (\n\treceived,\n\tpages,\n\tdataBrokerDefinitions,\n\teventHandlers,\n\tstate,\n\tvariantId\n) => {\n\tconst pageState = transformMacroponentToPageState(\n\t\treceived,\n\t\tdataBrokerDefinitions,\n\t\teventHandlers,\n\t\t[],\n\t\tstate,\n\t\tvariantId\n\t);\n\tconst index = pages.findIndex((page) => page.sysId === variantId);\n\n\treturn [\n\t\tpageState,\n\t\t[\n\t\t\t...pages.slice(0, index),\n\t\t\t{\n\t\t\t\tname: pageState.name,\n\t\t\t\tsysId: pageState.sysId,\n\t\t\t\ttype: pageState.type,\n\t\t\t\tpageStatus: pageState.pageStatus,\n\t\t\t\tscope: pageState.scope,\n\t\t\t\tuiTypeParameters: pageState.uiTypeParameters,\n\t\t\t\treadOnly: pageState.readOnly,\n\t\t\t\tsysPolicy: pageState.sysPolicy,\n\t\t\t\tscreenType: received.screenType\n\t\t\t},\n\t\t\t...pages.slice(index + 1)\n\t\t]\n\t];\n};\n\nexport const pathParamsFromPayload = ({\n\tappId,\n\tappsSysId,\n\tpageSysId,\n\tvariantSysId,\n\tname\n}) => ({\n\tappsSysId: appId || appsSysId,\n\tpageSysId,\n\tvariantSysId,\n\tname\n});\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport cloneDeep from 'lodash/cloneDeep';\nimport get from 'lodash/get';\nimport {\n\tNEW_CREATE_PAGE,\n\tNEW_PAGE_CREATE_REQUEST,\n\tNEW_PAGE_CREATE_STARTED,\n\tNEW_PAGE_CREATE_SUCCEEDED,\n\tNEW_PAGE_CREATE_FAILED\n} from './newPageActions';\nimport processContextState from '../contextState/contextStateProcessor';\nimport { addNewPageReceived, pathParamsFromPayload } from './newPageUtils';\nimport createPageState from '../../models/createPageState';\n\nconst newCreatePage = ({ action, dispatch }) => {\n\tdispatch(\n\t\tNEW_PAGE_CREATE_REQUEST,\n\t\taction.payload,\n\t\tpathParamsFromPayload(action.payload)\n\t);\n};\n\nconst newPageCreateStarted = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: true });\n};\nconst newPageCreateSucceeded = ({\n\tupdateProperties,\n\tupdateState,\n\taction,\n\tproperties,\n\tstate\n}) => {\n\tconst {\n\t\tdataBrokerDefinitions,\n\t\teventHandlers,\n\t\tpages,\n\t\tpageState: oldPageState\n\t} = properties;\n\n\tconst variantId = get(oldPageState, 'sysId');\n\n\tconst [pageState, newPages] = addNewPageReceived(\n\t\taction.payload.result,\n\t\tpages,\n\t\tdataBrokerDefinitions,\n\t\teventHandlers,\n\t\tstate,\n\t\tvariantId\n\t);\n\n\tconst {\n\t\tancestorDataBrokerInstances,\n\t\tparentDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tparentPageProperties,\n\t\tancestorElements,\n\t\tparentElements,\n\t\tparentEventHandlers,\n\t\tappChromeSettings,\n\t\ttheme\n\t} = processContextState({\n\t\tcontextState: get(action.payload, 'result.contextState', {}),\n\t\tupdateState,\n\t\tproperties\n\t});\n\n\tconst updatedPageState = createPageState(\n\t\t{\n\t\t\teventHandlers: parentEventHandlers\n\t\t},\n\t\tpageState\n\t);\n\n\tupdateProperties({ pages: newPages });\n\n\tupdateProperties({\n\t\tancestorDataBrokerInstances,\n\t\tparentDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tparentPageProperties,\n\t\tancestorElements,\n\t\tparentElements,\n\t\tappChromeSettings,\n\t\ttheme,\n\t\tisSavingPage: false,\n\t\tpageState: updatedPageState,\n\t\tpageStatePristine: cloneDeep(updatedPageState)\n\t});\n};\nconst newPageCreateFailed = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false, isLoadingPage: false });\n};\n\nexport default {\n\t[NEW_CREATE_PAGE]: newCreatePage,\n\t[NEW_PAGE_CREATE_REQUEST]: createHttpEffect(\n\t\t'/api/now/builder/:builderType/:appId/pages',\n\t\t{\n\t\t\tmethod: 'POST',\n\t\t\tbatch: false,\n\t\t\tpathParams: ['builderType', 'appId'],\n\t\t\tdataParam: 'data',\n\t\t\tstartActionType: NEW_PAGE_CREATE_STARTED,\n\t\t\tsuccessActionType: NEW_PAGE_CREATE_SUCCEEDED,\n\t\t\terrorActionType: NEW_PAGE_CREATE_FAILED\n\t\t}\n\t),\n\t[NEW_PAGE_CREATE_STARTED]: newPageCreateStarted,\n\t[NEW_PAGE_CREATE_SUCCEEDED]: newPageCreateSucceeded,\n\t[NEW_PAGE_CREATE_FAILED]: newPageCreateFailed\n};\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport {\n\tNEW_PAGE_DELETE_REQUEST,\n\tNEW_PAGE_DELETE_REQUEST_HTTP,\n\tNEW_PAGE_DELETE_STARTED,\n\tNEW_PAGE_DELETE_SUCCEEDED,\n\tNEW_PAGE_DELETE_FAILED\n} from './newPageActions';\nimport { pathParamsFromPayload } from './newPageUtils';\n\nconst newPageDeleteRequestEffect = createHttpEffect(\n\t'/api/now/builder/apps/:appId/pages/:pageSysId',\n\t{\n\t\tmethod: 'DELETE',\n\t\tpathParams: ['appId', 'pageSysId'],\n\t\tstartActionType: NEW_PAGE_DELETE_STARTED,\n\t\tsuccessActionType: NEW_PAGE_DELETE_SUCCEEDED,\n\t\terrorActionType: NEW_PAGE_DELETE_FAILED\n\t}\n);\n\nconst newPageDeleteRequestHandler = ({ action, dispatch }) => {\n\tdispatch(\n\t\tNEW_PAGE_DELETE_REQUEST_HTTP,\n\t\taction.payload,\n\t\tpathParamsFromPayload(action.payload)\n\t);\n};\n\nconst newPageDeleteStarted = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: true });\n};\n\nconst newPageDeleteSucceeded = ({ updateProperties, dispatch }) => {\n\tdispatch('SN_UXF#PAGE_STATE_CLEARED');\n\tupdateProperties({ isSavingPage: true });\n};\n\nconst newPageDeleteFailed = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false, isLoadingPage: false });\n};\n\nexport default {\n\t[NEW_PAGE_DELETE_REQUEST]: newPageDeleteRequestHandler,\n\t[NEW_PAGE_DELETE_REQUEST_HTTP]: newPageDeleteRequestEffect,\n\t[NEW_PAGE_DELETE_STARTED]: newPageDeleteStarted,\n\t[NEW_PAGE_DELETE_SUCCEEDED]: newPageDeleteSucceeded,\n\t[NEW_PAGE_DELETE_FAILED]: newPageDeleteFailed\n};\n","import get from 'lodash/get';\nimport { create as createMcpProperty } from '../../models/macroponentProperty';\n\nexport const generateUpdatedMacroponentProperties = (\n\tscreen,\n\tmacroponentProperties = []\n) => {\n\tconst updatedMcpDefinitions = get(\n\t\tscreen,\n\t\t'macroponentInstance.macroponentDefinitions',\n\t\t{}\n\t);\n\tconst rootMcpId = get(screen, 'macroponentInstance.rootMacroponentId', null);\n\tconst rootMcpHydratedPropertyValues =\n\t\tget(screen, 'macroponentInstance.propertyValues', {}) || {};\n\tconst rootMcpHydratedPropertyTestValues =\n\t\tget(screen, 'macroponentInstance.propertyTestValues', {}) || {};\n\tconst rootMcpDef = updatedMcpDefinitions[rootMcpId];\n\tconst newProperties =\n\t\trootMcpDef.properties\n\t\t\t.filter(\n\t\t\t\t({ label }) =>\n\t\t\t\t\t!macroponentProperties.find(\n\t\t\t\t\t\t({ label: existingLabel }) => label === existingLabel\n\t\t\t\t\t)\n\t\t\t)\n\t\t\t.map((prop) => {\n\t\t\t\tconst newProp = createMcpProperty(prop);\n\t\t\t\tnewProp.value =\n\t\t\t\t\trootMcpHydratedPropertyValues[prop.name] ||\n\t\t\t\t\trootMcpHydratedPropertyTestValues[prop.name] ||\n\t\t\t\t\t'';\n\t\t\t\treturn newProp;\n\t\t\t}) || [];\n\treturn [...newProperties, ...macroponentProperties];\n};\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport get from 'lodash/get';\nimport cloneDeep from 'lodash/cloneDeep';\nimport {\n\tNEW_PAGE_SAVED,\n\tNEW_PAGE_SAVE_REQUEST,\n\tNEW_PAGE_SAVE_STARTED,\n\tNEW_PAGE_SAVE_SUCCEEDED,\n\tNEW_PAGE_SAVE_FAILED\n} from './newPageActions';\nimport createPageState from '../../models/createPageState';\nimport { generateUpdatedMacroponentProperties } from './utils';\n\nconst newPageSave = ({ action, dispatch }) => {\n\tconst {\n\t\trouteType,\n\t\tpageName,\n\t\tparameters,\n\t\tfields,\n\t\ticon,\n\t\torder\n\t} = action.payload.data;\n\tdispatch(\n\t\tNEW_PAGE_SAVE_REQUEST,\n\t\t{\n\t\t\t...action.payload,\n\t\t\tdata: {\n\t\t\t\trouteType,\n\t\t\t\tname: pageName,\n\t\t\t\tparameters: parameters\n\t\t\t\t\t? Object.values(parameters).map((p) => ({\n\t\t\t\t\t\t\tname: p.name\n\t\t\t\t\t  }))\n\t\t\t\t\t: parameters,\n\t\t\t\tfields,\n\t\t\t\ticon,\n\t\t\t\torder\n\t\t\t}\n\t\t},\n\t\taction.meta\n\t);\n};\n\nconst newPageSaveStarted = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: true });\n};\nconst newPageSaveSucceeded = ({ action, properties, updateProperties }) => {\n\tconst { pageState } = properties;\n\tconst {\n\t\trootElement: { macroponentProperties }\n\t} = pageState;\n\n\tconst variants = get(action.payload, 'result.variants', []);\n\tconst currentlyLoadedScreen = variants.find(\n\t\t(variant) => variant.id === pageState.sysId\n\t);\n\tif (!currentlyLoadedScreen) {\n\t\treturn updateProperties({ isSavingPage: false, isLoadingPage: false });\n\t}\n\n\tconst oldPageState = cloneDeep(pageState);\n\tconst newPageState = createPageState(\n\t\t{\n\t\t\trootElement: {\n\t\t\t\t...oldPageState.rootElement,\n\t\t\t\tmacroponentProperties: generateUpdatedMacroponentProperties(\n\t\t\t\t\tcurrentlyLoadedScreen,\n\t\t\t\t\tmacroponentProperties\n\t\t\t\t)\n\t\t\t}\n\t\t},\n\t\toldPageState\n\t);\n\tupdateProperties({\n\t\tpageState: newPageState,\n\t\tpageStatePristine: newPageState,\n\t\tisSavingPage: false,\n\t\tisLoadingPage: false\n\t});\n};\nconst newPageSaveFailed = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false, isLoadingPage: false });\n};\n\nexport default {\n\t[NEW_PAGE_SAVED]: newPageSave,\n\t[NEW_PAGE_SAVE_REQUEST]: createHttpEffect(\n\t\t'/api/now/builder/apps/:appId/pages/:pageId',\n\t\t{\n\t\t\tmethod: 'PATCH',\n\t\t\tpathParams: ['appId', 'pageId'],\n\t\t\tdataParam: 'data',\n\t\t\tqueryParams: ['sysparm_transaction_scope'],\n\t\t\tstartActionType: NEW_PAGE_SAVE_STARTED,\n\t\t\tsuccessActionType: NEW_PAGE_SAVE_SUCCEEDED,\n\t\t\terrorActionType: NEW_PAGE_SAVE_FAILED,\n\t\t\tbatch: false\n\t\t}\n\t),\n\t[NEW_PAGE_SAVE_STARTED]: newPageSaveStarted,\n\t[NEW_PAGE_SAVE_SUCCEEDED]: newPageSaveSucceeded,\n\t[NEW_PAGE_SAVE_FAILED]: newPageSaveFailed\n};\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport {\n\tNEW_PAGE_VARIANT_CREATE_REQUEST,\n\tNEW_PAGE_VARIANT_CREATE_REQUEST_HTTP,\n\tNEW_PAGE_VARIANT_CREATE_STARTED,\n\tNEW_PAGE_VARIANT_CREATE_SUCCEEDED,\n\tNEW_PAGE_VARIANT_CREATE_FAILED\n} from './newPageActions';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { getTemplates } from '@devsnc/library-uxf';\nimport processContextState from '../contextState/contextStateProcessor';\nimport { pathParamsFromPayload, addNewPageReceived } from './newPageUtils';\nimport get from 'lodash/get';\n\nconst newPageVariantCreateHandler = ({ action, dispatch }) => {\n\tdispatch(\n\t\tNEW_PAGE_VARIANT_CREATE_REQUEST_HTTP,\n\t\taction.payload,\n\t\tpathParamsFromPayload(action.payload)\n\t);\n};\n\nconst newPageVariantCreateStarted = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: true });\n};\nexport const newPageVariantCreateSucceeded = ({\n\tupdateProperties,\n\tupdateState,\n\taction,\n\tproperties,\n\tstate\n}) => {\n\tconst { dataBrokerDefinitions, pages } = properties;\n\n\tconst {\n\t\tresult: {\n\t\t\tmacroponentInstance: { rootMacroponentId },\n\t\t\tcontextState\n\t\t}\n\t} = action.payload;\n\n\tconst {\n\t\tancestorDataBrokerInstances,\n\t\tparentDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tparentPageProperties,\n\t\tancestorElements,\n\t\tparentElements,\n\t\tappChromeSettings,\n\t\tparentEventHandlers,\n\t\ttheme\n\t} = processContextState({\n\t\tcontextState,\n\t\tupdateState,\n\t\tproperties: { dataBrokerDefinitions }\n\t});\n\n\t// Load component scripts dynamically\n\t// This is async, but shouldn't matter if the scripts are loaded after\n\t// the component tags have been rendered in the html\n\tif (rootMacroponentId) {\n\t\tgetTemplates([rootMacroponentId]);\n\t}\n\n\tconst variantId = get(properties, 'pageState.sysId', '');\n\n\tconst [pageState, newPages] = addNewPageReceived(\n\t\taction.payload.result,\n\t\tpages,\n\t\tdataBrokerDefinitions,\n\t\tparentEventHandlers,\n\t\tstate,\n\t\tvariantId\n\t);\n\n\tupdateProperties({ pages: newPages });\n\n\tupdateProperties({\n\t\tancestorDataBrokerInstances,\n\t\tparentDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tparentPageProperties,\n\t\tancestorElements,\n\t\tappChromeSettings,\n\t\tparentElements,\n\t\ttheme,\n\t\tisSavingPage: false,\n\t\tpageState,\n\t\tpageStatePristine: cloneDeep(pageState)\n\t});\n};\nconst newPageVariantCreateFailed = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false, isLoadingPage: false });\n};\n\nconst newPageVariantCreateHttpEffect = createHttpEffect(\n\t'/api/now/builder/:builderType/:appId/pages/:pageSysId/variants',\n\t{\n\t\tmethod: 'POST',\n\t\tpathParams: ['builderType', 'appId', 'pageSysId'],\n\t\tdataParam: 'data',\n\t\tstartActionType: NEW_PAGE_VARIANT_CREATE_STARTED,\n\t\tsuccessActionType: NEW_PAGE_VARIANT_CREATE_SUCCEEDED,\n\t\terrorActionType: NEW_PAGE_VARIANT_CREATE_FAILED,\n\t\tbatch: false\n\t}\n);\n\nexport default {\n\t[NEW_PAGE_VARIANT_CREATE_REQUEST]: newPageVariantCreateHandler,\n\t[NEW_PAGE_VARIANT_CREATE_REQUEST_HTTP]: newPageVariantCreateHttpEffect,\n\t[NEW_PAGE_VARIANT_CREATE_STARTED]: newPageVariantCreateStarted,\n\t[NEW_PAGE_VARIANT_CREATE_SUCCEEDED]: newPageVariantCreateSucceeded,\n\t[NEW_PAGE_VARIANT_CREATE_FAILED]: newPageVariantCreateFailed\n};\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\nimport {\n\tNEW_PAGE_VARIANT_DELETE_REQUEST,\n\tNEW_PAGE_VARIANT_DELETE_STARTED,\n\tNEW_PAGE_VARIANT_DELETE_SUCCEEDED,\n\tNEW_PAGE_VARIANT_DELETE_FAILED,\n\tNEW_PAGE_VARIANT_DELETE_REQUEST_HTTP\n} from './newPageActions';\nimport { pathParamsFromPayload } from './newPageUtils';\n\nconst newVariantDeletedHandler = ({ action, dispatch }) => {\n\tconst {\n\t\tpayload: { name, variantSysId, pageSysId, appId }\n\t} = action;\n\n\tdispatch(\n\t\tNEW_PAGE_VARIANT_DELETE_REQUEST_HTTP,\n\t\t{\n\t\t\tname,\n\t\t\tvariantSysId,\n\t\t\tpageSysId,\n\t\t\tappId\n\t\t},\n\t\tpathParamsFromPayload(action.payload)\n\t);\n};\nconst newPageVariantDeleteStarted = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: true });\n};\n\nconst newVariantDeletedHttpHandler = createHttpEffect(\n\t'/api/now/builder/apps/:appId/pages/:pageSysId/variants/:variantSysId',\n\t{\n\t\tmethod: 'DELETE',\n\t\tpathParams: ['appId', 'pageSysId', 'variantSysId'],\n\t\tstartActionType: NEW_PAGE_VARIANT_DELETE_STARTED,\n\t\tsuccessActionType: NEW_PAGE_VARIANT_DELETE_SUCCEEDED,\n\t\terrorActionType: NEW_PAGE_VARIANT_DELETE_FAILED,\n\t\tbatch: false\n\t}\n);\n\nconst newPageVariantDeleteSucceeded = ({\n\taction,\n\tproperties,\n\tupdateProperties\n}) => {\n\tconst {\n\t\tmeta: { deleteSysId }\n\t} = action;\n\n\tconst pages = properties.pages.filter(({ sysId }) => sysId !== deleteSysId);\n\n\tupdateProperties({\n\t\tpages,\n\t\tisSavingPage: false,\n\t\tpageState: null,\n\t\tpageStatePristine: null,\n\t\tisPageStateDirty: false\n\t});\n};\nconst newPageVariantDeleteFailed = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false, isLoadingPage: false });\n};\n\nexport default {\n\t[NEW_PAGE_VARIANT_DELETE_REQUEST]: newVariantDeletedHandler,\n\t[NEW_PAGE_VARIANT_DELETE_REQUEST_HTTP]: newVariantDeletedHttpHandler,\n\t[NEW_PAGE_VARIANT_DELETE_STARTED]: newPageVariantDeleteStarted,\n\t[NEW_PAGE_VARIANT_DELETE_SUCCEEDED]: newPageVariantDeleteSucceeded,\n\t[NEW_PAGE_VARIANT_DELETE_FAILED]: newPageVariantDeleteFailed\n};\n","import {\n\tNEW_PAGE_VARIANT_CREATE_OVERRIDE_FAILED,\n\tNEW_PAGE_VARIANT_CREATE_OVERRIDE_REQUEST,\n\tNEW_PAGE_VARIANT_CREATE_OVERRIDE_STARTED,\n\tNEW_PAGE_VARIANT_CREATE_OVERRIDE_SUCCEEDED\n} from './newPageActions';\nimport { createHttpEffect } from '@servicenow/ui-effect-http';\nimport processContextState from '../contextState/contextStateProcessor';\nimport { getTemplates } from '@devsnc/library-uxf';\nimport { replacePageWithOverrideReceived } from './newPageUtils';\nimport cloneDeep from 'lodash/cloneDeep';\n\nconst newPageVariantOverrideSucceeded = ({\n\tupdateProperties,\n\tupdateState,\n\taction,\n\tproperties,\n\tstate\n}) => {\n\tconst { dataBrokerDefinitions, pages } = properties;\n\n\tconst {\n\t\tresult: {\n\t\t\tmacroponentInstance: { rootMacroponentId },\n\t\t\tcontextState\n\t\t}\n\t} = action.payload;\n\n\tconst {\n\t\tancestorDataBrokerInstances,\n\t\tparentDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tparentPageProperties,\n\t\tancestorElements,\n\t\tappChromeSettings,\n\t\tparentElements,\n\t\tparentEventHandlers,\n\t\ttheme\n\t} = processContextState({\n\t\tcontextState,\n\t\tupdateState,\n\t\tproperties: { dataBrokerDefinitions }\n\t});\n\n\t// Load component scripts dynamically\n\t// This is async, but shouldn't matter if the scripts are loaded after\n\t// the component tags have been rendered in the html\n\tif (rootMacroponentId) {\n\t\tgetTemplates([rootMacroponentId]);\n\t}\n\n\tconst {\n\t\tpageState: { sysId: variantId }\n\t} = properties;\n\n\tconst [pageState, newPages] = replacePageWithOverrideReceived(\n\t\taction.payload.result,\n\t\tpages,\n\t\tdataBrokerDefinitions,\n\t\tparentEventHandlers,\n\t\tstate,\n\t\tvariantId\n\t);\n\n\tupdateProperties({\n\t\tpages: newPages,\n\t\tancestorDataBrokerInstances,\n\t\tparentDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tparentPageProperties,\n\t\tappChromeSettings,\n\t\tancestorElements,\n\t\tparentElements,\n\t\ttheme,\n\t\tpageState,\n\t\tpageStatePristine: cloneDeep(pageState)\n\t});\n};\n\nexport const generateOverrideCreateHttpEffect = ({\n\tsuccessActionType,\n\terrorActionType,\n\tstartActionType\n}) =>\n\tcreateHttpEffect('/api/now/uxframework/screens/:sysId/override', {\n\t\tmethod: 'POST',\n\t\tpathParams: ['sysId'],\n\t\tdataParam: 'data',\n\t\tqueryParams: ['sysparm_transaction_scope'],\n\t\tstartActionType,\n\t\tsuccessActionType,\n\t\terrorActionType,\n\t\tbatch: false\n\t});\n\nconst newPageVariantCreateOverrideHttpEffect = generateOverrideCreateHttpEffect(\n\t{\n\t\tsuccessActionType: NEW_PAGE_VARIANT_CREATE_OVERRIDE_SUCCEEDED,\n\t\tstartActionType: NEW_PAGE_VARIANT_CREATE_OVERRIDE_STARTED,\n\t\terrorActionType: NEW_PAGE_VARIANT_CREATE_OVERRIDE_FAILED\n\t}\n);\n\nexport default {\n\t[NEW_PAGE_VARIANT_CREATE_OVERRIDE_REQUEST]: newPageVariantCreateOverrideHttpEffect,\n\t[NEW_PAGE_VARIANT_CREATE_OVERRIDE_SUCCEEDED]: newPageVariantOverrideSucceeded\n};\n","import { createHttpEffect } from '@servicenow/ui-effect-http';\n\nimport {\n\tCONFIGURATION_COMPONENT_BY_INTERFACE_REQUESTED,\n\tCONFIGURATION_COMPONENT_BY_INTERFACE_SUCCEEDED,\n\tCONFIGURATION_COMPONENT_BY_INTERFACE_FAILED\n} from './configurationComponentByInterfaceActions';\n\nimport { COMPONENT_SOURCES_REQUESTED } from '../componentSources/componentSourcesActions';\n\nconst configurationComponentByInterfaceRequested = createHttpEffect(\n\t'/api/now/uxf/config_components/by_interface',\n\t{\n\t\tmethod: 'GET',\n\t\tsuccessActionType: CONFIGURATION_COMPONENT_BY_INTERFACE_SUCCEEDED,\n\t\terrorActionType: CONFIGURATION_COMPONENT_BY_INTERFACE_FAILED\n\t}\n);\n\nconst configurationComponentByInterfaceSucceeded = ({\n\taction,\n\tdispatch,\n\tupdateProperties\n}) => {\n\tconst configComponentsToLoad = Array.from(\n\t\tnew Set(\n\t\t\tObject.values(action.payload.result).map((value) => {\n\t\t\t\treturn value.componentId;\n\t\t\t})\n\t\t)\n\t);\n\n\tupdateProperties({ interfaceConfigurationComponent: action.payload.result });\n\n\tdispatch(COMPONENT_SOURCES_REQUESTED, {\n\t\tconfigComponents: configComponentsToLoad\n\t});\n};\n\nconst configurationComponentByInterfaceFailed = ({\n\tdispatch,\n\tupdateProperties\n}) => {\n\tupdateProperties({ interfaceConfigurationComponent: {} });\n\tdispatch(COMPONENT_SOURCES_REQUESTED, {\n\t\tconfigComponents: []\n\t});\n};\n\nexport default {\n\t[CONFIGURATION_COMPONENT_BY_INTERFACE_REQUESTED]: configurationComponentByInterfaceRequested,\n\t[CONFIGURATION_COMPONENT_BY_INTERFACE_SUCCEEDED]: configurationComponentByInterfaceSucceeded,\n\t[CONFIGURATION_COMPONENT_BY_INTERFACE_FAILED]: configurationComponentByInterfaceFailed\n};\n","import { getComponentsByTagNames } from '@devsnc/library-uxf';\n\nimport { COMPONENT_SOURCES_REQUESTED } from './componentSourcesActions';\n\nlet configComponents = null;\nlet pageComponents = null;\n\nconst componentSourcesRequested = ({ action }) => {\n\tif (action.payload.configComponents) {\n\t\tconfigComponents = action.payload.configComponents;\n\t}\n\n\tif (action.payload.pageComponents) {\n\t\tpageComponents = action.payload.pageComponents;\n\t}\n\n\tif (configComponents && pageComponents) {\n\t\tgetComponentsByTagNames(configComponents.concat(pageComponents));\n\t}\n};\n\nexport default {\n\t[COMPONENT_SOURCES_REQUESTED]: componentSourcesRequested\n};\n","export const layout = {\n\tdefault: {\n\t\ttype: 'grid',\n\t\troot: null,\n\t\tstyles: {},\n\t\trules: {\n\t\t\t'grid-template-columns': '1fr',\n\t\t\t'grid-template-rows': 'repeat(3, auto)',\n\t\t\t'grid-column-gap': '0px',\n\t\t\t'grid-row-gap': '1rem'\n\t\t},\n\t\tchildren: null,\n\t\titems: [\n\t\t\t{\n\t\t\t\tslotName: 'modal-title',\n\t\t\t\trules: {\n\t\t\t\t\t'grid-area': '1 / 1 / 2 / 2',\n\t\t\t\t\t'min-height': '50px'\n\t\t\t\t},\n\t\t\t\tstyles: {\n\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t'flex-direction': 'column'\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tslotName: 'modal-content',\n\t\t\t\trules: {\n\t\t\t\t\t'grid-area': '2 / 1 / 3 / 2',\n\t\t\t\t\t'min-height': '100px'\n\t\t\t\t},\n\t\t\t\tstyles: {\n\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t'flex-direction': 'column'\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tslotName: 'modal-footer',\n\t\t\t\trules: {\n\t\t\t\t\t'grid-area': '3 / 1 / 4 / 2',\n\t\t\t\t\t'min-height': '50px'\n\t\t\t\t},\n\t\t\t\tstyles: {\n\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t'flex-direction': 'column'\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t}\n};\n","export const isCustomModalComponent = (component) =>\n\tcomponent.tag === 'now-uxf-page-container';\n\nexport const isViewportModalComponent = (component) => {\n\treturn component.tag === 'now-uxf-modal-viewport';\n};\n\nconst allowedModalSizes = ['sm', 'md', 'lg', 'fullscreen'];\nexport const getModalSize = (size) =>\n\tallowedModalSizes.includes(size) ? size : 'md';\n","import { INSERT_MODAL } from './modalActions';\nimport { getTemplates } from '@devsnc/library-uxf';\nimport {\n\tcreateElementFromComponent,\n\tgetAllElementIds\n} from '../element/utils/element';\nimport createPageState from '../../models/createPageState';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { layout } from './defaultCustomModalLayout';\nimport { isCustomModalComponent, isViewportModalComponent } from './utils';\n\nexport default {\n\t[INSERT_MODAL]: ({\n\t\taction: { payload },\n\t\tstate: {\n\t\t\trawComponentList,\n\t\t\tproperties: { pageState },\n\t\t\tgetDefaultLayout\n\t\t},\n\t\tupdateProperties,\n\t\tdispatch\n\t}) => {\n\t\tconst {\n\t\t\tmodal: { id: selectedModalId }\n\t\t} = payload;\n\t\tconst modalComponent = rawComponentList.find(\n\t\t\t(component) => component.id === selectedModalId\n\t\t);\n\n\t\tgetTemplates([modalComponent.id]);\n\n\t\t/*\n\t\t   with the introduction of custom modals all the modals\n\t\t   are rendered using the element mount. This means the\n\t\t   out of the box modals will no longer render as expected\n\t\t   because their original tag is `now-uxf-page` and our\n\t\t   element mount tries to load that. Instead, what we want\n\t\t   is to load their macroponent because we need to pass it\n\t\t   certain properties (like button titles) and treat it like\n\t\t   a single component. Loading OOB modals using renderer\n\t\t   will break that model.\n\n\t\t   This approach also helps us remove a lot of async rendering\n\t\t   logic from the renderer which loads the modals using an\n\t\t   overlay\n\t\t*/\n\t\tif (\n\t\t\t!isCustomModalComponent(modalComponent) &&\n\t\t\t!isViewportModalComponent(modalComponent)\n\t\t) {\n\t\t\tmodalComponent.tag = `macroponent-${modalComponent.id}`;\n\t\t}\n\n\t\tconst newElement = createElementFromComponent(\n\t\t\tmodalComponent,\n\t\t\tpageState.rootElement,\n\t\t\ttrue,\n\t\t\tgetDefaultLayout()\n\t\t);\n\t\tconst allElementIds = getAllElementIds(pageState.rootElement);\n\t\tnewElement.initialize(allElementIds);\n\n\t\tif (isCustomModalComponent(modalComponent)) {\n\t\t\tnewElement.layout = layout;\n\t\t}\n\n\t\tconst newRootElement = cloneDeep(pageState.rootElement);\n\n\t\tnewRootElement.children.push(newElement);\n\n\t\tupdateProperties({\n\t\t\tpageState: createPageState(\n\t\t\t\t{\n\t\t\t\t\trootElement: newRootElement\n\t\t\t\t},\n\t\t\t\tpageState\n\t\t\t)\n\t\t});\n\n\t\tdispatch('UIB_ELEMENT#ELEMENT_SELECTED', {\n\t\t\ttype: 'element',\n\t\t\telementId: newElement.id,\n\t\t\telementInstanceName: newElement.instanceName,\n\t\t\tcomponent: modalComponent\n\t\t});\n\t}\n};\n","export const INSERT_MODAL = 'SN_UIB_ELEMENT_NAVIGATOR#INSERT_MODAL';\nexport const DELETE_MODAL = 'SN_UIB_ELEMENT_NAVIGATOR#DELETE_MODAL';\n","import { DELETE_MODAL } from './modalActions';\nimport createPageState from '../../models/createPageState';\nimport cloneDeep from 'lodash/cloneDeep';\n\nexport default {\n\t[DELETE_MODAL]: ({\n\t\taction: { payload },\n\t\tstate: {\n\t\t\tproperties: { pageState }\n\t\t},\n\t\tupdateProperties\n\t}) => {\n\t\tconst { elementId } = payload;\n\t\tconst newRootElement = cloneDeep(pageState.rootElement);\n\n\t\tnewRootElement.children = newRootElement.children.filter(\n\t\t\t(c) => c.id !== elementId\n\t\t);\n\n\t\tupdateProperties({\n\t\t\tpageState: createPageState(\n\t\t\t\t{\n\t\t\t\t\trootElement: newRootElement\n\t\t\t\t},\n\t\t\t\tpageState\n\t\t\t)\n\t\t});\n\t}\n};\n","import modalCreatedHandler from './modalCreatedHandler';\nimport deleteModalHandler from './deleteModalHandler';\n\nexport default {\n\t...modalCreatedHandler,\n\t...deleteModalHandler\n};\n","import get from 'lodash/get';\nimport { resolveBinding } from '../../utils.js';\n// @ts-check\n\n// Temporarily using flatMap from lodash to be able to unit test.\nimport _flatMap from 'lodash/flatMap';\nimport _isEmpty from 'lodash/isEmpty';\n\n/**\n * An Intellisense context binding.\n * A binding is composed of:\n * - a contextType (@element, @state, etc)\n * - optionally a context id (an element id )\n * - a propertyId (a key or id)\n *\n * @element.listNav.selectedList\n *  |       |       |\n *  |       |        propertyId\n *  |        contextId\n *   contextType\n *\n * @typedef Binding\n * @type {Object}\n * @property {!string} label  The actual binding string\n * @property {!string} bindingType  The binding type - a specialization of the context\n * @property {string=} contextId  The context id - some contexts will not have this\n * @property {!string} propertyId  The propertyId\n * @property {any=} value  The current value of this property\n * @property {any=} previewValue  A preview of what this property may look like\n * // LATER\n * // -----\n * // valueType {(string|object)} The string value of the type of the value,\n * //                             or an object with either an interfaceName or\n * //                             the json schema.\n */\n\n/**\n * @constant {Object.<string, string>}\n */\nconst bindingTypes = {\n\tdataBroker: 'dataBroker',\n\tparentDataBroker: 'parentDataBroker',\n\telement: 'element',\n\tpageProperty: 'pageProperty',\n\tparentPageProperty: 'parentPageProperty',\n\tclientStateParam: 'clientStateParam',\n\tsession: 'session',\n\tappChromeSettings: 'appChromeSettings'\n};\n\n/**\n * @constant {Object.<string, string>} contextType\n */\nconst contextTypes = {\n\t// `@data.<DATA BROKER INSTANCE ID>.<PROPERTY NAME>`\n\tdataBrokerInput: 'dataBrokerInput',\n\t// `@elements.<ELEMENT ID>.<PROPERTY NAME>`\n\telementProperty: 'elementProperty',\n\t// `@context.props.<PROPERTY NAME>`\n\tpageProperty: 'pageProperty',\n\t// `@state.<PROPERTY NAME>`\n\tclientStateInitialValue: 'clientStateInitialValue'\n};\n\n/**\n * @constant {Object.<string, Array.<string>>} validBindingTypesByContextType\n */\nconst validBindingTypesForContextType = {\n\t[contextTypes.dataBrokerInput]: [\n\t\tbindingTypes.dataBroker,\n\t\tbindingTypes.pageProperty,\n\t\tbindingTypes.session,\n\t\tbindingTypes.clientStateParam,\n\t\tbindingTypes.appChromeSettings\n\t],\n\t[contextTypes.elementProperty]: [\n\t\tbindingTypes.pageProperty,\n\t\tbindingTypes.element,\n\t\tbindingTypes.dataBroker,\n\t\tbindingTypes.clientStateParam,\n\t\tbindingTypes.session,\n\t\tbindingTypes.appChromeSettings\n\t],\n\t[contextTypes.pageProperty]: [\n\t\tbindingTypes.parentPageProperty,\n\t\tbindingTypes.parentDataBroker,\n\t\tbindingTypes.session,\n\t\tbindingTypes.appChromeSettings\n\t],\n\t[contextTypes.clientStateInitialValue]: [\n\t\tbindingTypes.pageProperty,\n\t\tbindingTypes.parentDataBroker,\n\t\tbindingTypes.dataBroker,\n\t\tbindingTypes.session,\n\t\tbindingTypes.appChromeSettings\n\t]\n};\n\nconst bindingTypesInContextType = {\n\t[contextTypes.dataBrokerInput]: [bindingTypes.dataBroker],\n\t[contextTypes.elementProperty]: [bindingTypes.element],\n\t[contextTypes.pageProperty]: [\n\t\tbindingTypes.parentPageProperty,\n\t\tbindingTypes.pageProperty\n\t],\n\t[contextTypes.clientStateInitialValue]: [bindingTypes.clientStateParam]\n};\n\nconst sameContext = ({ contextId, binding }) => binding.contextId === contextId;\n\nconst samePropertyId = ({ propertyId, binding }) =>\n\tbinding.propertyId === propertyId;\n\nconst samePropertyTestByContextType = {\n\t[contextTypes.dataBrokerInput]: sameContext,\n\t[contextTypes.elementProperty]: sameContext,\n\t[contextTypes.pageProperty]: samePropertyId,\n\t[contextTypes.clientStateInitialValue]: samePropertyId\n};\n\nconst defaultBindingFilter = ({\n\tcontextType: currentContextType,\n\tcontextId,\n\tpropertyId\n}) => (b) => {\n\tconst validBindingTypes = validBindingTypesForContextType[currentContextType];\n\tconst inValidBindingTypes = validBindingTypes.includes(b.bindingType);\n\tconst bindingTypesForContext = bindingTypesInContextType[currentContextType];\n\tconst sameContextType = bindingTypesForContext.includes(b.bindingType);\n\tconst test = samePropertyTestByContextType[currentContextType];\n\tconst sameProperty =\n\t\tsameContextType && test({ contextId, propertyId, binding: b });\n\n\treturn inValidBindingTypes && sameProperty === false;\n};\n\n/**\n *\n * @param {Array.<Object>} pageProperties\n * @returns {Array.<Binding>}\n */\nconst createPageBindings = (pageProperties, middlewareProperties) =>\n\tpageProperties.map(({ name, value, testValue }) => ({\n\t\tlabel: `@context.props.${name}`,\n\t\tvalue,\n\t\tpreviewValue: testValue || value,\n\t\tbindingType: bindingTypes.pageProperty,\n\t\tpropertyId: name,\n\t\tresolvedBinding: resolveBinding(\n\t\t\t`@context.props.${name}`,\n\t\t\tmiddlewareProperties\n\t\t)\n\t}));\n\n/**\n *\n * @returns {Array.<Binding>}\n */\nconst createSessionBindings = (middlewareProperties) => {\n\treturn [\n\t\t{\n\t\t\tlabel: '@context.session',\n\t\t\tbindingType: bindingTypes.session,\n\t\t\tpropertyId: 'session',\n\t\t\tresolvedBinding: resolveBinding('@context.session', middlewareProperties)\n\t\t}\n\t];\n};\n\n/**\n * @param {Object} appChromeSettings\n * @returns {Array.<Binding>}\n */\nconst createAppBindings = (appChromeSettings) =>\n\t(Object.entries(appChromeSettings) || []).map(([name, value]) => ({\n\t\tlabel: `@context.app.${name}`,\n\t\tvalue,\n\t\tbindingType: bindingTypes.appChromeSettings,\n\t\tpropertyId: name\n\t}));\n\n/**\n *\n * @param {Object} parentPageProperties\n * @returns {Array.<Binding>}\n */\nconst createParentPageBindings = (parentPageProperties, middlewareProperties) =>\n\tObject.keys(parentPageProperties).map((key) => ({\n\t\tlabel: `@context.props.${key}`,\n\t\tbindingType: bindingTypes.parentPageProperty,\n\t\tpropertyId: key,\n\t\tresolvedBinding: resolveBinding(\n\t\t\t`@context.props.${key}`,\n\t\t\tmiddlewareProperties\n\t\t)\n\t}));\n\n/**\n *\n * @param {Object} elementProperties\n * @param {Array.<Object>} elementArr\n * @returns {Array.<Binding>}\n */\nconst createElementBindings = (\n\telementProperties,\n\telementArr,\n\tmiddlewareProperties\n) => {\n\treturn _flatMap(Object.keys(elementProperties), (key) => {\n\t\tconst element = elementArr.find((e) => e.id === key);\n\t\tconst elementId = element ? element.id : key;\n\t\treturn (elementProperties[key] || [])\n\t\t\t.filter(\n\t\t\t\t(prop) => prop.id && prop.id !== '__instance_name__' && prop.selectable\n\t\t\t)\n\t\t\t.map(({ id, value }) => ({\n\t\t\t\tlabel: `@elements.${elementId}.${id}`,\n\t\t\t\tvalue,\n\t\t\t\tbindingType: bindingTypes.element,\n\t\t\t\tcontextId: elementId,\n\t\t\t\tpropertyId: id,\n\t\t\t\tresolvedBinding: resolveBinding(\n\t\t\t\t\t`@elements.${elementId}.${id}`,\n\t\t\t\t\tmiddlewareProperties\n\t\t\t\t)\n\t\t\t}));\n\t});\n};\n\n/**\n *\n * @param {Array.<Object>} clientStateParameters\n * @returns {Array.<Binding>}\n */\nconst createStateBindings = (clientStateParameters, middlewareProperties) =>\n\tclientStateParameters.map((param) => {\n\t\treturn {\n\t\t\tlabel: `@state.${param.name}`,\n\t\t\tbindingType: bindingTypes.clientStateParam,\n\t\t\tpropertyId: param.name,\n\t\t\tresolvedBinding: resolveBinding(\n\t\t\t\t`@state.${param.name}`,\n\t\t\t\tmiddlewareProperties\n\t\t\t)\n\t\t};\n\t});\n\n/**\n *\n * @param {{ simpleMutationBroker }} dataBroker\n * @returns {boolean}\n */\nconst isBindableDataBroker = ({ simpleMutationBroker }) =>\n\tsimpleMutationBroker === false;\n\n/**\n *\n * @param {Array.<Object>} dataBrokerInstances\n * @returns {Array.<Binding>}\n */\nconst createDataBrokerBindings = (\n\tdataBrokerInstances,\n\tmiddlewareProperties,\n\tisParent\n) =>\n\t_flatMap(\n\t\tdataBrokerInstances.filter(isBindableDataBroker),\n\t\t({ id, outputProperties, definition }) => {\n\t\t\tconst bindingType = isParent\n\t\t\t\t? bindingTypes.parentDataBroker\n\t\t\t\t: bindingTypes.dataBroker;\n\t\t\tif (get(definition, 'type', '') === 'CLIENT_STATE') {\n\t\t\t\treturn {\n\t\t\t\t\tlabel: `@data.${id}`,\n\t\t\t\t\tbindingType,\n\t\t\t\t\tcontextId: id,\n\t\t\t\t\tpropertyId: id,\n\t\t\t\t\tresolvedBinding: get(\n\t\t\t\t\t\tmiddlewareProperties,\n\t\t\t\t\t\t`clientScriptApi.data.${id}`,\n\t\t\t\t\t\t{}\n\t\t\t\t\t)\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (!_isEmpty(outputProperties)) {\n\t\t\t\treturn Object.keys(outputProperties).map((key) => ({\n\t\t\t\t\tlabel: `@data.${id}.${key}`,\n\t\t\t\t\tbindingType,\n\t\t\t\t\tcontextId: id,\n\t\t\t\t\tpropertyId: key,\n\t\t\t\t\tresolvedBinding: resolveBinding(\n\t\t\t\t\t\t`@data.${id}.${key}`,\n\t\t\t\t\t\tmiddlewareProperties\n\t\t\t\t\t)\n\t\t\t\t}));\n\t\t\t} else {\n\t\t\t\treturn [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: `@data.${id}`,\n\t\t\t\t\t\tbindingType,\n\t\t\t\t\t\tcontextId: id,\n\t\t\t\t\t\tresolvedBinding: resolveBinding(`@data.${id}`, middlewareProperties)\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\t);\n\n/**\n * Collect the exhaustive list of all possible intellisense bindings. Not for direct use.\n * Should be filtered with `filterBindings` with the appropriate parameters.\n * @param {{\n    pageProperties: Array.<import('../../models/macroponentProperty').MacroponentProperty>,\n    elementProperties: Object.<string, Array.<import('../../models/macroponentProperty').MacroponentProperty>>,\n    elementArr: Array.<import('../../models').Element>,\n    dataBrokerInstances: Array.<import('../utils').dataBrokerInstance>,\n    parentDataBrokerInstances: Array.<import('../utils').dataBrokerInstance>,\n    parentPageProperties: Object.<string, Array.<import('../../models/macroponentProperty').MacroponentProperty>>,\n    clientStateParameters: Array.<Object>\n   }} param\n * @returns {Array.<Binding>}\n */\nconst collectAllBindings = ({\n\tpageProperties = [],\n\telementProperties = {},\n\telementArr = [],\n\tdataBrokerInstances = [],\n\tparentDataBrokerInstances = [],\n\tparentPageProperties = {},\n\tclientStateParameters = [],\n\tmiddlewareProperties = {},\n\tappChromeSettings = {}\n}) => {\n\tconst pageBindings = createPageBindings(pageProperties, middlewareProperties);\n\tconst parentPageBindings = createParentPageBindings(\n\t\tparentPageProperties,\n\t\tmiddlewareProperties\n\t);\n\tconst elementBindings = createElementBindings(\n\t\telementProperties,\n\t\telementArr,\n\t\tmiddlewareProperties\n\t);\n\tconst dataBrokerBindings = createDataBrokerBindings(\n\t\tdataBrokerInstances,\n\t\tmiddlewareProperties,\n\t\tfalse\n\t);\n\tconst parentDataBrokerBindings = createDataBrokerBindings(\n\t\tparentDataBrokerInstances,\n\t\tmiddlewareProperties,\n\t\ttrue\n\t);\n\tconst clientStateBindings = createStateBindings(\n\t\tclientStateParameters,\n\t\tmiddlewareProperties\n\t);\n\n\tconst sessionBindings = createSessionBindings(middlewareProperties);\n\tconst appChromeBindings = createAppBindings(appChromeSettings);\n\n\treturn [\n\t\t...pageBindings,\n\t\t...parentPageBindings,\n\t\t...elementBindings,\n\t\t...dataBrokerBindings,\n\t\t...parentDataBrokerBindings,\n\t\t...clientStateBindings,\n\t\t...sessionBindings,\n\t\t...appChromeBindings\n\t];\n};\n\n/**\n *\n * @param {Array.<Binding>} bindings\n * @param {{ contextType: string, contextId?: string, propertyId: string}} contextBindingInfo\n * @returns {Array.<Binding>}\n */\nconst filterBindings = (bindings, contextBindingInfo) => {\n\tif (!contextBindingInfo) {\n\t\treturn bindings;\n\t}\n\tconst { contextType, contextId, propertyId } = contextBindingInfo;\n\tconst result = bindings.filter(\n\t\tdefaultBindingFilter({ contextType, contextId, propertyId })\n\t);\n\treturn result;\n};\n\nexport { collectAllBindings, filterBindings, bindingTypes, contextTypes };\n","export const SN_UXF_CONTEXT_BINDINGS_REQUESTED =\n\t'SN_UXF#CONTEXT_BINDINGS_REQUESTED';\n","import { filterBindings } from './bindings';\nimport { SN_UXF_CONTEXT_BINDINGS_REQUESTED } from './bindingActions';\n\nconst contextBindingsRequested = (coeffects) => {\n\tconst {\n\t\tstate: { allContextBindings },\n\t\taction,\n\t\tupdateState,\n\t\tupdateProperties\n\t} = coeffects;\n\n\tupdateState({\n\t\toperation: 'set',\n\t\tpath: 'contextBindingInfo',\n\t\tvalue: action.payload\n\t});\n\n\tupdateProperties({\n\t\tbindings: filterBindings(allContextBindings, action.payload)\n\t});\n};\n\nexport const bindingsHandlers = {\n\t[SN_UXF_CONTEXT_BINDINGS_REQUESTED]: contextBindingsRequested\n};\n","export { collectAllBindings, filterBindings, contextTypes } from './bindings';\nimport * as actions from './bindingActions';\nexport { bindingsHandlers } from './bindingHandlers';\nexport const bindingsActions = actions;\n","import {\n\tUIB_VIEWPORT_RENDER_CONTENTS,\n\tUIB_VIEWPORT_RENDER_REQUESTED\n} from './actions';\nimport {\n\trenderContents,\n\trenderEmptyState,\n\tgetViewportElementAndProperties,\n\tinitializeDataDrivenViewportProperties,\n\tisDataDrivenTab\n} from './utils';\nimport isEmpty from 'lodash/isEmpty';\nimport cloneDeep from 'lodash/cloneDeep';\nimport get from 'lodash/get';\nimport set from 'lodash/set';\nimport isEqual from 'lodash/isEqual';\nimport {\n\tREPEATED_VIEWPORT_TAB_DATA,\n\tDYNAMIC_VIEWPORT_TAB_DATA\n} from '../element/reservedPropertyIds';\nimport { t } from 'sn-translate';\n\nconst calculateNewActiveRouteAndScreen = (\n\tdataDrivenTabInfo,\n\tparentId,\n\tid,\n\tviewportRoutes\n) => {\n\tlet routeId;\n\n\tif (!isEmpty(dataDrivenTabInfo)) {\n\t\trouteId = dataDrivenTabInfo.dataDrivenViewportParentId;\n\t} else {\n\t\trouteId = parentId || id;\n\t}\n\n\tconst activeRoute = get(viewportRoutes, `${routeId}[0]`, {});\n\tlet activeScreen = get(activeRoute, 'macroponents[0]', {});\n\n\tif (isEmpty(dataDrivenTabInfo) && parentId && activeRoute.macroponents) {\n\t\tactiveScreen = activeRoute.macroponents.find((mcp) => mcp.id === id);\n\t}\n\n\treturn {\n\t\tactiveRoute,\n\t\tactiveScreen\n\t};\n};\n\nexport default {\n\t[UIB_VIEWPORT_RENDER_CONTENTS]: (coeffects) => {\n\t\tconst {\n\t\t\taction: {\n\t\t\t\tpayload: {\n\t\t\t\t\thost,\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tactiveRoute,\n\t\t\t\t\t\tactiveScreen,\n\t\t\t\t\t\tviewportRoutes,\n\t\t\t\t\t\tdynamicTabData\n\t\t\t\t\t},\n\t\t\t\t\tignoreCache = false\n\t\t\t\t}\n\t\t\t},\n\t\t\tstate,\n\t\t\tproperties: { pageState, pageProperties },\n\t\t\tupdateState,\n\t\t\tupdateProperties\n\t\t} = coeffects;\n\n\t\tconst routeToRender = activeRoute || undefined;\n\t\tconst screenToRender = activeScreen || undefined;\n\t\tconst resolvedRepeatedTabs = dynamicTabData || [];\n\t\tconst { activeViewportRoutes, activeViewportScreens } = state;\n\t\tconst { sysId: variantId } = pageState;\n\n\t\tif (!variantId) {\n\t\t\treturn;\n\t\t}\n\t\tconst newPageState = cloneDeep(pageState);\n\t\tconst {\n\t\t\tviewportElement,\n\t\t\tdynamicViewportTabData,\n\t\t\trepeatedViewportTabData\n\t\t} = getViewportElementAndProperties(newPageState, host.id);\n\n\t\tif (isEmpty(viewportRoutes)) {\n\t\t\trenderEmptyState(host, false);\n\t\t\t// When the new viewport component is dropped initially on the stage, it doesn't have dynamicTabData or repeatedTabData properties. The result is that the properties editor shows extra fields when the component is rendered or when it's properties are changed. So the below initializes those properties\n\t\t\tconst newViewportProperties = initializeDataDrivenViewportProperties(\n\t\t\t\tnull,\n\t\t\t\tstate\n\t\t\t);\n\t\t\tlet isViewportPropertySet = false;\n\t\t\tif (!dynamicViewportTabData) {\n\t\t\t\tset(\n\t\t\t\t\tviewportElement,\n\t\t\t\t\t`properties[${DYNAMIC_VIEWPORT_TAB_DATA}]`,\n\t\t\t\t\tnewViewportProperties[DYNAMIC_VIEWPORT_TAB_DATA]\n\t\t\t\t);\n\t\t\t\tisViewportPropertySet = true;\n\t\t\t}\n\t\t\tif (!repeatedViewportTabData) {\n\t\t\t\tset(\n\t\t\t\t\tviewportElement,\n\t\t\t\t\t`properties[${REPEATED_VIEWPORT_TAB_DATA}]`,\n\t\t\t\t\tnewViewportProperties[REPEATED_VIEWPORT_TAB_DATA]\n\t\t\t\t);\n\t\t\t\tisViewportPropertySet = true;\n\t\t\t}\n\t\t\tif (isViewportPropertySet) {\n\t\t\t\tisViewportPropertySet = false;\n\t\t\t\tupdateProperties({ pageState: newPageState });\n\t\t\t}\n\t\t} else {\n\t\t\tif (!isEmpty(routeToRender) && !isEmpty(screenToRender)) {\n\t\t\t\tconst currentlyRendered = {\n\t\t\t\t\troute: get(\n\t\t\t\t\t\tactiveViewportRoutes,\n\t\t\t\t\t\t`${variantId}.${host.id}.routeType`,\n\t\t\t\t\t\t''\n\t\t\t\t\t),\n\t\t\t\t\tscreen: get(activeViewportScreens, `${variantId}.${host.id}`, '')\n\t\t\t\t};\n\n\t\t\t\tif (!isEmpty(screenToRender) && isDataDrivenTab(routeToRender)) {\n\t\t\t\t\t// Add fields in the screen to render the data driven tabs and choose the first field in the list\n\t\t\t\t\tcurrentlyRendered.fields = get(\n\t\t\t\t\t\tactiveViewportScreens,\n\t\t\t\t\t\t`${variantId}.${host.id}.fields`,\n\t\t\t\t\t\t{}\n\t\t\t\t\t);\n\t\t\t\t\tconst renderedScreenDefaultFields =\n\t\t\t\t\t\tArray.isArray(resolvedRepeatedTabs) &&\n\t\t\t\t\t\t!isEmpty(resolvedRepeatedTabs)\n\t\t\t\t\t\t\t? resolvedRepeatedTabs[0].fields\n\t\t\t\t\t\t\t: {};\n\t\t\t\t\tscreenToRender.fields = isEmpty(screenToRender.fields)\n\t\t\t\t\t\t? renderedScreenDefaultFields\n\t\t\t\t\t\t: screenToRender.fields;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tcurrentlyRendered.route === routeToRender.routeType &&\n\t\t\t\t\tget(currentlyRendered, 'screen.id') === screenToRender.id &&\n\t\t\t\t\tisEqual(\n\t\t\t\t\t\tget(currentlyRendered, 'screen.macroponentConfiguration'),\n\t\t\t\t\t\tscreenToRender.macroponentConfiguration\n\t\t\t\t\t) &&\n\t\t\t\t\tisEqual(currentlyRendered.fields, screenToRender.fields) &&\n\t\t\t\t\t!ignoreCache\n\t\t\t\t) {\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\trenderContents(host, screenToRender, pageProperties);\n\t\t\t\t}\n\t\t\t} else if (!isEmpty(routeToRender) && isEmpty(screenToRender)) {\n\t\t\t\trenderEmptyState(\n\t\t\t\t\thost,\n\t\t\t\t\t!isEmpty(viewportRoutes),\n\t\t\t\t\tt('Please add a screen variant to {0}', routeToRender.name)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\trenderEmptyState(host, !isEmpty(viewportRoutes), t('Unexpected Error'));\n\t\t\t}\n\t\t}\n\n\t\t// lodash#set sets the reference and not the value\n\t\t// we dont want state to get updated by reference\n\t\tset(\n\t\t\tactiveViewportRoutes,\n\t\t\t`${variantId}.${host.id}`,\n\t\t\tcloneDeep(routeToRender)\n\t\t);\n\t\tset(\n\t\t\tactiveViewportScreens,\n\t\t\t`${variantId}.${host.id}`,\n\t\t\tcloneDeep(screenToRender)\n\t\t);\n\n\t\tupdateState({\n\t\t\t...state,\n\t\t\tactiveViewportRoutes,\n\t\t\tactiveViewportScreens\n\t\t});\n\t},\n\t[UIB_VIEWPORT_RENDER_REQUESTED]: (coeffects) => {\n\t\tconst {\n\t\t\taction: {\n\t\t\t\tpayload: { elementId, id, parentId, viewportRoutes, dataDrivenTabInfo }\n\t\t\t},\n\t\t\tproperties: { pageState },\n\t\t\tupdateProperties\n\t\t} = coeffects;\n\n\t\tconst newPageState = cloneDeep(pageState);\n\n\t\tconst { viewportElement } = getViewportElementAndProperties(\n\t\t\tnewPageState,\n\t\t\telementId\n\t\t);\n\n\t\t// TODO: handle this 0 when we know more about route variants\n\t\tlet newActiveRoute = null;\n\t\tlet newActiveScreen = null;\n\n\t\tconst newRouteAndScreen = calculateNewActiveRouteAndScreen(\n\t\t\tdataDrivenTabInfo,\n\t\t\tparentId,\n\t\t\tid,\n\t\t\tviewportRoutes\n\t\t);\n\t\tnewActiveRoute = newRouteAndScreen.activeRoute;\n\t\tnewActiveScreen = newRouteAndScreen.activeScreen;\n\n\t\tif (!isEmpty(dataDrivenTabInfo)) {\n\t\t\tset(newActiveScreen, 'fields', dataDrivenTabInfo.fields);\n\t\t}\n\n\t\tset(viewportElement, 'properties.activeRoute.value', newActiveRoute);\n\n\t\tset(viewportElement, 'properties.activeScreen.value', newActiveScreen);\n\n\t\tupdateProperties({\n\t\t\tpageState: newPageState\n\t\t});\n\t}\n};\n","export const UIB_VIEWPORT_RENDER_CONTENTS = 'UIB_VIEWPORT#RENDER_CONTENTS';\nexport const UIB_VIEWPORT_RENDER_REQUESTED = 'UIB_VIEWPORT#RENDER_REQUESTED';\nexport const UIB_VIEWPORT_DEFAULT_CHANGED = 'UIB_VIEWPORT#DEFAULT_CHANGED';\nexport const UIB_VIEWPORT_RESOLVE_DATA_SOURCE =\n\t'SN_UXF_VIEWPORT#RESOLVE_DATA_SOURCE';\n","import set from 'lodash/set';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { UIB_VIEWPORT_DEFAULT_CHANGED } from './actions';\nimport { getViewportElementAndProperties } from './utils.js';\n\nexport default {\n\t[UIB_VIEWPORT_DEFAULT_CHANGED]: ({\n\t\taction: {\n\t\t\tpayload: {\n\t\t\t\telementId,\n\t\t\t\titem: { id: newDefaultRoute }\n\t\t\t}\n\t\t},\n\t\tproperties: { pageState },\n\t\tupdateProperties\n\t}) => {\n\t\tconst newPageState = cloneDeep(pageState);\n\n\t\tconst {\n\t\t\tviewportElement,\n\t\t\tdefaultRoute: currentDefaultRoute\n\t\t} = getViewportElementAndProperties(newPageState, elementId);\n\n\t\tif (currentDefaultRoute === newDefaultRoute) {\n\t\t\treturn;\n\t\t}\n\n\t\tset(viewportElement, 'properties.defaultRoute.value', newDefaultRoute);\n\n\t\tupdateProperties({\n\t\t\tpageState: newPageState\n\t\t});\n\t}\n};\n","import cloneDeep from 'lodash/cloneDeep';\nimport set from 'lodash/set';\nimport get from 'lodash/get';\n\nimport { UIB_VIEWPORT_RESOLVE_DATA_SOURCE } from './actions';\nimport { getElementByProperty } from '../utils.js';\nimport reduceContextBindingsWithAncestors from '../pageProperties/utils/reduceContextBindingsWithAncestors';\nimport { resolveBinding } from '../../utils';\n\nexport default {\n\t[UIB_VIEWPORT_RESOLVE_DATA_SOURCE]: ({\n\t\taction,\n\t\tproperties,\n\t\tupdateProperties\n\t}) => {\n\t\tconst { value, elementId, isolationMode } = action.payload;\n\t\tconst {\n\t\t\tpageState,\n\t\t\tancestorPageProperties,\n\t\t\tdataBrokerInstances,\n\t\t\tancestorDataBrokerInstances,\n\t\t\tancestorElements,\n\t\t\tclientScriptApi,\n\t\t\tparentInfo,\n\t\t\tparentDataBrokerInstances,\n\t\t\tbindings,\n\t\t\tappChromeSettings\n\t\t} = properties;\n\n\t\tconst newPageState = cloneDeep(pageState);\n\t\tconst newRootElement = get(newPageState, 'rootElement', {});\n\t\tif (isolationMode) {\n\t\t\tconst newParentInfo = cloneDeep(parentInfo);\n\t\t\tconst resolvedPropertiesBindings =\n\t\t\t\tresolveBinding(value, {\n\t\t\t\t\tbindings,\n\t\t\t\t\tancestorPageProperties,\n\t\t\t\t\tdataBrokerInstances: parentDataBrokerInstances,\n\t\t\t\t\tancestorDataBrokerInstances,\n\t\t\t\t\trootElement: {},\n\t\t\t\t\tancestorElements,\n\t\t\t\t\tclientScriptApi,\n\t\t\t\t\tappChromeSettings\n\t\t\t\t}) || null;\n\t\t\tset(newParentInfo, 'resolvedDataSource', resolvedPropertiesBindings);\n\n\t\t\tupdateProperties({\n\t\t\t\tparentInfo: newParentInfo\n\t\t\t});\n\t\t} else {\n\t\t\tconst parentElement = getElementByProperty(\n\t\t\t\tnewRootElement,\n\t\t\t\telementId,\n\t\t\t\t'id'\n\t\t\t);\n\t\t\tconst contextBindings = reduceContextBindingsWithAncestors(\n\t\t\t\tpageState,\n\t\t\t\tancestorPageProperties\n\t\t\t);\n\t\t\tconst resolvedPropertiesBindings =\n\t\t\t\tresolveBinding(value, {\n\t\t\t\t\tbindings: contextBindings,\n\t\t\t\t\tancestorPageProperties,\n\t\t\t\t\tdataBrokerInstances: isolationMode\n\t\t\t\t\t\t? parentDataBrokerInstances\n\t\t\t\t\t\t: dataBrokerInstances,\n\t\t\t\t\tancestorDataBrokerInstances,\n\t\t\t\t\tnewRootElement,\n\t\t\t\t\tancestorElements,\n\t\t\t\t\tclientScriptApi,\n\t\t\t\t\tappChromeSettings\n\t\t\t\t}) || null;\n\t\t\tset(\n\t\t\t\tparentElement,\n\t\t\t\t'properties.repeatedTabData.value',\n\t\t\t\tresolvedPropertiesBindings\n\t\t\t);\n\n\t\t\tset(parentElement, 'properties.dynamicTabData.value', value);\n\n\t\t\tupdateProperties({\n\t\t\t\tpageState: newPageState\n\t\t\t});\n\t\t}\n\t}\n};\n","import viewportRenderHandlers from './render';\nimport updateViewportRouteHandlers from './update';\nimport dataDrivenViewportHandler from './dataDrivenViewport';\nexport default {\n\t...viewportRenderHandlers,\n\t...dataDrivenViewportHandler,\n\t...updateViewportRouteHandlers\n};\n","export const DASHBOARDS_CREATE_REQUEST = 'SN_UXF#DASHBOARDS_CREATE_REQUEST';\nexport const DASHBOARDS_CREATE_REQUEST_SUCCEEDED =\n\t'SN_UXF#DASHBOARDS_CREATE_REQUEST_SUCCEEDED';\nexport const DASHBOARDS_CREATE_REQUEST_FAILED =\n\t'SN_UXF#DASHBOARDS_CREATE_REQUEST_FAILED';\nexport const DASHBOARDS_CREATE_REQUEST_STARTED =\n\t'SN_UXF#DASHBOARDS_CREATE_REQUEST_STARTED';\n\nexport const DASHBOARDS_EDIT_REQUEST = 'SN_UXF#DASHBOARDS_EDIT_REQUEST';\nexport const DASHBOARDS_EDIT_REQUEST_SUCCEEDED =\n\t'SN_UXF#DASHBOARDS_EDIT_REQUEST_SUCCEEDED';\nexport const DASHBOARDS_EDIT_REQUEST_FAILED =\n\t'SN_UXF#DASHBOARDS_EDIT_REQUEST_FAILED';\nexport const DASHBOARDS_EDIT_REQUEST_STARTED =\n\t'SN_UXF#DASHBOARDS_EDIT_REQUEST_STARTED';\n\nexport const DASHBOARDS_DELETE_REQUEST = 'SN_UXF#DASHBOARDS_DELETE_REQUEST';\nexport const DASHBOARDS_DELETE_REQUEST_HTTP =\n\t'SN_UXF#DASHBOARDS_DELETE_REQUEST_HTTP';\nexport const DASHBOARDS_DELETE_REQUEST_SUCCEEDED =\n\t'SN_UXF#DASHBOARDS_DELETE_REQUEST_SUCCEEDED';\nexport const DASHBOARDS_DELETE_REQUEST_FAILED =\n\t'SN_UXF#DASHBOARDS_DELETE_REQUEST_FAILED';\nexport const DASHBOARDS_DELETE_REQUEST_STARTED =\n\t'SN_UXF#DASHBOARDS_DELETE_REQUEST_STARTED';\n\nexport const DASHBOARDS_SCREENS_LOADED = 'SN_UXF#DASHBOARDS_SCREENS_LOADED';\n\nexport const DASHBOARDS_CREATE_TAB_REQUEST =\n\t'SN_UXF#DASHBOARDS_CREATE_TAB_REQUEST';\nexport const DASHBOARDS_CREATE_TAB_SUCCEEDED =\n\t'SN_UXF#DASHBOARDS_CREATE_TAB_SUCCEEDED';\nexport const DASHBOARDS_CREATE_TAB_FAILED =\n\t'SN_UXF#DASHBOARDS_CREATE_TAB_FAILED';\nexport const DASHBOARDS_CREATE_TAB_STARTED =\n\t'SN_UXF#DASHBOARDS_CREATE_TAB_STARTED';\nexport const DASHBOARDS_CREATE_OVERRIDE_REQUEST =\n\t'SN_UXF#DASHBOARDS_CREATE_OVERRIDE_REQUEST';\nexport const DASHBOARDS_CREATE_OVERRIDE_REQUEST_SUCCEEDED =\n\t'SN_UXF#DASHBOARDS_CREATE_OVERRIDE_REQUEST_SUCCEEDED';\nexport const DASHBOARDS_CREATE_OVERRIDE_REQUEST_FAILED =\n\t'SN_UXF#DASHBOARDS_CREATE_OVERRIDE_REQUEST_FAILED';\nexport const DASHBOARDS_CREATE_OVERRIDE_REQUEST_STARTED =\n\t'SN_UXF#DASHBOARDS_CREATE_OVERRIDE_REQUEST_STARTED';\nexport const DASHBOARDS_CREATE_OVERRIDE_HTTP_REQUESTED =\n\t'SN_UXF#DASHBOARDS_CREATE_OVERRIDE_HTTP_REQUESTED';\n","import cloneDeep from 'lodash/cloneDeep';\nimport get from 'lodash/get';\nimport {\n\tDASHBOARDS_CREATE_REQUEST,\n\tDASHBOARDS_CREATE_REQUEST_SUCCEEDED,\n\tDASHBOARDS_CREATE_REQUEST_FAILED,\n\tDASHBOARDS_CREATE_REQUEST_STARTED,\n\tDASHBOARDS_CREATE_TAB_FAILED,\n\tDASHBOARDS_CREATE_TAB_STARTED,\n\tDASHBOARDS_CREATE_TAB_REQUEST,\n\tDASHBOARDS_CREATE_TAB_SUCCEEDED,\n\tDASHBOARDS_CREATE_OVERRIDE_REQUEST,\n\tDASHBOARDS_CREATE_OVERRIDE_REQUEST_STARTED,\n\tDASHBOARDS_CREATE_OVERRIDE_REQUEST_SUCCEEDED,\n\tDASHBOARDS_CREATE_OVERRIDE_REQUEST_FAILED,\n\tDASHBOARDS_CREATE_OVERRIDE_HTTP_REQUESTED\n} from './dashboardsActions';\nimport createPageState from '../../models/createPageState';\nimport processContextState from '../contextState/contextStateProcessor';\nimport { addNewPageReceived } from '../newPage/newPageUtils';\nimport { createHttpEffect } from '@servicenow/ui-effect-http';\nimport { generateOverrideCreateHttpEffect } from '../newPage/newPageVariantOverrideHandlers';\n\nconst dashboardsCreateEffect = createHttpEffect('/api/now/builder/dashboards', {\n\tmethod: 'POST',\n\tpathParams: [],\n\tdataParam: 'data',\n\tstartActionType: DASHBOARDS_CREATE_REQUEST_STARTED,\n\tsuccessActionType: DASHBOARDS_CREATE_REQUEST_SUCCEEDED,\n\terrorActionType: DASHBOARDS_CREATE_REQUEST_FAILED\n});\n\nconst dashboardsCreateStarted = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: true });\n};\n\nconst dashboardsCreateSucceeded = ({\n\tupdateProperties,\n\taction,\n\tproperties,\n\tupdateState,\n\tstate\n}) => {\n\tupdateProperties({ isSavingPage: false });\n\n\tconst {\n\t\tresult: { screen }\n\t} = action.payload;\n\tconst { dataBrokerDefinitions, eventHandlers, pages } = properties;\n\n\tconst [pageState, newPages] = addNewPageReceived(\n\t\tscreen,\n\t\tpages,\n\t\tdataBrokerDefinitions,\n\t\teventHandlers,\n\t\tstate\n\t);\n\n\tconst {\n\t\tancestorDataBrokerInstances,\n\t\tparentDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tparentPageProperties,\n\t\tancestorElements,\n\t\tparentElements,\n\t\tappChromeSettings,\n\t\tparentEventHandlers,\n\t\ttheme\n\t} = processContextState({\n\t\tcontextState: get(action.payload, 'result.contextState', {}),\n\t\tupdateState,\n\t\tproperties\n\t});\n\n\tconst updatedPageState = createPageState(\n\t\t{\n\t\t\teventHandlers: parentEventHandlers\n\t\t},\n\t\tpageState\n\t);\n\n\tupdateProperties({ pages: newPages });\n\n\tupdateProperties({\n\t\tancestorDataBrokerInstances,\n\t\tparentDataBrokerInstances,\n\t\tancestorPageProperties,\n\t\tparentPageProperties,\n\t\tancestorElements,\n\t\tappChromeSettings,\n\t\tparentElements,\n\t\ttheme,\n\t\tisSavingPage: false,\n\t\tpageState: updatedPageState,\n\t\tpageStatePristine: cloneDeep(updatedPageState)\n\t});\n};\n\nconst dashboardsCreateFailed = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false });\n};\n\nconst dashboardsTabCreateStarted = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: true });\n};\n\nconst dashboardsTabCreateSucceeded = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false });\n};\n\nconst dashboardsTabCreateFailed = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false });\n};\nconst dashboardsCreateOverrideRequested = ({\n\taction,\n\tproperties,\n\tdispatch\n}) => {\n\tconst { pageState } = properties;\n\tconst sysId = pageState.sysId || '';\n\tdispatch(\n\t\tDASHBOARDS_CREATE_OVERRIDE_HTTP_REQUESTED,\n\t\t{\n\t\t\t...action.payload,\n\t\t\tsysId\n\t\t},\n\t\taction.meta\n\t);\n};\n\nconst dashboardsCreateOverrideHttpRequested = generateOverrideCreateHttpEffect({\n\tsuccessActionType: DASHBOARDS_CREATE_OVERRIDE_REQUEST_SUCCEEDED,\n\tstartActionType: DASHBOARDS_CREATE_OVERRIDE_REQUEST_STARTED,\n\terrorActionType: DASHBOARDS_CREATE_OVERRIDE_REQUEST_FAILED\n});\n\nexport default {\n\t[DASHBOARDS_CREATE_REQUEST]: dashboardsCreateEffect,\n\t[DASHBOARDS_CREATE_REQUEST_STARTED]: dashboardsCreateStarted,\n\t[DASHBOARDS_CREATE_REQUEST_SUCCEEDED]: dashboardsCreateSucceeded,\n\t[DASHBOARDS_CREATE_REQUEST_FAILED]: dashboardsCreateFailed,\n\t[DASHBOARDS_CREATE_TAB_REQUEST]: createHttpEffect(\n\t\t'api/now/builder/dashboards/subroute',\n\t\t{\n\t\t\tmethod: 'POST',\n\t\t\tdataParam: 'data',\n\t\t\tstartActionType: DASHBOARDS_CREATE_TAB_STARTED,\n\t\t\tsuccessActionType: DASHBOARDS_CREATE_TAB_SUCCEEDED,\n\t\t\terrorActionType: DASHBOARDS_CREATE_TAB_FAILED,\n\t\t\tbatch: false\n\t\t}\n\t),\n\t[DASHBOARDS_CREATE_TAB_STARTED]: dashboardsTabCreateStarted,\n\t[DASHBOARDS_CREATE_TAB_SUCCEEDED]: dashboardsTabCreateSucceeded,\n\t[DASHBOARDS_CREATE_TAB_FAILED]: dashboardsTabCreateFailed,\n\t[DASHBOARDS_CREATE_OVERRIDE_REQUEST]: dashboardsCreateOverrideRequested,\n\t[DASHBOARDS_CREATE_OVERRIDE_HTTP_REQUESTED]: dashboardsCreateOverrideHttpRequested,\n\t[DASHBOARDS_CREATE_OVERRIDE_REQUEST_SUCCEEDED]: (coeffects) => {\n\t\tdashboardsCreateSucceeded({\n\t\t\t...coeffects,\n\t\t\taction: {\n\t\t\t\t...coeffects.action,\n\t\t\t\tpayload: {\n\t\t\t\t\t...coeffects.action.payload,\n\t\t\t\t\tresult: {\n\t\t\t\t\t\tscreen: coeffects.action.payload.result\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};\n","import {\n\tDASHBOARDS_EDIT_REQUEST,\n\tDASHBOARDS_EDIT_REQUEST_SUCCEEDED,\n\tDASHBOARDS_EDIT_REQUEST_FAILED,\n\tDASHBOARDS_EDIT_REQUEST_STARTED\n} from './dashboardsActions';\nimport { createHttpEffect } from '@servicenow/ui-effect-http';\n\nconst dashboardsEditEffect = createHttpEffect(\n\t'/api/now/builder/dashboards/:dashboardId',\n\t{\n\t\tmethod: 'PATCH',\n\t\tpathParams: ['dashboardId'],\n\t\tdataParam: 'data',\n\t\tstartActionType: DASHBOARDS_EDIT_REQUEST_STARTED,\n\t\tsuccessActionType: DASHBOARDS_EDIT_REQUEST_SUCCEEDED,\n\t\terrorActionType: DASHBOARDS_EDIT_REQUEST_FAILED,\n\t\tbatch: false\n\t}\n);\n\nconst dashboardsEditStarted = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: true });\n};\n\nconst dashboardsEditSucceeded = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false });\n};\n\nconst dashboardsEditFailed = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false });\n};\n\nexport default {\n\t[DASHBOARDS_EDIT_REQUEST]: dashboardsEditEffect,\n\t[DASHBOARDS_EDIT_REQUEST_STARTED]: dashboardsEditStarted,\n\t[DASHBOARDS_EDIT_REQUEST_SUCCEEDED]: dashboardsEditSucceeded,\n\t[DASHBOARDS_EDIT_REQUEST_FAILED]: dashboardsEditFailed\n};\n","import {\n\tDASHBOARDS_DELETE_REQUEST,\n\tDASHBOARDS_DELETE_REQUEST_HTTP,\n\tDASHBOARDS_DELETE_REQUEST_SUCCEEDED,\n\tDASHBOARDS_DELETE_REQUEST_FAILED,\n\tDASHBOARDS_DELETE_REQUEST_STARTED\n} from './dashboardsActions';\nimport { createHttpEffect } from '@servicenow/ui-effect-http';\n\nconst dashboardsDeleteRequest = ({ state, action, dispatch }) => {\n\tconst {\n\t\tproperties: {\n\t\t\tpageState: { scope }\n\t\t}\n\t} = state;\n\n\tconst {\n\t\tpayload: { dashboardId },\n\t\tmeta: { deletedDashboardId }\n\t} = action;\n\n\tdispatch(\n\t\tDASHBOARDS_DELETE_REQUEST_HTTP,\n\t\t{\n\t\t\tdashboardId,\n\t\t\tsysparm_transaction_scope: scope\n\t\t},\n\t\t{\n\t\t\tdeletedDashboardId\n\t\t}\n\t);\n};\n\nconst dashboardsDeleteEffect = createHttpEffect(\n\t'/api/now/builder/dashboards/:dashboardId',\n\t{\n\t\tmethod: 'DELETE',\n\t\tpathParams: ['dashboardId'],\n\t\tqueryParams: ['sysparm_transaction_scope'],\n\t\tstartActionType: DASHBOARDS_DELETE_REQUEST_STARTED,\n\t\tsuccessActionType: DASHBOARDS_DELETE_REQUEST_SUCCEEDED,\n\t\terrorActionType: DASHBOARDS_DELETE_REQUEST_FAILED,\n\t\tbatch: false\n\t}\n);\n\nconst dashboardsDeleteStarted = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: true });\n};\n\nconst dashboardsDeleteSucceeded = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false });\n};\n\nconst dashboardsDeleteFailed = ({ updateProperties }) => {\n\tupdateProperties({ isSavingPage: false });\n};\n\nexport default {\n\t[DASHBOARDS_DELETE_REQUEST]: dashboardsDeleteRequest,\n\t[DASHBOARDS_DELETE_REQUEST_HTTP]: dashboardsDeleteEffect,\n\t[DASHBOARDS_DELETE_REQUEST_STARTED]: dashboardsDeleteStarted,\n\t[DASHBOARDS_DELETE_REQUEST_SUCCEEDED]: dashboardsDeleteSucceeded,\n\t[DASHBOARDS_DELETE_REQUEST_FAILED]: dashboardsDeleteFailed\n};\n","import { DASHBOARDS_SCREENS_LOADED } from './dashboardsActions';\n\nexport default {\n\t[DASHBOARDS_SCREENS_LOADED]: ({ action, updateProperties, updateState }) => {\n\t\tupdateProperties({\n\t\t\tpages: action.payload.screens,\n\t\t\tisPagesLoading: false\n\t\t});\n\t\tupdateState({\n\t\t\tpagesLoaded: true\n\t\t});\n\t}\n};\n","import * as dashboardsActions from './dashboardsActions';\nimport dashboardsCreateHandlers from './dashboardsCreateHandlers';\nimport dashboardsEditHandlers from './dashboardsEditHandlers';\nimport dashboardsDeleteHandlers from './dashboardsDeleteHandlers';\nimport dashboardsScreensHandlers from './dashboardsScreensHandlers';\n\nexport { dashboardsActions };\nexport const dashboardsHandlers = {\n\t...dashboardsCreateHandlers,\n\t...dashboardsEditHandlers,\n\t...dashboardsDeleteHandlers,\n\t...dashboardsScreensHandlers\n};\n","export const SET_DOMAIN_EXPANDED = 'SN_UXF#SET_DOMAIN_EXPANDED';\n","import { SET_DOMAIN_EXPANDED } from './domainScopeActions';\nimport { SN_UIB_APP_UPDATE_APP_ROUTE_STATE } from '../../constants';\nimport { PAGE_LIST_REQUESTED } from '../pageList/pageListActions';\n\nconst setExpandedDomainScopeHandler = ({ action, dispatch }) => {\n\tconst { isDomainExpanded, appsSysId } = action.payload;\n\n\tdispatch(SN_UIB_APP_UPDATE_APP_ROUTE_STATE, {\n\t\tsysId: appsSysId,\n\t\tsysparm_query_no_domain: isDomainExpanded\n\t});\n\tdispatch(PAGE_LIST_REQUESTED, {\n\t\tappConfigId: appsSysId,\n\t\tsysparm_query_no_domain: isDomainExpanded\n\t});\n};\n\nexport default {\n\t[SET_DOMAIN_EXPANDED]: setExpandedDomainScopeHandler\n};\n","import get from 'lodash/get';\nimport isEmpty from 'lodash/isEmpty';\nimport { ROOT_MACROPONENT_SOURCE_EVENTS } from './page/constants';\n\nexport default {\n\t/**\n\t * List of available components\n\t * @type {Array<Component>}\n\t */\n\tcomponents: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\n\t/**\n\t * List of available data broker definitions\n\t */\n\tdataBrokerDefinitions: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\n\t/**\n\t * List of data broker instances\n\t * @type {Array<DataBrokerInstance>}\n\t */\n\tdataBrokerInstances: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current properties available for every data broker instance in the pageState,\n\t * including value set on the property and property metadata\n\t * @type {Object<String, Array<Object>>}\n\t */\n\tdataBrokerProperties: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\n\t/**\n\t * List of all ancestor data broker instances\n\t * @type {Array<DataBrokerInstance>}\n\t */\n\tancestorDataBrokerInstances: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\n\t/**\n\t * List of data broker instances on the direct parent\n\t * @type {Array<DataBrokerInstance>}\n\t */\n\tparentDataBrokerInstances: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\n\t/**\n\t * List of all page properties from ancestor tree\n\t * @type {Object<String, String>}\n\t */\n\tancestorPageProperties: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\n\t/**\n\t * List of page properties from the direct parent\n\t * @type {Object<String, String>}\n\t */\n\tparentPageProperties: {\n\t\tdefault: {}\n\t},\n\n\t/**\n\t * List of all ancestor element IDs and their instance names and propertyValues\n\t * @type {Object<String, Object>}\n\t */\n\tancestorElements: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\n\t/**\n\t * List of element IDs and instance names and propertyValues from the direct parent\n\t * @type {Object<String, String>}\n\t */\n\tparentElements: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\n\t/**\n\t * List of available handlers (type EVENT or DECLARATIVE_ACTION or DATABROKER_OP)\n\t * @public\n\t * @type {Array<EventHandler>}\n\t */\n\teventHandlers: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\n\t/**\n\t * A nested tree of elements in the stage\n\t */\n\telementTree: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current event mappings configured for every element in the pageState\n\t * @type {Object<String, Array<Object>>}\n\t */\n\telementEventMappings: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current event mappings configured for the screen\n\t * @type {Object<String, Array<Object>>}\n\t */\n\tscreenEventMappings: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current event mappings configured for data broker instances in the pageState\n\t * @type {Object<string, Arra}\n\t */\n\tdataBrokerEventMappings: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\n\t/*\n\t * Current values for each event mapping\n\t * @type {Object<String>, Array<Object>>}\n\t */\n\teventMappingHandlers: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current events available for every element in the pageState\n\t * @type {Object<String, Array<Object>>}\n\t */\n\telementEvents: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current properties available for every element in the pageState, including\n\t * value set on the property and property metadata\n\t * @type {Object<String, Array<Object>>}\n\t */\n\telementProperties: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current layout value for every element in the pageState, including\n\t * @type {Object<String, Array<Object>>}\n\t */\n\telementLayouts: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current style values for every element in the pageState, including\n\t * @type {Object<String, Array<Object>>}\n\t */\n\telementStyles: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current status of deleting a page\n\t * @type {boolean}\n\t */\n\tisDeletingPage: {\n\t\tdefault: false,\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current environment middleware is being instantiated\n\t */\n\tisLegacy: {\n\t\tdefault: null\n\t},\n\n\t/**\n\t * Current status of loading available components\n\t * @type {boolean}\n\t */\n\tisLoadingComponents: {\n\t\tdefault: false,\n\t\tselectable: true\n\t},\n\n\t/*\n\t * Current status of loading a page\n\t * @type {boolean}\n\t */\n\tisLoadingPage: {\n\t\tdefault: false,\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current status of loading available pages\n\t * @type {boolean}\n\t */\n\tisLoadingPages: {\n\t\tdefault: false,\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Protection policy to prevent copying protected pages or macroponents\n\t */\n\tisPageCopiable: {\n\t\tdefault: true,\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Read only flag evaluated from the page and all of the pages macroponents\n\t */\n\tisPageReadOnly: {\n\t\tdefault: false,\n\t\tselectable: true\n\t},\n\t/**\n\t * Whether there are unsaved changes to the pageState property\n\t/*\n\t * Current status of loading a page\n\t * @type {boolean}\n\t */\n\tisPageStateDirty: {\n\t\tdefault: false,\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current status of saving (creating or updating) a page\n\t * @type {boolean}\n\t */\n\tisSavingPage: {\n\t\tdefault: false,\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current metadata of page, including page parameters, type, name, and access priveleges.\n\t * @type {Object}\n\t */\n\tpageMetadata: {\n\t\tdefault: null,\n\t\tselectable: true\n\t},\n\n\t/**\n\t * List of available pages\n\t * @type {Array<LandingPage>}\n\t */\n\tpages: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Current page state model\n\t * @type {Object}\n\t */\n\tpageState: {\n\t\tdefault: null,\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Pristine copy of page state model\n\t * @type {Object}\n\t */\n\tpageStatePristine: {\n\t\tdefault: null,\n\t\tselectable: false\n\t},\n\n\t/**\n\t * Current merged tree of page's elements and layouts model\n\t * @type {Object}\n\t */\n\tpageTree: {\n\t\tdefault: null,\n\t\tselectable: true\n\t},\n\n\t/**\n\t * List of page properties (root macroponent properties)\n\t */\n\tpageProperties: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Layout model for the current page\n\t */\n\tpageLayout: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\t/**\n\t * Is the layout model currently the default model\n\t */\n\tisDefaultPageLayout: {\n\t\tdefault: false,\n\t\tselectable: true\n\t},\n\t/**\n\t * List of all UIB Templates\n\t */\n\ttemplates: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\t/**\n\t * Types of templates\n\t * @type {Array<TemplateType>}\n\t */\n\ttemplateTypes: {\n\t\tdefault: [],\n\t\tselectable: false\n\t},\n\t/**\n\t * Macroponent definitions for templates\n\t * @type {Array<Template>}\n\t */\n\ttemplatesDefinitions: {\n\t\tdefault: [],\n\t\tselectable: false\n\t},\n\n\t/**\n\t * List of operations for all data broker resources\n\t * @private\n\t * @type {Array<Object>}\n\t */\n\tdataBrokerOperations: {\n\t\tdefault: []\n\t},\n\tbindings: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\n\t/**\n\t * List of all the client scripts available for the current screen\n\t */\n\tclientScripts: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\n\t/**\n\t * Pristine copy of the client scripts\n\t * @type {Object[]}\n\t */\n\tclientScriptsPristine: {\n\t\tdefault: [],\n\t\tselectable: false\n\t},\n\n\t/**\n\t * Client scripts can be added or deleted\n\t */\n\tisClientScriptsBusy: {\n\t\tdefault: false,\n\t\tselectable: true\n\t},\n\t/**\n\t * Map of eventHandlers and elenents that trigger them\n\t */\n\teventHandlerElementMap: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\ttheme: {\n\t\tdefault: '',\n\t\tselectable: true\n\t},\n\t/**\n\t * List of all the client state parameters configured on the current screen\n\t */\n\tclientStateParameters: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\t/**\n\t * An object containing the current client state data, with binding values transformed\n\t */\n\tclientStateData: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\t/**\n\t * Macroponent dispatched events\n\t */\n\tdispatchedEvents: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\thandledEvents: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\t/**\n\t * Interface to configuration Component Map\n\t * @type {object}\n\t */\n\tinterfaceConfigurationComponent: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\t/**\n\t * Table updated flags for notifying when back end data changes (AMB)\n\t * @type {object}\n\t */\n\tupdatedTables: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\t/** Client scripts that need to evaluate at design time will use this api */\n\tclientScriptApi: {\n\t\tdefault: {\n\t\t\telements: null,\n\t\t\tdata: null,\n\t\t\tcontext: null,\n\t\t\tstate: null\n\t\t},\n\t\tselectable: true\n\t},\n\tclientScriptApiCompletions: {\n\t\tdefault: {\n\t\t\tclientScript: `interface api {\n\t\t\t\telements: null;\n\t\t\t\tdata: null;\n\t\t\t\tstate: null;\n\t\t\t\tcontext: null;\n\t\t\t\t/** Set current client state values */\n\t\t\t\t  setState(name: string, state: object): void;\n\t\t\t  }`,\n\t\t\tclientTransformScript: `interface api {\n\t\t\t\telements: null;\n\t\t\t\tdata: null;\n\t\t\t\tstate: null;\n\t\t\t\tcontext: null;\n\t\t\t  }`\n\t\t},\n\t\tselectable: true\n\t},\n\tparentInfo: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\tnewElementDefaultEventHandlers: {\n\t\tdefault: {},\n\t\tselectable: false\n\t},\n\tpageType: {\n\t\tdefault: null,\n\t\tselectable: false\n\t},\n\thiddenElements: {\n\t\tdefault: {},\n\t\tselectable: true\n\t},\n\tisDomainExpanded: {\n\t\tdefault: false,\n\t\tselectable: true\n\t},\n\trouteState: {\n\t\tdefault: {}\n\t},\n\tisIsolatedEditAndEmptyState: {\n\t\tdefault: false,\n\t\tcomputed({ properties: { routeState, pageState } }) {\n\t\t\treturn (\n\t\t\t\tget(routeState, 'queryParams.isolatedEditMode', false) &&\n\t\t\t\tisEmpty(pageState)\n\t\t\t);\n\t\t}\n\t},\n\tinternalEventMappings: {\n\t\tdefault: [],\n\t\tselectable: true\n\t},\n\tinternalEventMappingsSourceEvents: {\n\t\tdefault: [],\n\t\tselectable: true,\n\t\tcomputed({ properties: { handledEvents } }) {\n\t\t\treturn [...(handledEvents || []), ...ROOT_MACROPONENT_SOURCE_EVENTS];\n\t\t}\n\t},\n\tappChromeSettings: {\n\t\tdefault: {},\n\t\tselectable: true\n\t}\n};\n","import { createCustomElement, actionTypes } from '@servicenow/ui-core';\nimport snabbdom from '@servicenow/ui-renderer-snabbdom';\nimport get from 'lodash/get';\nimport isEqual from 'lodash/isEqual';\nimport map from 'lodash/map';\nimport PageTreeModel from '../models/pageTree';\nimport { componentListHandlers } from './componentList';\nimport { dataBrokerDefinitionsHandlers } from './dataBrokers/dataBrokerDefinitions';\nimport { dataBrokerInstancesHandlers } from './dataBrokers/dataBrokerInstances';\nimport { dataBrokerRuntimeHandlers } from './dataBrokers'; // TODO: Move instance and definition work here\nimport { DATA_BROKER_RUNTIME_EXECUTE_REQUESTED } from './dataBrokers/dataBrokerRuntimeActions';\nimport { elementHandlers } from './element';\nimport createElementArray from './element/utils/createElementArray';\nimport { isDefaultLayout } from './element/defaultLayoutElementHandlers/';\nimport { elementEventMappingsHandlers } from './elementEventMappings';\nimport { pageHandlers } from './page';\nimport { pageListHandlers } from './pageList';\nimport { screenPropertiesHandlers } from './screenProperties';\nimport { pagePropertiesHandlers } from './pageProperties';\nimport { pageLayoutHandlers } from './pageLayout';\nimport { templatesHandlers } from './templates';\nimport { pageTemplatesHandlers } from './pageTemplates';\nimport { layoutTemplatesHandlers } from './layoutTemplates';\nimport { clientScriptsHandlers } from './clientScripts';\nimport { clientStateHandlers, clientStateRuntimeHandlers } from './clientState';\nimport { dispatchedEventsHandlers } from './dispatchedEvents';\nimport { domReadyHandlers } from './domReady';\nimport { ambSubscribersHandlers } from './ambSubscribers';\nimport { updatedTablesHandlers } from './updatedTables';\nimport { CLIENT_STATE_DATA_REQUESTED } from './clientState/clientStateActions';\nimport {\n\tnewPageCreateHandlers,\n\tnewPageSaveHandlers,\n\tnewPageDeleteHandlers,\n\tnewPageVariantCreateHandlers,\n\tnewPageVariantDeleteHandlers\n} from './newPage';\nimport {\n\tcreateExposedProperty,\n\tgetDataBrokerInputPropertiesFromPageState,\n\tgetDataBrokerInstances,\n\tgetDataBrokerInstanceProperties,\n\tsetOnChangeForDependeeProperties,\n\tgetElementTree,\n\tgetElementEventMappings,\n\tgetElementEvents,\n\tgetElementProperties,\n\tgetElementLayouts,\n\tgetElementStyles,\n\tgetEventMappingHandlers,\n\tgetPageMetadata,\n\tgetPageProperties,\n\tisPageStateDirty,\n\tgetElementToEventMappingHandlerMap,\n\tgetStateParams,\n\tgetScreenEventMappings,\n\tgetInternalEventMappings,\n\tgetClientScriptApi,\n\tgetHiddenElements,\n\tprocessClientStateData,\n\tgetDataBrokerEventMappings,\n\tgetClientScriptApiCompletions,\n\tgenerateDataBrokerErrorObj,\n\tupdateDeclarativeClientStateUpdateEventHandlers\n} from './utils';\nimport { memoizeGetDefaultLayout } from './templates/utils/getDefaultLayout';\nimport { elementUsesSNLayout } from './element/utils/element';\nimport { configurationComponentByInterfaceHandlers } from './configurationComponentByInterface';\nimport { componentSourcesHandlers } from './componentSources';\nimport modalhandlers from './modalhandlers';\nimport {\n\tfilterBindings,\n\tcollectAllBindings,\n\tbindingsHandlers\n} from './bindings';\nimport viewportHandlers from './viewportHandlers';\nimport '@servicenow/now-modal';\nimport newPageVariantOverrideHandlers from './newPage/newPageVariantOverrideHandlers';\nimport { dashboardsHandlers } from './dashboards';\nimport { domainScopeHandlers } from './domainScope';\nimport configProperties from './configProperties';\nimport isEmpty from 'lodash/isEmpty';\n\nexport const PAGE_STATE_CLEARED = 'SN_UXF#PAGE_STATE_CLEARED';\nexport const PAGE_STATE_RESET = 'SN_UXF#PAGE_STATE_RESET';\nexport const SHOW_FAILURE_ALERT = 'SN_UXF#SHOW_FAILURE_ALERT';\n\nconst view = (state) => {\n\tconst { dataBrokerData, dataBrokerElements, ancestorElementElements } = state;\n\tconst {\n\t\tpageState,\n\t\tancestorDataBrokerInstances,\n\t\tancestorElements,\n\t\tclientScriptApi\n\t} = state.properties;\n\n\tconst clientSideDataBrokers =\n\t\tpageState && pageState.dataBrokerInstances\n\t\t\t? pageState.dataBrokerInstances.filter((dataBrokerInstance) => {\n\t\t\t\t\treturn dataBrokerInstance.definition.type === 'CLIENT_STATE';\n\t\t\t  })\n\t\t\t: [];\n\n\tconst ancestorClientStateDataBrokers = ancestorDataBrokerInstances.filter(\n\t\t(dbinstance) => {\n\t\t\treturn dbinstance.definition.type === 'CLIENT_STATE';\n\t\t}\n\t);\n\tconst serverSideDataBrokers =\n\t\tpageState && pageState.dataBrokerInstances\n\t\t\t? [\n\t\t\t\t\t...ancestorDataBrokerInstances,\n\t\t\t\t\t...pageState.dataBrokerInstances\n\t\t\t  ].filter((dataBrokerInstance) => {\n\t\t\t\t\treturn dataBrokerInstance.definition.type !== 'CLIENT_STATE';\n\t\t\t  })\n\t\t\t: [];\n\n\treturn (\n\t\t<div>\n\t\t\t{Object.entries(dataBrokerElements).map(\n\t\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\t\t([dataBrokerInstanceId, DataBrokerElementName]) => {\n\t\t\t\t\tconst targetData = dataBrokerData[dataBrokerInstanceId];\n\t\t\t\t\tconst targetDataBrokerInstance = serverSideDataBrokers.find(\n\t\t\t\t\t\t(serverSideDataBroker) =>\n\t\t\t\t\t\t\tserverSideDataBroker.id === dataBrokerInstanceId\n\t\t\t\t\t);\n\t\t\t\t\tconst outputs = targetDataBrokerInstance\n\t\t\t\t\t\t? Object.keys(\n\t\t\t\t\t\t\t\ttargetDataBrokerInstance.outputProperties || {}\n\t\t\t\t\t\t  ).reduce((acc, outputKey) => {\n\t\t\t\t\t\t\t\tacc[outputKey] =\n\t\t\t\t\t\t\t\t\tget(targetData, `result.${outputKey}`, null) ||\n\t\t\t\t\t\t\t\t\tget(targetData, 'result.output', { data: [] });\n\t\t\t\t\t\t\t\treturn acc;\n\t\t\t\t\t\t  }, {})\n\t\t\t\t\t\t: {};\n\n\t\t\t\t\tconst dateBrokerProps = getDataBrokerInputPropertiesFromPageState(\n\t\t\t\t\t\tpageState,\n\t\t\t\t\t\tdataBrokerInstanceId,\n\t\t\t\t\t\tclientScriptApi\n\t\t\t\t\t);\n\n\t\t\t\t\tconst dataBrokerRuntimeErrors = get(targetData, 'errors', []);\n\n\t\t\t\t\tconst targetDataPreview = dataBrokerRuntimeErrors.length\n\t\t\t\t\t\t? generateDataBrokerErrorObj(dataBrokerRuntimeErrors)\n\t\t\t\t\t\t: get(targetData, 'result', {});\n\t\t\t\t\tconst targetExecutionTime = get(targetData, 'executionTime', null);\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<DataBrokerElementName\n\t\t\t\t\t\t\tcomponent-id={dataBrokerInstanceId}\n\t\t\t\t\t\t\t{...outputs}\n\t\t\t\t\t\t\tpreview={targetDataPreview}\n\t\t\t\t\t\t\texecutionTime={targetExecutionTime}\n\t\t\t\t\t\t\t{...dateBrokerProps}\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t)}\n\t\t\t{clientSideDataBrokers.map((clientSideDataBroker) => {\n\t\t\t\tconst TagName = clientSideDataBroker.clientStateDataBrokerTagName; // eslint-disable-line no-unused-vars\n\t\t\t\tconst dataBrokerDataId = clientSideDataBroker.id;\n\n\t\t\t\tconst dateBrokerProps = getDataBrokerInputPropertiesFromPageState(\n\t\t\t\t\tpageState,\n\t\t\t\t\tdataBrokerDataId,\n\t\t\t\t\tclientScriptApi\n\t\t\t\t);\n\t\t\t\treturn (\n\t\t\t\t\t<TagName\n\t\t\t\t\t\tcomponent-id={clientSideDataBroker.id}\n\t\t\t\t\t\t{...dateBrokerProps}\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t})}\n\t\t\t{ancestorClientStateDataBrokers.map((ancestorClientStateDataBroker) => {\n\t\t\t\tconst TagName = // eslint-disable-line no-unused-vars\n\t\t\t\t\tancestorClientStateDataBroker.clientStateDataBrokerTagName;\n\t\t\t\tconst inputProps = Object.entries(\n\t\t\t\t\tancestorClientStateDataBroker.properties\n\t\t\t\t).reduce((acc, [key, { value }]) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...acc,\n\t\t\t\t\t\t[key]: value\n\t\t\t\t\t};\n\t\t\t\t}, {});\n\t\t\t\treturn (\n\t\t\t\t\t<TagName\n\t\t\t\t\t\tcomponent-id={ancestorClientStateDataBroker.id}\n\t\t\t\t\t\t{...inputProps}\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t})}\n\t\t\t{Object.entries(ancestorElementElements).map(\n\t\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\t\t([elementId, AncestorElementTagName]) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<AncestorElementTagName\n\t\t\t\t\t\t\tcomponent-id={elementId}\n\t\t\t\t\t\t\t{...get(ancestorElements, [elementId, 'propertyValues'], {})}\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t)}\n\t\t\t<slot />\n\t\t</div>\n\t);\n};\n\nexport default createCustomElement('sn-uxf-builder-middleware', {\n\trenderer: { type: snabbdom },\n\tview,\n\tinitialState: {\n\t\tdetachedElementData: null,\n\t\tdataBrokerElements: {},\n\t\tancestorElementElements: {},\n\t\tdataBrokerData: {},\n\t\tcontextBindingInfo: null,\n\t\tallContextBindings: [],\n\t\tactiveViewportRoutes: {},\n\t\tactiveViewportScreens: {},\n\t\tgetDefaultLayout: memoizeGetDefaultLayout()\n\t},\n\tproperties: configProperties,\n\tactionHandlers: {\n\t\t[actionTypes.COMPONENT_PROPERTY_CHANGED]: ({\n\t\t\taction,\n\t\t\tproperties,\n\t\t\tupdateProperties,\n\t\t\tdispatch,\n\t\t\tupdateState,\n\t\t\tstate\n\t\t}) => {\n\t\t\tconst {\n\t\t\t\tpageState,\n\t\t\t\tpageStatePristine,\n\t\t\t\tclientScripts,\n\t\t\t\tclientScriptsPristine,\n\t\t\t\tparentPageProperties,\n\t\t\t\tparentDataBrokerInstances,\n\t\t\t\tclientScriptApi,\n\t\t\t\thiddenElements,\n\t\t\t\tdataBrokerDefinitions,\n\t\t\t\tancestorDataBrokerInstances,\n\t\t\t\tancestorPageProperties,\n\t\t\t\tancestorElements,\n\t\t\t\ttemplatesDefinitions,\n\t\t\t\tappChromeSettings\n\t\t\t} = properties;\n\t\t\tconst { getDefaultLayout } = state;\n\t\t\tconst { name, value } = action.payload;\n\n\t\t\tconst previousValue = action.payload.previousValue || {};\n\n\t\t\t// The all important object of changing data\n\t\t\tconst selectablePropsToUpdate = {};\n\t\t\t// Whether to dispatch DATA_BROKER_RUNTIME_EXECUTE_REQUESTED, based on prop changes.\n\t\t\tlet reexecuteDataBrokerRuntime = false;\n\n\t\t\tif (name === 'pageState' && value && value.rootElement) {\n\t\t\t\tlet dataBrokerInstances, oldDataBrokerInstances;\n\n\t\t\t\tif (pageState.dataBrokersEnabled) {\n\t\t\t\t\tdataBrokerInstances = getDataBrokerInstances(\n\t\t\t\t\t\tvalue.dataBrokerInstances\n\t\t\t\t\t);\n\t\t\t\t\toldDataBrokerInstances = previousValue.dataBrokerInstances\n\t\t\t\t\t\t? getDataBrokerInstances(previousValue.dataBrokerInstances)\n\t\t\t\t\t\t: [];\n\t\t\t\t\tif (!isEqual(oldDataBrokerInstances, dataBrokerInstances)) {\n\t\t\t\t\t\tselectablePropsToUpdate.dataBrokerInstances = dataBrokerInstances;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst dataBrokerProperties = getDataBrokerInstanceProperties(\n\t\t\t\t\t\tvalue.dataBrokerInstances\n\t\t\t\t\t);\n\t\t\t\t\tconst oldDataBrokerProperties = getDataBrokerInstanceProperties(\n\t\t\t\t\t\tpreviousValue.dataBrokerInstances\n\t\t\t\t\t);\n\n\t\t\t\t\tif (!isEqual(oldDataBrokerProperties, dataBrokerProperties)) {\n\t\t\t\t\t\treexecuteDataBrokerRuntime = true;\n\t\t\t\t\t\tconst processedDataBrokerProperties = setOnChangeForDependeeProperties(\n\t\t\t\t\t\t\tdataBrokerProperties\n\t\t\t\t\t\t);\n\t\t\t\t\t\tselectablePropsToUpdate.dataBrokerProperties = processedDataBrokerProperties;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst dataBrokerEventMappings = getDataBrokerEventMappings(\n\t\t\t\t\t\tdataBrokerInstances\n\t\t\t\t\t);\n\t\t\t\t\tconst previousDataBrokerEventMappings = getDataBrokerEventMappings(\n\t\t\t\t\t\toldDataBrokerInstances\n\t\t\t\t\t);\n\t\t\t\t\tif (\n\t\t\t\t\t\t!isEqual(previousDataBrokerEventMappings, dataBrokerEventMappings)\n\t\t\t\t\t) {\n\t\t\t\t\t\tselectablePropsToUpdate.dataBrokerEventMappings = dataBrokerEventMappings;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst dataBrokerEventMappingHandlers = getEventMappingHandlers(\n\t\t\t\t\t\tdataBrokerInstances\n\t\t\t\t\t);\n\t\t\t\t\tconst previousDataBrokerEventMappingHandlers = getEventMappingHandlers(\n\t\t\t\t\t\toldDataBrokerInstances\n\t\t\t\t\t);\n\t\t\t\t\tif (\n\t\t\t\t\t\t!isEqual(\n\t\t\t\t\t\t\tpreviousDataBrokerEventMappingHandlers,\n\t\t\t\t\t\t\tdataBrokerEventMappingHandlers\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\tselectablePropsToUpdate.eventMappingHandlers = {\n\t\t\t\t\t\t\t...(properties.eventMappingHandlers || {}),\n\t\t\t\t\t\t\t...dataBrokerEventMappingHandlers\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!isEqual(previousValue.eventHandlers, value.eventHandlers)) {\n\t\t\t\t\tselectablePropsToUpdate.eventHandlers = value.eventHandlers;\n\t\t\t\t}\n\n\t\t\t\tconst internalEventMappings = getInternalEventMappings(\n\t\t\t\t\tvalue.rootElement\n\t\t\t\t);\n\t\t\t\tconst previousInternalEventMappings = getInternalEventMappings(\n\t\t\t\t\tpreviousValue.rootElement\n\t\t\t\t);\n\t\t\t\tif (!isEqual(previousInternalEventMappings, internalEventMappings)) {\n\t\t\t\t\tselectablePropsToUpdate.internalEventMappings = internalEventMappings;\n\t\t\t\t}\n\n\t\t\t\tconst internalEventMappingHandlers = getEventMappingHandlers([\n\t\t\t\t\t{ eventMappings: internalEventMappings }\n\t\t\t\t]);\n\t\t\t\tconst previousInternalEventMappingHandlers = getEventMappingHandlers([\n\t\t\t\t\t{ eventMappings: previousInternalEventMappings }\n\t\t\t\t]);\n\t\t\t\tif (\n\t\t\t\t\t!isEqual(\n\t\t\t\t\t\tpreviousInternalEventMappingHandlers,\n\t\t\t\t\t\tinternalEventMappingHandlers\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tselectablePropsToUpdate.eventMappingHandlers = {\n\t\t\t\t\t\t...(properties.eventMappingHandlers || {}),\n\t\t\t\t\t\t...(selectablePropsToUpdate.eventMappingHandlers || {}),\n\t\t\t\t\t\t...internalEventMappingHandlers\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tconst elementArr = createElementArray(value.rootElement, (element) => ({\n\t\t\t\t\tid: element.id,\n\t\t\t\t\tinstanceName: element.instanceName,\n\t\t\t\t\tisHidden: element.isHidden,\n\t\t\t\t\ttagName: element.component.tag,\n\t\t\t\t\tdispatchedEvents: element.component.dispatchedEvents,\n\t\t\t\t\teventMappings: element.eventMappings,\n\t\t\t\t\tstyles: element.styles,\n\t\t\t\t\tproperties: map(element.properties, createExposedProperty),\n\t\t\t\t\tlayout: elementUsesSNLayout(element) ? element.layout : null,\n\t\t\t\t\telementUsesSNLayout: elementUsesSNLayout(element)\n\t\t\t\t}));\n\n\t\t\t\tconst previousElementArr = previousValue.rootElement\n\t\t\t\t\t? createElementArray(previousValue.rootElement, (element) => ({\n\t\t\t\t\t\t\tid: element.id,\n\t\t\t\t\t\t\tinstanceName: element.instanceName,\n\t\t\t\t\t\t\tisHidden: element.isHidden,\n\t\t\t\t\t\t\ttagName: element.component.tag,\n\t\t\t\t\t\t\tdispatchedEvents: element.component.dispatchedEvents,\n\t\t\t\t\t\t\teventMappings: element.eventMappings,\n\t\t\t\t\t\t\tstyles: element.styles,\n\t\t\t\t\t\t\tproperties: map(element.properties, createExposedProperty),\n\t\t\t\t\t\t\tlayout: elementUsesSNLayout(element) ? element.layout : null,\n\t\t\t\t\t\t\telementUsesSNLayout: elementUsesSNLayout(element)\n\t\t\t\t\t  }))\n\t\t\t\t\t: [];\n\n\t\t\t\tconst elementProperties = getElementProperties(elementArr, value);\n\t\t\t\tconst previousElementProperties = getElementProperties(\n\t\t\t\t\tpreviousElementArr,\n\t\t\t\t\tvalue\n\t\t\t\t);\n\n\t\t\t\tif (!isEqual(previousElementProperties, elementProperties)) {\n\t\t\t\t\tconst currentHiddenElements = getHiddenElements(\n\t\t\t\t\t\telementArr,\n\t\t\t\t\t\tclientScriptApi\n\t\t\t\t\t);\n\t\t\t\t\tconst elementTree = getElementTree(\n\t\t\t\t\t\tvalue.rootElement,\n\t\t\t\t\t\tcurrentHiddenElements\n\t\t\t\t\t);\n\t\t\t\t\tconst processedElementProperties = setOnChangeForDependeeProperties(\n\t\t\t\t\t\telementProperties\n\t\t\t\t\t);\n\t\t\t\t\tselectablePropsToUpdate.elementProperties = processedElementProperties;\n\t\t\t\t\tselectablePropsToUpdate.elementTree = elementTree;\n\t\t\t\t\tselectablePropsToUpdate.hiddenElements = currentHiddenElements;\n\t\t\t\t}\n\n\t\t\t\tconst elementStyles = getElementStyles(elementArr, value);\n\t\t\t\tconst previousElementStyles = getElementStyles(\n\t\t\t\t\tpreviousElementArr,\n\t\t\t\t\tvalue\n\t\t\t\t);\n\n\t\t\t\tif (!isEqual(previousElementStyles, elementStyles)) {\n\t\t\t\t\tselectablePropsToUpdate.elementStyles = elementStyles;\n\t\t\t\t}\n\n\t\t\t\tconst elementLayouts = getElementLayouts(\n\t\t\t\t\telementArr,\n\t\t\t\t\ttemplatesDefinitions\n\t\t\t\t);\n\t\t\t\tconst previousElementLayouts = getElementLayouts(\n\t\t\t\t\tpreviousElementArr,\n\t\t\t\t\ttemplatesDefinitions\n\t\t\t\t);\n\n\t\t\t\tif (!isEqual(previousElementLayouts, elementLayouts)) {\n\t\t\t\t\tselectablePropsToUpdate.elementLayouts = elementLayouts;\n\t\t\t\t}\n\n\t\t\t\tconst elementEvents = getElementEvents(elementArr);\n\t\t\t\tconst previousElementEvents = getElementEvents(previousElementArr);\n\t\t\t\tif (!isEqual(previousElementEvents, elementEvents)) {\n\t\t\t\t\tselectablePropsToUpdate.elementEvents = elementEvents;\n\t\t\t\t}\n\n\t\t\t\tconst elementEventMappings = getElementEventMappings(elementArr);\n\t\t\t\tconst previousElementEventMappings = getElementEventMappings(\n\t\t\t\t\tpreviousElementArr\n\t\t\t\t);\n\t\t\t\tif (!isEqual(previousElementEventMappings, elementEventMappings)) {\n\t\t\t\t\tselectablePropsToUpdate.elementEventMappings = elementEventMappings;\n\t\t\t\t}\n\n\t\t\t\tconst eventMappingHandlers = getEventMappingHandlers(elementArr);\n\t\t\t\tconst previousEventMappingHandlers = getEventMappingHandlers(\n\t\t\t\t\tpreviousElementArr\n\t\t\t\t);\n\t\t\t\tif (!isEqual(previousEventMappingHandlers, eventMappingHandlers)) {\n\t\t\t\t\tselectablePropsToUpdate.eventMappingHandlers = {\n\t\t\t\t\t\t...(properties.eventMappingHandlers || {}),\n\t\t\t\t\t\t...(selectablePropsToUpdate.eventMappingHandlers || {}),\n\t\t\t\t\t\t...eventMappingHandlers\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tconst elementToEventMappingHandlerMap = getElementToEventMappingHandlerMap(\n\t\t\t\t\telementArr,\n\t\t\t\t\telementEventMappings,\n\t\t\t\t\teventMappingHandlers\n\t\t\t\t);\n\t\t\t\tconst previousElementToEventMappingHandlerMap = getElementToEventMappingHandlerMap(\n\t\t\t\t\tpreviousElementArr,\n\t\t\t\t\tpreviousElementEventMappings,\n\t\t\t\t\tpreviousEventMappingHandlers\n\t\t\t\t);\n\t\t\t\tif (\n\t\t\t\t\t!isEqual(\n\t\t\t\t\t\tpreviousElementToEventMappingHandlerMap,\n\t\t\t\t\t\telementToEventMappingHandlerMap\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tselectablePropsToUpdate.eventHandlerElementMap = elementToEventMappingHandlerMap;\n\t\t\t\t}\n\n\t\t\t\tconst dispatchedEvents = value.dispatchedEvents;\n\t\t\t\tconst previousDispatchedEvents = previousValue.dispatchedEvents;\n\t\t\t\tif (!isEqual(dispatchedEvents, previousDispatchedEvents)) {\n\t\t\t\t\tselectablePropsToUpdate.dispatchedEvents = dispatchedEvents;\n\t\t\t\t}\n\n\t\t\t\tconst handledEvents = value.handledEvents;\n\t\t\t\tconst previousHandledEvents = previousValue.handledEvents;\n\t\t\t\tif (!isEqual(handledEvents, previousHandledEvents)) {\n\t\t\t\t\tselectablePropsToUpdate.handledEvents = handledEvents;\n\t\t\t\t}\n\n\t\t\t\tconst screenEventMappings = getScreenEventMappings(\n\t\t\t\t\tvalue.screenEventMappings\n\t\t\t\t);\n\t\t\t\tconst previousScreenEventMappings = getScreenEventMappings(\n\t\t\t\t\tpreviousValue.screenEventMappings || []\n\t\t\t\t);\n\t\t\t\tif (!isEqual(screenEventMappings, previousScreenEventMappings)) {\n\t\t\t\t\tselectablePropsToUpdate.screenEventMappings = screenEventMappings;\n\t\t\t\t}\n\n\t\t\t\tconst screenEventMappingHandlers = getEventMappingHandlers([\n\t\t\t\t\t{ eventMappings: value.screenEventMappings }\n\t\t\t\t]);\n\t\t\t\tconst previousScreenEventMappingHandlers = getEventMappingHandlers([\n\t\t\t\t\t{ eventMappings: previousValue.screenEventMappings || [] }\n\t\t\t\t]);\n\t\t\t\tif (\n\t\t\t\t\t!isEqual(\n\t\t\t\t\t\tscreenEventMappingHandlers,\n\t\t\t\t\t\tpreviousScreenEventMappingHandlers\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tselectablePropsToUpdate.eventMappingHandlers = {\n\t\t\t\t\t\t...(properties.eventMappingHandlers || {}),\n\t\t\t\t\t\t...(selectablePropsToUpdate.eventMappingHandlers || {}),\n\t\t\t\t\t\t...screenEventMappingHandlers\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tconst pageTree = new PageTreeModel({\n\t\t\t\t\trootElement: value.rootElement\n\t\t\t\t});\n\n\t\t\t\tconst previousPageTree = new PageTreeModel({\n\t\t\t\t\trootElement: previousValue.rootElement || {}\n\t\t\t\t});\n\n\t\t\t\tif (!isEqual(previousPageTree, pageTree)) {\n\t\t\t\t\tselectablePropsToUpdate.pageTree = pageTree;\n\t\t\t\t}\n\n\t\t\t\tconst elementTree = getElementTree(value.rootElement, hiddenElements);\n\t\t\t\tconst previousElementTree = getElementTree(\n\t\t\t\t\tpreviousValue.rootElement,\n\t\t\t\t\thiddenElements\n\t\t\t\t);\n\t\t\t\tif (!isEqual(previousElementTree, elementTree)) {\n\t\t\t\t\tselectablePropsToUpdate.elementTree = elementTree;\n\t\t\t\t}\n\n\t\t\t\tconst pageMetadata = getPageMetadata(value);\n\t\t\t\tconst previousPageMetadata = getPageMetadata(previousValue);\n\t\t\t\tif (!isEqual(previousPageMetadata, pageMetadata)) {\n\t\t\t\t\tselectablePropsToUpdate.pageMetadata = pageMetadata;\n\t\t\t\t}\n\n\t\t\t\tconst pageProperties = getPageProperties(value.rootElement);\n\t\t\t\tconst previousPageProperties = previousValue.rootElement\n\t\t\t\t\t? getPageProperties(previousValue.rootElement)\n\t\t\t\t\t: [];\n\t\t\t\tif (!isEqual(previousPageProperties, pageProperties)) {\n\t\t\t\t\tif (pageState.dataBrokersEnabled) {\n\t\t\t\t\t\treexecuteDataBrokerRuntime = true;\n\t\t\t\t\t}\n\t\t\t\t\tdispatch(CLIENT_STATE_DATA_REQUESTED, {\n\t\t\t\t\t\tparams: value.clientStateParameters\n\t\t\t\t\t});\n\t\t\t\t\tselectablePropsToUpdate.pageProperties = pageProperties;\n\t\t\t\t}\n\n\t\t\t\tconst pageLayout = get(value, 'rootElement.layout', {});\n\t\t\t\tconst previousPageLayout = previousValue.rootElement\n\t\t\t\t\t? get(previousValue, 'rootElement.layout', {})\n\t\t\t\t\t: {};\n\t\t\t\tif (!isEqual(previousPageLayout, pageLayout)) {\n\t\t\t\t\tselectablePropsToUpdate.pageLayout = pageLayout;\n\t\t\t\t}\n\n\t\t\t\tconst hasChildren = get(value, 'rootElement.children', []).length > 0;\n\t\t\t\tconst isDefaultPageLayout =\n\t\t\t\t\t!hasChildren && isDefaultLayout(pageLayout, getDefaultLayout);\n\t\t\t\tselectablePropsToUpdate.isDefaultPageLayout = isDefaultPageLayout;\n\n\t\t\t\tconst bindings = collectAllBindings({\n\t\t\t\t\tpageProperties,\n\t\t\t\t\telementProperties,\n\t\t\t\t\telementArr,\n\t\t\t\t\tdataBrokerInstances,\n\t\t\t\t\tparentDataBrokerInstances,\n\t\t\t\t\tparentPageProperties,\n\t\t\t\t\tclientStateParameters: value.clientStateParameters,\n\t\t\t\t\tmiddlewareProperties: properties,\n\t\t\t\t\tappChromeSettings\n\t\t\t\t});\n\t\t\t\tconst previousBindings = collectAllBindings({\n\t\t\t\t\tpreviousPageProperties,\n\t\t\t\t\tpreviousElementProperties,\n\t\t\t\t\tpreviousElementArr,\n\t\t\t\t\toldDataBrokerInstances,\n\t\t\t\t\tparentDataBrokerInstances,\n\t\t\t\t\tparentPageProperties,\n\t\t\t\t\tclientStateParameters: previousValue.clientStateParameters,\n\t\t\t\t\tmiddlewareProperties: properties,\n\t\t\t\t\tappChromeSettings\n\t\t\t\t});\n\t\t\t\tif (!isEqual(previousBindings, bindings)) {\n\t\t\t\t\tupdateState({\n\t\t\t\t\t\toperation: 'set',\n\t\t\t\t\t\tpath: 'allContextBindings',\n\t\t\t\t\t\tvalue: bindings\n\t\t\t\t\t});\n\t\t\t\t\tselectablePropsToUpdate.bindings = filterBindings(\n\t\t\t\t\t\tbindings,\n\t\t\t\t\t\tstate.contextBindingInfo\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t!isEqual(\n\t\t\t\t\t\tgetStateParams(previousValue.clientStateParameters),\n\t\t\t\t\t\tgetStateParams(value.clientStateParameters)\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tselectablePropsToUpdate.clientStateParameters =\n\t\t\t\t\t\tvalue.clientStateParameters;\n\t\t\t\t\tdispatch(CLIENT_STATE_DATA_REQUESTED, {\n\t\t\t\t\t\tparams: value.clientStateParameters\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treexecuteDataBrokerRuntime === true &&\n\t\t\t\t\tdispatch(DATA_BROKER_RUNTIME_EXECUTE_REQUESTED);\n\t\t\t} else if (name === 'pageState' && value === null) {\n\t\t\t\tselectablePropsToUpdate;\n\t\t\t\t(selectablePropsToUpdate.dataBrokerInstances =\n\t\t\t\t\tconfigProperties.dataBrokerInstances.default),\n\t\t\t\t\t(selectablePropsToUpdate.dataBrokerEventMappings =\n\t\t\t\t\t\tconfigProperties.dataBrokerEventMappings.default),\n\t\t\t\t\t(selectablePropsToUpdate.eventMappingHandlers =\n\t\t\t\t\t\tconfigProperties.eventMappingHandlers.default),\n\t\t\t\t\t(selectablePropsToUpdate.eventHandlers =\n\t\t\t\t\t\tconfigProperties.eventHandlers.default),\n\t\t\t\t\t(selectablePropsToUpdate.internalEventMappings =\n\t\t\t\t\t\tconfigProperties.internalEventMappings.default),\n\t\t\t\t\t(selectablePropsToUpdate.elementProperties =\n\t\t\t\t\t\tconfigProperties.elementProperties.default),\n\t\t\t\t\t(selectablePropsToUpdate.elementTree =\n\t\t\t\t\t\tconfigProperties.elementTree.default),\n\t\t\t\t\t(selectablePropsToUpdate.hiddenElements =\n\t\t\t\t\t\tconfigProperties.hiddenElements.default),\n\t\t\t\t\t(selectablePropsToUpdate.elementStyles =\n\t\t\t\t\t\tconfigProperties.elementStyles.default),\n\t\t\t\t\t(selectablePropsToUpdate.elementLayouts =\n\t\t\t\t\t\tconfigProperties.elementLayouts.default),\n\t\t\t\t\t(selectablePropsToUpdate.elementEvents =\n\t\t\t\t\t\tconfigProperties.elementEvents.default),\n\t\t\t\t\t(selectablePropsToUpdate.elementEventMappings =\n\t\t\t\t\t\tconfigProperties.elementEventMappings.default),\n\t\t\t\t\t(selectablePropsToUpdate.eventHandlerElementMap =\n\t\t\t\t\t\tconfigProperties.eventHandlerElementMap.default),\n\t\t\t\t\t(selectablePropsToUpdate.dispatchedEvents =\n\t\t\t\t\t\tconfigProperties.dispatchedEvents.default),\n\t\t\t\t\t(selectablePropsToUpdate.handledEvents =\n\t\t\t\t\t\tconfigProperties.handledEvents.default),\n\t\t\t\t\t(selectablePropsToUpdate.screenEventMappings =\n\t\t\t\t\t\tconfigProperties.screenEventMappings.default),\n\t\t\t\t\t(selectablePropsToUpdate.pageTree =\n\t\t\t\t\t\tconfigProperties.pageTree.default),\n\t\t\t\t\t(selectablePropsToUpdate.pageMetadata =\n\t\t\t\t\t\tconfigProperties.pageMetadata.default),\n\t\t\t\t\t(selectablePropsToUpdate.pageProperties =\n\t\t\t\t\t\tconfigProperties.pageProperties.default),\n\t\t\t\t\t(selectablePropsToUpdate.clientScriptApi =\n\t\t\t\t\t\tconfigProperties.clientScriptApi.default),\n\t\t\t\t\t(selectablePropsToUpdate.pageLayout =\n\t\t\t\t\t\tconfigProperties.pageLayout.default),\n\t\t\t\t\t(selectablePropsToUpdate.isDefaultPageLayout =\n\t\t\t\t\t\tconfigProperties.isDefaultPageLayout.default),\n\t\t\t\t\t(selectablePropsToUpdate.bindings =\n\t\t\t\t\t\tconfigProperties.bindings.default),\n\t\t\t\t\t(selectablePropsToUpdate.clientStateParameters =\n\t\t\t\t\t\tconfigProperties.clientStateParameters.default);\n\t\t\t} else if (name === 'parentPageProperties') {\n\t\t\t\t// Get properties derived from pageState\n\t\t\t\t// for case when updated property is a parent prop\n\t\t\t\tconst {\n\t\t\t\t\tpageProperties,\n\t\t\t\t\telementProperties,\n\t\t\t\t\telementArr,\n\t\t\t\t\tdataBrokerInstances,\n\t\t\t\t\tisIsolatedEditAndEmptyState,\n\t\t\t\t\tappChromeSettings\n\t\t\t\t} = properties;\n\n\t\t\t\tconst bindings = collectAllBindings({\n\t\t\t\t\tpageProperties,\n\t\t\t\t\telementProperties,\n\t\t\t\t\telementArr,\n\t\t\t\t\tdataBrokerInstances,\n\t\t\t\t\tparentDataBrokerInstances,\n\t\t\t\t\tparentPageProperties,\n\t\t\t\t\tclientStateParameters: value.clientStateParameters,\n\t\t\t\t\tmiddlewareProperties: properties,\n\t\t\t\t\tappChromeSettings\n\t\t\t\t});\n\t\t\t\tconst previousBindings = collectAllBindings({\n\t\t\t\t\tpageProperties,\n\t\t\t\t\telementProperties,\n\t\t\t\t\telementArr,\n\t\t\t\t\tdataBrokerInstances,\n\t\t\t\t\tparentDataBrokerInstances,\n\t\t\t\t\tparentPageProperties,\n\t\t\t\t\tclientStateParameters: value.clientStateParameters,\n\t\t\t\t\tmiddlewareProperties: properties,\n\t\t\t\t\tappChromeSettings\n\t\t\t\t});\n\t\t\t\tif (\n\t\t\t\t\t!isEqual(previousBindings, bindings) ||\n\t\t\t\t\tisIsolatedEditAndEmptyState\n\t\t\t\t) {\n\t\t\t\t\tif (isIsolatedEditAndEmptyState) {\n\t\t\t\t\t\tdispatch(DATA_BROKER_RUNTIME_EXECUTE_REQUESTED);\n\t\t\t\t\t}\n\t\t\t\t\tupdateState({\n\t\t\t\t\t\toperation: 'set',\n\t\t\t\t\t\tpath: 'allContextBindings',\n\t\t\t\t\t\tvalue: bindings\n\t\t\t\t\t});\n\n\t\t\t\t\tselectablePropsToUpdate.bindings = filterBindings(\n\t\t\t\t\t\tbindings,\n\t\t\t\t\t\tstate.contextBindingInfo\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else if (\n\t\t\t\tname === 'pageState' ||\n\t\t\t\tname === 'pageStatePristine' ||\n\t\t\t\tname === 'clientStateParameters' ||\n\t\t\t\tname === 'eventMappingHandlers'\n\t\t\t) {\n\t\t\t\tconst { eventMappingHandlers, clientStateParameters } = properties;\n\t\t\t\tif (!pageState || !pageState.rootElement) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (clientStateParameters && clientStateParameters.length > 0) {\n\t\t\t\t\tconst clientStateParamsToUse =\n\t\t\t\t\t\tname === 'clientStateParameters' ? value : clientStateParameters;\n\t\t\t\t\tselectablePropsToUpdate.eventMappingHandlers = updateDeclarativeClientStateUpdateEventHandlers(\n\t\t\t\t\t\teventMappingHandlers,\n\t\t\t\t\t\tclientStateParamsToUse\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tconst elementArr = createElementArray(pageState.rootElement, (el) => ({\n\t\t\t\t\tid: el.id,\n\t\t\t\t\tproperties: map(el.properties, createExposedProperty),\n\t\t\t\t\tisHidden: el.isHidden\n\t\t\t\t}));\n\t\t\t\tconst clientScriptApi = getClientScriptApi({\n\t\t\t\t\tpageState,\n\t\t\t\t\tancestorPageProperties,\n\t\t\t\t\telements: elementArr,\n\t\t\t\t\tdataBrokerInstances: pageState.dataBrokerInstances,\n\t\t\t\t\tclientStateData: processClientStateData(\n\t\t\t\t\t\tclientStateParameters,\n\t\t\t\t\t\tpageState,\n\t\t\t\t\t\tancestorPageProperties,\n\t\t\t\t\t\tpageState.dataBrokerInstances,\n\t\t\t\t\t\tancestorDataBrokerInstances,\n\t\t\t\t\t\tancestorElements,\n\t\t\t\t\t\tappChromeSettings\n\t\t\t\t\t),\n\t\t\t\t\tdataBrokerDefinitions,\n\t\t\t\t\tappChromeSettings\n\t\t\t\t});\n\t\t\t\tconst currentHiddenElements = getHiddenElements(\n\t\t\t\t\telementArr,\n\t\t\t\t\tclientScriptApi\n\t\t\t\t);\n\t\t\t\tconst elementTree = getElementTree(\n\t\t\t\t\tpageState.rootElement,\n\t\t\t\t\tcurrentHiddenElements\n\t\t\t\t);\n\n\t\t\t\tconst clientScriptApiCompletions = getClientScriptApiCompletions(\n\t\t\t\t\tclientScriptApi\n\t\t\t\t);\n\n\t\t\t\tconst clientTransformScriptApiCompletions = getClientScriptApiCompletions(\n\t\t\t\t\tclientScriptApi,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\n\t\t\t\tselectablePropsToUpdate.clientScriptApi = clientScriptApi;\n\t\t\t\tselectablePropsToUpdate.clientScriptApiCompletions = {\n\t\t\t\t\tclientScript: clientScriptApiCompletions,\n\t\t\t\t\tclientTransformScript: clientTransformScriptApiCompletions\n\t\t\t\t};\n\t\t\t\tselectablePropsToUpdate.elementTree = elementTree;\n\t\t\t\tselectablePropsToUpdate.hiddenElements = currentHiddenElements;\n\t\t\t} else if (name === 'clientStateData') {\n\t\t\t\tif (!isEqual(value, previousValue)) {\n\t\t\t\t\tdispatch(DATA_BROKER_RUNTIME_EXECUTE_REQUESTED);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tname === 'pageState' ||\n\t\t\t\tname === 'pageStatePristine' ||\n\t\t\t\tname === 'clientScripts' ||\n\t\t\t\tname === 'clientScriptsPristine'\n\t\t\t) {\n\t\t\t\t// This handles the case when the page has been deleted\n\t\t\t\tif (!pageState) {\n\t\t\t\t\tselectablePropsToUpdate.isPageStateDirty = false;\n\t\t\t\t} else {\n\t\t\t\t\tselectablePropsToUpdate.isPageStateDirty =\n\t\t\t\t\t\tisPageStateDirty(pageState, pageStatePristine) ||\n\t\t\t\t\t\t!isEqual(clientScripts, clientScriptsPristine);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!isEmpty(selectablePropsToUpdate)) {\n\t\t\t\tupdateProperties({ ...selectablePropsToUpdate });\n\t\t\t}\n\t\t},\n\t\t...domReadyHandlers,\n\t\t...componentListHandlers,\n\t\t...dataBrokerDefinitionsHandlers,\n\t\t...dataBrokerInstancesHandlers,\n\t\t...dataBrokerRuntimeHandlers,\n\t\t...elementHandlers,\n\t\t...elementEventMappingsHandlers,\n\t\t...pageHandlers,\n\t\t...pageListHandlers,\n\t\t...screenPropertiesHandlers,\n\t\t...pagePropertiesHandlers,\n\t\t...pageLayoutHandlers,\n\t\t...templatesHandlers,\n\t\t...pageTemplatesHandlers,\n\t\t...layoutTemplatesHandlers,\n\t\t...elementHandlers,\n\t\t...configurationComponentByInterfaceHandlers,\n\t\t...componentSourcesHandlers,\n\t\t...newPageCreateHandlers,\n\t\t...newPageSaveHandlers,\n\t\t...newPageDeleteHandlers,\n\t\t...newPageVariantCreateHandlers,\n\t\t...newPageVariantDeleteHandlers,\n\t\t...newPageVariantOverrideHandlers,\n\t\t...clientScriptsHandlers,\n\t\t...modalhandlers,\n\t\t...clientStateHandlers,\n\t\t...clientStateRuntimeHandlers,\n\t\t...dispatchedEventsHandlers,\n\t\t...bindingsHandlers,\n\t\t...ambSubscribersHandlers,\n\t\t...updatedTablesHandlers,\n\t\t...viewportHandlers,\n\t\t...dashboardsHandlers,\n\t\t...domainScopeHandlers,\n\t\t[actionTypes.COMPONENT_RENDER_REQUESTED]: ({\n\t\t\taction,\n\t\t\tproperties,\n\t\t\tupdateProperties,\n\t\t\tstate,\n\t\t\tdispatch\n\t\t}) => {\n\t\t\tconst { previousRenderState } = action.payload;\n\t\t\tconst {\n\t\t\t\tpageState,\n\t\t\t\tclientStateParameters,\n\t\t\t\tancestorDataBrokerInstances,\n\t\t\t\tancestorPageProperties,\n\t\t\t\tdataBrokerInstances,\n\t\t\t\tancestorElements,\n\t\t\t\tdataBrokerDefinitions,\n\t\t\t\tappChromeSettings\n\t\t\t} = properties;\n\t\t\tif (!isEqual(state.dataBrokerData, previousRenderState.dataBrokerData)) {\n\t\t\t\tif (!pageState || !pageState.rootElement) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst elementArr = createElementArray(pageState.rootElement, (el) => ({\n\t\t\t\t\tid: el.id,\n\t\t\t\t\tproperties: map(el.properties, createExposedProperty),\n\t\t\t\t\tisHidden: el.isHidden\n\t\t\t\t}));\n\n\t\t\t\t// Let the task queues clear so the data broker seismic elements\n\t\t\t\t// will be hydrated prior to resolving them for script api\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tconst clientScriptApi = getClientScriptApi({\n\t\t\t\t\t\tpageState,\n\t\t\t\t\t\tancestorPageProperties,\n\t\t\t\t\t\telements: elementArr,\n\t\t\t\t\t\tdataBrokerInstances: dataBrokerInstances,\n\t\t\t\t\t\tclientStateData: processClientStateData(\n\t\t\t\t\t\t\tclientStateParameters,\n\t\t\t\t\t\t\tpageState,\n\t\t\t\t\t\t\tancestorPageProperties,\n\t\t\t\t\t\t\tpageState.dataBrokerInstances,\n\t\t\t\t\t\t\tancestorDataBrokerInstances,\n\t\t\t\t\t\t\tancestorElements,\n\t\t\t\t\t\t\tappChromeSettings\n\t\t\t\t\t\t),\n\t\t\t\t\t\tdataBrokerDefinitions,\n\t\t\t\t\t\tappChromeSettings\n\t\t\t\t\t});\n\n\t\t\t\t\tconst currentHiddenElements = getHiddenElements(\n\t\t\t\t\t\telementArr,\n\t\t\t\t\t\tclientScriptApi\n\t\t\t\t\t);\n\n\t\t\t\t\tupdateProperties({\n\t\t\t\t\t\tclientScriptApi,\n\t\t\t\t\t\thiddenElements: currentHiddenElements\n\t\t\t\t\t});\n\t\t\t\t\tdispatch(CLIENT_STATE_DATA_REQUESTED, {\n\t\t\t\t\t\tparams: properties.clientStateParameters\n\t\t\t\t\t});\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t},\n\t\t[PAGE_STATE_CLEARED]: ({ updateProperties }) => {\n\t\t\tupdateProperties({\n\t\t\t\tpageState: null,\n\t\t\t\tpageStatePristine: null,\n\t\t\t\tisPageStateDirty: false\n\t\t\t});\n\t\t},\n\t\t[PAGE_STATE_RESET]: ({ updateProperties, properties }) => {\n\t\t\tupdateProperties({\n\t\t\t\tpageState: properties.pageStatePristine,\n\t\t\t\tisPageStateDirty: false\n\t\t\t});\n\t\t}\n\t}\n});\n","export { default as snUXFBuilderMiddleware } from './sn-uxf-builder-middleware';\nexport { collectAllBindings, filterBindings, contextTypes } from './bindings';\nexport { default as effectProxy } from './helpers/effectProxy';\nexport { getPayloadPropertiesFromHandlerDefinition } from './page/utils/shared';\n\nimport { clientScriptsActions } from './clientScripts';\nimport { clientStateActions } from './clientState';\nimport { componentListActions } from './componentList';\nimport { dataBrokerDefinitionsActions } from './dataBrokers/dataBrokerDefinitions';\nimport { dataBrokerInstancesActions } from './dataBrokers/dataBrokerInstances';\nimport { dataBrokerRuntimeActions } from './dataBrokers';\nimport { elementActions } from './element';\nimport { elementEventMappingsActions } from './elementEventMappings';\nimport { templatesActions } from './templates';\nimport { layoutTemplatesActions } from './layoutTemplates';\nimport { pageTemplatesActions } from './pageTemplates';\nimport { newPageActions } from './newPage';\nimport { pageActions } from './page';\nimport { pageLayoutActions } from './pageLayout';\nimport { pageListActions } from './pageList';\nimport { pagePropertiesActions } from './pageProperties';\nimport { screenPropertiesActions } from './screenProperties';\nimport { dispatchedEventsActions } from './dispatchedEvents';\nimport { ambSubscribersActions } from './ambSubscribers';\nimport { updatedTablesActions } from './updatedTables';\nimport { dashboardsActions } from './dashboards';\nimport { domainScopeActions } from './domainScope';\nimport {\n\tPAGE_STATE_CLEARED,\n\tPAGE_STATE_RESET,\n\tSHOW_FAILURE_ALERT\n} from './sn-uxf-builder-middleware';\nimport { bindingsActions } from './bindings';\nimport { configurationComponentByInterfaceActions } from './configurationComponentByInterface';\n\nexport const snUXFActions = {\n\t...clientScriptsActions,\n\t...clientStateActions,\n\t...componentListActions,\n\t...dataBrokerDefinitionsActions,\n\t...dataBrokerInstancesActions,\n\t...dataBrokerRuntimeActions,\n\t...elementActions,\n\t...elementEventMappingsActions,\n\t...layoutTemplatesActions,\n\t...newPageActions,\n\t...pageActions,\n\t...pageLayoutActions,\n\t...pageListActions,\n\t...pagePropertiesActions,\n\t...templatesActions,\n\t...pageTemplatesActions,\n\t...layoutTemplatesActions,\n\t...screenPropertiesActions,\n\t...dispatchedEventsActions,\n\t...newPageActions,\n\t...clientScriptsActions,\n\t...bindingsActions,\n\t...ambSubscribersActions,\n\t...updatedTablesActions,\n\t...dashboardsActions,\n\t...configurationComponentByInterfaceActions,\n\t...domainScopeActions,\n\tPAGE_STATE_CLEARED,\n\tPAGE_STATE_RESET,\n\tSHOW_FAILURE_ALERT\n};\n","/**\n * @typedef Element\n * @property {string} id\n * @property {Element[]} children\n * @property {boolean} isModal\n */\n/**\n * a function that takes in a rootElement and returns the selected element, or\n * the element's closest modal parent if one exists\n * @param {Element} element\n * @param {string} selectedElementId\n * @return {Element|undefined}\n */\nexport const findSelectedElement = (element, selectedElementId) => {\n\tconst parentStack = [];\n\treturn search(parentStack, element, selectedElementId);\n};\n\n/**\n * a function which uses a stack to keep track of ancestral lineage while\n * it recurses the element's children to find the selectedElement\n * @param {Element[]} stack\n * @param {Element} element\n * @param {string} selectedElementId\n * @return {Element|undefined}\n */\nconst search = (stack, element, selectedElementId) => {\n\tif (!selectedElementId) {\n\t\treturn undefined;\n\t}\n\n\tif (element.id === selectedElementId) {\n\t\tlet el;\n\t\twhile ((el = stack.pop())) {\n\t\t\tif (el.isModal) {\n\t\t\t\treturn el;\n\t\t\t}\n\t\t}\n\t\treturn element;\n\t}\n\n\tstack.push(element);\n\n\tfor (const elem of element.children) {\n\t\tconst e = search(stack, elem, selectedElementId);\n\t\tif (e) {\n\t\t\treturn e;\n\t\t}\n\t}\n\n\tstack.pop();\n\treturn undefined;\n};\n\nexport const closeModal = (eventOrAction, dispatch) => {\n\teventOrAction.stopPropagation();\n\tdispatch('UIB_ELEMENT#ELEMENT_SELECTED', {\n\t\telementId: null,\n\t\telementInstanceName: null\n\t});\n};\n","import { createCustomElement } from '@servicenow/ui-core';\n// eslint-disable-next-line no-unused-vars\nimport snabbdom, { Fragment } from '@servicenow/ui-renderer-snabbdom';\n\ncreateCustomElement('sn-uib-value-renderer', {\n\trenderer: { type: snabbdom },\n\tview: ({ properties: { value } }) => <span>{value}</span>,\n\tproperties: {\n\t\tvalue: {\n\t\t\tdefault: {}\n\t\t}\n\t}\n});\n","import { createCustomElement } from '@servicenow/ui-core';\n// eslint-disable-next-line no-unused-vars\nimport snabbdom, { Fragment } from '@servicenow/ui-renderer-snabbdom';\nimport get from 'lodash/get';\nimport styles from './sn-uxf-renderer.scss';\nimport { getModalSize } from '../sn-uxf-builder-middleware/modalhandlers/utils';\nimport './sn-uib-value-renderer';\nimport { resolveBinding } from '../utils';\nimport { closeModal } from './utils';\n\nconst CONFIRM_AND_DESTROY_MODAL_ID = '637fc6a75b230010b913cbd59b81c779';\nconst IFRAME_MODAL_ID = 'e80108425b101010b913cbd59b81c771';\nconst ALERT_MODAL_ID = '05d8b1515b230010b913cbd59b81c71a';\n\nconst resolveBindingValue = (\n\tstringVal,\n\t{\n\t\tbindings,\n\t\tancestorPageProperties,\n\t\tdataBrokerInstances,\n\t\tancestorDataBrokerInstances,\n\t\trootElement,\n\t\tancestorElements,\n\t\tclientScriptApi,\n\t\tappChromeSettings\n\t}\n) => {\n\treturn resolveBinding(stringVal, {\n\t\tbindings,\n\t\tancestorPageProperties,\n\t\tdataBrokerInstances,\n\t\tancestorDataBrokerInstances,\n\t\trootElement,\n\t\tancestorElements,\n\t\tclientScriptApi,\n\t\tappChromeSettings\n\t});\n};\n\nconst renderModalHeader = (properties, dispatch) => {\n\tconst { element } = properties;\n\tconst headerLabel = get(element, 'properties.headerLabel.value', '');\n\treturn (\n\t\t<Fragment>\n\t\t\t<h1 className=\"now-modal-heading\">\n\t\t\t\t<sn-uib-value-renderer\n\t\t\t\t\tvalue={resolveBindingValue(headerLabel, properties)}\n\t\t\t\t/>\n\t\t\t</h1>\n\t\t\t<div on-click={(event) => closeModal(event, dispatch)}>\n\t\t\t\t<now-button-iconic\n\t\t\t\t\ticon=\"close-fill\"\n\t\t\t\t\tsize=\"md\"\n\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\tbare={true}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Fragment>\n\t);\n};\n\nconst renderModalContent = (properties) => {\n\tconst { element } = properties;\n\tconst isIframeModal = get(element, 'component.id', '') === IFRAME_MODAL_ID;\n\tconst content = get(element, 'properties.content.value', '');\n\tconst iframeSrc = get(element, 'properties.src.value', '');\n\n\tconst renderOOBModalContent = isIframeModal ? (\n\t\t<sn-uib-no-interact-wrapper>\n\t\t\t<iframe\n\t\t\t\tid=\"iframe-modal-id\"\n\t\t\t\ttitle=\"iframe-modal\"\n\t\t\t\tframeBorder=\"0\"\n\t\t\t\tscrolling=\"no\"\n\t\t\t\tsrc={iframeSrc}\n\t\t\t\twidth=\"100%\"\n\t\t\t\theight=\"100%\"\n\t\t\t/>\n\t\t</sn-uib-no-interact-wrapper>\n\t) : (\n\t\t<sn-uib-value-renderer value={resolveBindingValue(content, properties)} />\n\t);\n\n\treturn renderOOBModalContent;\n};\n\nconst renderModalFooter = (properties) => {\n\tconst { element } = properties;\n\tconst componentId = get(element, 'component.id', '');\n\tconst isConfirmDestroyModal = componentId === CONFIRM_AND_DESTROY_MODAL_ID;\n\tconst isIframeModal = componentId === IFRAME_MODAL_ID;\n\n\tif (isIframeModal) {\n\t\treturn;\n\t}\n\n\tconst primaryButtonLabel =\n\t\tcomponentId === ALERT_MODAL_ID\n\t\t\t? get(element, 'properties.buttonLabel.value', '')\n\t\t\t: get(element, 'properties.primaryButtonLabel.value', '');\n\tconst secondaryButtonLabel = get(\n\t\telement,\n\t\t'properties.secondaryButtonLabel.value',\n\t\t''\n\t);\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<now-button\n\t\t\t\tlabel={resolveBindingValue(primaryButtonLabel, properties)}\n\t\t\t\tclassName=\"footer-button-1\"\n\t\t\t\tvariant={isConfirmDestroyModal ? 'primary-negative' : 'primary'}\n\t\t\t\tsize=\"md\"\n\t\t\t/>\n\n\t\t\t{element.properties.secondaryButtonLabel ? (\n\t\t\t\t<now-button\n\t\t\t\t\tlabel={resolveBindingValue(secondaryButtonLabel, properties)}\n\t\t\t\t\tclassName=\"footer-button-2\"\n\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\tsize=\"md\"\n\t\t\t\t/>\n\t\t\t) : null}\n\t\t</Fragment>\n\t);\n};\n\nconst view = ({ properties }, { dispatch }) => {\n\tconst { element } = properties;\n\treturn (\n\t\t<div\n\t\t\tclass={{\n\t\t\t\t'stage-modal-container': true,\n\t\t\t\t[getModalSize(element.properties.size.value)]: true\n\t\t\t}}>\n\t\t\t<div className=\"now-modal-header\">\n\t\t\t\t{renderModalHeader(properties, dispatch)}\n\t\t\t</div>\n\t\t\t<div className=\"now-modal-body\">{renderModalContent(properties)}</div>\n\t\t\t<div className=\"now-modal-footer\">{renderModalFooter(properties)}</div>\n\t\t</div>\n\t);\n};\n\ncreateCustomElement('sn-uib-modal-content', {\n\trenderer: { type: snabbdom },\n\tview,\n\tstyles,\n\tproperties: {\n\t\telement: {\n\t\t\tdefault: {}\n\t\t},\n\t\trenderers: {\n\t\t\tdefault: {}\n\t\t},\n\t\tbindings: {\n\t\t\tdefault: {}\n\t\t},\n\t\trootElement: {\n\t\t\tdefault: {}\n\t\t},\n\t\tancestorPageProperties: {\n\t\t\tdefault: '@uxf/ancestorPageProperties'\n\t\t},\n\t\tdataBrokerInstances: {\n\t\t\tdefault: '@uxf/dataBrokerInstances'\n\t\t},\n\t\tancestorDataBrokerInstances: {\n\t\t\tdefault: '@uxf/ancestorDataBrokerInstances'\n\t\t},\n\t\tancestorElements: {\n\t\t\tdefault: '@uxf/ancestorElements'\n\t\t},\n\t\tclientScriptApi: {\n\t\t\tdefault: '@uxf/clientScriptApi'\n\t\t},\n\t\tappChromeSettings: {\n\t\t\tdefault: '@uxf/appChromeSettings'\n\t\t}\n\t}\n});\n","import '@servicenow/now-uxf-page';\nimport { createCustomElement } from '@servicenow/ui-core';\nimport snabbdom from '@servicenow/ui-renderer-snabbdom';\nimport styles from './sn-uxf-renderer.scss';\nimport get from 'lodash/get';\nimport createContextBindings from '../sn-uxf-builder-middleware/pageProperties/utils/createContextBindings';\nimport { t } from 'sn-translate';\nimport { installTheme } from '@devsnc/library-uxf';\nimport { findSelectedElement, closeModal } from './utils';\nimport resetTheme from './resetTheme.json';\nimport {\n\tisCustomModalComponent,\n\tisViewportModalComponent\n} from '../sn-uxf-builder-middleware/modalhandlers/utils';\nimport './sn-uib-modal-content';\nimport '@servicenow/now-empty-state';\n\nconst renderBareModalContent = ({\n\telement,\n\trenderers,\n\tbindings,\n\trootElement,\n\thiddenElements\n}) => {\n\tconst component = get(element, 'component', {});\n\tif (isCustomModalComponent(component)) {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"modal-content\"\n\t\t\t\tstyle={hiddenElements[element.id] ? { display: 'none' } : null}>\n\t\t\t\t<sn-uxf-element-mount\n\t\t\t\t\telement={element}\n\t\t\t\t\trenderers={renderers}\n\t\t\t\t\tbindings={bindings}\n\t\t\t\t\trootElement={rootElement}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\tif (isViewportModalComponent(component)) {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"modal-content\"\n\t\t\t\tstyle={hiddenElements[element.id] ? { display: 'none' } : null}>\n\t\t\t\t<now-empty-state\n\t\t\t\t\tvariant=\"auto\"\n\t\t\t\t\ticon=\"modal-outline\"\n\t\t\t\t\theaderText={t('The content of this viewport modal are dynamic.')}\n\t\t\t\t\tbodyText={t('Use event binding to pass content in.')}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n};\n\nconst view = (state) => {\n\tconst {\n\t\tproperties: {\n\t\t\tpage,\n\t\t\trenderers,\n\t\t\tselectedElementId,\n\t\t\tstageDimensions,\n\t\t\ttheme,\n\t\t\tbindings,\n\t\t\tselectedSlotName,\n\t\t\tselectedSlotParent,\n\t\t\thiddenElements\n\t\t}\n\t} = state;\n\n\tif (page) {\n\t\tconst { rootElement } = page;\n\n\t\tconst { top = 0, height = 1000 } = stageDimensions;\n\n\t\tconst elementId = selectedSlotName ? selectedSlotParent : selectedElementId;\n\n\t\tconst selectedElement =\n\t\t\tfindSelectedElement(page.rootElement, elementId) || {};\n\n\t\tlet themeAsJson;\n\t\ttry {\n\t\t\tthemeAsJson = JSON.parse(theme);\n\t\t} catch (er) {\n\t\t\tthemeAsJson = {};\n\t\t}\n\n\t\tconst resetThemeWithOverrides = {\n\t\t\t...themeAsJson,\n\t\t\ttheme: {\n\t\t\t\t...resetTheme,\n\t\t\t\t...themeAsJson.theme\n\t\t\t}\n\t\t};\n\t\tconst installResetThemeWithOverrides = (vnode) => {\n\t\t\tinstallTheme(\n\t\t\t\tresetThemeWithOverrides,\n\t\t\t\tvnode.elm,\n\t\t\t\t'reset-theme',\n\t\t\t\t'#sn-uxf-renderer-theme-with-overrides'\n\t\t\t);\n\t\t};\n\n\t\tconst modalStyle = {\n\t\t\ttop: `${top}px`,\n\t\t\theight: `${height}px`\n\t\t};\n\n\t\thiddenElements[selectedElement.id] && (modalStyle.display = 'none');\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclass={{\n\t\t\t\t\t'stage-renderer': true,\n\t\t\t\t\t'-modal': selectedElement && selectedElement.isModal\n\t\t\t\t}}>\n\t\t\t\t<div\n\t\t\t\t\tid=\"sn-uxf-renderer-theme-with-overrides\"\n\t\t\t\t\thook-insert={installResetThemeWithOverrides}>\n\t\t\t\t\t<sn-uxf-element-mount\n\t\t\t\t\t\telement={page.rootElement}\n\t\t\t\t\t\trenderers={renderers}\n\t\t\t\t\t\tbindings={bindings}\n\t\t\t\t\t\trootElement={rootElement}\n\t\t\t\t\t\thiddenElements={hiddenElements}\n\t\t\t\t\t/>\n\n\t\t\t\t\t{selectedElement && selectedElement.isModal ? (\n\t\t\t\t\t\tisCustomModalComponent(selectedElement.component) ||\n\t\t\t\t\t\tisViewportModalComponent(selectedElement.component) ? (\n\t\t\t\t\t\t\t<now-uxf-bare-modal\n\t\t\t\t\t\t\t\tstyle={\n\t\t\t\t\t\t\t\t\thiddenElements[selectedElement.id]\n\t\t\t\t\t\t\t\t\t\t? { display: 'none' }\n\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\topened={true}\n\t\t\t\t\t\t\t\tsize={get(selectedElement, 'properties.size.value', 'md')}\n\t\t\t\t\t\t\t\toverlayPositionAbsolute={true}\n\t\t\t\t\t\t\t\tdisableDismiss={get(\n\t\t\t\t\t\t\t\t\tselectedElement,\n\t\t\t\t\t\t\t\t\t'properties.disableDismiss.value',\n\t\t\t\t\t\t\t\t\tfalse\n\t\t\t\t\t\t\t\t)}>\n\t\t\t\t\t\t\t\t{renderBareModalContent({\n\t\t\t\t\t\t\t\t\telement: selectedElement,\n\t\t\t\t\t\t\t\t\trenderers,\n\t\t\t\t\t\t\t\t\tbindings,\n\t\t\t\t\t\t\t\t\trootElement,\n\t\t\t\t\t\t\t\t\thiddenElements\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</now-uxf-bare-modal>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName=\"stage-modal-overlay\"\n\t\t\t\t\t\t\t\tstyle={modalStyle}\n\t\t\t\t\t\t\t\ton-click={(event) => {\n\t\t\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t<sn-uib-modal-content\n\t\t\t\t\t\t\t\t\telement={selectedElement}\n\t\t\t\t\t\t\t\t\trenderers={renderers}\n\t\t\t\t\t\t\t\t\tbindings={bindings}\n\t\t\t\t\t\t\t\t\trootElement={rootElement}\n\t\t\t\t\t\t\t\t\tclassName=\"modal-content-container\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)\n\t\t\t\t\t) : null}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t} else {\n\t\treturn null;\n\t}\n};\n\nexport default createCustomElement('sn-uxf-renderer', {\n\trenderer: { type: snabbdom },\n\tview,\n\tstyles,\n\tproperties: {\n\t\tpage: {\n\t\t\tdefault: null\n\t\t},\n\t\tbindings: {\n\t\t\tcomputed({ properties: { page } }) {\n\t\t\t\tif (page) {\n\t\t\t\t\tconst { uiTypeParameters = {} } = page;\n\t\t\t\t\tconst pageProperties = createContextBindings(page);\n\t\t\t\t\tconst bindings = {\n\t\t\t\t\t\t...uiTypeParameters,\n\t\t\t\t\t\t...pageProperties\n\t\t\t\t\t};\n\t\t\t\t\treturn bindings;\n\t\t\t\t}\n\t\t\t\treturn {};\n\t\t\t}\n\t\t},\n\t\tselectedElementId: {\n\t\t\tdefault: ''\n\t\t},\n\t\tstageDimensions: {\n\t\t\tdefault: {}\n\t\t},\n\t\trenderers: {\n\t\t\tdefault: {\n\t\t\t\tcolumn: null,\n\t\t\t\trow: null,\n\t\t\t\telement: null,\n\t\t\t\temptySlot: null\n\t\t\t}\n\t\t},\n\t\tancestorPageProperties: {\n\t\t\tdefault: '@uxf/ancestorPageProperties'\n\t\t},\n\t\tdataBrokerInstances: {\n\t\t\tdefault: '@uxf/dataBrokerInstances'\n\t\t},\n\t\tancestorDataBrokerInstances: {\n\t\t\tdefault: '@uxf/ancestorDataBrokerInstances'\n\t\t},\n\t\tancestorElements: {\n\t\t\tdefault: '@uxf/ancestorElements'\n\t\t},\n\t\ttheme: {\n\t\t\tdefault: '@uxf/theme'\n\t\t},\n\t\tselectedSlotName: {\n\t\t\tdefault: null\n\t\t},\n\t\tselectedSlotParent: {\n\t\t\tdefault: null\n\t\t},\n\t\tselectedSlotParentComponent: {\n\t\t\tdefault: null\n\t\t},\n\t\thiddenElements: {\n\t\t\tdefault: {}\n\t\t}\n\t},\n\tactionHandlers: {\n\t\t['NOW_BUTTON_ICONIC#CLICKED']: ({ action }) => action.stopPropagation(),\n\t\t['NOW_UXF_BARE_MODAL#DISMISSED']: ({ action, dispatch }) =>\n\t\t\tcloseModal(action, dispatch)\n\t}\n});\n","import pick from 'lodash/pick';\nimport isEmpty from 'lodash/isEmpty';\nimport get from 'lodash/get';\n\nconst hostAllowList = [\n\t'flex',\n\t'align-self',\n\t'order',\n\t'flex-grow',\n\t'flex-shrink',\n\t'flex-basis',\n\t'grid-column-start',\n\t'grid-column-end',\n\t'grid-row-start',\n\t'grid-row-end',\n\t'grid-area',\n\t'justify-self',\n\t'place-self',\n\t'display',\n\t'width',\n\t'min-width',\n\t'max-width',\n\t'height',\n\t'min-height',\n\t'max-height',\n\t'margin',\n\t'margin-top',\n\t'margin-right',\n\t'margin-bottom',\n\t'margin-left'\n];\n\nconst stripSlotStyles = (model = {}, layouRole = 'default') => {\n\tconst defaultModel = get(model, layouRole, {}) || {};\n\tconst items = defaultModel.items || [];\n\n\treturn {\n\t\t...model,\n\t\tdefault: {\n\t\t\t...defaultModel,\n\t\t\titems: items.map((item) => {\n\t\t\t\treturn {\n\t\t\t\t\t...item,\n\t\t\t\t\tstyles: pick(item.styles || {}, hostAllowList)\n\t\t\t\t};\n\t\t\t})\n\t\t}\n\t};\n};\nconst cssStringToObject = (css) => {\n\t/**\n\t * Fun regex:\n\t * (?:^|;) -- This is making sure the pattern either starts with the beginning of the string or the previous line has a semicolon\n\t * \\s* -- covering possible whitespace\n\t * (\\w[\\w-]+) -- Looking for rules that start with a word character and then consists of word characters and '-'. This is captured to use as the rule\n\t * \\s* -- possible whitespace\n\t * : -- a colon!\n\t * \\s* -- possible whitespace\n\t * (?:\\([^)]+\\)|[^;])+) -- Capturing the rule's value. Anything that is in a parentheses or (the pipe character) anything that's not a semicolon\n\t * \\s* -- possible whitespace\n\t * (?:;|$) making sure the end of the 'rule' is either the end of the input or a semicolon.\n\t */\n\n\tconst rgx = /\\s*(\\w[\\w-]+)\\s*:\\s*((?:\\([^)]+\\)|[^;])+)\\s*(?:;|$)/gm;\n\tconst cssObj = {};\n\tlet result = rgx.exec(css);\n\n\twhile (result) {\n\t\tcssObj[result[1].trim()] = result[2].trim();\n\t\tresult = rgx.exec(css);\n\t}\n\n\treturn cssObj;\n};\n\nconst HostCss = ({ cssObj, id }) => {\n\tif (isEmpty(cssObj)) {\n\t\treturn null;\n\t}\n\tconst filteredObj = pick(cssObj, hostAllowList);\n\tconst css = `:host {${Object.entries(filteredObj)\n\t\t.map((arr) => arr.join(' : '))\n\t\t.join(';')}}`;\n\n\treturn <style key={id} type=\"text/css\" innerHTML={css} />;\n};\n\nconst getHostCSS = (host) => {\n\tif (!host || !host.shadowRoot) {\n\t\treturn {};\n\t}\n\tconst tag = host.tagName;\n\tconst root = host.shadowRoot;\n\n\treturn [...root.styleSheets, ...root.adoptedStyleSheets]\n\t\t.map((styleSheet) => {\n\t\t\ttry {\n\t\t\t\treturn [...styleSheet.cssRules]\n\t\t\t\t\t.map((rule) => {\n\t\t\t\t\t\tconst rxp = new RegExp(`\\\\:host\\\\(${tag}\\\\)`, 'i');\n\t\t\t\t\t\tconst text = rule.cssText.replace(rxp, ':host');\n\n\t\t\t\t\t\treturn text;\n\t\t\t\t\t})\n\t\t\t\t\t.filter((ruleText) => {\n\t\t\t\t\t\tconst rxp = new RegExp(`:host\\\\s*[,{]`, 'i');\n\n\t\t\t\t\t\treturn rxp.test(ruleText);\n\t\t\t\t\t})\n\t\t\t\t\t.reduce((acc, css) => {\n\t\t\t\t\t\tconst regexForInsideBrackets = /^.+\\{([^}]+)}.*$/m;\n\t\t\t\t\t\tconst results = regexForInsideBrackets.exec(css) || [null, ''];\n\t\t\t\t\t\tconst parsed = cssStringToObject(results[1]);\n\n\t\t\t\t\t\treturn { ...acc, ...parsed };\n\t\t\t\t\t}, {});\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(\n\t\t\t\t\t'Access to stylesheet %s is denied. Ignoring...',\n\t\t\t\t\tstyleSheet.href,\n\t\t\t\t\te.message\n\t\t\t\t);\n\t\t\t}\n\t\t})\n\t\t.filter(Boolean)\n\t\t.reduce((acc, css) => {\n\t\t\treturn { ...acc, ...css };\n\t\t}, {});\n};\n\nexport { getHostCSS, HostCss, hostAllowList, stripSlotStyles };\n","import '@devsnc/sn-layout';\nimport '@servicenow/now-uxf-page';\nimport { createCustomElement } from '@servicenow/ui-core';\n// eslint-disable-next-line no-unused-vars\nimport snabbdom, { Fragment } from '@servicenow/ui-renderer-snabbdom';\n\nimport assign from 'lodash/assign';\nimport omit from 'lodash/omit';\nimport pick from 'lodash/pick';\nimport camelCase from 'lodash/camelCase';\nimport forEach from 'lodash/forEach';\nimport get from 'lodash/get';\nimport isEmpty from 'lodash/isEmpty';\nimport mapValues from 'lodash/mapValues';\nimport {\n\tDATA_NAMESPACE,\n\tDATA_OUTPUT_BINDING,\n\tJSON_LITERAL,\n\tDEFER\n} from '../constants';\n// eslint-disable-next-line no-unused-vars\nimport { getHostCSS, HostCss, hostAllowList, stripSlotStyles } from './utils';\nimport {\n\tmatchBindingSyntax,\n\tresolvePropertyBinding,\n\tresolveBinding,\n\tgetWithNullDefault,\n\tnormalizeRowColumnSlots\n} from '../utils';\nimport { UIB_VIEWPORT_RENDER_CONTENTS } from '../sn-uxf-builder-middleware/viewportHandlers/actions';\nimport { VIEWPORT_ROUTES } from '../sn-uxf-builder-middleware/element/reservedPropertyIds';\nimport {\n\tisViewportComponent,\n\tisViewportIsolatedEditingDisabled\n} from '../sn-uxf-builder-middleware/viewportHandlers/utils';\n\nconst defaultElementRenderer = ({ children }) => <div>{children}</div>;\n\nconst isContainer = (tag) =>\n\ttag === 'sn-page' ||\n\ttag === 'sn-page-container' ||\n\ttag === 'now-uxf-page-container' ||\n\ttag === 'now-uxf-page-simple-container';\n\nconst partialRendererFn = (rendererFn, args) => (layoutArgs) =>\n\trendererFn(assign(args, layoutArgs));\n\nconst nextFrame = (fn) =>\n\trequestAnimationFrame(() => {\n\t\tsetTimeout(() => fn());\n\t});\nconst doesSlotSeeMount = (el, id) => {\n\tconst slot = el.assignedSlot;\n\tconst nodes = slot ? slot.assignedNodes() : [];\n\treturn nodes.some((node) => node.element.id === id);\n};\nconst reattachSlotName = (el, slotName) => {\n\tel.slot = 'foo';\n\tnextFrame(() => {\n\t\tel.slot = slotName;\n\t});\n};\n\nfunction elementHasNoDefaultSlot(element) {\n\treturn element.component.slots.indexOf('@default') === -1;\n}\n\nfunction elementHasNamedSlots(element) {\n\treturn (\n\t\telement.component.slots.filter((slot) => {\n\t\t\treturn slot !== '@default';\n\t\t}).length > 0\n\t);\n}\nconst NO_SLOT = 'NO_SLOT';\n\nconst transformChildren = (acc, child) => {\n\tif (!get(child, 'slot.name')) {\n\t\tconst existingChildren = acc[NO_SLOT] || [];\n\t\treturn { ...acc, [NO_SLOT]: [...existingChildren, child] };\n\t}\n\tconst existingChildren = acc[child.slot.name] || [];\n\treturn { ...acc, [child.slot.name]: [...existingChildren, child] };\n};\n\nconst styleForUIB = (element, isHidden) => {\n\tif (isHidden) {\n\t\treturn { display: 'none' };\n\t}\n\treturn {};\n};\n\nconst processChildren = (\n\tchildren,\n\trenderers,\n\trootElement,\n\telement,\n\tbindings,\n\thiddenElements\n) => {\n\treturn (\n\t\t<Fragment>\n\t\t\t{children.map((child) => {\n\t\t\t\treturn (\n\t\t\t\t\t<sn-uxf-element-mount\n\t\t\t\t\t\tstyle={styleForUIB(child, hiddenElements[child.id])}\n\t\t\t\t\t\telement={child}\n\t\t\t\t\t\trenderers={renderers}\n\t\t\t\t\t\tkey={child.id}\n\t\t\t\t\t\tslot={get(child, 'slot.name', null)}\n\t\t\t\t\t\thook={{\n\t\t\t\t\t\t\tinsert({ elm }) {\n\t\t\t\t\t\t\t\tnextFrame(() => {\n\t\t\t\t\t\t\t\t\tconst slotConnected = doesSlotSeeMount(elm, child.id);\n\t\t\t\t\t\t\t\t\tif (!slotConnected) {\n\t\t\t\t\t\t\t\t\t\treattachSlotName(elm, child.slot.name);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tupdate(_, { elm }) {\n\t\t\t\t\t\t\t\tnextFrame(() => {\n\t\t\t\t\t\t\t\t\tconst slotConnected = doesSlotSeeMount(elm, child.id);\n\t\t\t\t\t\t\t\t\tif (!slotConnected) {\n\t\t\t\t\t\t\t\t\t\treattachSlotName(elm, child.slot.name);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tparent={element.id}\n\t\t\t\t\t\tbindings={bindings}\n\t\t\t\t\t\trootElement={rootElement}\n\t\t\t\t\t\thiddenElements={hiddenElements}\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t})}\n\t\t</Fragment>\n\t);\n};\n\n// If element supports has not @default slot return\n// if element is of type rowC\nconst renderChildren = (\n\telement,\n\trenderers,\n\tparent,\n\tbindings,\n\trootElement,\n\thiddenElements\n) => {\n\tif (elementHasNoDefaultSlot(element) && !elementHasNamedSlots(element)) {\n\t\treturn null;\n\t}\n\n\tconst mountableChildren = element.children.filter((child) => !child.isModal);\n\n\tif (get(element, 'layout.default.type') === 'rowColumn') {\n\t\tconst formattedModel = normalizeRowColumnSlots(element.layout);\n\t\tconst layoutRendererParams = {\n\t\t\tisContainer: false,\n\t\t\tlayout: get(element, 'layout.default', null),\n\t\t\telementId: element.id\n\t\t};\n\n\t\tconst obj = mountableChildren.reduce(transformChildren, {});\n\n\t\tconst unslottedChildren = obj[NO_SLOT] || [];\n\t\treturn (\n\t\t\t<sn-layout\n\t\t\t\tmodel={stripSlotStyles(element.layout)}\n\t\t\t\trenderers={{\n\t\t\t\t\tcolumn: renderers.column\n\t\t\t\t\t\t? partialRendererFn(renderers.column, layoutRendererParams)\n\t\t\t\t\t\t: null,\n\t\t\t\t\trow: renderers.row\n\t\t\t\t\t\t? partialRendererFn(renderers.row, layoutRendererParams)\n\t\t\t\t\t\t: null\n\t\t\t\t}}>\n\t\t\t\t{formattedModel.default.items.map((item) => {\n\t\t\t\t\tconst children = obj[item.slotName];\n\t\t\t\t\tif (children && children.length > 0) {\n\t\t\t\t\t\treturn renderers.slotWrapper({\n\t\t\t\t\t\t\tchildren: processChildren(\n\t\t\t\t\t\t\t\tchildren,\n\t\t\t\t\t\t\t\trenderers,\n\t\t\t\t\t\t\t\trootElement,\n\t\t\t\t\t\t\t\telement,\n\t\t\t\t\t\t\t\tbindings,\n\t\t\t\t\t\t\t\thiddenElements\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tslotName: item.slotName,\n\t\t\t\t\t\t\tslotParent: element.id,\n\t\t\t\t\t\t\tstyles: item.styles || {}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn renderers.slotWrapper({\n\t\t\t\t\t\t\tchildren: renderers.emptyRegion\n\t\t\t\t\t\t\t\t? renderers.emptyRegion({\n\t\t\t\t\t\t\t\t\t\telementId: element.id,\n\t\t\t\t\t\t\t\t\t\tparentElementId: parent || element.id,\n\t\t\t\t\t\t\t\t\t\tslotName: item.slotName,\n\t\t\t\t\t\t\t\t\t\tisModalDescendant:\n\t\t\t\t\t\t\t\t\t\t\telement.isModal || element.isModalDescendant\n\t\t\t\t\t\t\t\t  })\n\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\tslotName: item.slotName,\n\t\t\t\t\t\t\tslotParent: element.id,\n\n\t\t\t\t\t\t\tstyles: item.styles || {}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})}\n\t\t\t\t{processChildren(\n\t\t\t\t\tunslottedChildren,\n\t\t\t\t\trenderers,\n\t\t\t\t\trootElement,\n\t\t\t\t\telement,\n\t\t\t\t\tbindings,\n\t\t\t\t\thiddenElements\n\t\t\t\t)}\n\t\t\t</sn-layout>\n\t\t);\n\t}\n\tif (getWithNullDefault(element, 'layout.default.items', []).length > 0) {\n\t\tif (mountableChildren.length > 0) {\n\t\t\tconst obj = mountableChildren.reduce(transformChildren, {});\n\n\t\t\t/**\n\t\t\t * Render a slot render for each for each item\n\t\t\t */\n\t\t\treturn (\n\t\t\t\t<sn-layout model={stripSlotStyles(element.layout)}>\n\t\t\t\t\t{element.layout.default.items.map((item) => {\n\t\t\t\t\t\tconst children = obj[item.slotName];\n\t\t\t\t\t\tif (children && children.length > 0) {\n\t\t\t\t\t\t\treturn renderers.slotWrapper({\n\t\t\t\t\t\t\t\tchildren: processChildren(\n\t\t\t\t\t\t\t\t\tchildren,\n\t\t\t\t\t\t\t\t\trenderers,\n\t\t\t\t\t\t\t\t\trootElement,\n\t\t\t\t\t\t\t\t\telement,\n\t\t\t\t\t\t\t\t\tbindings,\n\t\t\t\t\t\t\t\t\thiddenElements\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tslotName: item.slotName,\n\t\t\t\t\t\t\t\tslotParent: element.id,\n\t\t\t\t\t\t\t\tstyles: item.styles || {}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn renderers.slotWrapper({\n\t\t\t\t\t\t\t\tchildren: renderers.emptyRegion\n\t\t\t\t\t\t\t\t\t? renderers.emptyRegion({\n\t\t\t\t\t\t\t\t\t\t\telementId: element.id,\n\t\t\t\t\t\t\t\t\t\t\tparentElementId: parent || element.id,\n\t\t\t\t\t\t\t\t\t\t\tslotName: item.slotName,\n\t\t\t\t\t\t\t\t\t\t\tisModalDescendant:\n\t\t\t\t\t\t\t\t\t\t\t\telement.isModal || element.isModalDescendant\n\t\t\t\t\t\t\t\t\t  })\n\t\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\t\tslotName: item.slotName,\n\t\t\t\t\t\t\t\tslotParent: element.id,\n\t\t\t\t\t\t\t\tstyles: item.styles || {}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})}\n\t\t\t\t</sn-layout>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<sn-layout model={stripSlotStyles(element.layout)}>\n\t\t\t\t\t{element.layout.default.items.map((item) =>\n\t\t\t\t\t\trenderers.slotWrapper({\n\t\t\t\t\t\t\tchildren: renderers.emptyRegion\n\t\t\t\t\t\t\t\t? renderers.emptyRegion({\n\t\t\t\t\t\t\t\t\t\telementId: element.id,\n\t\t\t\t\t\t\t\t\t\tparentElementId: parent || element.id,\n\t\t\t\t\t\t\t\t\t\tslotName: item.slotName,\n\t\t\t\t\t\t\t\t\t\tisModalDescendant:\n\t\t\t\t\t\t\t\t\t\t\telement.isModal || element.isModalDescendant\n\t\t\t\t\t\t\t\t  })\n\t\t\t\t\t\t\t\t: null,\n\n\t\t\t\t\t\t\tslotName: item.slotName,\n\t\t\t\t\t\t\tslotParent: element.id,\n\t\t\t\t\t\t\tstyles: item.styles || {}\n\t\t\t\t\t\t})\n\t\t\t\t\t)}\n\t\t\t\t</sn-layout>\n\t\t\t);\n\t\t}\n\t}\n\n\tif (elementHasNamedSlots(element)) {\n\t\t/**\n\t\t * We do not call slotWrapper here because:\n\t\t * - Until optional slot metadata is supported we don't want to pass default elements into slots\n\t\t * - Since sn-layout is not used in named slots we cannot style the slots or insert\n\t\t * \tnear them there aren't many reasons to display them.\n\t\t */\n\t\tif (element.children && element.children.length > 0) {\n\t\t\treturn processChildren(\n\t\t\t\telement.children,\n\t\t\t\trenderers,\n\t\t\t\trootElement,\n\t\t\t\telement,\n\t\t\t\tbindings,\n\t\t\t\thiddenElements\n\t\t\t);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\treturn renderers.emptySlot\n\t\t? renderers.emptySlot({\n\t\t\t\telementId: element.id,\n\t\t\t\tparentElementId: parent\n\t\t  })\n\t\t: null;\n};\n\nconst rootNodeStyles = {\n\tminHeight: 'inherit',\n\tminWidth: 'inherit',\n\twidth: 'inherit',\n\theight: 'inherit'\n};\nconst view = (state, { dispatch, updateState }) => {\n\tconst {\n\t\thostCss,\n\t\tproperties: {\n\t\t\telement,\n\t\t\trenderers,\n\t\t\tparent,\n\t\t\trootElement,\n\t\t\tancestorElements,\n\t\t\tbindings,\n\t\t\tancestorPageProperties,\n\t\t\tdataBrokerInstances,\n\t\t\tancestorDataBrokerInstances,\n\t\t\tclientScriptApi,\n\t\t\thiddenElements,\n\t\t\tappChromeSettings,\n\t\t\t...dataProviderPropValues\n\t\t}\n\t} = state;\n\n\tif (!element) {\n\t\treturn null;\n\t}\n\trenderers.slotWrapper = renderers.slotWrapper\n\t\t? renderers.slotWrapper\n\t\t: ({ children }) => {\n\t\t\t\treturn <Fragment>{children}</Fragment>;\n\t\t  };\n\n\tconst MountedComponent = element.component.tag;\n\n\tconst propertyTypeMap = mapValues(element.properties, ({ type }) => type);\n\n\tconst properties = {\n\t\t...mapValues(element.properties, ({ name, value }) =>\n\t\t\t!element.propertyValues || element.propertyValues[name] === undefined\n\t\t\t\t? value\n\t\t\t\t: element.propertyValues[name]\n\t\t),\n\t\t...dataProviderPropValues[camelCase(MountedComponent)]\n\t};\n\n\tif (!parent) {\n\t\tproperties['component-id'] = element.id;\n\t}\n\n\tforEach(properties, (property, propName) => {\n\t\t/* \n\t\t\tUX Runtime added a property called defer to enhance performance by\n\t\t\trequesting only the components which are visible to the user (helpful in\n\t\t\tcase of modals etc). when an element is being mounted, we need to do \n\t\t\tthe same in UIB\n\t\t*/\n\t\tif (propName === DEFER) {\n\t\t\tproperties[propName] = false;\n\t\t} else {\n\t\t\tproperties[propName] = resolveBinding(property, {\n\t\t\t\tbindings,\n\t\t\t\tancestorPageProperties,\n\t\t\t\tdataBrokerInstances,\n\t\t\t\tancestorDataBrokerInstances,\n\t\t\t\trootElement,\n\t\t\t\tancestorElements,\n\t\t\t\tclientScriptApi,\n\t\t\t\tappChromeSettings,\n\t\t\t\ttype: propertyTypeMap[propName]\n\t\t\t});\n\t\t}\n\n\t\tconst processParentMcpBindingsForViewports = (mcp) => {\n\t\t\tif (!isEmpty(mcp.macroponentConfiguration)) {\n\t\t\t\tObject.keys(mcp.macroponentConfiguration).forEach((key) => {\n\t\t\t\t\tconst val = mcp.macroponentConfiguration[key];\n\t\t\t\t\tconst { type, binding } = val;\n\n\t\t\t\t\tif (type === DATA_OUTPUT_BINDING) {\n\t\t\t\t\t\tconst dbPath =\n\t\t\t\t\t\t\tbinding.address && [DATA_NAMESPACE, ...binding.address].join('.');\n\t\t\t\t\t\tconst matchedValues = dbPath && matchBindingSyntax(dbPath);\n\n\t\t\t\t\t\tconst value = resolvePropertyBinding({\n\t\t\t\t\t\t\tmatchedValues,\n\t\t\t\t\t\t\tbindings,\n\t\t\t\t\t\t\tancestorPageProperties,\n\t\t\t\t\t\t\tdataBrokerInstances,\n\t\t\t\t\t\t\tancestorDataBrokerInstances,\n\t\t\t\t\t\t\trootElement,\n\t\t\t\t\t\t\tancestorElements,\n\t\t\t\t\t\t\tappChromeSettings\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\tmcp.macroponentConfiguration[key] = {\n\t\t\t\t\t\t\t\ttype: JSON_LITERAL,\n\t\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\t// the macroponent loader which is used by viewport only renders\n\t\t// the tab page and has no information regarding any of the ancestors.\n\t\t// In that case, since it would not have access to parent data brokers,\n\t\t// we need to resolve it into a static value in the configuration before\n\t\t// making it available to the viewport. The viewport then\n\t\t// continues to use this value and render it on the UI.\n\n\t\tif (propName === VIEWPORT_ROUTES && !isEmpty(property)) {\n\t\t\tfor (const route in property) {\n\t\t\t\tconst routeConfiguration = property[route];\n\t\t\t\t// TODO: change this 0 when we know more about\n\t\t\t\t// route variants\n\t\t\t\tconst macroponents = get(routeConfiguration, `[0].macroponents`, []);\n\t\t\t\tmacroponents.forEach(processParentMcpBindingsForViewports);\n\t\t\t}\n\t\t}\n\t});\n\n\tconst renderViewportContents = ({ elm, ignoreCache }) => {\n\t\tif (isViewportComponent(element.component)) {\n\t\t\tdispatch(UIB_VIEWPORT_RENDER_CONTENTS, {\n\t\t\t\thost: elm,\n\t\t\t\tproperties,\n\t\t\t\tignoreCache\n\t\t\t});\n\t\t}\n\t\tconst css = getHostCSS(elm);\n\n\t\tif (!isEmpty(css) && isEmpty(hostCss || {})) {\n\t\t\tupdateState({ hostCss: css });\n\t\t}\n\t};\n\n\tconst isContainerNode = isContainer(element.component.tag);\n\n\treturn (\n\t\t<div style={rootNodeStyles}>\n\t\t\t<HostCss\n\t\t\t\tid={element.id}\n\t\t\t\tkey={element.id}\n\t\t\t\tcssObj={{ ...hostCss, ...element.styles }}\n\t\t\t/>\n\t\t\t{(renderers.element || defaultElementRenderer)({\n\t\t\t\tchildren: (\n\t\t\t\t\t<MountedComponent\n\t\t\t\t\t\tid={element.id}\n\t\t\t\t\t\tcomponent-id={element.id}\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t...omit(element.styles, hostAllowList),\n\t\t\t\t\t\t\t...(isContainerNode\n\t\t\t\t\t\t\t\t? pick(element.styles, ['width', 'height', 'display'])\n\t\t\t\t\t\t\t\t: pick(element.styles, ['width', 'height']))\n\t\t\t\t\t\t}}\n\t\t\t\t\t\thook-insert={({ elm }) => {\n\t\t\t\t\t\t\trenderViewportContents({ elm, ignoreCache: true });\n\t\t\t\t\t\t}}\n\t\t\t\t\t\thook-update={renderViewportContents}\n\t\t\t\t\t\t{...properties}>\n\t\t\t\t\t\t{renderChildren(\n\t\t\t\t\t\t\telement,\n\t\t\t\t\t\t\trenderers,\n\t\t\t\t\t\t\tparent,\n\t\t\t\t\t\t\tbindings,\n\t\t\t\t\t\t\trootElement,\n\t\t\t\t\t\t\thiddenElements\n\t\t\t\t\t\t)}\n\t\t\t\t\t</MountedComponent>\n\t\t\t\t),\n\t\t\t\telementId: element.id,\n\t\t\t\tcomponentId: element.component.id,\n\t\t\t\tisContainer: isContainerNode,\n\t\t\t\tparentElementId: parent,\n\t\t\t\tcomponentIcon: element.component.icon,\n\t\t\t\tinstanceName: element.instanceName,\n\t\t\t\thasError: element.error !== null,\n\t\t\t\tallowIsolatedEditing:\n\t\t\t\t\tisViewportComponent(element.component) &&\n\t\t\t\t\t!isViewportIsolatedEditingDisabled(properties)\n\t\t\t})}\n\t\t</div>\n\t);\n};\n\nexport default createCustomElement('sn-uxf-element-mount', {\n\trenderer: { type: snabbdom },\n\tview,\n\tproperties: {\n\t\telement: {\n\t\t\tdefault: null\n\t\t},\n\t\trenderers: {\n\t\t\tdefault: {\n\t\t\t\tcolumn: null,\n\t\t\t\trow: null,\n\t\t\t\telement: null,\n\t\t\t\tslotWrapper: ({ children }) => {\n\t\t\t\t\treturn <Fragment>{children}</Fragment>;\n\t\t\t\t},\n\t\t\t\temptySlot: null\n\t\t\t}\n\t\t},\n\t\tpageState: {\n\t\t\tdefault: '@uxf/pageState'\n\t\t},\n\t\tparent: {\n\t\t\tdefault: null\n\t\t},\n\t\tbindings: {\n\t\t\tdefault: {}\n\t\t},\n\t\tancestorPageProperties: {\n\t\t\tdefault: '@uxf/ancestorPageProperties'\n\t\t},\n\t\tdataBrokerInstances: {\n\t\t\tdefault: '@uxf/dataBrokerInstances'\n\t\t},\n\t\tancestorDataBrokerInstances: {\n\t\t\tdefault: '@uxf/ancestorDataBrokerInstances'\n\t\t},\n\t\trootElement: {\n\t\t\tdefault: null\n\t\t},\n\t\tancestorElements: {\n\t\t\tdefault: '@uxf/ancestorElements'\n\t\t},\n\t\tclientScriptApi: {\n\t\t\tdefault: '@uxf/clientScriptApi'\n\t\t},\n\t\thiddenElements: {\n\t\t\tdefault: {}\n\t\t},\n\t\tappChromeSettings: {\n\t\t\tdefault: '@uxf/appChromeSettings'\n\t\t}\n\t}\n});\n"],"sourceRoot":""}